<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::snapshot::LogReducer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1snapshot_1_1LogReducer.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfoedus_1_1snapshot_1_1LogReducer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::snapshot::LogReducer Class Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__SNAPSHOT.html">Snapshot Manager</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A log reducer, which receives log entries sent from mappers and applies them to construct new snapshot files.  
 <a href="classfoedus_1_1snapshot_1_1LogReducer.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A log reducer, which receives log entries sent from mappers and applies them to construct new snapshot files. </p>
<h1><a class="anchor" id="REDUCER_OVERVIEW"></a>
Overview</h1>
<p>Reducers receive log entries from mappers and apply them to new snapshot files.</p>
<h1><a class="anchor" id="SORTING"></a>
Sorting</h1>
<p>The log entries are sorted in a few steps to be processed efficiently and simply. Sorting starts when one of the reducer's buffer becomes full. Reducer never starts sorting until that to maximize the benefits of batch-processing (this design might be revisited later, though). Reducers maintain two buffers to let mappers keep sending data while reducers are sorting and dumping to temporary files.</p>
<h2><a class="anchor" id="STORAGE-SORT"></a>
Storage Sorting</h2>
<p>The first step is to sort log entries by storage, which is done in mappers. We process all log entries of one storage together. This has a benefit of code simplicity and less D-cache misses. We don't actually sort in this case because we don't care the order between storages. Thus, we use hashmap-like structure in mappers to sort based on storage-id.</p>
<p>Upon receiving a chunk of data from mappers, the reducer has to collect all of them to do the following (otherwise the sorting is incomplete). This is done by simply reading all block headers utilizing the block_length_ property. Assuming each block is sufficiently large, this jumping cost on DRAM should be negligible. If each block is not sufficiently large, there are anyway other performance issues.</p>
<h2><a class="anchor" id="KEY-ORDINAL-SORT"></a>
Key and Ordinal Sorting</h2>
<p>Then, in each storage, we sort logs by keys and then by ordinal (*). The algorithm to do this sorting depends on the storage type (eg Array, Masstree) because some storage has a VERY efficient way to do this. We exploit the fact that this sorting occurs only per storage, just passing the whole log entries for the storage to storage-specific logic defined in <a class="el" href="classfoedus_1_1storage_1_1Partitioner.html" title="Partitioning and sorting logic for one storage. ">foedus::storage::Partitioner</a>. This is another reason to sort by storage first.</p>
<p>(*) We do need to sort by ordinal. Otherwise correct result is not guaranteed. For example, imagine the following case: </p><ul>
<li>UPDATE rec-1 to A. Log-ordinal 1. </li>
<li>UPDATE rec-1 to B. Log-ordinal 2. Ordinal-1 must be processed before ordinal 2.</li>
</ul>
<p>For more details, see <a class="el" href="classfoedus_1_1storage_1_1Partitioner.html" title="Partitioning and sorting logic for one storage. ">foedus::storage::Partitioner</a>.</p>
<h2><a class="anchor" id="DUMP-MERGE"></a>
Dumping Logs and and Merging</h2>
<p>After the sorting, the reducer dumps the buffer to a file. When all logs are received, the reducer does merge-sort on top of the sorted run files.</p>
<h2><a class="anchor" id="COMPACTING"></a>
Compacting Logs</h2>
<p>In some cases, we can delete log entries for the same keys. For example, when we have two logs for the same key like the example above, we can safely omit the first log with ordinal 1 AS FAR AS both logs appear in the same reducer buffer and updated byte positions in the record are the same. Another example is updates followed by a deletion.</p>
<p>This compaction is especially useful for a record that is repeatedly updated/inserted/deleted, such as TPC-C's WAREHOUSE/DISTRICT records, where several thousands of overwrite-logs in each reducer buffer will be compacted into just one log.</p>
<p>See <a class="el" href="classfoedus_1_1storage_1_1Partitioner.html#a8c8909d8a44ae9d6a4afee0ded0add4c" title="Called from log reducer to sort log entries by keys. ">foedus::storage::Partitioner::sort_batch()</a> for more details.</p>
<h1><a class="anchor" id="DATAPAGES"></a>
Data Pages</h1>
<p>One tricky thing in reducer is how it manages data pages to read previous snapshot pages and apply the new logs. So far, we assume each reducer allocates a sufficient amount of DRAM to hold all pages it read/write during one snapshotting. If this doesn't hold, we might directly allocate pages on NVRAM and read/write there.</p>
<dl class="section note"><dt>Note</dt><dd>This is a private implementation-details of <a class="el" href="group__SNAPSHOT.html">Snapshot Manager</a>, thus file name ends with _impl. Do not include this header from a client program. There is no case client program needs to access this internal class.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>This class got a bit bloated and hard to do a whitebox test because of dependencies to other modules. Dump-part and merge-part should be separated into its own classes in a way testcases can independently test them. Maybe reducer should be its own package? </dd></dl>

<p>Definition at line <a class="el" href="log__reducer__impl_8hpp_source.html#l00293">293</a> of file <a class="el" href="log__reducer__impl_8hpp_source.html">log_reducer_impl.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="log__reducer__impl_8hpp_source.html">log_reducer_impl.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for foedus::snapshot::LogReducer:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducer__inherit__graph.png" border="0" usemap="#foedus_1_1snapshot_1_1LogReducer_inherit__map" alt="Inheritance graph"/></div>
<map name="foedus_1_1snapshot_1_1LogReducer_inherit__map" id="foedus_1_1snapshot_1_1LogReducer_inherit__map">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1MapReduceBase.html" title="Base class for LogMapper and LogReducer to share common code. " alt="" coords="5,155,233,181"/>
<area shape="rect" id="node3" href="classfoedus_1_1DefaultInitializable.html" title="Typical implementation of Initializable as a skeleton base class. " alt="" coords="33,80,205,107"/>
<area shape="rect" id="node4" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="53,5,185,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for foedus::snapshot::LogReducer:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducer__coll__graph.png" border="0" usemap="#foedus_1_1snapshot_1_1LogReducer_coll__map" alt="Collaboration graph"/></div>
<map name="foedus_1_1snapshot_1_1LogReducer_coll__map" id="foedus_1_1snapshot_1_1LogReducer_coll__map">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1MapReduceBase.html" title="Base class for LogMapper and LogReducer to share common code. " alt="" coords="1679,79,1907,105"/>
<area shape="rect" id="node3" href="classfoedus_1_1DefaultInitializable.html" title="Typical implementation of Initializable as a skeleton base class. " alt="" coords="808,5,980,32"/>
<area shape="rect" id="node4" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="294,23,426,49"/>
<area shape="rect" id="node10" href="classfoedus_1_1Engine.html" title="Database engine object that holds all resources and provides APIs. " alt="" coords="633,56,741,83"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html" title="A remote view of LogGleaner from all engines. " alt="" coords="1368,111,1583,137"/>
<area shape="rect" id="node6" href="classfoedus_1_1Attachable.html" title="foedus::Attachable\l\&lt; LogGleanerControlBlock \&gt;" alt="" coords="1004,107,1191,149"/>
<area shape="rect" id="node7" href="structfoedus_1_1snapshot_1_1LogGleanerControlBlock.html" title="Shared data for LogGleaner. " alt="" coords="589,122,784,163"/>
<area shape="rect" id="node8" href="structfoedus_1_1snapshot_1_1Snapshot.html" title="Represents one snapshot that converts all logs from base epoch to valid_until epoch into snapshot fil..." alt="" coords="268,129,452,156"/>
<area shape="rect" id="node9" href="classfoedus_1_1Epoch.html" title="Represents a time epoch. " alt="" coords="5,129,111,156"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1PartitionerMetadata.html" title="Tiny metadata of partitioner for every storage used while log gleaning. " alt="" coords="1008,181,1187,222"/>
<area shape="rect" id="node12" href="classfoedus_1_1soc_1_1SharedMutex.html" title="A mutex that can be placed in shared memory and used from multiple processes. " alt="" coords="599,188,774,215"/>
<area shape="rect" id="node13" title="STL class. " alt="" coords="1433,161,1517,188"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:addaf1ec8c392fb0384c0ae90e46a1b34"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html#addaf1ec8c392fb0384c0ae90e46a1b34">LogReducer</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine)</td></tr>
<tr class="separator:addaf1ec8c392fb0384c0ae90e46a1b34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f5f2664fee7cafc37ad28a657e37e9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html#a2f5f2664fee7cafc37ad28a657e37e9c">initialize_once</a> () override</td></tr>
<tr class="separator:a2f5f2664fee7cafc37ad28a657e37e9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dc30e3460f4d9e5a9fb56f8bd20f0c2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html#a9dc30e3460f4d9e5a9fb56f8bd20f0c2">uninitialize_once</a> () override</td></tr>
<tr class="separator:a9dc30e3460f4d9e5a9fb56f8bd20f0c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87f87c814bddb6a113be600ed415d92c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html#a87f87c814bddb6a113be600ed415d92c">to_string</a> () const  override</td></tr>
<tr class="memdesc:a87f87c814bddb6a113be600ed415d92c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expects "LogReducer-x", "LogMapper-y" etc.  <a href="#a87f87c814bddb6a113be600ed415d92c">More...</a><br /></td></tr>
<tr class="separator:a87f87c814bddb6a113be600ed415d92c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">foedus::snapshot::MapReduceBase</a></td></tr>
<tr class="memitem:a578d7b4aec1f63e400e42fcb265831d3 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a578d7b4aec1f63e400e42fcb265831d3">MapReduceBase</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, uint16_t id)</td></tr>
<tr class="separator:a578d7b4aec1f63e400e42fcb265831d3 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39f91a709d8086fc702cf13e648ab149 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a39f91a709d8086fc702cf13e648ab149">MapReduceBase</a> ()=delete</td></tr>
<tr class="separator:a39f91a709d8086fc702cf13e648ab149 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd843d0d59ba29071a5d1f0f09b3c73e inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#acd843d0d59ba29071a5d1f0f09b3c73e">MapReduceBase</a> (const <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">MapReduceBase</a> &amp;other)=delete</td></tr>
<tr class="separator:acd843d0d59ba29071a5d1f0f09b3c73e inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed433d7f533dafba97af9c500827bb6a inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">MapReduceBase</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aed433d7f533dafba97af9c500827bb6a">operator=</a> (const <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">MapReduceBase</a> &amp;other)=delete</td></tr>
<tr class="separator:aed433d7f533dafba97af9c500827bb6a inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc7581a3f7b95b4893c1a75b123fa76 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html">LogGleanerRef</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a1cc7581a3f7b95b4893c1a75b123fa76">get_parent</a> ()</td></tr>
<tr class="separator:a1cc7581a3f7b95b4893c1a75b123fa76 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3711faba6c5e0191c3edf66ea88805f inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ab3711faba6c5e0191c3edf66ea88805f">get_id</a> () const </td></tr>
<tr class="separator:ab3711faba6c5e0191c3edf66ea88805f inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a649cad8103f0e450c68866e7f44bea74 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a649cad8103f0e450c68866e7f44bea74">get_numa_node</a> () const </td></tr>
<tr class="separator:a649cad8103f0e450c68866e7f44bea74 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb73ed60ea4202f906f63f203b467ff inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a4bb73ed60ea4202f906f63f203b467ff">launch_thread</a> ()</td></tr>
<tr class="memdesc:a4bb73ed60ea4202f906f63f203b467ff inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start executing.  <a href="#a4bb73ed60ea4202f906f63f203b467ff">More...</a><br /></td></tr>
<tr class="separator:a4bb73ed60ea4202f906f63f203b467ff inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af685ecd4f6aa00202e875c4d4780ad38 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#af685ecd4f6aa00202e875c4d4780ad38">join_thread</a> ()</td></tr>
<tr class="separator:af685ecd4f6aa00202e875c4d4780ad38 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1DefaultInitializable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1DefaultInitializable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1DefaultInitializable.html">foedus::DefaultInitializable</a></td></tr>
<tr class="memitem:a5e0a2679baa030e297c1a51847352945 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a5e0a2679baa030e297c1a51847352945">DefaultInitializable</a> ()</td></tr>
<tr class="separator:a5e0a2679baa030e297c1a51847352945 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe7a18ec3e5edd143eb7d6a75d65ef9b inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#afe7a18ec3e5edd143eb7d6a75d65ef9b">~DefaultInitializable</a> ()</td></tr>
<tr class="separator:afe7a18ec3e5edd143eb7d6a75d65ef9b inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd6a8f8296ab570b545430593287d454 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#afd6a8f8296ab570b545430593287d454">DefaultInitializable</a> (const <a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;)=delete</td></tr>
<tr class="separator:afd6a8f8296ab570b545430593287d454 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31eb5acadf0544b97414efd33aed08c7 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a31eb5acadf0544b97414efd33aed08c7">operator=</a> (const <a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;)=delete</td></tr>
<tr class="separator:a31eb5acadf0544b97414efd33aed08c7 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff">initialize</a> () override final</td></tr>
<tr class="memdesc:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typical implementation of <a class="el" href="classfoedus_1_1Initializable.html#aa087b096d1edaeb0304c250eadb0d7e1" title="Acquires resources in this object, usually called right after constructor. ">Initializable::initialize()</a> that provides initialize-once semantics.  <a href="#a22a0dc3bbbca682c3bc41eace9b6d1ff">More...</a><br /></td></tr>
<tr class="separator:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb">uninitialize</a> () override final</td></tr>
<tr class="memdesc:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typical implementation of <a class="el" href="classfoedus_1_1Initializable.html#afbe5738b0bc85362fba80bdf788fd3c3" title="An idempotent method to release all resources of this object, if any. ">Initializable::uninitialize()</a> that provides uninitialize-once semantics.  <a href="#ab14b136a7d26f9f499ab9dc15a45a8cb">More...</a><br /></td></tr>
<tr class="separator:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e">is_initialized</a> () const  override final</td></tr>
<tr class="memdesc:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the object has been already initialized or not.  <a href="#a1abda1e84b8af8bd6916e52fd0a09f3e">More...</a><br /></td></tr>
<tr class="separator:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1Initializable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1Initializable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1Initializable.html">foedus::Initializable</a></td></tr>
<tr class="memitem:aff308260543d18b3fd1367fd9017b176 inherit pub_methods_classfoedus_1_1Initializable"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Initializable.html#aff308260543d18b3fd1367fd9017b176">~Initializable</a> ()</td></tr>
<tr class="separator:aff308260543d18b3fd1367fd9017b176 inherit pub_methods_classfoedus_1_1Initializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a09b348c18e707b626d9873a7a69fbfc7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html#a09b348c18e707b626d9873a7a69fbfc7">handle_process</a> () override</td></tr>
<tr class="memdesc:a09b348c18e707b626d9873a7a69fbfc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the specific logics in derived class.  <a href="#a09b348c18e707b626d9873a7a69fbfc7">More...</a><br /></td></tr>
<tr class="separator:a09b348c18e707b626d9873a7a69fbfc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classfoedus_1_1snapshot_1_1MapReduceBase')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">foedus::snapshot::MapReduceBase</a></td></tr>
<tr class="memitem:a3ba06a325855ed48539cd6f7d40a0412 inherit pro_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a3ba06a325855ed48539cd6f7d40a0412">check_cancelled</a> () const </td></tr>
<tr class="memdesc:a3ba06a325855ed48539cd6f7d40a0412 inherit pro_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derived class's <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae296d44aff3ed68f31958f46089526a0" title="Implements the specific logics in derived class. ">handle_process()</a> should occasionally call this to exit if it's cancelled.  <a href="#a3ba06a325855ed48539cd6f7d40a0412">More...</a><br /></td></tr>
<tr class="separator:a3ba06a325855ed48539cd6f7d40a0412 inherit pro_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a0f46ae94b8c2f43b2dcae4b4eed6438b"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html#a0f46ae94b8c2f43b2dcae4b4eed6438b">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html">LogReducer</a> &amp;v)</td></tr>
<tr class="separator:a0f46ae94b8c2f43b2dcae4b4eed6438b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">foedus::snapshot::MapReduceBase</a></td></tr>
<tr class="memitem:afa57df91188b9ce05a71ceab488f9395 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">engine_</a></td></tr>
<tr class="separator:afa57df91188b9ce05a71ceab488f9395 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f3ce7311cab6118e780bd933e3f407 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html">LogGleanerRef</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae5f3ce7311cab6118e780bd933e3f407">parent_</a></td></tr>
<tr class="separator:ae5f3ce7311cab6118e780bd933e3f407 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad999cfc08cc7d7072ae6e0ed73651fca inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">const uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ad999cfc08cc7d7072ae6e0ed73651fca">id_</a></td></tr>
<tr class="memdesc:ad999cfc08cc7d7072ae6e0ed73651fca inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unique ID of this mapper or reducer.  <a href="#ad999cfc08cc7d7072ae6e0ed73651fca">More...</a><br /></td></tr>
<tr class="separator:ad999cfc08cc7d7072ae6e0ed73651fca inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed7f9c509c71fc238b1b794b54b839f inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">const uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a></td></tr>
<tr class="separator:aeed7f9c509c71fc238b1b794b54b839f inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94fd638dfbeec596f032f1942499c551 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a94fd638dfbeec596f032f1942499c551">running_</a></td></tr>
<tr class="memdesc:a94fd638dfbeec596f032f1942499c551 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">only for sanity check  <a href="#a94fd638dfbeec596f032f1942499c551">More...</a><br /></td></tr>
<tr class="separator:a94fd638dfbeec596f032f1942499c551 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e750423125af9fc0cd82935732f7b03 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">std::thread&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a2e750423125af9fc0cd82935732f7b03">thread_</a></td></tr>
<tr class="separator:a2e750423125af9fc0cd82935732f7b03 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="addaf1ec8c392fb0384c0ae90e46a1b34"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::snapshot::LogReducer::LogReducer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__impl_8cpp_source.html#l00052">52</a> of file <a class="el" href="log__reducer__impl_8cpp_source.html">log_reducer_impl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00071">foedus::snapshot::MapReduceBase::engine_</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="soc__manager_8cpp_source.html#l00038">foedus::soc::SocManager::get_shared_memory_repo()</a>, <a class="el" href="engine_8cpp_source.html#l00059">foedus::Engine::get_soc_manager()</a>, <a class="el" href="snapshot__options_8hpp_source.html#l00115">foedus::snapshot::SnapshotOptions::log_reducer_buffer_mb_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00373">foedus::soc::NodeMemoryAnchors::log_reducer_buffers_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00367">foedus::soc::NodeMemoryAnchors::log_reducer_memory_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00380">foedus::soc::NodeMemoryAnchors::log_reducer_root_info_pages_</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00075">foedus::snapshot::MapReduceBase::numa_node_</a>, and <a class="el" href="engine__options_8hpp_source.html#l00143">foedus::EngineOptions::snapshot_</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;: <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a39f91a709d8086fc702cf13e648ab149">MapReduceBase</a>(engine, engine-&gt;get_soc_id()),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  previous_snapshot_files_(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">engine_</a>),</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  sorted_runs_(0) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  soc::NodeMemoryAnchors* anchors = engine-&gt;get_soc_manager()-&gt;get_shared_memory_repo()-&gt;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    get_node_memory_anchors(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  control_block_ = anchors-&gt;log_reducer_memory_;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  buffers_[0] = anchors-&gt;log_reducer_buffers_[0];</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  buffers_[1] = anchors-&gt;log_reducer_buffers_[1];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">const</span> SnapshotOptions&amp; option = <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">snapshot_</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  buffer_half_size_bytes_ = <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(option.log_reducer_buffer_mb_) &lt;&lt; 19;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(reinterpret_cast&lt;char*&gt;(buffers_[0]) + buffer_half_size_bytes_</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    == reinterpret_cast&lt;char*&gt;(buffers_[1]));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  root_info_pages_ = anchors-&gt;log_reducer_root_info_pages_;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_a39f91a709d8086fc702cf13e648ab149"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a39f91a709d8086fc702cf13e648ab149">foedus::snapshot::MapReduceBase::MapReduceBase</a></div><div class="ttdeci">MapReduceBase()=delete</div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_ac8febbe3a3d3015c9b93cc1afb8154c1"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">foedus::EngineOptions::snapshot_</a></div><div class="ttdeci">snapshot::SnapshotOptions snapshot_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00143">engine_options.hpp:143</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_aeed7f9c509c71fc238b1b794b54b839f"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">foedus::snapshot::MapReduceBase::numa_node_</a></div><div class="ttdeci">const uint16_t numa_node_</div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00075">mapreduce_base_impl.hpp:75</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_afa57df91188b9ce05a71ceab488f9395"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">foedus::snapshot::MapReduceBase::engine_</a></div><div class="ttdeci">Engine *const engine_</div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00071">mapreduce_base_impl.hpp:71</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducer_addaf1ec8c392fb0384c0ae90e46a1b34_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducer_addaf1ec8c392fb0384c0ae90e46a1b34_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducer_addaf1ec8c392fb0384c0ae90e46a1b34_cgraph" id="classfoedus_1_1snapshot_1_1LogReducer_addaf1ec8c392fb0384c0ae90e46a1b34_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="275,5,409,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="252,71,432,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="275,136,409,177"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a09b348c18e707b626d9873a7a69fbfc7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::snapshot::LogReducer::handle_process </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements the specific logics in derived class. </p>

<p>Implements <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae296d44aff3ed68f31958f46089526a0">foedus::snapshot::MapReduceBase</a>.</p>

<p>Definition at line <a class="el" href="log__reducer__impl_8cpp_source.html#l00134">134</a> of file <a class="el" href="log__reducer__impl_8cpp_source.html">log_reducer_impl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="mapreduce__base__impl_8cpp_source.html#l00054">foedus::snapshot::MapReduceBase::check_cancelled()</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00202">foedus::snapshot::LogReducerControlBlock::current_buffer_</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00185">foedus::snapshot::LogReducerControlBlock::get_current_buffer_status()</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00188">foedus::snapshot::LogReducerControlBlock::get_non_current_buffer_status()</a>, <a class="el" href="log__gleaner__ref_8cpp_source.html#l00064">foedus::snapshot::LogGleanerRef::is_all_mappers_completed()</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00080">foedus::snapshot::ReducerBufferStatus::is_clear()</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00077">foedus::snapshot::ReducerBufferStatus::is_no_more_writers()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00072">foedus::snapshot::MapReduceBase::parent_</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00300">to_string()</a>, and <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>.</p>
<div class="fragment"><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                      {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    std::this_thread::sleep_for(std::chrono::milliseconds(10));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a3ba06a325855ed48539cd6f7d40a0412">check_cancelled</a>());</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae5f3ce7311cab6118e780bd933e3f407">parent_</a>.<a class="code" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#aae41c8b743b7c1eae699b809b2dd70b3">is_all_mappers_completed</a>()) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// should I switch the current buffer?</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// this is while, not if, in case the new current buffer becomes full while this reducer is</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// dumping the old current buffer.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">while</span> (control_block_-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a6612d60371c0574a953a66da6b929471">get_current_buffer_status</a>().<a class="code" href="unionfoedus_1_1snapshot_1_1ReducerBufferStatus.html#add166bd2377a5f285d5f4d184c2f1829">is_no_more_writers</a>()) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a3ba06a325855ed48539cd6f7d40a0412">check_cancelled</a>());</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="comment">// okay, let&#39;s switch now. As this thread dumps the buffer as soon as this happens,</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="comment">// only one of the buffers can be full.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">if</span> (!control_block_-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#adfcf739cfe0fac8aa7c5eca80c8f684b">get_non_current_buffer_status</a>().<a class="code" href="unionfoedus_1_1snapshot_1_1ReducerBufferStatus.html#a56e3bf6d9682880703bd381a35ba2289">is_clear</a>()) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        LOG(FATAL) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogReducer.html#a87f87c814bddb6a113be600ed415d92c">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; wtf. both buffers are in use, can&#39;t happen&quot;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      LOG(INFO) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogReducer.html#a87f87c814bddb6a113be600ed415d92c">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; switching buffer. current_buffer_=&quot;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        &lt;&lt; control_block_-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a2e5f8d0f9222e8c716b74edff4afe3b7">current_buffer_</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      control_block_-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a2e5f8d0f9222e8c716b74edff4afe3b7">current_buffer_</a>.fetch_add(1U);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(sorted_runs_ + 1U == control_block_-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a2e5f8d0f9222e8c716b74edff4afe3b7">current_buffer_</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">// Then, immediately start dumping the full buffer.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(dump_buffer());</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  LOG(INFO) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogReducer.html#a87f87c814bddb6a113be600ed415d92c">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; all mappers are done, this reducer starts the merge-sort phase.&quot;</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae5f3ce7311cab6118e780bd933e3f407">parent_</a>.<a class="code" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#aae41c8b743b7c1eae699b809b2dd70b3">is_all_mappers_completed</a>());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a3ba06a325855ed48539cd6f7d40a0412">check_cancelled</a>());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(merge_sort());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  LOG(INFO) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogReducer.html#a87f87c814bddb6a113be600ed415d92c">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; all done.&quot;</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="ttc" id="unionfoedus_1_1snapshot_1_1ReducerBufferStatus_html_add166bd2377a5f285d5f4d184c2f1829"><div class="ttname"><a href="unionfoedus_1_1snapshot_1_1ReducerBufferStatus.html#add166bd2377a5f285d5f4d184c2f1829">foedus::snapshot::ReducerBufferStatus::is_no_more_writers</a></div><div class="ttdeci">bool is_no_more_writers() const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00077">log_reducer_impl.hpp:77</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_a3ba06a325855ed48539cd6f7d40a0412"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a3ba06a325855ed48539cd6f7d40a0412">foedus::snapshot::MapReduceBase::check_cancelled</a></div><div class="ttdeci">ErrorCode check_cancelled() const </div><div class="ttdoc">Derived class&#39;s handle_process() should occasionally call this to exit if it&#39;s cancelled. </div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8cpp_source.html#l00054">mapreduce_base_impl.cpp:54</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_a6612d60371c0574a953a66da6b929471"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a6612d60371c0574a953a66da6b929471">foedus::snapshot::LogReducerControlBlock::get_current_buffer_status</a></div><div class="ttdeci">ReducerBufferStatus get_current_buffer_status() const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00185">log_reducer_impl.hpp:185</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_a2e5f8d0f9222e8c716b74edff4afe3b7"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a2e5f8d0f9222e8c716b74edff4afe3b7">foedus::snapshot::LogReducerControlBlock::current_buffer_</a></div><div class="ttdeci">std::atomic&lt; uint32_t &gt; current_buffer_</div><div class="ttdoc">buffers_[current_buffer_ % 2] is the buffer mappers should append to. </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00202">log_reducer_impl.hpp:202</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_adfcf739cfe0fac8aa7c5eca80c8f684b"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#adfcf739cfe0fac8aa7c5eca80c8f684b">foedus::snapshot::LogReducerControlBlock::get_non_current_buffer_status</a></div><div class="ttdeci">ReducerBufferStatus get_non_current_buffer_status() const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00188">log_reducer_impl.hpp:188</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogGleanerRef_html_aae41c8b743b7c1eae699b809b2dd70b3"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#aae41c8b743b7c1eae699b809b2dd70b3">foedus::snapshot::LogGleanerRef::is_all_mappers_completed</a></div><div class="ttdeci">bool is_all_mappers_completed() const </div><div class="ttdef"><b>Definition:</b> <a href="log__gleaner__ref_8cpp_source.html#l00064">log_gleaner_ref.cpp:64</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducer_html_a87f87c814bddb6a113be600ed415d92c"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducer.html#a87f87c814bddb6a113be600ed415d92c">foedus::snapshot::LogReducer::to_string</a></div><div class="ttdeci">std::string to_string() const  override</div><div class="ttdoc">Expects "LogReducer-x", "LogMapper-y" etc. </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00300">log_reducer_impl.hpp:300</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_ae5f3ce7311cab6118e780bd933e3f407"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae5f3ce7311cab6118e780bd933e3f407">foedus::snapshot::MapReduceBase::parent_</a></div><div class="ttdeci">LogGleanerRef parent_</div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00072">mapreduce_base_impl.hpp:72</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
<div class="ttc" id="unionfoedus_1_1snapshot_1_1ReducerBufferStatus_html_a56e3bf6d9682880703bd381a35ba2289"><div class="ttname"><a href="unionfoedus_1_1snapshot_1_1ReducerBufferStatus.html#a56e3bf6d9682880703bd381a35ba2289">foedus::snapshot::ReducerBufferStatus::is_clear</a></div><div class="ttdeci">bool is_clear() const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00080">log_reducer_impl.hpp:80</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducer_a09b348c18e707b626d9873a7a69fbfc7_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducer_a09b348c18e707b626d9873a7a69fbfc7_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducer_a09b348c18e707b626d9873a7a69fbfc7_cgraph" id="classfoedus_1_1snapshot_1_1LogReducer_a09b348c18e707b626d9873a7a69fbfc7_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a3ba06a325855ed48539cd6f7d40a0412" title="Derived class&#39;s handle_process() should occasionally call this to exit if it&#39;s cancelled. " alt="" coords="254,5,453,47"/>
<area shape="rect" id="node4" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a6612d60371c0574a953a66da6b929471" title="foedus::snapshot::LogReducer\lControlBlock::get_current\l_buffer_status" alt="" coords="254,71,453,127"/>
<area shape="rect" id="node6" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#adfcf739cfe0fac8aa7c5eca80c8f684b" title="foedus::snapshot::LogReducer\lControlBlock::get_non_current\l_buffer_status" alt="" coords="254,151,453,207"/>
<area shape="rect" id="node7" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#aae41c8b743b7c1eae699b809b2dd70b3" title="foedus::snapshot::LogGleaner\lRef::is_all_mappers_completed" alt="" coords="252,232,455,273"/>
<area shape="rect" id="node8" href="unionfoedus_1_1snapshot_1_1ReducerBufferStatus.html#a56e3bf6d9682880703bd381a35ba2289" title="foedus::snapshot::Reducer\lBufferStatus::is_clear" alt="" coords="265,297,442,339"/>
<area shape="rect" id="node9" href="unionfoedus_1_1snapshot_1_1ReducerBufferStatus.html#add166bd2377a5f285d5f4d184c2f1829" title="foedus::snapshot::Reducer\lBufferStatus::is_no_more\l_writers" alt="" coords="265,363,442,419"/>
<area shape="rect" id="node10" href="classfoedus_1_1snapshot_1_1LogReducer.html#a87f87c814bddb6a113be600ed415d92c" title="Expects &quot;LogReducer&#45;x&quot;, &quot;LogMapper&#45;y&quot; etc. " alt="" coords="254,444,453,485"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#ac5b28bcfdc09bd7fe48cd7dd1e687fd1" title="foedus::snapshot::LogGleaner\lRef::is_error" alt="" coords="505,5,699,47"/>
<area shape="rect" id="node5" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a7c8feb59a8368bdae9ffea4b2e3fa8e8" title="foedus::snapshot::LogReducer\lControlBlock::get_buffer\l_status_atomic" alt="" coords="503,111,701,167"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2f5f2664fee7cafc37ad28a657e37e9c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::snapshot::LogReducer::initialize_once </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classfoedus_1_1DefaultInitializable.html#ab8ae37e5f20f312f8b945fc40d3e0250">foedus::DefaultInitializable</a>.</p>

<p>Definition at line <a class="el" href="log__reducer__impl_8cpp_source.html#l00068">68</a> of file <a class="el" href="log__reducer__impl_8cpp_source.html">log_reducer_impl.cpp</a>.</p>

<p>References <a class="el" href="aligned__memory_8cpp_source.html#l00113">foedus::memory::AlignedMemory::alloc()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00071">foedus::snapshot::MapReduceBase::engine_</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00061">foedus::snapshot::MapReduceBase::get_numa_node()</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00172">foedus::memory::AlignedMemory::get_size()</a>, <a class="el" href="engine_8cpp_source.html#l00073">foedus::Engine::get_soc_id()</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00212">foedus::snapshot::LogReducerControlBlock::id_</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00164">foedus::snapshot::LogReducerControlBlock::initialize()</a>, <a class="el" href="initializable_8hpp_source.html#l00169">foedus::DefaultInitializable::initialize()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00170">foedus::memory::AlignedMemory::is_null()</a>, <a class="el" href="memory__id_8hpp_source.html#l00050">foedus::memory::kHugepageSize</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00083">foedus::memory::AlignedMemory::kNumaAllocOnnode</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="snapshot__options_8hpp_source.html#l00120">foedus::snapshot::SnapshotOptions::log_reducer_dump_io_buffer_mb_</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00075">foedus::snapshot::MapReduceBase::numa_node_</a>, <a class="el" href="engine__options_8hpp_source.html#l00143">foedus::EngineOptions::snapshot_</a>, <a class="el" href="snapshot__options_8hpp_source.html#l00144">foedus::snapshot::SnapshotOptions::snapshot_writer_intermediate_pool_size_mb_</a>, and <a class="el" href="snapshot__options_8hpp_source.html#l00136">foedus::snapshot::SnapshotOptions::snapshot_writer_page_pool_size_mb_</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                       {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  control_block_-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a966d8e3e1ef26127add6b515174599b2">initialize</a>();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  control_block_-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#af2a537aa1d0ef7b0c08d9f9c736e1cab">id_</a> = <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9">get_soc_id</a>();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">const</span> SnapshotOptions&amp; option = <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">snapshot_</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  uint64_t dump_buffer_size = <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(option.log_reducer_dump_io_buffer_mb_) &lt;&lt; 20;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  dump_io_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    dump_buffer_size,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a649cad8103f0e450c68866e7f44bea74">get_numa_node</a>());</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!dump_io_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0">is_null</a>());</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// start from 1/16 of the main buffer. Should be big enough.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  sort_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    buffer_half_size_bytes_ &gt;&gt; 5,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a649cad8103f0e450c68866e7f44bea74">get_numa_node</a>());</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// start from 1/16 of the main buffer. Should be big enough.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  positions_buffers_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    buffer_half_size_bytes_ &gt;&gt; 5,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a649cad8103f0e450c68866e7f44bea74">get_numa_node</a>());</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  input_positions_slice_ = memory::AlignedMemorySlice(</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    &amp;positions_buffers_,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    0,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    positions_buffers_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">get_size</a>() &gt;&gt; 1);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  output_positions_slice_ = memory::AlignedMemorySlice(</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    &amp;positions_buffers_,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    positions_buffers_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">get_size</a>() &gt;&gt; 1,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    positions_buffers_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">get_size</a>() &gt;&gt; 1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  writer_pool_memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    static_cast&lt;uint64_t&gt;(option.snapshot_writer_page_pool_size_mb_) &lt;&lt; 20,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  writer_intermediate_memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    static_cast&lt;uint64_t&gt;(option.snapshot_writer_intermediate_pool_size_mb_) &lt;&lt; 20,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a>),</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  sorted_runs_ = 0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(previous_snapshot_files_.<a class="code" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff">initialize</a>());</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_a649cad8103f0e450c68866e7f44bea74"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a649cad8103f0e450c68866e7f44bea74">foedus::snapshot::MapReduceBase::get_numa_node</a></div><div class="ttdeci">uint16_t get_numa_node() const </div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00061">mapreduce_base_impl.hpp:61</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">foedus::memory::AlignedMemory::kNumaAllocOnnode</a></div><div class="ttdoc">numa_alloc_onnode() and numa_free(). </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00083">aligned_memory.hpp:83</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a5166bae2fdad9ffa0d5c279edfd3307e"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">foedus::memory::AlignedMemory::alloc</a></div><div class="ttdeci">void alloc(uint64_t size, uint64_t alignment, AllocType alloc_type, int numa_node) noexcept</div><div class="ttdoc">Allocate a memory, releasing the current memory if exists. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8cpp_source.html#l00113">aligned_memory.cpp:113</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="group__MEMORY_html_gad3fad11cbb0632c8613fd4a3375100b2"><div class="ttname"><a href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">foedus::memory::kHugepageSize</a></div><div class="ttdeci">const uint64_t kHugepageSize</div><div class="ttdoc">So far 2MB is the only page size available via Transparent Huge Page (THP). </div><div class="ttdef"><b>Definition:</b> <a href="memory__id_8hpp_source.html#l00050">memory_id.hpp:50</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_a966d8e3e1ef26127add6b515174599b2"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a966d8e3e1ef26127add6b515174599b2">foedus::snapshot::LogReducerControlBlock::initialize</a></div><div class="ttdeci">void initialize()</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00164">log_reducer_impl.hpp:164</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_ac8febbe3a3d3015c9b93cc1afb8154c1"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">foedus::EngineOptions::snapshot_</a></div><div class="ttdeci">snapshot::SnapshotOptions snapshot_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00143">engine_options.hpp:143</a></div></div>
<div class="ttc" id="classfoedus_1_1DefaultInitializable_html_a22a0dc3bbbca682c3bc41eace9b6d1ff"><div class="ttname"><a href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff">foedus::DefaultInitializable::initialize</a></div><div class="ttdeci">ErrorStack initialize() override final</div><div class="ttdoc">Typical implementation of Initializable::initialize() that provides initialize-once semantics...</div><div class="ttdef"><b>Definition:</b> <a href="initializable_8hpp_source.html#l00169">initializable.hpp:169</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a8db2e188293eaeebdf36cf39920efedd"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">foedus::memory::AlignedMemory::get_size</a></div><div class="ttdeci">uint64_t get_size() const </div><div class="ttdoc">Returns the byte size of the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00172">aligned_memory.hpp:172</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_aeed7f9c509c71fc238b1b794b54b839f"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">foedus::snapshot::MapReduceBase::numa_node_</a></div><div class="ttdeci">const uint16_t numa_node_</div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00075">mapreduce_base_impl.hpp:75</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a8d9a31e48aec9b73e16b64170c0250f9"><div class="ttname"><a href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9">foedus::Engine::get_soc_id</a></div><div class="ttdeci">soc::SocId get_soc_id() const </div><div class="ttdoc">If this is a child instance, returns its SOC ID (NUMA node). </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00073">engine.cpp:73</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_afa57df91188b9ce05a71ceab488f9395"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">foedus::snapshot::MapReduceBase::engine_</a></div><div class="ttdeci">Engine *const engine_</div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00071">mapreduce_base_impl.hpp:71</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_af2a537aa1d0ef7b0c08d9f9c736e1cab"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#af2a537aa1d0ef7b0c08d9f9c736e1cab">foedus::snapshot::LogReducerControlBlock::id_</a></div><div class="ttdeci">uint16_t id_</div><div class="ttdoc">ID of this reducer (or numa node ID). </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00212">log_reducer_impl.hpp:212</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_ad11d2289458b26db2aaef9de984045a0"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0">foedus::memory::AlignedMemory::is_null</a></div><div class="ttdeci">bool is_null() const </div><div class="ttdoc">Returns if this object doesn&#39;t hold a valid memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00170">aligned_memory.hpp:170</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducer_a2f5f2664fee7cafc37ad28a657e37e9c_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducer_a2f5f2664fee7cafc37ad28a657e37e9c_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducer_a2f5f2664fee7cafc37ad28a657e37e9c_cgraph" id="classfoedus_1_1snapshot_1_1LogReducer_a2f5f2664fee7cafc37ad28a657e37e9c_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e" title="Allocate a memory, releasing the current memory if exists. " alt="" coords="252,222,465,263"/>
<area shape="rect" id="node15" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a649cad8103f0e450c68866e7f44bea74" title="foedus::snapshot::MapReduce\lBase::get_numa_node" alt="" coords="259,291,458,332"/>
<area shape="rect" id="node16" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="291,356,426,398"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="252,422,465,463"/>
<area shape="rect" id="node18" href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9" title="If this is a child instance, returns its SOC ID (NUMA node). " alt="" coords="291,487,426,528"/>
<area shape="rect" id="node19" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a966d8e3e1ef26127add6b515174599b2" title="foedus::snapshot::LogReducer\lControlBlock::initialize" alt="" coords="259,552,458,594"/>
<area shape="rect" id="node21" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff" title="Typical implementation of Initializable::initialize() that provides initialize&#45;once semantics..." alt="" coords="273,626,445,667"/>
<area shape="rect" id="node26" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="252,691,465,732"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1memory.html#ac2422aa4fe378da8a9594901762e17df" title="foedus::memory::alloc_mmap" alt="" coords="760,276,953,302"/>
<area shape="rect" id="node5" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1014,392,1154,434"/>
<area shape="rect" id="node6" href="namespacefoedus_1_1memory.html#ae51e4a90f52316ba9dce8ff783f30d84" title="foedus::memory::alloc\l_mmap_1gb_pages" alt="" coords="537,276,688,318"/>
<area shape="rect" id="node7" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="776,392,937,434"/>
<area shape="rect" id="node8" href="group__ASSORTED.html#gab3d1892edaa7db4b02029567b7993f37" title="In order to run even on a non&#45;numa machine or a machine with fewer sockets, we allow specifying arbit..." alt="" coords="537,58,688,99"/>
<area shape="rect" id="node9" href="numa_8h.html#a413cadd87796fff247c83d9ad817cc7e" title="numa_available" alt="" coords="801,6,912,33"/>
<area shape="rect" id="node11" href="numa_8h.html#aba49c14c68d23dc05d046db02766b928" title="numa_preferred" alt="" coords="557,124,668,150"/>
<area shape="rect" id="node12" href="numa_8h.html#a56f33968932f6550e5e5eb4d1acc67b3" title="numa_set_preferred" alt="" coords="545,174,681,201"/>
<area shape="rect" id="node13" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="545,342,680,383"/>
<area shape="rect" id="node4" href="namespacefoedus_1_1memory.html#af6145d9296231995c84badafb6a2a0a9" title="Returns if 1GB hugepages were enabled. " alt="" coords="1001,268,1167,310"/>
<area shape="rect" id="node10" href="numa_8h.html#a22585176d6e08c221de8377637bd72a7" title="numa_num_configured\l_nodes" alt="" coords="781,58,933,99"/>
<area shape="rect" id="node14" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="789,327,924,368"/>
<area shape="rect" id="node20" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a10138591711bd165e6605de2b9d43b10" title="foedus::snapshot::LogReducer\lControlBlock::clear" alt="" coords="513,510,712,551"/>
<area shape="rect" id="node22" href="classfoedus_1_1DefaultInitializable.html#ab8ae37e5f20f312f8b945fc40d3e0250" title="foedus::DefaultInitializable\l::initialize_once" alt="" coords="527,706,699,747"/>
<area shape="rect" id="node23" href="classfoedus_1_1ErrorStack.html#a9c7b3a8b3806ff623c7fb4a9db5cbeec" title="Returns if this return code is not kErrorCodeOk. " alt="" coords="547,771,678,812"/>
<area shape="rect" id="node24" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="527,575,699,616"/>
<area shape="rect" id="node25" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b" title="foedus::DefaultInitializable\l::uninitialize_once" alt="" coords="527,640,699,682"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a87f87c814bddb6a113be600ed415d92c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string foedus::snapshot::LogReducer::to_string </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Expects "LogReducer-x", "LogMapper-y" etc. </p>
<p>Used only for logging/debugging. </p>

<p>Implements <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ac6e7366e9f890077872aea8f2c16099b">foedus::snapshot::MapReduceBase</a>.</p>

<p>Definition at line <a class="el" href="log__reducer__impl_8hpp_source.html#l00300">300</a> of file <a class="el" href="log__reducer__impl_8hpp_source.html">log_reducer_impl.hpp</a>.</p>

<p>References <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00074">foedus::snapshot::MapReduceBase::id_</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__impl_8cpp_source.html#l00134">handle_process()</a>.</p>
<div class="fragment"><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;{ <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;Reducer-&quot;</span>) + std::to_string(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ad999cfc08cc7d7072ae6e0ed73651fca">id_</a>); }</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_ad999cfc08cc7d7072ae6e0ed73651fca"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ad999cfc08cc7d7072ae6e0ed73651fca">foedus::snapshot::MapReduceBase::id_</a></div><div class="ttdeci">const uint16_t id_</div><div class="ttdoc">Unique ID of this mapper or reducer. </div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00074">mapreduce_base_impl.hpp:74</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducer_a87f87c814bddb6a113be600ed415d92c_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducer_a87f87c814bddb6a113be600ed415d92c_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducer_a87f87c814bddb6a113be600ed415d92c_icgraph" id="classfoedus_1_1snapshot_1_1LogReducer_a87f87c814bddb6a113be600ed415d92c_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducer.html#a09b348c18e707b626d9873a7a69fbfc7" title="Implements the specific logics in derived class. " alt="" coords="252,5,451,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9dc30e3460f4d9e5a9fb56f8bd20f0c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::snapshot::LogReducer::uninitialize_once </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b">foedus::DefaultInitializable</a>.</p>

<p>Definition at line <a class="el" href="log__reducer__impl_8cpp_source.html#l00122">122</a> of file <a class="el" href="log__reducer__impl_8cpp_source.html">log_reducer_impl.cpp</a>.</p>

<p>References <a class="el" href="error__stack__batch_8hpp_source.html#l00083">foedus::ErrorStackBatch::emprace_back()</a>, <a class="el" href="aligned__memory_8cpp_source.html#l00235">foedus::memory::AlignedMemory::release_block()</a>, <a class="el" href="error__stack__batch_8hpp_source.html#l00136">SUMMARIZE_ERROR_BATCH</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00173">foedus::snapshot::LogReducerControlBlock::uninitialize()</a>, and <a class="el" href="initializable_8hpp_source.html#l00187">foedus::DefaultInitializable::uninitialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                         {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  ErrorStackBatch batch;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  batch.emprace_back(previous_snapshot_files_.<a class="code" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb">uninitialize</a>());</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  writer_intermediate_memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">release_block</a>();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  writer_pool_memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">release_block</a>();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  dump_io_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">release_block</a>();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  sort_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">release_block</a>();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  positions_buffers_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">release_block</a>();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  control_block_-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a380a05209f90e3b273f9904d7bd1fc33">uninitialize</a>();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga67390b22b0afbe5a4938df9847eafda9">SUMMARIZE_ERROR_BATCH</a>(batch);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_afd955f5f991e28943c72ecff1167c16b"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">foedus::memory::AlignedMemory::release_block</a></div><div class="ttdeci">void release_block()</div><div class="ttdoc">Releases the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8cpp_source.html#l00235">aligned_memory.cpp:235</a></div></div>
<div class="ttc" id="classfoedus_1_1DefaultInitializable_html_ab14b136a7d26f9f499ab9dc15a45a8cb"><div class="ttname"><a href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb">foedus::DefaultInitializable::uninitialize</a></div><div class="ttdeci">ErrorStack uninitialize() override final</div><div class="ttdoc">Typical implementation of Initializable::uninitialize() that provides uninitialize-once semantics...</div><div class="ttdef"><b>Definition:</b> <a href="initializable_8hpp_source.html#l00187">initializable.hpp:187</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga67390b22b0afbe5a4938df9847eafda9"><div class="ttname"><a href="group__ERRORCODES.html#ga67390b22b0afbe5a4938df9847eafda9">SUMMARIZE_ERROR_BATCH</a></div><div class="ttdeci">#define SUMMARIZE_ERROR_BATCH(x)</div><div class="ttdoc">This macro calls ErrorStackBatch::summarize() with automatically provided parameters. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack__batch_8hpp_source.html#l00136">error_stack_batch.hpp:136</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_a380a05209f90e3b273f9904d7bd1fc33"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a380a05209f90e3b273f9904d7bd1fc33">foedus::snapshot::LogReducerControlBlock::uninitialize</a></div><div class="ttdeci">void uninitialize()</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00173">log_reducer_impl.hpp:173</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducer_a9dc30e3460f4d9e5a9fb56f8bd20f0c2_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducer_a9dc30e3460f4d9e5a9fb56f8bd20f0c2_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducer_a9dc30e3460f4d9e5a9fb56f8bd20f0c2_cgraph" id="classfoedus_1_1snapshot_1_1LogReducer_a9dc30e3460f4d9e5a9fb56f8bd20f0c2_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1ErrorStackBatch.html#a1fe18afaafed459feb5c644ba9d7c56e" title="If the given ErrorStack is an error, this method adds it to the end of this batch. " alt="" coords="277,5,441,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b" title="Releases the memory block. " alt="" coords="252,71,465,112"/>
<area shape="rect" id="node4" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a380a05209f90e3b273f9904d7bd1fc33" title="foedus::snapshot::LogReducer\lControlBlock::uninitialize" alt="" coords="259,136,458,177"/>
<area shape="rect" id="node5" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb" title="Typical implementation of Initializable::uninitialize() that provides uninitialize&#45;once semantics..." alt="" coords="273,201,445,243"/>
<area shape="rect" id="node6" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="513,168,685,209"/>
<area shape="rect" id="node7" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b" title="foedus::DefaultInitializable\l::uninitialize_once" alt="" coords="513,233,685,275"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a0f46ae94b8c2f43b2dcae4b4eed6438b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html">LogReducer</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__impl_8cpp_source.html#l00912">912</a> of file <a class="el" href="log__reducer__impl_8cpp_source.html">log_reducer_impl.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                                           {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;LogReducer&gt;&quot;</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;id_&gt;&quot;</span> &lt;&lt; v.get_id() &lt;&lt; <span class="stringliteral">&quot;&lt;/id_&gt;&quot;</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;numa_node&gt;&quot;</span> &lt;&lt; v.get_numa_node() &lt;&lt; <span class="stringliteral">&quot;&lt;/numa_node&gt;&quot;</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;total_storage_count&gt;&quot;</span> &lt;&lt; v.control_block_-&gt;total_storage_count_ &lt;&lt; <span class="stringliteral">&quot;&lt;/total_storage_count&gt;&quot;</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;sort_buffer_&gt;&quot;</span> &lt;&lt; v.sort_buffer_ &lt;&lt; <span class="stringliteral">&quot;&lt;/sort_buffer_&gt;&quot;</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;positions_buffers_&gt;&quot;</span> &lt;&lt; v.positions_buffers_ &lt;&lt; <span class="stringliteral">&quot;&lt;/positions_buffers_&gt;&quot;</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;current_buffer_&gt;&quot;</span> &lt;&lt; v.control_block_-&gt;current_buffer_ &lt;&lt; <span class="stringliteral">&quot;&lt;/current_buffer_&gt;&quot;</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;sorted_runs_&gt;&quot;</span> &lt;&lt; v.sorted_runs_ &lt;&lt; <span class="stringliteral">&quot;&lt;/sorted_runs_&gt;&quot;</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;/LogReducer&gt;&quot;</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/snapshot/<a class="el" href="log__reducer__impl_8hpp_source.html">log_reducer_impl.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/snapshot/<a class="el" href="log__reducer__impl_8cpp_source.html">log_reducer_impl.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1snapshot.html">snapshot</a></li><li class="navelem"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html">LogReducer</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::storage::hash::HashTmpBin Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::storage::hash::HashTmpBin Class Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__STORAGE.html">Storage Manager</a> &raquo; <a class="el" href="group__HASH.html">Hashtable Storage</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>An in-memory single-threaded data structure to compose tuples in a hash bin.  
 <a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An in-memory single-threaded data structure to compose tuples in a hash bin. </p>
<p>This object is used in the hash composer to organize data pages for each hash bin, applying log entries to existing tuples. In essense, it is another hash-table where bucket is low-bits (while bin-bits use high-bits). For testability and modularity, we separated this to its own class.</p>
<dl class="section user"><dt>Access pattern to optimize for</dt><dd>Reducer sorts hash log entries by their hash bins. In each bin, logs are sorted by timestamp. So, the inputs are not sorted by full-hash values, which would have simplified how this object indexes each tuple (just linked list is enough). Instead, we can assume that the next access on the same key surely has a larger timestamp, so this object doesn't have to worry about the order of applying modifications. </dd></dl>

<p>Definition at line <a class="el" href="hash__tmpbin_8hpp_source.html#l00054">54</a> of file <a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html">Record</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a record with a unique key.  <a href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a9d8395fff848df50de411353c9300db1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1">Constants</a> { <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">kBucketCount</a> = 1 &lt;&lt; 16, 
<a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1ab474b3bb226cc7c6997198b18a5910ae">kDefaultInitialSize</a> = 1 &lt;&lt; 24
 }<tr class="separator:a9d8395fff848df50de411353c9300db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</td></tr>
<tr class="memitem:a075134aaf3c354674f451509af4bc0c2"><td class="memItemLeft" align="right" valign="top">typedef uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a></td></tr>
<tr class="memdesc:a075134aaf3c354674f451509af4bc0c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html" title="Represents a record with a unique key. ">Record</a>.  <a href="#a075134aaf3c354674f451509af4bc0c2">More...</a><br /></td></tr>
<tr class="separator:a075134aaf3c354674f451509af4bc0c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af8315c345f9ab21446335ff6e85e513d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#af8315c345f9ab21446335ff6e85e513d">HashTmpBin</a> ()</td></tr>
<tr class="memdesc:af8315c345f9ab21446335ff6e85e513d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor doesn't do any initialization.  <a href="#af8315c345f9ab21446335ff6e85e513d">More...</a><br /></td></tr>
<tr class="separator:af8315c345f9ab21446335ff6e85e513d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44b5b127711bdcde112b8950c0777f01"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a44b5b127711bdcde112b8950c0777f01">create_memory</a> (uint16_t numa_node, uint64_t initial_size=<a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1ab474b3bb226cc7c6997198b18a5910ae">kDefaultInitialSize</a>)</td></tr>
<tr class="memdesc:a44b5b127711bdcde112b8950c0777f01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates the memory to use by this object.  <a href="#a44b5b127711bdcde112b8950c0777f01">More...</a><br /></td></tr>
<tr class="separator:a44b5b127711bdcde112b8950c0777f01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f546901cdf6de1815ba5d91b4bfa75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a16f546901cdf6de1815ba5d91b4bfa75">release_memory</a> ()</td></tr>
<tr class="memdesc:a16f546901cdf6de1815ba5d91b4bfa75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor automatically releases everything, but you can use this to do it earlier.  <a href="#a16f546901cdf6de1815ba5d91b4bfa75">More...</a><br /></td></tr>
<tr class="separator:a16f546901cdf6de1815ba5d91b4bfa75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece534e0cf6fb32ce2919062c90494b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#aece534e0cf6fb32ce2919062c90494b3">steal_memory</a> (<a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> *provider)</td></tr>
<tr class="memdesc:aece534e0cf6fb32ce2919062c90494b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a special version of <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a44b5b127711bdcde112b8950c0777f01" title="Allocates the memory to use by this object. ">create_memory()</a> where this object <em>steals</em> the memory ownership from the recipient.  <a href="#aece534e0cf6fb32ce2919062c90494b3">More...</a><br /></td></tr>
<tr class="separator:aece534e0cf6fb32ce2919062c90494b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c29d5ae3263c1e0e5c5a729ed37bf6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#ad4c29d5ae3263c1e0e5c5a729ed37bf6">give_memory</a> (<a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> *recipient)</td></tr>
<tr class="memdesc:ad4c29d5ae3263c1e0e5c5a729ed37bf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a special version of <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a16f546901cdf6de1815ba5d91b4bfa75" title="Destructor automatically releases everything, but you can use this to do it earlier. ">release_memory()</a> where this object <em>moves</em> the memory ownership to the recipient.  <a href="#ad4c29d5ae3263c1e0e5c5a729ed37bf6">More...</a><br /></td></tr>
<tr class="separator:ad4c29d5ae3263c1e0e5c5a729ed37bf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e54f04414874188fa9d656aa0eba85c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c">clean</a> ()</td></tr>
<tr class="memdesc:a8e54f04414874188fa9d656aa0eba85c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes all tuple data for the current bin.  <a href="#a8e54f04414874188fa9d656aa0eba85c">More...</a><br /></td></tr>
<tr class="separator:a8e54f04414874188fa9d656aa0eba85c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d4cee79b8822c3c942c53aad6df9059"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a2d4cee79b8822c3c942c53aad6df9059">clean_quick</a> ()</td></tr>
<tr class="memdesc:a2d4cee79b8822c3c942c53aad6df9059"><td class="mdescLeft">&#160;</td><td class="mdescRight">This version selectively clears buckets_ by seeing individual records.  <a href="#a2d4cee79b8822c3c942c53aad6df9059">More...</a><br /></td></tr>
<tr class="separator:a2d4cee79b8822c3c942c53aad6df9059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a828a61afe3e29f6290e27651a0d95a2f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html">Record</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">get_record</a> (<a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a> index) const </td></tr>
<tr class="separator:a828a61afe3e29f6290e27651a0d95a2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6829f6933a05213435bd0ab6409ab371"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a6829f6933a05213435bd0ab6409ab371">get_records_capacity</a> () const </td></tr>
<tr class="separator:a6829f6933a05213435bd0ab6409ab371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e76f022ea8d17397b524831d50f5c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a03e76f022ea8d17397b524831d50f5c8">get_records_consumed</a> () const </td></tr>
<tr class="separator:a03e76f022ea8d17397b524831d50f5c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a766152ddf547a633d9d2bf39c6d324e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2">get_first_record</a> () const </td></tr>
<tr class="separator:a766152ddf547a633d9d2bf39c6d324e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1912f1438718913e9cd8e94b3abb5fce"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a1912f1438718913e9cd8e94b3abb5fce">get_physical_record_count</a> () const </td></tr>
<tr class="separator:a1912f1438718913e9cd8e94b3abb5fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f3ec9bb7a4a92366e942d33c4046e1b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a2f3ec9bb7a4a92366e942d33c4046e1b">get_bucket_head</a> (uint32_t bucket) const </td></tr>
<tr class="separator:a2f3ec9bb7a4a92366e942d33c4046e1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5ac0d32ded6cfa7bb3df7f28eafb33e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#ab5ac0d32ded6cfa7bb3df7f28eafb33e">insert_record</a> (<a class="el" href="structfoedus_1_1xct_1_1XctId.html">xct::XctId</a> xct_id, const void *key, uint16_t key_length, <a class="el" href="group__HASH.html#ga9fb894469b702dac3a6564416e19ed42">HashValue</a> hash, const void *payload, uint16_t payload_length)</td></tr>
<tr class="memdesc:ab5ac0d32ded6cfa7bb3df7f28eafb33e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts a new record of the given key and payload.  <a href="#ab5ac0d32ded6cfa7bb3df7f28eafb33e">More...</a><br /></td></tr>
<tr class="separator:ab5ac0d32ded6cfa7bb3df7f28eafb33e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a105eb120235425e73380a9b943a9bf66"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a105eb120235425e73380a9b943a9bf66">delete_record</a> (<a class="el" href="structfoedus_1_1xct_1_1XctId.html">xct::XctId</a> xct_id, const void *key, uint16_t key_length, <a class="el" href="group__HASH.html#ga9fb894469b702dac3a6564416e19ed42">HashValue</a> hash)</td></tr>
<tr class="memdesc:a105eb120235425e73380a9b943a9bf66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Logically deletes a record of the given key.  <a href="#a105eb120235425e73380a9b943a9bf66">More...</a><br /></td></tr>
<tr class="separator:a105eb120235425e73380a9b943a9bf66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f726ea1ce191d9ea5c41202568623b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#ae3f726ea1ce191d9ea5c41202568623b">overwrite_record</a> (<a class="el" href="structfoedus_1_1xct_1_1XctId.html">xct::XctId</a> xct_id, const void *key, uint16_t key_length, <a class="el" href="group__HASH.html#ga9fb894469b702dac3a6564416e19ed42">HashValue</a> hash, const void *payload, uint16_t payload_offset, uint16_t payload_count)</td></tr>
<tr class="memdesc:ae3f726ea1ce191d9ea5c41202568623b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overwrites a part of the record of the given key.  <a href="#ae3f726ea1ce191d9ea5c41202568623b">More...</a><br /></td></tr>
<tr class="separator:ae3f726ea1ce191d9ea5c41202568623b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad54d9fdfa4874b6eaa0231bce58fccf8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#ad54d9fdfa4874b6eaa0231bce58fccf8">update_record</a> (<a class="el" href="structfoedus_1_1xct_1_1XctId.html">xct::XctId</a> xct_id, const void *key, uint16_t key_length, <a class="el" href="group__HASH.html#ga9fb894469b702dac3a6564416e19ed42">HashValue</a> hash, const void *payload, uint16_t payload_length)</td></tr>
<tr class="memdesc:ad54d9fdfa4874b6eaa0231bce58fccf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates a record of the given key with the given payload, which might change length.  <a href="#ad54d9fdfa4874b6eaa0231bce58fccf8">More...</a><br /></td></tr>
<tr class="separator:ad54d9fdfa4874b6eaa0231bce58fccf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a5069bbdf61fab52d7ddde826ca950aaf"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a5069bbdf61fab52d7ddde826ca950aaf">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html">HashTmpBin</a> &amp;v)</td></tr>
<tr class="separator:a5069bbdf61fab52d7ddde826ca950aaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a075134aaf3c354674f451509af4bc0c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint32_t <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">foedus::storage::hash::HashTmpBin::RecordIndex</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer to <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html" title="Represents a record with a unique key. ">Record</a>. </p>
<p>0 means null. </p>

<p>Definition at line <a class="el" href="hash__tmpbin_8hpp_source.html#l00069">69</a> of file <a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a9d8395fff848df50de411353c9300db1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1">foedus::storage::hash::HashTmpBin::Constants</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784"></a>kBucketCount&#160;</td><td class="fielddoc">
<p>This is a per-bin data structure. </p>
<p>This should be large enough. If not, the bin has many data pages, causing low performance anyways. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a9d8395fff848df50de411353c9300db1ab474b3bb226cc7c6997198b18a5910ae"></a>kDefaultInitialSize&#160;</td><td class="fielddoc">
<p>Let's be super generous, assuming that we are reusing memories. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="hash__tmpbin_8hpp_source.html#l00056">56</a> of file <a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                 {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">kBucketCount</a> = 1 &lt;&lt; 16,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1ab474b3bb226cc7c6997198b18a5910ae">kDefaultInitialSize</a> = 1 &lt;&lt; 24,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  };</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a9d8395fff848df50de411353c9300db1ab474b3bb226cc7c6997198b18a5910ae"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1ab474b3bb226cc7c6997198b18a5910ae">foedus::storage::hash::HashTmpBin::kDefaultInitialSize</a></div><div class="ttdoc">Let&#39;s be super generous, assuming that we are reusing memories. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00063">hash_tmpbin.hpp:63</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">foedus::storage::hash::HashTmpBin::kBucketCount</a></div><div class="ttdoc">This is a per-bin data structure. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00061">hash_tmpbin.hpp:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="af8315c345f9ab21446335ff6e85e513d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">foedus::storage::hash::HashTmpBin::HashTmpBin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor doesn't do any initialization. </p>
<p>You must call <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a44b5b127711bdcde112b8950c0777f01" title="Allocates the memory to use by this object. ">create_memory()</a> before using. </p>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00032">32</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  : memory_(), records_capacity_(0), records_consumed_(0), buckets_(<span class="keyword">nullptr</span>), records_(<span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a8e54f04414874188fa9d656aa0eba85c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::hash::HashTmpBin::clean </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes all tuple data for the current bin. </p>
<p>The memory is kept so that we can efficiently reuse resources for next bins to process.</p>
<p>This is a <em>full</em> cleaning method that can be used anytime, but costs a bit more. When there were few records, it is a bit expensive to mem-zero the entire buckets_. In that case, use <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a2d4cee79b8822c3c942c53aad6df9059" title="This version selectively clears buckets_ by seeing individual records. ">clean_quick()</a> </p>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00074">74</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>

<p>References <a class="el" href="hash__tmpbin_8hpp_source.html#l00204">get_first_record()</a>.</p>

<p>Referenced by <a class="el" href="hash__tmpbin_8cpp_source.html#l00036">create_memory()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l00487">foedus::storage::hash::HashComposeContext::execute()</a>, <a class="el" href="hash__tmpbin_8cpp_source.html#l00064">give_memory()</a>, <a class="el" href="hash__tmpbin_8cpp_source.html#l00049">release_memory()</a>, and <a class="el" href="hash__tmpbin_8cpp_source.html#l00055">steal_memory()</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                       {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  records_consumed_ = <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2">get_first_record</a>();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">if</span> (buckets_) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    std::memset(buckets_, 0, records_consumed_ * <span class="keyword">sizeof</span>(Record));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a766152ddf547a633d9d2bf39c6d324e2"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2">foedus::storage::hash::HashTmpBin::get_first_record</a></div><div class="ttdeci">RecordIndex get_first_record() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00204">hash_tmpbin.hpp:204</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a8e54f04414874188fa9d656aa0eba85c_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a8e54f04414874188fa9d656aa0eba85c_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a8e54f04414874188fa9d656aa0eba85c_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a8e54f04414874188fa9d656aa0eba85c_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2" title="foedus::storage::hash\l::HashTmpBin::get_first\l_record" alt="" coords="200,5,359,61"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a8e54f04414874188fa9d656aa0eba85c_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a8e54f04414874188fa9d656aa0eba85c_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a8e54f04414874188fa9d656aa0eba85c_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a8e54f04414874188fa9d656aa0eba85c_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a44b5b127711bdcde112b8950c0777f01" title="Allocates the memory to use by this object. " alt="" coords="223,5,371,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashComposeContext.html#aa55b6ec5e0174d4122bdb9b728cd2088" title="foedus::storage::hash\l::HashComposeContext\l::execute" alt="" coords="443,39,603,95"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#ad4c29d5ae3263c1e0e5c5a729ed37bf6" title="This is a special version of release_memory() where this object moves the memory ownership to the rec..." alt="" coords="203,137,391,178"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a16f546901cdf6de1815ba5d91b4bfa75" title="Destructor automatically releases everything, but you can use this to do it earlier. " alt="" coords="220,203,375,259"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#aece534e0cf6fb32ce2919062c90494b3" title="This is a special version of create_memory() where this object steals the memory ownership from the r..." alt="" coords="200,283,395,325"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2d4cee79b8822c3c942c53aad6df9059"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::hash::HashTmpBin::clean_quick </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This version selectively clears buckets_ by seeing individual records. </p>
<p>Hence, this can be used only after records_consumed_ is populated. Instead, when there are just a few records, this is much faster than <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c" title="Removes all tuple data for the current bin. ">clean()</a>. </p>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00081">81</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00204">get_first_record()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00197">get_record()</a>, and <a class="el" href="hash__tmpbin_8hpp_source.html#l00084">foedus::storage::hash::HashTmpBin::Record::hash_</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                             {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(buckets_);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(records_capacity_ &gt; 0);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(records_consumed_ &gt;= <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2">get_first_record</a>());</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">// at some point, just mem-zero is faster. we could do a switch like below, but it&#39;s rare.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// this also makes unit-testing more tricky.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">// if (records_consumed_ &gt; get_first_record() + 256U) {</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">//   clean();</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">//   return;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a> index = <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2">get_first_record</a>(); index &lt; records_consumed_; ++index) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    Record* record = <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">get_record</a>(index);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    buckets_[extract_bucket(record-&gt;hash_)] = 0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  records_consumed_ = <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2">get_first_record</a>();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a075134aaf3c354674f451509af4bc0c2"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">foedus::storage::hash::HashTmpBin::RecordIndex</a></div><div class="ttdeci">uint32_t RecordIndex</div><div class="ttdoc">Pointer to Record. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00069">hash_tmpbin.hpp:69</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a828a61afe3e29f6290e27651a0d95a2f"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">foedus::storage::hash::HashTmpBin::get_record</a></div><div class="ttdeci">Record * get_record(RecordIndex index) const </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00197">hash_tmpbin.hpp:197</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a766152ddf547a633d9d2bf39c6d324e2"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2">foedus::storage::hash::HashTmpBin::get_first_record</a></div><div class="ttdeci">RecordIndex get_first_record() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00204">hash_tmpbin.hpp:204</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a2d4cee79b8822c3c942c53aad6df9059_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a2d4cee79b8822c3c942c53aad6df9059_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a2d4cee79b8822c3c942c53aad6df9059_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a2d4cee79b8822c3c942c53aad6df9059_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2" title="foedus::storage::hash\l::HashTmpBin::get_first\l_record" alt="" coords="242,5,401,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f" title="foedus::storage::hash\l::HashTmpBin::get_record" alt="" coords="235,86,408,127"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a44b5b127711bdcde112b8950c0777f01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashTmpBin::create_memory </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>numa_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>initial_size</em> = <code><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1ab474b3bb226cc7c6997198b18a5910ae">kDefaultInitialSize</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates the memory to use by this object. </p>
<p>Must be called before using this object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numa_node</td><td>the NUMA node to allocate this object's memory on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">initial_size</td><td>byte size of the memory to start from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>initial_size &gt; sizeof(RecordIndex)*kBucketCount, in reality should be much larger </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>!memory_-&gt;is_null() </dd></dl>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00036">36</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>

<p>References <a class="el" href="aligned__memory_8cpp_source.html#l00113">foedus::memory::AlignedMemory::alloc()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__tmpbin_8cpp_source.html#l00074">clean()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00061">kBucketCount</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00083">foedus::memory::AlignedMemory::kNumaAllocOnnode</a>, and <a class="el" href="storage__id_8hpp_source.html#l00045">foedus::storage::kPageSize</a>.</p>

<p>Referenced by <a class="el" href="hash__composer__impl_8cpp_source.html#l00487">foedus::storage::hash::HashComposeContext::execute()</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                                                             {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(initial_size &gt; <span class="keyword">sizeof</span>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a>) * <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">kBucketCount</a>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<span class="keyword">sizeof</span>(Record) == <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">kPageSize</a>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    initial_size,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    1ULL &lt;&lt; 21,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    numa_node);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  on_memory_set();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c">clean</a>();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">foedus::memory::AlignedMemory::kNumaAllocOnnode</a></div><div class="ttdoc">numa_alloc_onnode() and numa_free(). </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00083">aligned_memory.hpp:83</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a075134aaf3c354674f451509af4bc0c2"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">foedus::storage::hash::HashTmpBin::RecordIndex</a></div><div class="ttdeci">uint32_t RecordIndex</div><div class="ttdoc">Pointer to Record. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00069">hash_tmpbin.hpp:69</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a8e54f04414874188fa9d656aa0eba85c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c">foedus::storage::hash::HashTmpBin::clean</a></div><div class="ttdeci">void clean()</div><div class="ttdoc">Removes all tuple data for the current bin. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8cpp_source.html#l00074">hash_tmpbin.cpp:74</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a5166bae2fdad9ffa0d5c279edfd3307e"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">foedus::memory::AlignedMemory::alloc</a></div><div class="ttdeci">void alloc(uint64_t size, uint64_t alignment, AllocType alloc_type, int numa_node) noexcept</div><div class="ttdoc">Allocate a memory, releasing the current memory if exists. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8cpp_source.html#l00113">aligned_memory.cpp:113</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">foedus::storage::hash::HashTmpBin::kBucketCount</a></div><div class="ttdoc">This is a per-bin data structure. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00061">hash_tmpbin.hpp:61</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga1a3c05fe1d44455fc3e761947c6e21e6"><div class="ttname"><a href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">foedus::storage::kPageSize</a></div><div class="ttdeci">const uint16_t kPageSize</div><div class="ttdoc">A constant defining the page size (in bytes) of both snapshot pages and volatile pages. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00045">storage_id.hpp:45</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a44b5b127711bdcde112b8950c0777f01_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a44b5b127711bdcde112b8950c0777f01_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a44b5b127711bdcde112b8950c0777f01_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a44b5b127711bdcde112b8950c0777f01_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e" title="Allocate a memory, releasing the current memory if exists. " alt="" coords="201,257,415,299"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c" title="Removes all tuple data for the current bin. " alt="" coords="235,407,381,448"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1memory.html#ac2422aa4fe378da8a9594901762e17df" title="foedus::memory::alloc_mmap" alt="" coords="669,57,863,83"/>
<area shape="rect" id="node5" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="923,173,1063,215"/>
<area shape="rect" id="node6" href="namespacefoedus_1_1memory.html#ae51e4a90f52316ba9dce8ff783f30d84" title="foedus::memory::alloc\l_mmap_1gb_pages" alt="" coords="467,5,617,47"/>
<area shape="rect" id="node7" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="685,173,847,215"/>
<area shape="rect" id="node8" href="group__ASSORTED.html#gab3d1892edaa7db4b02029567b7993f37" title="In order to run even on a non&#45;numa machine or a machine with fewer sockets, we allow specifying arbit..." alt="" coords="467,341,617,383"/>
<area shape="rect" id="node9" href="numa_8h.html#a413cadd87796fff247c83d9ad817cc7e" title="numa_available" alt="" coords="711,290,821,317"/>
<area shape="rect" id="node11" href="numa_8h.html#aba49c14c68d23dc05d046db02766b928" title="numa_preferred" alt="" coords="487,407,597,434"/>
<area shape="rect" id="node12" href="numa_8h.html#a56f33968932f6550e5e5eb4d1acc67b3" title="numa_set_preferred" alt="" coords="474,458,610,485"/>
<area shape="rect" id="node13" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="475,123,609,164"/>
<area shape="rect" id="node4" href="namespacefoedus_1_1memory.html#af6145d9296231995c84badafb6a2a0a9" title="Returns if 1GB hugepages were enabled. " alt="" coords="911,49,1076,91"/>
<area shape="rect" id="node10" href="numa_8h.html#a22585176d6e08c221de8377637bd72a7" title="numa_num_configured\l_nodes" alt="" coords="690,341,842,383"/>
<area shape="rect" id="node14" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="699,108,833,149"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2" title="foedus::storage::hash\l::HashTmpBin::get_first\l_record" alt="" coords="463,509,621,565"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a44b5b127711bdcde112b8950c0777f01_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a44b5b127711bdcde112b8950c0777f01_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a44b5b127711bdcde112b8950c0777f01_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a44b5b127711bdcde112b8950c0777f01_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashComposeContext.html#aa55b6ec5e0174d4122bdb9b728cd2088" title="foedus::storage::hash\l::HashComposeContext\l::execute" alt="" coords="201,5,361,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a105eb120235425e73380a9b943a9bf66"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashTmpBin::delete_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1xct_1_1XctId.html">xct::XctId</a>&#160;</td>
          <td class="paramname"><em>xct_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__HASH.html#ga9fb894469b702dac3a6564416e19ed42">HashValue</a>&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Logically deletes a record of the given key. </p>
<p>If there is no existing record of the key, or such a record is already logically deleted, this method returns an error (kErrorCodeStrKeyNotFound). Mustn't happen either. </p>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00167">167</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="xct__id_8hpp_source.html#l00993">foedus::xct::XctId::compare_epoch_and_orginal()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00197">get_record()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00084">foedus::storage::hash::HashTmpBin::Record::hash_</a>, <a class="el" href="hash__hashinate_8cpp_source.html#l00031">foedus::storage::hash::hashinate()</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, and <a class="el" href="hash__tmpbin_8hpp_source.html#l00079">foedus::storage::hash::HashTmpBin::Record::xct_id_</a>.</p>
<div class="fragment"><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                  {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(xct_id.is_deleted());</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679">hashinate</a>(key, key_length) == hash);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  SearchResult result = search_bucket(key, key_length, hash);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(result.found_ == 0)) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    DLOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;HashTmpBin::delete_record() hit KeyNotFound case 1. This must not&quot;</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; happen except unit testcases.&quot;</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    Record* record = <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">get_record</a>(result.found_);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(record-&gt;hash_ == hash);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(record-&gt;xct_id_.is_deleted())) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      DLOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;HashTmpBin::delete_record() hit KeyNotFound case 2. This must not&quot;</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; happen except unit testcases.&quot;</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(record-&gt;xct_id_.compare_epoch_and_orginal(xct_id) &lt; 0);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    record-&gt;xct_id_ = xct_id;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__HASH_html_ga8c4ca78e36b2188f1feac100ce7df679"><div class="ttname"><a href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679">foedus::storage::hash::hashinate</a></div><div class="ttdeci">HashValue hashinate(const void *key, uint16_t key_length)</div><div class="ttdoc">Calculates hash value for general input. </div><div class="ttdef"><b>Definition:</b> <a href="hash__hashinate_8cpp_source.html#l00031">hash_hashinate.cpp:31</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a828a61afe3e29f6290e27651a0d95a2f"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">foedus::storage::hash::HashTmpBin::get_record</a></div><div class="ttdeci">Record * get_record(RecordIndex index) const </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00197">hash_tmpbin.hpp:197</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a105eb120235425e73380a9b943a9bf66_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a105eb120235425e73380a9b943a9bf66_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a105eb120235425e73380a9b943a9bf66_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a105eb120235425e73380a9b943a9bf66_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1xct_1_1XctId.html#a76fa9521598d6415dcb58cdff12c7cb1" title="Returns &#45;1, 0, 1 when this is less than, same, larger than other in terms of epoch/ordinal. " alt="" coords="211,57,362,113"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f" title="foedus::storage::hash\l::HashTmpBin::get_record" alt="" coords="200,137,373,179"/>
<area shape="rect" id="node8" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679" title="Calculates hash value for general input. " alt="" coords="213,203,360,244"/>
<area shape="rect" id="node9" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="225,268,348,309"/>
<area shape="rect" id="node3" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="624,5,747,47"/>
<area shape="rect" id="node4" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="437,35,560,76"/>
<area shape="rect" id="node5" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="421,101,576,127"/>
<area shape="rect" id="node6" href="structfoedus_1_1xct_1_1XctId.html#a936888dbc82de6e76194b72c28c9a10f" title="foedus::xct::XctId\l::get_ordinal" alt="" coords="437,152,560,193"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2f3ec9bb7a4a92366e942d33c4046e1b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a> foedus::storage::hash::HashTmpBin::get_bucket_head </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>bucket</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__tmpbin_8hpp_source.html#l00211">211</a> of file <a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, and <a class="el" href="hash__tmpbin_8hpp_source.html#l00061">kBucketCount</a>.</p>
<div class="fragment"><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                                     {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bucket &lt; <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">kBucketCount</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span> buckets_[bucket];</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">foedus::storage::hash::HashTmpBin::kBucketCount</a></div><div class="ttdoc">This is a per-bin data structure. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00061">hash_tmpbin.hpp:61</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a766152ddf547a633d9d2bf39c6d324e2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a> foedus::storage::hash::HashTmpBin::get_first_record </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__tmpbin_8hpp_source.html#l00204">204</a> of file <a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a>.</p>

<p>References <a class="el" href="hash__tmpbin_8hpp_source.html#l00061">kBucketCount</a>.</p>

<p>Referenced by <a class="el" href="hash__tmpbin_8cpp_source.html#l00074">clean()</a>, <a class="el" href="hash__tmpbin_8cpp_source.html#l00081">clean_quick()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00208">get_physical_record_count()</a>, and <a class="el" href="hash__tmpbin_8cpp_source.html#l00287">foedus::storage::hash::operator&lt;&lt;()</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                       {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a>) * <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">kBucketCount</a> / <span class="keyword">sizeof</span>(Record);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a075134aaf3c354674f451509af4bc0c2"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">foedus::storage::hash::HashTmpBin::RecordIndex</a></div><div class="ttdeci">uint32_t RecordIndex</div><div class="ttdoc">Pointer to Record. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00069">hash_tmpbin.hpp:69</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">foedus::storage::hash::HashTmpBin::kBucketCount</a></div><div class="ttdoc">This is a per-bin data structure. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00061">hash_tmpbin.hpp:61</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a766152ddf547a633d9d2bf39c6d324e2_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a766152ddf547a633d9d2bf39c6d324e2_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a766152ddf547a633d9d2bf39c6d324e2_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a766152ddf547a633d9d2bf39c6d324e2_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c" title="Removes all tuple data for the current bin. " alt="" coords="231,137,378,178"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a2d4cee79b8822c3c942c53aad6df9059" title="This version selectively clears buckets_ by seeing individual records. " alt="" coords="214,202,395,243"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a1912f1438718913e9cd8e94b3abb5fce" title="foedus::storage::hash\l::HashTmpBin::get_physical\l_record_count" alt="" coords="212,268,397,324"/>
<area shape="rect" id="node10" href="namespacefoedus_1_1storage_1_1hash.html#af4a5992caea964850c8e2e2f19a6b46c" title="foedus::storage::hash\l::operator\&lt;\&lt;" alt="" coords="231,349,378,390"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a44b5b127711bdcde112b8950c0777f01" title="Allocates the memory to use by this object. " alt="" coords="469,5,617,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashComposeContext.html#aa55b6ec5e0174d4122bdb9b728cd2088" title="foedus::storage::hash\l::HashComposeContext\l::execute" alt="" coords="688,39,848,95"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#ad4c29d5ae3263c1e0e5c5a729ed37bf6" title="This is a special version of release_memory() where this object moves the memory ownership to the rec..." alt="" coords="449,137,637,178"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a16f546901cdf6de1815ba5d91b4bfa75" title="Destructor automatically releases everything, but you can use this to do it earlier. " alt="" coords="465,203,620,259"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#aece534e0cf6fb32ce2919062c90494b3" title="This is a special version of create_memory() where this object steals the memory ownership from the r..." alt="" coords="445,283,640,325"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1912f1438718913e9cd8e94b3abb5fce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::storage::hash::HashTmpBin::get_physical_record_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>number of physical records, which may or may not be logically deleted </dd></dl>

<p>Definition at line <a class="el" href="hash__tmpbin_8hpp_source.html#l00208">208</a> of file <a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a>.</p>

<p>References <a class="el" href="hash__tmpbin_8hpp_source.html#l00204">get_first_record()</a>, and <a class="el" href="hash__tmpbin_8hpp_source.html#l00203">get_records_consumed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a03e76f022ea8d17397b524831d50f5c8">get_records_consumed</a>() - <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2">get_first_record</a>();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a03e76f022ea8d17397b524831d50f5c8"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a03e76f022ea8d17397b524831d50f5c8">foedus::storage::hash::HashTmpBin::get_records_consumed</a></div><div class="ttdeci">RecordIndex get_records_consumed() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00203">hash_tmpbin.hpp:203</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a766152ddf547a633d9d2bf39c6d324e2"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2">foedus::storage::hash::HashTmpBin::get_first_record</a></div><div class="ttdeci">RecordIndex get_first_record() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00204">hash_tmpbin.hpp:204</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a1912f1438718913e9cd8e94b3abb5fce_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a1912f1438718913e9cd8e94b3abb5fce_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a1912f1438718913e9cd8e94b3abb5fce_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a1912f1438718913e9cd8e94b3abb5fce_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2" title="foedus::storage::hash\l::HashTmpBin::get_first\l_record" alt="" coords="249,5,408,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a03e76f022ea8d17397b524831d50f5c8" title="foedus::storage::hash\l::HashTmpBin::get_records\l_consumed" alt="" coords="239,85,419,141"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a828a61afe3e29f6290e27651a0d95a2f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html">Record</a>* foedus::storage::hash::HashTmpBin::get_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a>&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__tmpbin_8hpp_source.html#l00197">197</a> of file <a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, and <a class="el" href="hash__tmpbin_8hpp_source.html#l00061">kBucketCount</a>.</p>

<p>Referenced by <a class="el" href="hash__tmpbin_8cpp_source.html#l00081">clean_quick()</a>, <a class="el" href="hash__tmpbin_8cpp_source.html#l00167">delete_record()</a>, <a class="el" href="hash__tmpbin_8cpp_source.html#l00126">insert_record()</a>, <a class="el" href="hash__tmpbin_8cpp_source.html#l00287">foedus::storage::hash::operator&lt;&lt;()</a>, <a class="el" href="hash__tmpbin_8cpp_source.html#l00194">overwrite_record()</a>, and <a class="el" href="hash__tmpbin_8cpp_source.html#l00229">update_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                                  {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(index &lt; records_capacity_);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(index &gt;= <span class="keyword">sizeof</span>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a>) * <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">kBucketCount</a> / <span class="keyword">sizeof</span>(Record));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">return</span> records_ + index;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a075134aaf3c354674f451509af4bc0c2"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">foedus::storage::hash::HashTmpBin::RecordIndex</a></div><div class="ttdeci">uint32_t RecordIndex</div><div class="ttdoc">Pointer to Record. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00069">hash_tmpbin.hpp:69</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">foedus::storage::hash::HashTmpBin::kBucketCount</a></div><div class="ttdoc">This is a per-bin data structure. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00061">hash_tmpbin.hpp:61</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a828a61afe3e29f6290e27651a0d95a2f_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a828a61afe3e29f6290e27651a0d95a2f_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a828a61afe3e29f6290e27651a0d95a2f_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a828a61afe3e29f6290e27651a0d95a2f_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a2d4cee79b8822c3c942c53aad6df9059" title="This version selectively clears buckets_ by seeing individual records. " alt="" coords="227,5,408,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a105eb120235425e73380a9b943a9bf66" title="Logically deletes a record of the given key. " alt="" coords="244,71,391,127"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#ab5ac0d32ded6cfa7bb3df7f28eafb33e" title="Inserts a new record of the given key and payload. " alt="" coords="244,151,391,207"/>
<area shape="rect" id="node5" href="namespacefoedus_1_1storage_1_1hash.html#af4a5992caea964850c8e2e2f19a6b46c" title="foedus::storage::hash\l::operator\&lt;\&lt;" alt="" coords="244,232,391,273"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#ae3f726ea1ce191d9ea5c41202568623b" title="Overwrites a part of the record of the given key. " alt="" coords="236,298,399,354"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#ad54d9fdfa4874b6eaa0231bce58fccf8" title="Updates a record of the given key with the given payload, which might change length. " alt="" coords="242,378,393,434"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6829f6933a05213435bd0ab6409ab371"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a> foedus::storage::hash::HashTmpBin::get_records_capacity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__tmpbin_8hpp_source.html#l00202">202</a> of file <a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;{ <span class="keywordflow">return</span> records_capacity_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a03e76f022ea8d17397b524831d50f5c8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a> foedus::storage::hash::HashTmpBin::get_records_consumed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__tmpbin_8hpp_source.html#l00203">203</a> of file <a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a>.</p>

<p>Referenced by <a class="el" href="hash__tmpbin_8hpp_source.html#l00208">get_physical_record_count()</a>, and <a class="el" href="hash__tmpbin_8cpp_source.html#l00287">foedus::storage::hash::operator&lt;&lt;()</a>.</p>
<div class="fragment"><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{ <span class="keywordflow">return</span> records_consumed_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a03e76f022ea8d17397b524831d50f5c8_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a03e76f022ea8d17397b524831d50f5c8_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a03e76f022ea8d17397b524831d50f5c8_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a03e76f022ea8d17397b524831d50f5c8_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a1912f1438718913e9cd8e94b3abb5fce" title="foedus::storage::hash\l::HashTmpBin::get_physical\l_record_count" alt="" coords="233,5,419,61"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1storage_1_1hash.html#af4a5992caea964850c8e2e2f19a6b46c" title="foedus::storage::hash\l::operator\&lt;\&lt;" alt="" coords="253,86,399,127"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad4c29d5ae3263c1e0e5c5a729ed37bf6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::hash::HashTmpBin::give_memory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> *&#160;</td>
          <td class="paramname"><em>recipient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is a special version of <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a16f546901cdf6de1815ba5d91b4bfa75" title="Destructor automatically releases everything, but you can use this to do it earlier. ">release_memory()</a> where this object <em>moves</em> the memory ownership to the recipient. </p>
<p>Combined with <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#aece534e0cf6fb32ce2919062c90494b3" title="This is a special version of create_memory() where this object steals the memory ownership from the r...">steal_memory()</a>, this allows completely reusing memory. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">recipient</td><td>the memory to receive the ownership of memory this object has </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>!memory_-&gt;is_null() </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>!recipient-&gt;is_null() </dd>
<dd>
memory_-&gt;is_null() </dd></dl>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00064">64</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__tmpbin_8cpp_source.html#l00074">clean()</a>, and <a class="el" href="aligned__memory_8hpp_source.html#l00170">foedus::memory::AlignedMemory::is_null()</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                                           {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0">is_null</a>());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  *recipient = std::move(memory_);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!recipient-&gt;is_null());</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0">is_null</a>());</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  on_memory_set();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c">clean</a>();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a8e54f04414874188fa9d656aa0eba85c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c">foedus::storage::hash::HashTmpBin::clean</a></div><div class="ttdeci">void clean()</div><div class="ttdoc">Removes all tuple data for the current bin. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8cpp_source.html#l00074">hash_tmpbin.cpp:74</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_ad11d2289458b26db2aaef9de984045a0"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0">foedus::memory::AlignedMemory::is_null</a></div><div class="ttdeci">bool is_null() const </div><div class="ttdoc">Returns if this object doesn&#39;t hold a valid memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00170">aligned_memory.hpp:170</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ad4c29d5ae3263c1e0e5c5a729ed37bf6_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ad4c29d5ae3263c1e0e5c5a729ed37bf6_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ad4c29d5ae3263c1e0e5c5a729ed37bf6_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ad4c29d5ae3263c1e0e5c5a729ed37bf6_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c" title="Removes all tuple data for the current bin. " alt="" coords="275,13,421,54"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="241,78,455,119"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2" title="foedus::storage::hash\l::HashTmpBin::get_first\l_record" alt="" coords="503,5,661,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab5ac0d32ded6cfa7bb3df7f28eafb33e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashTmpBin::insert_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1xct_1_1XctId.html">xct::XctId</a>&#160;</td>
          <td class="paramname"><em>xct_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__HASH.html#ga9fb894469b702dac3a6564416e19ed42">HashValue</a>&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inserts a new record of the given key and payload. </p>
<p>If there is an existing record of the key that is logically deleted, we flip the deletion flag. If such an record exists and also is not logically deleted, this method returns an error (kErrorCodeStrKeyAlreadyExists). Considering how this object is used, it mustn't hapepn. </p>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00126">126</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="xct__id_8hpp_source.html#l00993">foedus::xct::XctId::compare_epoch_and_orginal()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00197">get_record()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00084">foedus::storage::hash::HashTmpBin::Record::hash_</a>, <a class="el" href="hash__hashinate_8cpp_source.html#l00031">foedus::storage::hash::hashinate()</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00177">foedus::kErrorCodeStrKeyAlreadyExists</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00086">foedus::storage::hash::HashTmpBin::Record::next_</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00097">foedus::storage::hash::HashTmpBin::Record::set_all()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00124">foedus::storage::hash::HashTmpBin::Record::set_payload()</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, and <a class="el" href="hash__tmpbin_8hpp_source.html#l00079">foedus::storage::hash::HashTmpBin::Record::xct_id_</a>.</p>
<div class="fragment"><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                           {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!xct_id.is_deleted());</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679">hashinate</a>(key, key_length) == hash);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  SearchResult result = search_bucket(key, key_length, hash);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">if</span> (result.found_ == 0) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">RecordIndex</a> new_index;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(alloc_record(&amp;new_index));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    Record* record = <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">get_record</a>(new_index);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    record-&gt;set_all(xct_id, key, key_length, hash, payload, payload_length);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (result.tail_ == 0) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      uint16_t bucket_index = extract_bucket(hash);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(buckets_[bucket_index] == 0);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      buckets_[bucket_index] = new_index;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(buckets_[extract_bucket(hash)] != 0);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      Record* tail_record = <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">get_record</a>(result.tail_);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      tail_record-&gt;next_ = new_index;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    Record* record = <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">get_record</a>(result.found_);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(record-&gt;hash_ == hash);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(!record-&gt;xct_id_.is_deleted())) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      DLOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;HashTmpBin::insert_record() hit KeyAlreadyExists case. This must not&quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; happen except unit testcases.&quot;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56adfc9588c95653090f65a029c574bfc9c">kErrorCodeStrKeyAlreadyExists</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(record-&gt;xct_id_.compare_epoch_and_orginal(xct_id) &lt; 0);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    record-&gt;xct_id_ = xct_id;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    record-&gt;set_payload(payload, payload_length);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a075134aaf3c354674f451509af4bc0c2"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a075134aaf3c354674f451509af4bc0c2">foedus::storage::hash::HashTmpBin::RecordIndex</a></div><div class="ttdeci">uint32_t RecordIndex</div><div class="ttdoc">Pointer to Record. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00069">hash_tmpbin.hpp:69</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__HASH_html_ga8c4ca78e36b2188f1feac100ce7df679"><div class="ttname"><a href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679">foedus::storage::hash::hashinate</a></div><div class="ttdeci">HashValue hashinate(const void *key, uint16_t key_length)</div><div class="ttdoc">Calculates hash value for general input. </div><div class="ttdef"><b>Definition:</b> <a href="hash__hashinate_8cpp_source.html#l00031">hash_hashinate.cpp:31</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a828a61afe3e29f6290e27651a0d95a2f"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">foedus::storage::hash::HashTmpBin::get_record</a></div><div class="ttdeci">Record * get_record(RecordIndex index) const </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00197">hash_tmpbin.hpp:197</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56adfc9588c95653090f65a029c574bfc9c"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56adfc9588c95653090f65a029c574bfc9c">foedus::kErrorCodeStrKeyAlreadyExists</a></div><div class="ttdoc">0x080B : "STORAGE: This key already exists in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00177">error_code.hpp:177</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ab5ac0d32ded6cfa7bb3df7f28eafb33e_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ab5ac0d32ded6cfa7bb3df7f28eafb33e_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ab5ac0d32ded6cfa7bb3df7f28eafb33e_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ab5ac0d32ded6cfa7bb3df7f28eafb33e_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1xct_1_1XctId.html#a76fa9521598d6415dcb58cdff12c7cb1" title="Returns &#45;1, 0, 1 when this is less than, same, larger than other in terms of epoch/ordinal. " alt="" coords="211,93,362,149"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f" title="foedus::storage::hash\l::HashTmpBin::get_record" alt="" coords="200,173,373,215"/>
<area shape="rect" id="node8" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679" title="Calculates hash value for general input. " alt="" coords="213,239,360,280"/>
<area shape="rect" id="node9" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="225,304,348,345"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html#a88c4b2bbb2805dc7c206d46133e17ad5" title="foedus::storage::hash\l::HashTmpBin::Record\l::set_all" alt="" coords="210,450,363,506"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html#af7baf3f0c744ec86455d850489dba62c" title="foedus::storage::hash\l::HashTmpBin::Record\l::set_payload" alt="" coords="210,370,363,426"/>
<area shape="rect" id="node3" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="629,100,752,141"/>
<area shape="rect" id="node4" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="440,71,563,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="424,187,579,214"/>
<area shape="rect" id="node6" href="structfoedus_1_1xct_1_1XctId.html#a936888dbc82de6e76194b72c28c9a10f" title="foedus::xct::XctId\l::get_ordinal" alt="" coords="440,5,563,47"/>
<area shape="rect" id="node11" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="421,450,581,477"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html#affa2a7bd5a1685a9cf815aefdf382e99" title="foedus::storage::hash\l::HashTmpBin::Record\l::get_key" alt="" coords="425,501,578,557"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html#a9d0e1e148c4cf1ca14f2566fabbdba0b" title="foedus::storage::hash\l::HashTmpBin::Record\l::get_payload" alt="" coords="425,370,578,426"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae3f726ea1ce191d9ea5c41202568623b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashTmpBin::overwrite_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1xct_1_1XctId.html">xct::XctId</a>&#160;</td>
          <td class="paramname"><em>xct_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__HASH.html#ga9fb894469b702dac3a6564416e19ed42">HashValue</a>&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Overwrites a part of the record of the given key. </p>
<p>If there is no existing record of the key, or such a record is already logically deleted, this method returns an error (kErrorCodeStrKeyNotFound). Mustn't happen either. </p>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00194">194</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="xct__id_8hpp_source.html#l00993">foedus::xct::XctId::compare_epoch_and_orginal()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00197">get_record()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00084">foedus::storage::hash::HashTmpBin::Record::hash_</a>, <a class="el" href="hash__hashinate_8cpp_source.html#l00031">foedus::storage::hash::hashinate()</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="error__code_8hpp_source.html#l00176">foedus::kErrorCodeStrTooShortPayload</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00133">foedus::storage::hash::HashTmpBin::Record::overwrite_payload()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00081">foedus::storage::hash::HashTmpBin::Record::payload_length_</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, and <a class="el" href="hash__tmpbin_8hpp_source.html#l00079">foedus::storage::hash::HashTmpBin::Record::xct_id_</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                          {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!xct_id.is_deleted());</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679">hashinate</a>(key, key_length) == hash);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  SearchResult result = search_bucket(key, key_length, hash);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(result.found_ == 0)) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    DLOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;HashTmpBin::overwrite_record() hit KeyNotFound case 1. This must not&quot;</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; happen except unit testcases.&quot;</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    Record* record = <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">get_record</a>(result.found_);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(record-&gt;hash_ == hash);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(record-&gt;xct_id_.is_deleted())) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      DLOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;HashTmpBin::overwrite_record() hit KeyNotFound case 2. This must not&quot;</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; happen except unit testcases.&quot;</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(record-&gt;payload_length_ &lt; payload_offset + payload_count)) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      DLOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;HashTmpBin::overwrite_record() hit TooShortPayload case. This must not&quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; happen except unit testcases.&quot;</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">kErrorCodeStrTooShortPayload</a>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(record-&gt;xct_id_.compare_epoch_and_orginal(xct_id) &lt; 0);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    record-&gt;xct_id_ = xct_id;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    record-&gt;overwrite_payload(payload, payload_offset, payload_count);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">foedus::kErrorCodeStrTooShortPayload</a></div><div class="ttdoc">0x080A : "STORAGE: The record&#39;s payload is smaller than requested" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00176">error_code.hpp:176</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__HASH_html_ga8c4ca78e36b2188f1feac100ce7df679"><div class="ttname"><a href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679">foedus::storage::hash::hashinate</a></div><div class="ttdeci">HashValue hashinate(const void *key, uint16_t key_length)</div><div class="ttdoc">Calculates hash value for general input. </div><div class="ttdef"><b>Definition:</b> <a href="hash__hashinate_8cpp_source.html#l00031">hash_hashinate.cpp:31</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a828a61afe3e29f6290e27651a0d95a2f"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">foedus::storage::hash::HashTmpBin::get_record</a></div><div class="ttdeci">Record * get_record(RecordIndex index) const </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00197">hash_tmpbin.hpp:197</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ae3f726ea1ce191d9ea5c41202568623b_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ae3f726ea1ce191d9ea5c41202568623b_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ae3f726ea1ce191d9ea5c41202568623b_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ae3f726ea1ce191d9ea5c41202568623b_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1xct_1_1XctId.html#a76fa9521598d6415dcb58cdff12c7cb1" title="Returns &#45;1, 0, 1 when this is less than, same, larger than other in terms of epoch/ordinal. " alt="" coords="227,57,378,113"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f" title="foedus::storage::hash\l::HashTmpBin::get_record" alt="" coords="216,137,389,179"/>
<area shape="rect" id="node8" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679" title="Calculates hash value for general input. " alt="" coords="229,203,376,244"/>
<area shape="rect" id="node9" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="241,268,364,309"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html#ac0d8b895512c27bbb528ff5a405cff9e" title="foedus::storage::hash\l::HashTmpBin::Record\l::overwrite_payload" alt="" coords="226,334,379,390"/>
<area shape="rect" id="node3" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="640,5,763,47"/>
<area shape="rect" id="node4" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="453,35,576,76"/>
<area shape="rect" id="node5" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="437,101,592,127"/>
<area shape="rect" id="node6" href="structfoedus_1_1xct_1_1XctId.html#a936888dbc82de6e76194b72c28c9a10f" title="foedus::xct::XctId\l::get_ordinal" alt="" coords="453,152,576,193"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html#a9d0e1e148c4cf1ca14f2566fabbdba0b" title="foedus::storage::hash\l::HashTmpBin::Record\l::get_payload" alt="" coords="438,334,591,390"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a16f546901cdf6de1815ba5d91b4bfa75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::hash::HashTmpBin::release_memory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor automatically releases everything, but you can use this to do it earlier. </p>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00049">49</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>

<p>References <a class="el" href="hash__tmpbin_8cpp_source.html#l00074">clean()</a>, and <a class="el" href="aligned__memory_8cpp_source.html#l00235">foedus::memory::AlignedMemory::release_block()</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">release_block</a>();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  on_memory_set();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c">clean</a>();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_afd955f5f991e28943c72ecff1167c16b"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">foedus::memory::AlignedMemory::release_block</a></div><div class="ttdeci">void release_block()</div><div class="ttdoc">Releases the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8cpp_source.html#l00235">aligned_memory.cpp:235</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a8e54f04414874188fa9d656aa0eba85c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c">foedus::storage::hash::HashTmpBin::clean</a></div><div class="ttdeci">void clean()</div><div class="ttdoc">Removes all tuple data for the current bin. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8cpp_source.html#l00074">hash_tmpbin.cpp:74</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a16f546901cdf6de1815ba5d91b4bfa75_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a16f546901cdf6de1815ba5d91b4bfa75_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a16f546901cdf6de1815ba5d91b4bfa75_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_a16f546901cdf6de1815ba5d91b4bfa75_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c" title="Removes all tuple data for the current bin. " alt="" coords="241,13,388,54"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b" title="Releases the memory block. " alt="" coords="208,78,421,119"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2" title="foedus::storage::hash\l::HashTmpBin::get_first\l_record" alt="" coords="469,5,628,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aece534e0cf6fb32ce2919062c90494b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::hash::HashTmpBin::steal_memory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> *&#160;</td>
          <td class="paramname"><em>provider</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is a special version of <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a44b5b127711bdcde112b8950c0777f01" title="Allocates the memory to use by this object. ">create_memory()</a> where this object <em>steals</em> the memory ownership from the recipient. </p>
<p>Combined with <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#ad4c29d5ae3263c1e0e5c5a729ed37bf6" title="This is a special version of release_memory() where this object moves the memory ownership to the rec...">give_memory()</a>, this allows completely reusing memory. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">provider</td><td>the memory from which this object steals ownership </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>!provider-&gt;is_null() </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>provider-&gt;is_null() </dd>
<dd>
!memory_-&gt;is_null() </dd></dl>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00055">55</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__tmpbin_8cpp_source.html#l00074">clean()</a>, and <a class="el" href="aligned__memory_8hpp_source.html#l00170">foedus::memory::AlignedMemory::is_null()</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                                           {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!provider-&gt;is_null());</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  memory_ = std::move(*provider);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(provider-&gt;is_null());</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!memory_.is_null());</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  on_memory_set();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c">clean</a>();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a8e54f04414874188fa9d656aa0eba85c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c">foedus::storage::hash::HashTmpBin::clean</a></div><div class="ttdeci">void clean()</div><div class="ttdoc">Removes all tuple data for the current bin. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8cpp_source.html#l00074">hash_tmpbin.cpp:74</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_aece534e0cf6fb32ce2919062c90494b3_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_aece534e0cf6fb32ce2919062c90494b3_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_aece534e0cf6fb32ce2919062c90494b3_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_aece534e0cf6fb32ce2919062c90494b3_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a8e54f04414874188fa9d656aa0eba85c" title="Removes all tuple data for the current bin. " alt="" coords="281,13,428,54"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="248,78,461,119"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a766152ddf547a633d9d2bf39c6d324e2" title="foedus::storage::hash\l::HashTmpBin::get_first\l_record" alt="" coords="509,5,668,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad54d9fdfa4874b6eaa0231bce58fccf8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashTmpBin::update_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1xct_1_1XctId.html">xct::XctId</a>&#160;</td>
          <td class="paramname"><em>xct_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__HASH.html#ga9fb894469b702dac3a6564416e19ed42">HashValue</a>&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates a record of the given key with the given payload, which might change length. </p>
<p>This method is same as <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a105eb120235425e73380a9b943a9bf66" title="Logically deletes a record of the given key. ">delete_record()</a>+insert_record(). The difference is that this can be faster because it does only one lookup. If there is no existing record of the key, or such a record is already logically deleted, this method returns an error (kErrorCodeStrKeyNotFound). Mustn't happen either. </p>

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00229">229</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="xct__id_8hpp_source.html#l00993">foedus::xct::XctId::compare_epoch_and_orginal()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00197">get_record()</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00084">foedus::storage::hash::HashTmpBin::Record::hash_</a>, <a class="el" href="hash__hashinate_8cpp_source.html#l00031">foedus::storage::hash::hashinate()</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="hash__tmpbin_8hpp_source.html#l00124">foedus::storage::hash::HashTmpBin::Record::set_payload()</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, and <a class="el" href="hash__tmpbin_8hpp_source.html#l00079">foedus::storage::hash::HashTmpBin::Record::xct_id_</a>.</p>
<div class="fragment"><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                           {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!xct_id.is_deleted());</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679">hashinate</a>(key, key_length) == hash);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  SearchResult result = search_bucket(key, key_length, hash);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(result.found_ == 0)) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    DLOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;HashTmpBin::update_record() hit KeyNotFound case 1. This must not&quot;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; happen except unit testcases.&quot;</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    Record* record = <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">get_record</a>(result.found_);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(record-&gt;hash_ == hash);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(record-&gt;xct_id_.is_deleted())) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      DLOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;HashTmpBin::update_record() hit KeyNotFound case 2. This must not&quot;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; happen except unit testcases.&quot;</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(record-&gt;xct_id_.compare_epoch_and_orginal(xct_id) &lt; 0);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    record-&gt;xct_id_ = xct_id;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    record-&gt;set_payload(payload, payload_length);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__HASH_html_ga8c4ca78e36b2188f1feac100ce7df679"><div class="ttname"><a href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679">foedus::storage::hash::hashinate</a></div><div class="ttdeci">HashValue hashinate(const void *key, uint16_t key_length)</div><div class="ttdoc">Calculates hash value for general input. </div><div class="ttdef"><b>Definition:</b> <a href="hash__hashinate_8cpp_source.html#l00031">hash_hashinate.cpp:31</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a828a61afe3e29f6290e27651a0d95a2f"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f">foedus::storage::hash::HashTmpBin::get_record</a></div><div class="ttdeci">Record * get_record(RecordIndex index) const </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00197">hash_tmpbin.hpp:197</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ad54d9fdfa4874b6eaa0231bce58fccf8_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ad54d9fdfa4874b6eaa0231bce58fccf8_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ad54d9fdfa4874b6eaa0231bce58fccf8_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_ad54d9fdfa4874b6eaa0231bce58fccf8_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1xct_1_1XctId.html#a76fa9521598d6415dcb58cdff12c7cb1" title="Returns &#45;1, 0, 1 when this is less than, same, larger than other in terms of epoch/ordinal. " alt="" coords="215,57,366,113"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a828a61afe3e29f6290e27651a0d95a2f" title="foedus::storage::hash\l::HashTmpBin::get_record" alt="" coords="204,137,377,179"/>
<area shape="rect" id="node8" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679" title="Calculates hash value for general input. " alt="" coords="217,203,364,244"/>
<area shape="rect" id="node9" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="229,268,352,309"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html#af7baf3f0c744ec86455d850489dba62c" title="foedus::storage::hash\l::HashTmpBin::Record\l::set_payload" alt="" coords="214,334,367,390"/>
<area shape="rect" id="node3" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="633,5,756,47"/>
<area shape="rect" id="node4" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="444,35,567,76"/>
<area shape="rect" id="node5" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="428,101,583,127"/>
<area shape="rect" id="node6" href="structfoedus_1_1xct_1_1XctId.html#a936888dbc82de6e76194b72c28c9a10f" title="foedus::xct::XctId\l::get_ordinal" alt="" coords="444,152,567,193"/>
<area shape="rect" id="node11" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="425,315,585,342"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1hash_1_1HashTmpBin_1_1Record.html#a9d0e1e148c4cf1ca14f2566fabbdba0b" title="foedus::storage::hash\l::HashTmpBin::Record\l::get_payload" alt="" coords="429,366,582,422"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a5069bbdf61fab52d7ddde826ca950aaf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html">HashTmpBin</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__tmpbin_8cpp_source.html#l00287">287</a> of file <a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                                           {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// Each bin shouldn&#39;t have that many records... so, output everything!</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;HashTmpBin&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; v.memory_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;  &lt;records_capacity_&gt;&quot;</span> &lt;&lt; v.records_capacity_ &lt;&lt; <span class="stringliteral">&quot;&lt;/records_capacity_&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;  &lt;records_consumed_&gt;&quot;</span> &lt;&lt; v.records_consumed_ &lt;&lt; <span class="stringliteral">&quot;&lt;/records_consumed_&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;  &lt;buckets_&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">HashTmpBin::kBucketCount</a>; ++i) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (v.buckets_[i] != 0) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      o &lt;&lt; <span class="stringliteral">&quot;    &lt;bucket idx=\&quot;&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\&quot; head_rec=\&quot;&quot;</span> &lt;&lt; v.buckets_[i] &lt;&lt; <span class="stringliteral">&quot;\&quot; /&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;  &lt;/buckets_&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;  &lt;records_&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  uint32_t begin = v.get_first_record();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = begin; i &lt; v.get_records_consumed(); ++i) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    HashTmpBin::Record* record = v.get_record(i);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;    &lt;record id=\&quot;&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\&quot; hash=\&quot;&quot;</span> &lt;&lt; assorted::Hex(record-&gt;hash_, 16) &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (record-&gt;next_) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      o &lt;&lt; <span class="stringliteral">&quot; next_rec=\&quot;&quot;</span> &lt;&lt; record-&gt;next_ &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;key&gt;&quot;</span> &lt;&lt; assorted::HexString(std::string(record-&gt;get_key(), record-&gt;key_length_))</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;&lt;/key&gt;&quot;</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;payload&gt;&quot;</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      &lt;&lt; assorted::HexString(std::string(record-&gt;get_payload(), record-&gt;payload_length_))</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;&lt;/payload&gt;&quot;</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    o &lt;&lt; record-&gt;xct_id_;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;/record&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;  &lt;/records_&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;/HashTmpBin&gt;&quot;</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashTmpBin_html_a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html#a9d8395fff848df50de411353c9300db1a33df5b8c7e1ab015a7308180995e8784">foedus::storage::hash::HashTmpBin::kBucketCount</a></div><div class="ttdoc">This is a per-bin data structure. </div><div class="ttdef"><b>Definition:</b> <a href="hash__tmpbin_8hpp_source.html#l00061">hash_tmpbin.hpp:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/storage/hash/<a class="el" href="hash__tmpbin_8hpp_source.html">hash_tmpbin.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/hash/<a class="el" href="hash__tmpbin_8cpp_source.html">hash_tmpbin.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1storage.html">storage</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1storage_1_1hash.html">hash</a></li><li class="navelem"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashTmpBin.html">HashTmpBin</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

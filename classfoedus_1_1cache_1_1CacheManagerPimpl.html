<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::cache::CacheManagerPimpl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1cache_1_1CacheManagerPimpl.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classfoedus_1_1cache_1_1CacheManagerPimpl-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::cache::CacheManagerPimpl Class Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__CACHE.html">Snapshot Cache Manager</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Pimpl object of <a class="el" href="classfoedus_1_1cache_1_1CacheManager.html" title="Snapshot cache manager. ">CacheManager</a>.  
 <a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Pimpl object of <a class="el" href="classfoedus_1_1cache_1_1CacheManager.html" title="Snapshot cache manager. ">CacheManager</a>. </p>
<p>A private pimpl object for <a class="el" href="classfoedus_1_1cache_1_1CacheManager.html" title="Snapshot cache manager. ">CacheManager</a>. Do not include this header from a client program unless you know what you are doing.</p>
<dl class="section user"><dt>Eviction Policy</dt><dd>So far we use a simple CLOCK algorithm to minimize the overhead, especially synchronization overhead. </dd></dl>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00044">44</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for foedus::cache::CacheManagerPimpl:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl__inherit__graph.png" border="0" usemap="#foedus_1_1cache_1_1CacheManagerPimpl_inherit__map" alt="Inheritance graph"/></div>
<map name="foedus_1_1cache_1_1CacheManagerPimpl_inherit__map" id="foedus_1_1cache_1_1CacheManagerPimpl_inherit__map">
<area shape="rect" id="node2" href="classfoedus_1_1DefaultInitializable.html" title="Typical implementation of Initializable as a skeleton base class. " alt="" coords="19,80,191,107"/>
<area shape="rect" id="node3" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="39,5,171,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for foedus::cache::CacheManagerPimpl:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl__coll__graph.png" border="0" usemap="#foedus_1_1cache_1_1CacheManagerPimpl_coll__map" alt="Collaboration graph"/></div>
<map name="foedus_1_1cache_1_1CacheManagerPimpl_coll__map" id="foedus_1_1cache_1_1CacheManagerPimpl_coll__map">
<area shape="rect" id="node2" href="classfoedus_1_1DefaultInitializable.html" title="Typical implementation of Initializable as a skeleton base class. " alt="" coords="760,5,932,32"/>
<area shape="rect" id="node3" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="369,32,501,59"/>
<area shape="rect" id="node4" href="classfoedus_1_1Engine.html" title="Database engine object that holds all resources and provides APIs. " alt="" coords="792,63,900,89"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1PagePool.html" title="Page pool for volatile read/write store (VolatilePage) and the read&#45;only bufferpool (SnapshotPage)..." alt="" coords="757,127,935,153"/>
<area shape="rect" id="node6" href="classfoedus_1_1cache_1_1CacheHashtable.html" title="A NUMA&#45;local hashtable of cached snapshot pages. " alt="" coords="743,204,949,231"/>
<area shape="rect" id="node7" href="structfoedus_1_1cache_1_1HashFunc.html" title="A simple hash function logic used in snasphot cache. " alt="" coords="349,100,520,127"/>
<area shape="rect" id="node8" href="structfoedus_1_1assorted_1_1ConstDiv.html" title="The pre&#45;calculated p&#45;m pair for optimized integer division by constant. " alt="" coords="17,100,195,127"/>
<area shape="rect" id="node9" href="classfoedus_1_1soc_1_1SharedMutex.html" title="A mutex that can be placed in shared memory and used from multiple processes. " alt="" coords="347,152,522,179"/>
<area shape="rect" id="node10" href="namespacefoedus_1_1cache.html#structfoedus_1_1cache_1_1CacheOverflowEntry" title="An entry in the overflow linked list for snapshot cache. " alt="" coords="337,266,533,307"/>
<area shape="rect" id="node11" href="structfoedus_1_1cache_1_1CacheBucket.html" title="Hash bucket in cache table. " alt="" coords="11,228,201,255"/>
<area shape="rect" id="node12" href="structfoedus_1_1cache_1_1CacheRefCount.html" title="A loosely maintained reference count for CLOCK algorithm. " alt="" coords="5,300,207,327"/>
<area shape="rect" id="node13" href="classfoedus_1_1memory_1_1AlignedMemory.html" title="Represents one memory block aligned to actual OS/hardware pages. " alt="" coords="328,412,541,439"/>
<area shape="rect" id="node14" title="STL class. " alt="" coords="804,491,888,517"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af988b50f580d524334c9b9b0b7dc84e1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af988b50f580d524334c9b9b0b7dc84e1">CacheManagerPimpl</a> ()=delete</td></tr>
<tr class="separator:af988b50f580d524334c9b9b0b7dc84e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b40e7ae6820c838e2e86ec6f611ee71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a4b40e7ae6820c838e2e86ec6f611ee71">CacheManagerPimpl</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine)</td></tr>
<tr class="separator:a4b40e7ae6820c838e2e86ec6f611ee71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af04416fadb8ec5160408982fa67a08c1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af04416fadb8ec5160408982fa67a08c1">initialize_once</a> () override</td></tr>
<tr class="separator:af04416fadb8ec5160408982fa67a08c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1322d8be16a7fe558bd83de18eb41c85"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1322d8be16a7fe558bd83de18eb41c85">uninitialize_once</a> () override</td></tr>
<tr class="separator:a1322d8be16a7fe558bd83de18eb41c85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2876d026b658af099cdf153ed1529369"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">describe</a> () const </td></tr>
<tr class="separator:a2876d026b658af099cdf153ed1529369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a0fd87ff73e0f43e5a901f1c4fa34e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a5a0fd87ff73e0f43e5a901f1c4fa34e3">handle_cleaner</a> ()</td></tr>
<tr class="memdesc:a5a0fd87ff73e0f43e5a901f1c4fa34e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main routine of cleaner_.  <a href="#a5a0fd87ff73e0f43e5a901f1c4fa34e3">More...</a><br /></td></tr>
<tr class="separator:a5a0fd87ff73e0f43e5a901f1c4fa34e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b5e7574ed3474be65757a9f1d2595fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a0b5e7574ed3474be65757a9f1d2595fc">handle_cleaner_evict_pages</a> (uint64_t target_count)</td></tr>
<tr class="memdesc:a0b5e7574ed3474be65757a9f1d2595fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evicts pages up to about target_count (maybe a bit more or less).  <a href="#a0b5e7574ed3474be65757a9f1d2595fc">More...</a><br /></td></tr>
<tr class="separator:a0b5e7574ed3474be65757a9f1d2595fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a913ee4a71391ff0261b6725ca658925a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a913ee4a71391ff0261b6725ca658925a">stop_cleaner</a> ()</td></tr>
<tr class="separator:a913ee4a71391ff0261b6725ca658925a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1DefaultInitializable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1DefaultInitializable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1DefaultInitializable.html">foedus::DefaultInitializable</a></td></tr>
<tr class="memitem:a5e0a2679baa030e297c1a51847352945 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a5e0a2679baa030e297c1a51847352945">DefaultInitializable</a> ()</td></tr>
<tr class="separator:a5e0a2679baa030e297c1a51847352945 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe7a18ec3e5edd143eb7d6a75d65ef9b inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#afe7a18ec3e5edd143eb7d6a75d65ef9b">~DefaultInitializable</a> ()</td></tr>
<tr class="separator:afe7a18ec3e5edd143eb7d6a75d65ef9b inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd6a8f8296ab570b545430593287d454 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#afd6a8f8296ab570b545430593287d454">DefaultInitializable</a> (const <a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;)=delete</td></tr>
<tr class="separator:afd6a8f8296ab570b545430593287d454 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31eb5acadf0544b97414efd33aed08c7 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a31eb5acadf0544b97414efd33aed08c7">operator=</a> (const <a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;)=delete</td></tr>
<tr class="separator:a31eb5acadf0544b97414efd33aed08c7 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff">initialize</a> () override final</td></tr>
<tr class="memdesc:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typical implementation of <a class="el" href="classfoedus_1_1Initializable.html#aa087b096d1edaeb0304c250eadb0d7e1" title="Acquires resources in this object, usually called right after constructor. ">Initializable::initialize()</a> that provides initialize-once semantics.  <a href="#a22a0dc3bbbca682c3bc41eace9b6d1ff">More...</a><br /></td></tr>
<tr class="separator:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb">uninitialize</a> () override final</td></tr>
<tr class="memdesc:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typical implementation of <a class="el" href="classfoedus_1_1Initializable.html#afbe5738b0bc85362fba80bdf788fd3c3" title="An idempotent method to release all resources of this object, if any. ">Initializable::uninitialize()</a> that provides uninitialize-once semantics.  <a href="#ab14b136a7d26f9f499ab9dc15a45a8cb">More...</a><br /></td></tr>
<tr class="separator:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e">is_initialized</a> () const  override final</td></tr>
<tr class="memdesc:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the object has been already initialized or not.  <a href="#a1abda1e84b8af8bd6916e52fd0a09f3e">More...</a><br /></td></tr>
<tr class="separator:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1Initializable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1Initializable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1Initializable.html">foedus::Initializable</a></td></tr>
<tr class="memitem:aff308260543d18b3fd1367fd9017b176 inherit pub_methods_classfoedus_1_1Initializable"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Initializable.html#aff308260543d18b3fd1367fd9017b176">~Initializable</a> ()</td></tr>
<tr class="separator:aff308260543d18b3fd1367fd9017b176 inherit pub_methods_classfoedus_1_1Initializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a11b8ef3c07c8871cb34620976a39370c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a></td></tr>
<tr class="separator:a11b8ef3c07c8871cb34620976a39370c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d0888a1d0fd682cb1e42830b091044d"><td class="memItemLeft" align="right" valign="top">std::thread&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a6d0888a1d0fd682cb1e42830b091044d">cleaner_</a></td></tr>
<tr class="memdesc:a6d0888a1d0fd682cb1e42830b091044d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The only cleaner thread in this SOC engine.  <a href="#a6d0888a1d0fd682cb1e42830b091044d">More...</a><br /></td></tr>
<tr class="separator:a6d0888a1d0fd682cb1e42830b091044d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad30307affc38a5fa2b46f1cc3316053a"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a></td></tr>
<tr class="separator:ad30307affc38a5fa2b46f1cc3316053a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fc02bb6dc7405008fd2cf706ca6a47c"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">cleaner_threshold_</a></td></tr>
<tr class="memdesc:a3fc02bb6dc7405008fd2cf706ca6a47c"><td class="mdescLeft">&#160;</td><td class="mdescRight">the number of allocated pages above which cleaner starts cleaning  <a href="#a3fc02bb6dc7405008fd2cf706ca6a47c">More...</a><br /></td></tr>
<tr class="separator:a3fc02bb6dc7405008fd2cf706ca6a47c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cfa4137e2243f7e8bb43a1b11441bf6"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">urgent_threshold_</a></td></tr>
<tr class="memdesc:a1cfa4137e2243f7e8bb43a1b11441bf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">the number of allocated pages above which cleaner advances epoch to release pages  <a href="#a1cfa4137e2243f7e8bb43a1b11441bf6">More...</a><br /></td></tr>
<tr class="separator:a1cfa4137e2243f7e8bb43a1b11441bf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b94264bea60c98e93556f7458d02385"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">stop_requested_</a></td></tr>
<tr class="memdesc:a9b94264bea60c98e93556f7458d02385"><td class="mdescLeft">&#160;</td><td class="mdescRight">to stop cleaner_  <a href="#a9b94264bea60c98e93556f7458d02385">More...</a><br /></td></tr>
<tr class="separator:a9b94264bea60c98e93556f7458d02385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60dcb46431ef158283b2923c03ed930"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1memory_1_1PagePool.html">memory::PagePool</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">pool_</a></td></tr>
<tr class="memdesc:ad60dcb46431ef158283b2923c03ed930"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SOC-local snapshot page pool in this SOC engine.  <a href="#ad60dcb46431ef158283b2923c03ed930">More...</a><br /></td></tr>
<tr class="separator:ad60dcb46431ef158283b2923c03ed930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad04d70867dbd39a5ae1c00e3e8d3b150"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1cache_1_1CacheHashtable.html">CacheHashtable</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad04d70867dbd39a5ae1c00e3e8d3b150">hashtable_</a></td></tr>
<tr class="memdesc:ad04d70867dbd39a5ae1c00e3e8d3b150"><td class="mdescLeft">&#160;</td><td class="mdescRight">The cache hashtable (SnapshotPageId -&gt; offset in pool) on top of the page pool.  <a href="#ad04d70867dbd39a5ae1c00e3e8d3b150">More...</a><br /></td></tr>
<tr class="separator:ad04d70867dbd39a5ae1c00e3e8d3b150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af806f450ee89c5881ad1670f8f5a14f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">reclaimed_pages_</a></td></tr>
<tr class="memdesc:af806f450ee89c5881ad1670f8f5a14f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This buffers pages being reclaimed.  <a href="#af806f450ee89c5881ad1670f8f5a14f2">More...</a><br /></td></tr>
<tr class="separator:af806f450ee89c5881ad1670f8f5a14f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7e849ef002da81240c4cb13c0d0083e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#aa7e849ef002da81240c4cb13c0d0083e">reclaimed_pages_memory_</a></td></tr>
<tr class="memdesc:aa7e849ef002da81240c4cb13c0d0083e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The memory backing reclaimed_pages_.  <a href="#aa7e849ef002da81240c4cb13c0d0083e">More...</a><br /></td></tr>
<tr class="separator:aa7e849ef002da81240c4cb13c0d0083e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93843fcb689b82e4eb63c5b3cb51f2f6"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a></td></tr>
<tr class="memdesc:a93843fcb689b82e4eb63c5b3cb51f2f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of pages buffered so far.  <a href="#a93843fcb689b82e4eb63c5b3cb51f2f6">More...</a><br /></td></tr>
<tr class="separator:a93843fcb689b82e4eb63c5b3cb51f2f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="af988b50f580d524334c9b9b0b7dc84e1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::cache::CacheManagerPimpl::CacheManagerPimpl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4b40e7ae6820c838e2e86ec6f611ee71"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::cache::CacheManagerPimpl::CacheManagerPimpl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00038">38</a> of file <a class="el" href="cache__manager__pimpl_8cpp_source.html">cache_manager_pimpl.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  : <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>(engine),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">stop_requested_</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">pool_</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad04d70867dbd39a5ae1c00e3e8d3b150">hashtable_</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">reclaimed_pages_</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a>(0) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_af806f450ee89c5881ad1670f8f5a14f2"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">foedus::cache::CacheManagerPimpl::reclaimed_pages_</a></div><div class="ttdeci">memory::PagePoolOffset * reclaimed_pages_</div><div class="ttdoc">This buffers pages being reclaimed. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00106">cache_manager_pimpl.hpp:106</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad04d70867dbd39a5ae1c00e3e8d3b150"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad04d70867dbd39a5ae1c00e3e8d3b150">foedus::cache::CacheManagerPimpl::hashtable_</a></div><div class="ttdeci">CacheHashtable * hashtable_</div><div class="ttdoc">The cache hashtable (SnapshotPageId -> offset in pool) on top of the page pool. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00093">cache_manager_pimpl.hpp:93</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a9b94264bea60c98e93556f7458d02385"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">foedus::cache::CacheManagerPimpl::stop_requested_</a></div><div class="ttdeci">std::atomic&lt; bool &gt; stop_requested_</div><div class="ttdoc">to stop cleaner_ </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00077">cache_manager_pimpl.hpp:77</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad60dcb46431ef158283b2923c03ed930"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">foedus::cache::CacheManagerPimpl::pool_</a></div><div class="ttdeci">memory::PagePool * pool_</div><div class="ttdoc">The SOC-local snapshot page pool in this SOC engine. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00085">cache_manager_pimpl.hpp:85</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a93843fcb689b82e4eb63c5b3cb51f2f6"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">foedus::cache::CacheManagerPimpl::reclaimed_pages_count_</a></div><div class="ttdeci">uint64_t reclaimed_pages_count_</div><div class="ttdoc">Number of pages buffered so far. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00112">cache_manager_pimpl.hpp:112</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a11b8ef3c07c8871cb34620976a39370c"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">foedus::cache::CacheManagerPimpl::engine_</a></div><div class="ttdeci">Engine *const engine_</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00063">cache_manager_pimpl.hpp:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a2876d026b658af099cdf153ed1529369"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string foedus::cache::CacheManagerPimpl::describe </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00213">213</a> of file <a class="el" href="cache__manager__pimpl_8cpp_source.html">cache_manager_pimpl.cpp</a>.</p>

<p>References <a class="el" href="page__pool_8hpp_source.html#l00177">foedus::memory::PagePool::Stat::allocated_pages_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00073">cleaner_threshold_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00063">engine_</a>, <a class="el" href="engine_8cpp_source.html#l00073">foedus::Engine::get_soc_id()</a>, <a class="el" href="page__pool_8cpp_source.html#l00118">foedus::memory::PagePool::get_stat()</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00085">pool_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00112">reclaimed_pages_count_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00109">reclaimed_pages_memory_</a>, <a class="el" href="page__pool_8hpp_source.html#l00176">foedus::memory::PagePool::Stat::total_pages_</a>, and <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00075">urgent_threshold_</a>.</p>

<p>Referenced by <a class="el" href="cache__manager_8cpp_source.html#l00037">foedus::cache::CacheManager::describe()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00102">uninitialize_once()</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                            {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">pool_</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;SnapshotCacheManager /&gt;&quot;</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  std::stringstream str;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  memory::PagePool::Stat pool_stat = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">pool_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#aae17b661b01fd08a3019128c82227e7c">get_stat</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  str &lt;&lt; <span class="stringliteral">&quot;&lt;SpCache &quot;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; node=\&quot;&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9">get_soc_id</a>() &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; total=\&quot;&quot;</span> &lt;&lt; pool_stat.total_pages_ &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; alloc=\&quot;&quot;</span> &lt;&lt; pool_stat.allocated_pages_ &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; threshold=\&quot;&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">cleaner_threshold_</a> &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; urgent_threshold=\&quot;&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">urgent_threshold_</a> &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; reclaimed_count=\&quot;&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a> &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#aa7e849ef002da81240c4cb13c0d0083e">reclaimed_pages_memory_</a> &lt;&lt; <span class="stringliteral">&quot;&lt;/SpCache&gt;&quot;</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">return</span> str.str();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePool_html_aae17b661b01fd08a3019128c82227e7c"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePool.html#aae17b661b01fd08a3019128c82227e7c">foedus::memory::PagePool::get_stat</a></div><div class="ttdeci">Stat get_stat() const </div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8cpp_source.html#l00118">page_pool.cpp:118</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a1cfa4137e2243f7e8bb43a1b11441bf6"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">foedus::cache::CacheManagerPimpl::urgent_threshold_</a></div><div class="ttdeci">uint64_t urgent_threshold_</div><div class="ttdoc">the number of allocated pages above which cleaner advances epoch to release pages ...</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00075">cache_manager_pimpl.hpp:75</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad60dcb46431ef158283b2923c03ed930"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">foedus::cache::CacheManagerPimpl::pool_</a></div><div class="ttdeci">memory::PagePool * pool_</div><div class="ttdoc">The SOC-local snapshot page pool in this SOC engine. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00085">cache_manager_pimpl.hpp:85</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_aa7e849ef002da81240c4cb13c0d0083e"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#aa7e849ef002da81240c4cb13c0d0083e">foedus::cache::CacheManagerPimpl::reclaimed_pages_memory_</a></div><div class="ttdeci">memory::AlignedMemory reclaimed_pages_memory_</div><div class="ttdoc">The memory backing reclaimed_pages_. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00109">cache_manager_pimpl.hpp:109</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a93843fcb689b82e4eb63c5b3cb51f2f6"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">foedus::cache::CacheManagerPimpl::reclaimed_pages_count_</a></div><div class="ttdeci">uint64_t reclaimed_pages_count_</div><div class="ttdoc">Number of pages buffered so far. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00112">cache_manager_pimpl.hpp:112</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a11b8ef3c07c8871cb34620976a39370c"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">foedus::cache::CacheManagerPimpl::engine_</a></div><div class="ttdeci">Engine *const engine_</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00063">cache_manager_pimpl.hpp:63</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a3fc02bb6dc7405008fd2cf706ca6a47c"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">foedus::cache::CacheManagerPimpl::cleaner_threshold_</a></div><div class="ttdeci">uint64_t cleaner_threshold_</div><div class="ttdoc">the number of allocated pages above which cleaner starts cleaning </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00073">cache_manager_pimpl.hpp:73</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a8d9a31e48aec9b73e16b64170c0250f9"><div class="ttname"><a href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9">foedus::Engine::get_soc_id</a></div><div class="ttdeci">soc::SocId get_soc_id() const </div><div class="ttdoc">If this is a child instance, returns its SOC ID (NUMA node). </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00073">engine.cpp:73</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_a2876d026b658af099cdf153ed1529369_cgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_a2876d026b658af099cdf153ed1529369_cgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_a2876d026b658af099cdf153ed1529369_cgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_a2876d026b658af099cdf153ed1529369_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9" title="If this is a child instance, returns its SOC ID (NUMA node). " alt="" coords="274,5,409,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1PagePool.html#aae17b661b01fd08a3019128c82227e7c" title="foedus::memory::PagePool\l::get_stat" alt="" coords="252,71,431,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a55ba648cb98718804a890ea3b4965e39" title="foedus::memory::PagePool\lPimpl::get_stat" alt="" coords="479,71,657,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="705,71,884,112"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_a2876d026b658af099cdf153ed1529369_icgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_a2876d026b658af099cdf153ed1529369_icgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_a2876d026b658af099cdf153ed1529369_icgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_a2876d026b658af099cdf153ed1529369_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1cache_1_1CacheManager.html#a210cd75b484f0961e84c3400f203d69b" title="kind of to_string(). " alt="" coords="252,5,451,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a5a0fd87ff73e0f43e5a901f1c4fa34e3" title="Main routine of cleaner_. " alt="" coords="252,71,451,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1322d8be16a7fe558bd83de18eb41c85" title="foedus::cache::CacheManager\lPimpl::uninitialize_once" alt="" coords="252,136,451,177"/>
<area shape="rect" id="node4" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af04416fadb8ec5160408982fa67a08c1" title="foedus::cache::CacheManager\lPimpl::initialize_once" alt="" coords="499,71,697,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1cache_1_1CacheManager.html#a9181ec7d7e0ee1faa942ba9eec6c1345" title="foedus::cache::CacheManager\l::initialize_once" alt="" coords="745,71,944,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1cache_1_1CacheManager.html#ab7dbe48b7c06d1bcefcf787bce285c25" title="foedus::cache::CacheManager\l::uninitialize_once" alt="" coords="499,136,697,177"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5a0fd87ff73e0f43e5a901f1c4fa34e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::cache::CacheManagerPimpl::handle_cleaner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main routine of cleaner_. </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">119</a> of file <a class="el" href="cache__manager__pimpl_8cpp_source.html">cache_manager_pimpl.cpp</a>.</p>

<p>References <a class="el" href="xct__manager__pimpl_8cpp_source.html#l00070">foedus::xct::XctManager::advance_current_global_epoch()</a>, <a class="el" href="page__pool_8hpp_source.html#l00177">foedus::memory::PagePool::Stat::allocated_pages_</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00073">cleaner_threshold_</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00213">describe()</a>, <a class="el" href="stop__watch_8hpp_source.html#l00045">foedus::debugging::StopWatch::elapsed_us()</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00063">engine_</a>, <a class="el" href="xct__manager__pimpl_8cpp_source.html#l00057">foedus::xct::XctManager::get_current_global_epoch()</a>, <a class="el" href="page__pool_8cpp_source.html#l00118">foedus::memory::PagePool::get_stat()</a>, <a class="el" href="engine_8cpp_source.html#l00061">foedus::Engine::get_xct_manager()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00190">handle_cleaner_evict_pages()</a>, <a class="el" href="xct__manager_8cpp_source.html#l00031">foedus::xct::XctManager::is_initialized()</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00046">foedus::assorted::memory_fence_acquire()</a>, <a class="el" href="epoch_8hpp_source.html#l00127">foedus::Epoch::one_more()</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00085">pool_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00106">reclaimed_pages_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00112">reclaimed_pages_count_</a>, <a class="el" href="page__pool_8cpp_source.html#l00134">foedus::memory::PagePool::release()</a>, <a class="el" href="stop__watch_8cpp_source.html#l00035">foedus::debugging::StopWatch::stop()</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00077">stop_requested_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00071">total_pages_</a>, <a class="el" href="page__pool_8hpp_source.html#l00176">foedus::memory::PagePool::Stat::total_pages_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00075">urgent_threshold_</a>, and <a class="el" href="xct__manager_8cpp_source.html#l00035">foedus::xct::XctManager::wait_for_current_global_epoch()</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>.</p>
<div class="fragment"><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                       {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Here we go. Cleaner thread: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">describe</a>();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">const</span> uint32_t kIntervalMs = 5;  <span class="comment">// should be a bit shorter than epoch-advance interval</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">stop_requested_</a>) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    DVLOG(2) &lt;&lt; <span class="stringliteral">&quot;Cleaner thread came in: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">describe</a>();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a> == 0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    memory::PagePool::Stat stat = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">pool_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#aae17b661b01fd08a3019128c82227e7c">get_stat</a>();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(stat.total_pages_ == <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (stat.allocated_pages_ &gt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">cleaner_threshold_</a>) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Time to evict: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">describe</a>();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      uint64_t target_count = stat.allocated_pages_ - <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">cleaner_threshold_</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      debugging::StopWatch evict_watch;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a0b5e7574ed3474be65757a9f1d2595fc">handle_cleaner_evict_pages</a>(target_count);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      evict_watch.stop();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Evicted &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a> &lt;&lt; <span class="stringliteral">&quot; pages in &quot;</span> &lt;&lt; evict_watch.elapsed_us()</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;us: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">describe</a>();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a> &gt; 0) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">// We collected some number of pages in previous execution. now we have to wait for</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">// grace period before returning them to the pool as free pages.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        xct::XctManager* xct_manager = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a48d5e1f7ce2f70161c253f650c75ed95">get_xct_manager</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(xct_manager-&gt;is_initialized());  <span class="comment">// see stop_cleaner()&#39;s comment why this is true.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        Epoch reclaimed_pages_epoch = xct_manager-&gt;get_current_global_epoch();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Collected &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a> &lt;&lt; <span class="stringliteral">&quot; pages. let&#39;s return them to &quot;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;the pool: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">describe</a>();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        Epoch wait_until = reclaimed_pages_epoch.one_more();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">// We have to wait for grace-period, in other words until the next epoch.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> (stat.allocated_pages_ &gt;= <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">urgent_threshold_</a>) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          VLOG(0) &lt;&lt; <span class="stringliteral">&quot;We are in urgent lack of free pages, let&#39;s advance epoch right now&quot;</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          xct_manager-&gt;advance_current_global_epoch();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">// wait forever, but occasionally wake up to check if the system is being shutdown</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">while</span> (!<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">stop_requested_</a> &amp;&amp; xct_manager-&gt;get_current_global_epoch() &lt; wait_until) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <span class="keyword">const</span> uint64_t interval_microsec = 100000ULL;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          xct_manager-&gt;wait_for_current_global_epoch(wait_until, interval_microsec);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">stop_requested_</a>) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          Epoch current_epoch = xct_manager-&gt;get_current_global_epoch();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(reclaimed_pages_epoch &lt; current_epoch);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Okay! reclaimed_pages_epoch_=&quot;</span> &lt;&lt; reclaimed_pages_epoch</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;, current_epoch=&quot;</span> &lt;&lt; current_epoch;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          memory::PagePoolOffsetDynamicChunk chunk(<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a>, <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">reclaimed_pages_</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">pool_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#a802171ff0578875748d20b4e9c8c9463">release</a>(<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a>, &amp;chunk);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a> = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Wtf, we couldn&#39;t collect any pages? that&#39;s weird...: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">describe</a>();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">if</span> (stat.allocated_pages_ &gt;= <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">urgent_threshold_</a>) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Umm, still severely lacking free pages. This might mean&quot;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          <span class="stringliteral">&quot; that the cleaner thread is getting behind or the pool is too small: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">describe</a>();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      DVLOG(2) &lt;&lt; <span class="stringliteral">&quot;Still enough free pages. do nothing&quot;</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">stop_requested_</a>) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      std::this_thread::sleep_for(std::chrono::milliseconds(kIntervalMs));</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Quiting... Cleaner thread: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">describe</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad30307affc38a5fa2b46f1cc3316053a"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">foedus::cache::CacheManagerPimpl::total_pages_</a></div><div class="ttdeci">uint64_t total_pages_</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00071">cache_manager_pimpl.hpp:71</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_af806f450ee89c5881ad1670f8f5a14f2"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">foedus::cache::CacheManagerPimpl::reclaimed_pages_</a></div><div class="ttdeci">memory::PagePoolOffset * reclaimed_pages_</div><div class="ttdoc">This buffers pages being reclaimed. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00106">cache_manager_pimpl.hpp:106</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePool_html_aae17b661b01fd08a3019128c82227e7c"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePool.html#aae17b661b01fd08a3019128c82227e7c">foedus::memory::PagePool::get_stat</a></div><div class="ttdeci">Stat get_stat() const </div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8cpp_source.html#l00118">page_pool.cpp:118</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a2876d026b658af099cdf153ed1529369"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">foedus::cache::CacheManagerPimpl::describe</a></div><div class="ttdeci">std::string describe() const </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8cpp_source.html#l00213">cache_manager_pimpl.cpp:213</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a9b94264bea60c98e93556f7458d02385"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">foedus::cache::CacheManagerPimpl::stop_requested_</a></div><div class="ttdeci">std::atomic&lt; bool &gt; stop_requested_</div><div class="ttdoc">to stop cleaner_ </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00077">cache_manager_pimpl.hpp:77</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a1cfa4137e2243f7e8bb43a1b11441bf6"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">foedus::cache::CacheManagerPimpl::urgent_threshold_</a></div><div class="ttdeci">uint64_t urgent_threshold_</div><div class="ttdoc">the number of allocated pages above which cleaner advances epoch to release pages ...</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00075">cache_manager_pimpl.hpp:75</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad60dcb46431ef158283b2923c03ed930"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">foedus::cache::CacheManagerPimpl::pool_</a></div><div class="ttdeci">memory::PagePool * pool_</div><div class="ttdoc">The SOC-local snapshot page pool in this SOC engine. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00085">cache_manager_pimpl.hpp:85</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a0b5e7574ed3474be65757a9f1d2595fc"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a0b5e7574ed3474be65757a9f1d2595fc">foedus::cache::CacheManagerPimpl::handle_cleaner_evict_pages</a></div><div class="ttdeci">void handle_cleaner_evict_pages(uint64_t target_count)</div><div class="ttdoc">Evicts pages up to about target_count (maybe a bit more or less). </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8cpp_source.html#l00190">cache_manager_pimpl.cpp:190</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePool_html_a802171ff0578875748d20b4e9c8c9463"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePool.html#a802171ff0578875748d20b4e9c8c9463">foedus::memory::PagePool::release</a></div><div class="ttdeci">void release(uint32_t desired_release_count, PagePoolOffsetChunk *chunk)</div><div class="ttdoc">Returns the specified number of free pages from the chunk. </div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8cpp_source.html#l00134">page_pool.cpp:134</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a48d5e1f7ce2f70161c253f650c75ed95"><div class="ttname"><a href="classfoedus_1_1Engine.html#a48d5e1f7ce2f70161c253f650c75ed95">foedus::Engine::get_xct_manager</a></div><div class="ttdeci">xct::XctManager * get_xct_manager() const </div><div class="ttdoc">See Transaction Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00061">engine.cpp:61</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a93843fcb689b82e4eb63c5b3cb51f2f6"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">foedus::cache::CacheManagerPimpl::reclaimed_pages_count_</a></div><div class="ttdeci">uint64_t reclaimed_pages_count_</div><div class="ttdoc">Number of pages buffered so far. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00112">cache_manager_pimpl.hpp:112</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a11b8ef3c07c8871cb34620976a39370c"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">foedus::cache::CacheManagerPimpl::engine_</a></div><div class="ttdeci">Engine *const engine_</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00063">cache_manager_pimpl.hpp:63</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a3fc02bb6dc7405008fd2cf706ca6a47c"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">foedus::cache::CacheManagerPimpl::cleaner_threshold_</a></div><div class="ttdeci">uint64_t cleaner_threshold_</div><div class="ttdoc">the number of allocated pages above which cleaner starts cleaning </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00073">cache_manager_pimpl.hpp:73</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaf84f9944a16c5848f69beacdfeedf939"><div class="ttname"><a href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">foedus::assorted::memory_fence_acquire</a></div><div class="ttdeci">void memory_fence_acquire()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acquire). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00046">atomic_fences.hpp:46</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_a5a0fd87ff73e0f43e5a901f1c4fa34e3_cgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_a5a0fd87ff73e0f43e5a901f1c4fa34e3_cgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_a5a0fd87ff73e0f43e5a901f1c4fa34e3_cgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_a5a0fd87ff73e0f43e5a901f1c4fa34e3_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1XctManager.html#aa75089821b48c98a00cd7e4ddc0615da" title="Requests to advance the current global epoch as soon as possible and blocks until it actually does..." alt="" coords="261,293,468,335"/>
<area shape="rect" id="node5" href="classfoedus_1_1Epoch.html#a786afd92afdc87b54dfa11ef093f06f3" title="foedus::Epoch::one_more" alt="" coords="798,71,969,98"/>
<area shape="rect" id="node15" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369" title="foedus::cache::CacheManager\lPimpl::describe" alt="" coords="265,101,464,143"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1PagePool.html#aae17b661b01fd08a3019128c82227e7c" title="foedus::memory::PagePool\l::get_stat" alt="" coords="539,36,718,77"/>
<area shape="rect" id="node20" href="classfoedus_1_1debugging_1_1StopWatch.html#a7f1f05f4dd494dd57c3ecafb5d9131fb" title="foedus::debugging::\lStopWatch::elapsed_us" alt="" coords="1057,565,1219,607"/>
<area shape="rect" id="node21" href="classfoedus_1_1xct_1_1XctManager.html#a419a270d62522ede9bd871dd4adc0e2a" title="Returns the current global epoch, the epoch a newly started transaction will be in. " alt="" coords="539,219,718,260"/>
<area shape="rect" id="node22" href="classfoedus_1_1Engine.html#a48d5e1f7ce2f70161c253f650c75ed95" title="See Transaction Manager. " alt="" coords="297,456,432,497"/>
<area shape="rect" id="node23" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a0b5e7574ed3474be65757a9f1d2595fc" title="Evicts pages up to about target_count (maybe a bit more or less). " alt="" coords="252,599,477,640"/>
<area shape="rect" id="node31" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="1071,892,1205,933"/>
<area shape="rect" id="node36" href="classfoedus_1_1xct_1_1XctManager.html#a8c2222c8c5db52f4f1175b1250bf1a4a" title="Returns whether the object has been already initialized or not. " alt="" coords="283,664,446,705"/>
<area shape="rect" id="node38" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="278,729,451,771"/>
<area shape="rect" id="node39" href="classfoedus_1_1memory_1_1PagePool.html#a802171ff0578875748d20b4e9c8c9463" title="Returns the specified number of free pages from the chunk. " alt="" coords="275,795,454,836"/>
<area shape="rect" id="node41" href="classfoedus_1_1xct_1_1XctManager.html#aa3178a6ce1c815fb88b6c8d5607da5d4" title="Passively wait until the current global epoch becomes the given value. " alt="" coords="263,371,467,412"/>
<area shape="rect" id="node3" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a925da0bb4b846daa21eb947e4f67b0c6" title="foedus::xct::XctManagerPimpl\l::advance_current_global_epoch" alt="" coords="525,284,732,325"/>
<area shape="rect" id="node4" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a787bb892079cb32d5a2065188825a522" title="foedus::xct::XctManagerPimpl\l::get_current_global_epoch" alt="" coords="786,188,981,229"/>
<area shape="rect" id="node6" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a03678427b184e7ce71f9bbb164dd0bad" title="foedus::xct::XctManagerPimpl\l::set_requested_global_epoch" alt="" coords="786,384,981,425"/>
<area shape="rect" id="node9" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#afce787897428bd372c67224acd3e8ea7" title="foedus::xct::XctManagerPimpl\l::wakeup_epoch_chime_thread" alt="" coords="783,123,984,164"/>
<area shape="rect" id="node13" href="classfoedus_1_1soc_1_1SharedPolling.html#ac6ad7822e42e2e942b55708b1da8516b" title="Gives the ticket to. " alt="" coords="795,319,972,360"/>
<area shape="rect" id="node14" href="classfoedus_1_1soc_1_1SharedPolling.html#a9fc7bfaf57e1f2224be9869a8e9708d3" title="Unconditionally wait for signal. " alt="" coords="795,253,972,295"/>
<area shape="rect" id="node7" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a6071efec3ffc3876192101db2a1873b4" title="foedus::xct::XctManagerPimpl\l::get_requested_global_epoch" alt="" coords="1041,317,1235,359"/>
<area shape="rect" id="node8" href="classfoedus_1_1Epoch.html#af13cf48db2b5bd1d273f5f7350a4d8cf" title="Returns the raw integer representation. " alt="" coords="1067,383,1209,410"/>
<area shape="rect" id="node10" href="classfoedus_1_1soc_1_1SharedPolling.html#ae523f3b3bda39c0c81bfb5cb0d5ad626" title="Signal it to let waiters exit. " alt="" coords="1049,133,1227,175"/>
<area shape="rect" id="node11" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf" title="Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). " alt="" coords="1298,211,1471,252"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1soc.html#ad6b40c6c8e2db3fbf1bbdf6daa025275" title="foedus::soc::ugly_atomic_inc" alt="" coords="1289,141,1480,167"/>
<area shape="rect" id="node16" href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9" title="If this is a child instance, returns its SOC ID (NUMA node). " alt="" coords="561,101,696,143"/>
<area shape="rect" id="node18" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a55ba648cb98718804a890ea3b4965e39" title="foedus::memory::PagePool\lPimpl::get_stat" alt="" coords="794,5,973,47"/>
<area shape="rect" id="node19" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="1049,5,1227,47"/>
<area shape="rect" id="node24" href="classfoedus_1_1cache_1_1CacheHashtable.html#a8e9c6560b489d4709183256c6e6d332a" title="Evict some entries from the hashtable. " alt="" coords="525,599,732,640"/>
<area shape="rect" id="node25" href="classfoedus_1_1cache_1_1CacheHashtable.html#a090081806f98e5bb1184632b9fce6293" title="foedus::cache::CacheHashtable\l::evict_main_loop" alt="" coords="780,631,987,672"/>
<area shape="rect" id="node28" href="classfoedus_1_1cache_1_1CacheHashtable.html#abd3c185877f109817850f92eab7ff4b3" title="foedus::cache::CacheHashtable\l::get_physical_buckets" alt="" coords="1035,500,1241,541"/>
<area shape="rect" id="node34" href="classfoedus_1_1cache_1_1CacheHashtable.html#abcd23e94ab45dd35b1ae158a498e4344" title="foedus::cache::CacheHashtable\l::evict_overflow_loop" alt="" coords="780,729,987,771"/>
<area shape="rect" id="node26" href="structfoedus_1_1cache_1_1CacheHashtable_1_1EvictArgs.html#abf10e784be4a89750374654daa89d1d3" title="foedus::cache::CacheHashtable\l::EvictArgs::add_evicted" alt="" coords="1035,696,1241,737"/>
<area shape="rect" id="node27" href="structfoedus_1_1cache_1_1CacheRefCount.html#a13f4ce6af05ea4a063dbce09a4479439" title="returns whether the counter is still non&#45;zero " alt="" coords="1037,761,1239,803"/>
<area shape="rect" id="node29" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="1052,631,1224,672"/>
<area shape="rect" id="node30" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1299,631,1471,672"/>
<area shape="rect" id="node32" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="1317,859,1452,900"/>
<area shape="rect" id="node33" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="1304,924,1465,965"/>
<area shape="rect" id="node35" href="structfoedus_1_1cache_1_1CacheBucket.html#ab91d1b89c885979b7a6a4ef70b12b54d" title="foedus::cache::CacheBucket\l::get_content_id" alt="" coords="1043,827,1233,868"/>
<area shape="rect" id="node37" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="543,664,715,705"/>
<area shape="rect" id="node40" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a13d785355359fd936c2b3863d296ba2c" title="foedus::memory::PagePool\lPimpl::release" alt="" coords="539,795,718,836"/>
<area shape="rect" id="node42" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#af5cb0928185cf79dda519313f05fe0ee" title="foedus::xct::XctManagerPimpl\l::wait_for_current_global_epoch" alt="" coords="527,355,731,396"/>
<area shape="rect" id="node43" href="classfoedus_1_1soc_1_1SharedPolling.html#a1b9f5c8b129c454887a77d3255956157" title="Wait for signal up to the given timeout. " alt="" coords="795,449,972,491"/>
<area shape="rect" id="node44" href="namespacefoedus_1_1soc.html#a875ded688a72b32f8f690f37750e609f" title="foedus::soc::get_now\l_microsec" alt="" coords="1065,435,1211,476"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_a5a0fd87ff73e0f43e5a901f1c4fa34e3_icgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_a5a0fd87ff73e0f43e5a901f1c4fa34e3_icgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_a5a0fd87ff73e0f43e5a901f1c4fa34e3_icgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_a5a0fd87ff73e0f43e5a901f1c4fa34e3_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af04416fadb8ec5160408982fa67a08c1" title="foedus::cache::CacheManager\lPimpl::initialize_once" alt="" coords="252,5,451,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1cache_1_1CacheManager.html#a9181ec7d7e0ee1faa942ba9eec6c1345" title="foedus::cache::CacheManager\l::initialize_once" alt="" coords="499,5,697,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0b5e7574ed3474be65757a9f1d2595fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::cache::CacheManagerPimpl::handle_cleaner_evict_pages </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>target_count</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evicts pages up to about target_count (maybe a bit more or less). </p>
<p>Results are written to reclaimed_pages_count_ and reclaimed_pages_. </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00190">190</a> of file <a class="el" href="cache__manager__pimpl_8cpp_source.html">cache_manager_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="cache__hashtable_8cpp_source.html#l00171">foedus::cache::CacheHashtable::evict()</a>, <a class="el" href="cache__hashtable_8hpp_source.html#l00290">foedus::cache::CacheHashtable::EvictArgs::evicted_count_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00093">hashtable_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00106">reclaimed_pages_</a>, and <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00112">reclaimed_pages_count_</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>.</p>
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                                                        {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a> == 0);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(target_count &gt; 0);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  CacheHashtable::EvictArgs args = { target_count, 0, <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">reclaimed_pages_</a> };</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad04d70867dbd39a5ae1c00e3e8d3b150">hashtable_</a>-&gt;<a class="code" href="classfoedus_1_1cache_1_1CacheHashtable.html#a8e9c6560b489d4709183256c6e6d332a">evict</a>(&amp;args);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a> = args.evicted_count_;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_af806f450ee89c5881ad1670f8f5a14f2"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">foedus::cache::CacheManagerPimpl::reclaimed_pages_</a></div><div class="ttdeci">memory::PagePoolOffset * reclaimed_pages_</div><div class="ttdoc">This buffers pages being reclaimed. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00106">cache_manager_pimpl.hpp:106</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad04d70867dbd39a5ae1c00e3e8d3b150"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad04d70867dbd39a5ae1c00e3e8d3b150">foedus::cache::CacheManagerPimpl::hashtable_</a></div><div class="ttdeci">CacheHashtable * hashtable_</div><div class="ttdoc">The cache hashtable (SnapshotPageId -> offset in pool) on top of the page pool. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00093">cache_manager_pimpl.hpp:93</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheHashtable_html_a8e9c6560b489d4709183256c6e6d332a"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheHashtable.html#a8e9c6560b489d4709183256c6e6d332a">foedus::cache::CacheHashtable::evict</a></div><div class="ttdeci">void evict(EvictArgs *args)</div><div class="ttdoc">Evict some entries from the hashtable. </div><div class="ttdef"><b>Definition:</b> <a href="cache__hashtable_8cpp_source.html#l00171">cache_hashtable.cpp:171</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a93843fcb689b82e4eb63c5b3cb51f2f6"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">foedus::cache::CacheManagerPimpl::reclaimed_pages_count_</a></div><div class="ttdeci">uint64_t reclaimed_pages_count_</div><div class="ttdoc">Number of pages buffered so far. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00112">cache_manager_pimpl.hpp:112</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_a0b5e7574ed3474be65757a9f1d2595fc_cgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_a0b5e7574ed3474be65757a9f1d2595fc_cgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_a0b5e7574ed3474be65757a9f1d2595fc_cgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_a0b5e7574ed3474be65757a9f1d2595fc_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1cache_1_1CacheHashtable.html#a8e9c6560b489d4709183256c6e6d332a" title="Evict some entries from the hashtable. " alt="" coords="279,251,485,292"/>
<area shape="rect" id="node3" href="classfoedus_1_1cache_1_1CacheHashtable.html#a090081806f98e5bb1184632b9fce6293" title="foedus::cache::CacheHashtable\l::evict_main_loop" alt="" coords="533,251,740,292"/>
<area shape="rect" id="node7" href="classfoedus_1_1cache_1_1CacheHashtable.html#abd3c185877f109817850f92eab7ff4b3" title="foedus::cache::CacheHashtable\l::get_physical_buckets" alt="" coords="788,397,995,439"/>
<area shape="rect" id="node13" href="classfoedus_1_1cache_1_1CacheHashtable.html#abcd23e94ab45dd35b1ae158a498e4344" title="foedus::cache::CacheHashtable\l::evict_overflow_loop" alt="" coords="533,153,740,195"/>
<area shape="rect" id="node4" href="structfoedus_1_1cache_1_1CacheHashtable_1_1EvictArgs.html#abf10e784be4a89750374654daa89d1d3" title="foedus::cache::CacheHashtable\l::EvictArgs::add_evicted" alt="" coords="788,267,995,308"/>
<area shape="rect" id="node5" href="structfoedus_1_1cache_1_1CacheRefCount.html#a13f4ce6af05ea4a063dbce09a4479439" title="returns whether the counter is still non&#45;zero " alt="" coords="791,71,992,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1debugging_1_1StopWatch.html#a7f1f05f4dd494dd57c3ecafb5d9131fb" title="foedus::debugging::\lStopWatch::elapsed_us" alt="" coords="811,136,972,177"/>
<area shape="rect" id="node8" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="805,332,977,373"/>
<area shape="rect" id="node10" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="824,201,959,243"/>
<area shape="rect" id="node9" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1043,332,1215,373"/>
<area shape="rect" id="node11" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="1061,235,1196,276"/>
<area shape="rect" id="node12" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="1048,169,1209,211"/>
<area shape="rect" id="node14" href="structfoedus_1_1cache_1_1CacheBucket.html#ab91d1b89c885979b7a6a4ef70b12b54d" title="foedus::cache::CacheBucket\l::get_content_id" alt="" coords="797,5,986,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_a0b5e7574ed3474be65757a9f1d2595fc_icgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_a0b5e7574ed3474be65757a9f1d2595fc_icgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_a0b5e7574ed3474be65757a9f1d2595fc_icgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_a0b5e7574ed3474be65757a9f1d2595fc_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a5a0fd87ff73e0f43e5a901f1c4fa34e3" title="Main routine of cleaner_. " alt="" coords="279,5,477,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af04416fadb8ec5160408982fa67a08c1" title="foedus::cache::CacheManager\lPimpl::initialize_once" alt="" coords="525,5,724,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1cache_1_1CacheManager.html#a9181ec7d7e0ee1faa942ba9eec6c1345" title="foedus::cache::CacheManager\l::initialize_once" alt="" coords="772,5,971,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af04416fadb8ec5160408982fa67a08c1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::cache::CacheManagerPimpl::initialize_once </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classfoedus_1_1DefaultInitializable.html#ab8ae37e5f20f312f8b945fc40d3e0250">foedus::DefaultInitializable</a>.</p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">47</a> of file <a class="el" href="cache__manager__pimpl_8cpp_source.html">cache_manager_pimpl.cpp</a>.</p>

<p>References <a class="el" href="aligned__memory_8cpp_source.html#l00113">foedus::memory::AlignedMemory::alloc()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="engine__options_8hpp_source.html#l00136">foedus::EngineOptions::cache_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00070">cleaner_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00073">cleaner_threshold_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00063">engine_</a>, <a class="el" href="error__stack_8hpp_source.html#l00480">ERROR_STACK</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00168">foedus::memory::AlignedMemory::get_block()</a>, <a class="el" href="engine__memory_8hpp_source.html#l00073">foedus::memory::EngineMemory::get_local_memory()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="numa__node__memory_8hpp_source.html#l00059">foedus::memory::NumaNodeMemory::get_snapshot_cache_table()</a>, <a class="el" href="numa__node__memory_8hpp_source.html#l00058">foedus::memory::NumaNodeMemory::get_snapshot_pool()</a>, <a class="el" href="engine_8cpp_source.html#l00073">foedus::Engine::get_soc_id()</a>, <a class="el" href="page__pool_8cpp_source.html#l00118">foedus::memory::PagePool::get_stat()</a>, <a class="el" href="thread__options_8hpp_source.html#l00062">foedus::thread::ThreadOptions::get_total_thread_count()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00093">hashtable_</a>, <a class="el" href="initializable_8hpp_source.html#l00196">foedus::DefaultInitializable::is_initialized()</a>, <a class="el" href="engine_8cpp_source.html#l00068">foedus::Engine::is_master()</a>, <a class="el" href="error__code_8hpp_source.html#l00109">foedus::kErrorCodeDepedentModuleUnavailableInit</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00083">foedus::memory::AlignedMemory::kNumaAllocOnnode</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="engine__options_8hpp_source.html#l00139">foedus::EngineOptions::memory_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00085">pool_</a>, <a class="el" href="memory__options_8hpp_source.html#l00131">foedus::memory::MemoryOptions::private_page_pool_initial_grab_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00106">reclaimed_pages_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00112">reclaimed_pages_count_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00109">reclaimed_pages_memory_</a>, <a class="el" href="cache__options_8hpp_source.html#l00083">foedus::cache::CacheOptions::snapshot_cache_eviction_threshold_</a>, <a class="el" href="cache__options_8hpp_source.html#l00096">foedus::cache::CacheOptions::snapshot_cache_urgent_threshold_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00077">stop_requested_</a>, <a class="el" href="engine__options_8hpp_source.html#l00146">foedus::EngineOptions::thread_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00071">total_pages_</a>, <a class="el" href="page__pool_8hpp_source.html#l00176">foedus::memory::PagePool::Stat::total_pages_</a>, and <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00075">urgent_threshold_</a>.</p>

<p>Referenced by <a class="el" href="cache__manager_8cpp_source.html#l00035">foedus::cache::CacheManager::initialize_once()</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                              {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a5a390a597023f4b5c8cbcdcdd95e17ee">is_master</a>()) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// nothing to do in master engine</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e">is_initialized</a>()) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#gaa598b0ca7f0de626ecfa17f2cd58d5b4">ERROR_STACK</a>(<a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a154d6f9c4bf17ea4f3909286f00e2d7d">kErrorCodeDepedentModuleUnavailableInit</a>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Initializing Snapshot Cache in Node-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9">get_soc_id</a>() &lt;&lt; <span class="stringliteral">&quot;...&quot;</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  memory::NumaNodeMemory* node = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a0c5065125240df0f59f2cd04ff5f8808">get_local_memory</a>();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">pool_</a> = node-&gt;get_snapshot_pool();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad04d70867dbd39a5ae1c00e3e8d3b150">hashtable_</a> = node-&gt;get_snapshot_cache_table();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a> = 0;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">// So far, the reclaimed_pages_memory_ is large enough to hold all pages in the pool at once.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// This is obviously too much for most cases, but wouldn&#39;t be an issue as the memory consumption</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// is anyway negligibly smaller than the page pool itself. Keep it simple stupid.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a> = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">pool_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#aae17b661b01fd08a3019128c82227e7c">get_stat</a>().<a class="code" href="group__MEMORY.html#a4efb79683e7ec8fa293219c8d5d9674a">total_pages_</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keyword">const</span> CacheOptions&amp; options = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a6e51937e58975e50d0f3eea198b24d3e">cache_</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">cleaner_threshold_</a> = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a> * options.snapshot_cache_eviction_threshold_;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">urgent_threshold_</a> = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a> * options.snapshot_cache_urgent_threshold_;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// exclude page counts initially grabbed by each thread.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  uint64_t initial_allocations</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a0fba742942a9ff0de143e354fea34d4b">memory_</a>.<a class="code" href="structfoedus_1_1memory_1_1MemoryOptions.html#aece3277ecf8d3908dfb25fab83bd057b">private_page_pool_initial_grab_</a></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    * <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a97a206187b610b15a6edbfc75a384b1a">thread_</a>.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#a74b2658ba7a1f73f87a66a2a21fe0c41">get_total_thread_count</a>();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">cleaner_threshold_</a> += initial_allocations;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">urgent_threshold_</a> += initial_allocations;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">cleaner_threshold_</a> &gt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a>) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">cleaner_threshold_</a> = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">urgent_threshold_</a> &gt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a>) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">urgent_threshold_</a> = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">cleaner_threshold_</a> &gt; 0);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">urgent_threshold_</a> &gt;= <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">cleaner_threshold_</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a> &gt;= <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">urgent_threshold_</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#aa7e849ef002da81240c4cb13c0d0083e">reclaimed_pages_memory_</a>.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">total_pages_</a> * <span class="keyword">sizeof</span>(<a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a>),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    1ULL &lt;&lt; 21,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9">get_soc_id</a>());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">reclaimed_pages_</a> = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a>*<span class="keyword">&gt;</span>(<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#aa7e849ef002da81240c4cb13c0d0083e">reclaimed_pages_memory_</a>.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1">get_block</a>());</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// launch the cleaner thread</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">stop_requested_</a>.store(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a6d0888a1d0fd682cb1e42830b091044d">cleaner_</a> = std::move(std::thread(&amp;<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a5a0fd87ff73e0f43e5a901f1c4fa34e3">CacheManagerPimpl::handle_cleaner</a>, <span class="keyword">this</span>));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad30307affc38a5fa2b46f1cc3316053a"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad30307affc38a5fa2b46f1cc3316053a">foedus::cache::CacheManagerPimpl::total_pages_</a></div><div class="ttdeci">uint64_t total_pages_</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00071">cache_manager_pimpl.hpp:71</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">foedus::memory::AlignedMemory::kNumaAllocOnnode</a></div><div class="ttdoc">numa_alloc_onnode() and numa_free(). </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00083">aligned_memory.hpp:83</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_af806f450ee89c5881ad1670f8f5a14f2"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">foedus::cache::CacheManagerPimpl::reclaimed_pages_</a></div><div class="ttdeci">memory::PagePoolOffset * reclaimed_pages_</div><div class="ttdoc">This buffers pages being reclaimed. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00106">cache_manager_pimpl.hpp:106</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa598b0ca7f0de626ecfa17f2cd58d5b4"><div class="ttname"><a href="group__ERRORCODES.html#gaa598b0ca7f0de626ecfa17f2cd58d5b4">ERROR_STACK</a></div><div class="ttdeci">#define ERROR_STACK(e)        </div><div class="ttdoc">Instantiates ErrorStack with the given foedus::error_code, creating an error stack with the current f...</div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00480">error_stack.hpp:480</a></div></div>
<div class="ttc" id="structfoedus_1_1memory_1_1MemoryOptions_html_aece3277ecf8d3908dfb25fab83bd057b"><div class="ttname"><a href="structfoedus_1_1memory_1_1MemoryOptions.html#aece3277ecf8d3908dfb25fab83bd057b">foedus::memory::MemoryOptions::private_page_pool_initial_grab_</a></div><div class="ttdeci">uint32_t private_page_pool_initial_grab_</div><div class="ttdoc">How many pages each NumaCoreMemory initially grabs when it is initialized. </div><div class="ttdef"><b>Definition:</b> <a href="memory__options_8hpp_source.html#l00131">memory_options.hpp:131</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad04d70867dbd39a5ae1c00e3e8d3b150"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad04d70867dbd39a5ae1c00e3e8d3b150">foedus::cache::CacheManagerPimpl::hashtable_</a></div><div class="ttdeci">CacheHashtable * hashtable_</div><div class="ttdoc">The cache hashtable (SnapshotPageId -> offset in pool) on top of the page pool. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00093">cache_manager_pimpl.hpp:93</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePool_html_aae17b661b01fd08a3019128c82227e7c"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePool.html#aae17b661b01fd08a3019128c82227e7c">foedus::memory::PagePool::get_stat</a></div><div class="ttdeci">Stat get_stat() const </div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8cpp_source.html#l00118">page_pool.cpp:118</a></div></div>
<div class="ttc" id="group__MEMORY_html_gaf7ed7c23d184b14ce978b1775a86dfae"><div class="ttname"><a href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">foedus::memory::PagePoolOffset</a></div><div class="ttdeci">uint32_t PagePoolOffset</div><div class="ttdoc">Offset in PagePool that compactly represents the page address (unlike 8 bytes pointer). </div><div class="ttdef"><b>Definition:</b> <a href="memory__id_8hpp_source.html#l00044">memory_id.hpp:44</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a154d6f9c4bf17ea4f3909286f00e2d7d"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a154d6f9c4bf17ea4f3909286f00e2d7d">foedus::kErrorCodeDepedentModuleUnavailableInit</a></div><div class="ttdoc">0x0005 : "GENERAL: A dependent module is not initialized yet. This implies a wrong initialization ord...</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00109">error_code.hpp:109</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a5166bae2fdad9ffa0d5c279edfd3307e"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">foedus::memory::AlignedMemory::alloc</a></div><div class="ttdeci">void alloc(uint64_t size, uint64_t alignment, AllocType alloc_type, int numa_node) noexcept</div><div class="ttdoc">Allocate a memory, releasing the current memory if exists. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8cpp_source.html#l00113">aligned_memory.cpp:113</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a9b94264bea60c98e93556f7458d02385"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">foedus::cache::CacheManagerPimpl::stop_requested_</a></div><div class="ttdeci">std::atomic&lt; bool &gt; stop_requested_</div><div class="ttdoc">to stop cleaner_ </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00077">cache_manager_pimpl.hpp:77</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a1cfa4137e2243f7e8bb43a1b11441bf6"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1cfa4137e2243f7e8bb43a1b11441bf6">foedus::cache::CacheManagerPimpl::urgent_threshold_</a></div><div class="ttdeci">uint64_t urgent_threshold_</div><div class="ttdoc">the number of allocated pages above which cleaner advances epoch to release pages ...</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00075">cache_manager_pimpl.hpp:75</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad60dcb46431ef158283b2923c03ed930"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">foedus::cache::CacheManagerPimpl::pool_</a></div><div class="ttdeci">memory::PagePool * pool_</div><div class="ttdoc">The SOC-local snapshot page pool in this SOC engine. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00085">cache_manager_pimpl.hpp:85</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a5a390a597023f4b5c8cbcdcdd95e17ee"><div class="ttname"><a href="classfoedus_1_1Engine.html#a5a390a597023f4b5c8cbcdcdd95e17ee">foedus::Engine::is_master</a></div><div class="ttdeci">bool is_master() const </div><div class="ttdoc">Returns if this engine object is a master instance. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00068">engine.cpp:68</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_aa7e849ef002da81240c4cb13c0d0083e"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#aa7e849ef002da81240c4cb13c0d0083e">foedus::cache::CacheManagerPimpl::reclaimed_pages_memory_</a></div><div class="ttdeci">memory::AlignedMemory reclaimed_pages_memory_</div><div class="ttdoc">The memory backing reclaimed_pages_. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00109">cache_manager_pimpl.hpp:109</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_a0fba742942a9ff0de143e354fea34d4b"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#a0fba742942a9ff0de143e354fea34d4b">foedus::EngineOptions::memory_</a></div><div class="ttdeci">memory::MemoryOptions memory_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00139">engine_options.hpp:139</a></div></div>
<div class="ttc" id="group__MEMORY_html_a4efb79683e7ec8fa293219c8d5d9674a"><div class="ttname"><a href="group__MEMORY.html#a4efb79683e7ec8fa293219c8d5d9674a">foedus::memory::PagePool::Stat::total_pages_</a></div><div class="ttdeci">uint64_t total_pages_</div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8hpp_source.html#l00176">page_pool.hpp:176</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a6d0888a1d0fd682cb1e42830b091044d"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a6d0888a1d0fd682cb1e42830b091044d">foedus::cache::CacheManagerPimpl::cleaner_</a></div><div class="ttdeci">std::thread cleaner_</div><div class="ttdoc">The only cleaner thread in this SOC engine. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00070">cache_manager_pimpl.hpp:70</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_af306ba60622e2a87f75ae93dc6c597b1"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1">foedus::memory::AlignedMemory::get_block</a></div><div class="ttdeci">void * get_block() const </div><div class="ttdoc">Returns the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00168">aligned_memory.hpp:168</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_a97a206187b610b15a6edbfc75a384b1a"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#a97a206187b610b15a6edbfc75a384b1a">foedus::EngineOptions::thread_</a></div><div class="ttdeci">thread::ThreadOptions thread_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00146">engine_options.hpp:146</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a0c5065125240df0f59f2cd04ff5f8808"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a0c5065125240df0f59f2cd04ff5f8808">foedus::memory::EngineMemory::get_local_memory</a></div><div class="ttdeci">NumaNodeMemory * get_local_memory() const </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00073">engine_memory.hpp:73</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a93843fcb689b82e4eb63c5b3cb51f2f6"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">foedus::cache::CacheManagerPimpl::reclaimed_pages_count_</a></div><div class="ttdeci">uint64_t reclaimed_pages_count_</div><div class="ttdoc">Number of pages buffered so far. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00112">cache_manager_pimpl.hpp:112</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a5a0fd87ff73e0f43e5a901f1c4fa34e3"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a5a0fd87ff73e0f43e5a901f1c4fa34e3">foedus::cache::CacheManagerPimpl::handle_cleaner</a></div><div class="ttdeci">void handle_cleaner()</div><div class="ttdoc">Main routine of cleaner_. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8cpp_source.html#l00119">cache_manager_pimpl.cpp:119</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a11b8ef3c07c8871cb34620976a39370c"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">foedus::cache::CacheManagerPimpl::engine_</a></div><div class="ttdeci">Engine *const engine_</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00063">cache_manager_pimpl.hpp:63</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a3fc02bb6dc7405008fd2cf706ca6a47c"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a3fc02bb6dc7405008fd2cf706ca6a47c">foedus::cache::CacheManagerPimpl::cleaner_threshold_</a></div><div class="ttdeci">uint64_t cleaner_threshold_</div><div class="ttdoc">the number of allocated pages above which cleaner starts cleaning </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00073">cache_manager_pimpl.hpp:73</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadOptions_html_a74b2658ba7a1f73f87a66a2a21fe0c41"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadOptions.html#a74b2658ba7a1f73f87a66a2a21fe0c41">foedus::thread::ThreadOptions::get_total_thread_count</a></div><div class="ttdeci">ThreadId get_total_thread_count() const </div><div class="ttdef"><b>Definition:</b> <a href="thread__options_8hpp_source.html#l00062">thread_options.hpp:62</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a8d9a31e48aec9b73e16b64170c0250f9"><div class="ttname"><a href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9">foedus::Engine::get_soc_id</a></div><div class="ttdeci">soc::SocId get_soc_id() const </div><div class="ttdoc">If this is a child instance, returns its SOC ID (NUMA node). </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00073">engine.cpp:73</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
<div class="ttc" id="classfoedus_1_1DefaultInitializable_html_a1abda1e84b8af8bd6916e52fd0a09f3e"><div class="ttname"><a href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e">foedus::DefaultInitializable::is_initialized</a></div><div class="ttdeci">bool is_initialized() const  override final</div><div class="ttdoc">Returns whether the object has been already initialized or not. </div><div class="ttdef"><b>Definition:</b> <a href="initializable_8hpp_source.html#l00196">initializable.hpp:196</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_a6e51937e58975e50d0f3eea198b24d3e"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#a6e51937e58975e50d0f3eea198b24d3e">foedus::EngineOptions::cache_</a></div><div class="ttdeci">cache::CacheOptions cache_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00136">engine_options.hpp:136</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_af04416fadb8ec5160408982fa67a08c1_cgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_af04416fadb8ec5160408982fa67a08c1_cgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_af04416fadb8ec5160408982fa67a08c1_cgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_af04416fadb8ec5160408982fa67a08c1_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e" title="Allocate a memory, releasing the current memory if exists. " alt="" coords="1060,230,1273,272"/>
<area shape="rect" id="node15" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="261,1140,475,1181"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1EngineMemory.html#a0c5065125240df0f59f2cd04ff5f8808" title="foedus::memory::EngineMemory\l::get_local_memory" alt="" coords="263,1205,473,1246"/>
<area shape="rect" id="node17" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="301,1270,435,1312"/>
<area shape="rect" id="node18" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="301,1336,435,1377"/>
<area shape="rect" id="node19" href="classfoedus_1_1memory_1_1NumaNodeMemory.html#ad8fddde9484a0ceb8d31cd8eca323c77" title="foedus::memory::NumaNode\lMemory::get_snapshot_cache_table" alt="" coords="252,1401,484,1442"/>
<area shape="rect" id="node20" href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a0541f9ed9fc128fc2c246a4a3bd2b740" title="foedus::memory::NumaNode\lMemory::get_snapshot_pool" alt="" coords="275,1466,461,1508"/>
<area shape="rect" id="node21" href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9" title="If this is a child instance, returns its SOC ID (NUMA node). " alt="" coords="841,888,976,929"/>
<area shape="rect" id="node22" href="classfoedus_1_1memory_1_1PagePool.html#aae17b661b01fd08a3019128c82227e7c" title="foedus::memory::PagePool\l::get_stat" alt="" coords="819,1129,998,1170"/>
<area shape="rect" id="node25" href="structfoedus_1_1thread_1_1ThreadOptions.html#a74b2658ba7a1f73f87a66a2a21fe0c41" title="foedus::thread::ThreadOptions\l::get_total_thread_count" alt="" coords="270,1532,466,1573"/>
<area shape="rect" id="node26" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a5a0fd87ff73e0f43e5a901f1c4fa34e3" title="Main routine of cleaner_. " alt="" coords="269,734,467,776"/>
<area shape="rect" id="node44" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="823,314,995,356"/>
<area shape="rect" id="node50" href="classfoedus_1_1Engine.html#a5a390a597023f4b5c8cbcdcdd95e17ee" title="Returns if this engine object is a master instance. " alt="" coords="305,1597,431,1638"/>
<area shape="rect" id="node3" href="numa_8h.html#a413cadd87796fff247c83d9ad817cc7e" title="numa_available" alt="" coords="1589,182,1700,208"/>
<area shape="rect" id="node4" href="numa_8h.html#aba49c14c68d23dc05d046db02766b928" title="numa_preferred" alt="" coords="1355,299,1466,326"/>
<area shape="rect" id="node5" href="numa_8h.html#a56f33968932f6550e5e5eb4d1acc67b3" title="numa_set_preferred" alt="" coords="1343,350,1479,376"/>
<area shape="rect" id="node6" href="group__ASSORTED.html#gab3d1892edaa7db4b02029567b7993f37" title="In order to run even on a non&#45;numa machine or a machine with fewer sockets, we allow specifying arbit..." alt="" coords="1335,233,1486,274"/>
<area shape="rect" id="node8" href="namespacefoedus_1_1memory.html#ac2422aa4fe378da8a9594901762e17df" title="foedus::memory::alloc_mmap" alt="" coords="1548,72,1741,99"/>
<area shape="rect" id="node10" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1802,6,1942,48"/>
<area shape="rect" id="node11" href="namespacefoedus_1_1memory.html#ae51e4a90f52316ba9dce8ff783f30d84" title="foedus::memory::alloc\l_mmap_1gb_pages" alt="" coords="1335,116,1486,157"/>
<area shape="rect" id="node12" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="1343,456,1478,497"/>
<area shape="rect" id="node14" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="1564,393,1725,434"/>
<area shape="rect" id="node7" href="numa_8h.html#a22585176d6e08c221de8377637bd72a7" title="numa_num_configured\l_nodes" alt="" coords="1569,233,1721,274"/>
<area shape="rect" id="node9" href="namespacefoedus_1_1memory.html#af6145d9296231995c84badafb6a2a0a9" title="Returns if 1GB hugepages were enabled. " alt="" coords="1789,72,1955,113"/>
<area shape="rect" id="node13" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="1577,458,1712,500"/>
<area shape="rect" id="node23" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a55ba648cb98718804a890ea3b4965e39" title="foedus::memory::PagePool\lPimpl::get_stat" alt="" coords="1077,1136,1256,1177"/>
<area shape="rect" id="node24" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="1321,1136,1500,1177"/>
<area shape="rect" id="node27" href="classfoedus_1_1xct_1_1XctManager.html#aa75089821b48c98a00cd7e4ddc0615da" title="Requests to advance the current global epoch as soon as possible and blocks until it actually does..." alt="" coords="541,1005,748,1046"/>
<area shape="rect" id="node30" href="classfoedus_1_1Epoch.html#a786afd92afdc87b54dfa11ef093f06f3" title="foedus::Epoch::one_more" alt="" coords="1081,1084,1252,1111"/>
<area shape="rect" id="node35" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369" title="foedus::cache::CacheManager\lPimpl::describe" alt="" coords="545,888,744,929"/>
<area shape="rect" id="node36" href="classfoedus_1_1debugging_1_1StopWatch.html#a7f1f05f4dd494dd57c3ecafb5d9131fb" title="foedus::debugging::\lStopWatch::elapsed_us" alt="" coords="1330,522,1491,564"/>
<area shape="rect" id="node37" href="classfoedus_1_1xct_1_1XctManager.html#a419a270d62522ede9bd871dd4adc0e2a" title="Returns the current global epoch, the epoch a newly started transaction will be in. " alt="" coords="819,757,998,798"/>
<area shape="rect" id="node38" href="classfoedus_1_1Engine.html#a48d5e1f7ce2f70161c253f650c75ed95" title="See Transaction Manager. " alt="" coords="577,457,712,498"/>
<area shape="rect" id="node39" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a0b5e7574ed3474be65757a9f1d2595fc" title="Evicts pages up to about target_count (maybe a bit more or less). " alt="" coords="532,522,757,564"/>
<area shape="rect" id="node43" href="classfoedus_1_1xct_1_1XctManager.html#a8c2222c8c5db52f4f1175b1250bf1a4a" title="Returns whether the object has been already initialized or not. " alt="" coords="563,340,726,381"/>
<area shape="rect" id="node45" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="558,705,731,746"/>
<area shape="rect" id="node46" href="classfoedus_1_1memory_1_1PagePool.html#a802171ff0578875748d20b4e9c8c9463" title="Returns the specified number of free pages from the chunk. " alt="" coords="555,640,734,681"/>
<area shape="rect" id="node48" href="classfoedus_1_1xct_1_1XctManager.html#aa3178a6ce1c815fb88b6c8d5607da5d4" title="Passively wait until the current global epoch becomes the given value. " alt="" coords="543,822,747,864"/>
<area shape="rect" id="node28" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a925da0bb4b846daa21eb947e4f67b0c6" title="foedus::xct::XctManagerPimpl\l::advance_current_global_epoch" alt="" coords="805,953,1012,994"/>
<area shape="rect" id="node29" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a787bb892079cb32d5a2065188825a522" title="foedus::xct::XctManagerPimpl\l::get_current_global_epoch" alt="" coords="1069,757,1264,798"/>
<area shape="rect" id="node31" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a03678427b184e7ce71f9bbb164dd0bad" title="foedus::xct::XctManagerPimpl\l::set_requested_global_epoch" alt="" coords="1069,953,1264,994"/>
<area shape="rect" id="node32" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#afce787897428bd372c67224acd3e8ea7" title="foedus::xct::XctManagerPimpl\l::wakeup_epoch_chime_thread" alt="" coords="1066,1018,1267,1060"/>
<area shape="rect" id="node33" href="classfoedus_1_1soc_1_1SharedPolling.html#ac6ad7822e42e2e942b55708b1da8516b" title="Gives the ticket to. " alt="" coords="1078,822,1255,864"/>
<area shape="rect" id="node34" href="classfoedus_1_1soc_1_1SharedPolling.html#a9fc7bfaf57e1f2224be9869a8e9708d3" title="Unconditionally wait for signal. " alt="" coords="1078,888,1255,929"/>
<area shape="rect" id="node40" href="classfoedus_1_1cache_1_1CacheHashtable.html#a8e9c6560b489d4709183256c6e6d332a" title="Evict some entries from the hashtable. " alt="" coords="805,522,1012,564"/>
<area shape="rect" id="node41" href="classfoedus_1_1cache_1_1CacheHashtable.html#a090081806f98e5bb1184632b9fce6293" title="foedus::cache::CacheHashtable\l::evict_main_loop" alt="" coords="1063,522,1270,564"/>
<area shape="rect" id="node42" href="classfoedus_1_1cache_1_1CacheHashtable.html#abcd23e94ab45dd35b1ae158a498e4344" title="foedus::cache::CacheHashtable\l::evict_overflow_loop" alt="" coords="1063,457,1270,498"/>
<area shape="rect" id="node47" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a13d785355359fd936c2b3863d296ba2c" title="foedus::memory::PagePool\lPimpl::release" alt="" coords="819,640,998,681"/>
<area shape="rect" id="node49" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#af5cb0928185cf79dda519313f05fe0ee" title="foedus::xct::XctManagerPimpl\l::wait_for_current_global_epoch" alt="" coords="807,822,1011,864"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_af04416fadb8ec5160408982fa67a08c1_icgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_af04416fadb8ec5160408982fa67a08c1_icgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_af04416fadb8ec5160408982fa67a08c1_icgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_af04416fadb8ec5160408982fa67a08c1_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1cache_1_1CacheManager.html#a9181ec7d7e0ee1faa942ba9eec6c1345" title="foedus::cache::CacheManager\l::initialize_once" alt="" coords="252,5,451,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a913ee4a71391ff0261b6725ca658925a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::cache::CacheManagerPimpl::stop_cleaner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00198">198</a> of file <a class="el" href="cache__manager__pimpl_8cpp_source.html">cache_manager_pimpl.cpp</a>.</p>

<p>References <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00070">cleaner_</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, and <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00077">stop_requested_</a>.</p>

<p>Referenced by <a class="el" href="cache__manager_8cpp_source.html#l00038">foedus::cache::CacheManager::stop_cleaner()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00102">uninitialize_once()</a>.</p>
<div class="fragment"><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                           {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordtype">bool</span> original = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordtype">bool</span> changed = <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">stop_requested_</a>.compare_exchange_strong(original, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">if</span> (changed) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a6d0888a1d0fd682cb1e42830b091044d">cleaner_</a>.joinable()) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Requesting Cache Cleaner to stop...&quot;</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a6d0888a1d0fd682cb1e42830b091044d">cleaner_</a>.join();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Cache Cleaner seems already stop-requested&quot;</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a9b94264bea60c98e93556f7458d02385"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a9b94264bea60c98e93556f7458d02385">foedus::cache::CacheManagerPimpl::stop_requested_</a></div><div class="ttdeci">std::atomic&lt; bool &gt; stop_requested_</div><div class="ttdoc">to stop cleaner_ </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00077">cache_manager_pimpl.hpp:77</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a6d0888a1d0fd682cb1e42830b091044d"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a6d0888a1d0fd682cb1e42830b091044d">foedus::cache::CacheManagerPimpl::cleaner_</a></div><div class="ttdeci">std::thread cleaner_</div><div class="ttdoc">The only cleaner thread in this SOC engine. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00070">cache_manager_pimpl.hpp:70</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_a913ee4a71391ff0261b6725ca658925a_icgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_a913ee4a71391ff0261b6725ca658925a_icgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_a913ee4a71391ff0261b6725ca658925a_icgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_a913ee4a71391ff0261b6725ca658925a_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1cache_1_1CacheManager.html#ad3fb77fc199a9556115435bbf7557edc" title="Stops internal eviction thread even before uninitialize() of this object is called. " alt="" coords="252,5,451,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a1322d8be16a7fe558bd83de18eb41c85" title="foedus::cache::CacheManager\lPimpl::uninitialize_once" alt="" coords="252,71,451,112"/>
<area shape="rect" id="node3" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a8fb6cedfd224c44cac4224877c688672" title="foedus::xct::XctManagerPimpl\l::uninitialize_once" alt="" coords="501,5,695,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1cache_1_1CacheManager.html#ab7dbe48b7c06d1bcefcf787bce285c25" title="foedus::cache::CacheManager\l::uninitialize_once" alt="" coords="499,71,697,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1322d8be16a7fe558bd83de18eb41c85"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::cache::CacheManagerPimpl::uninitialize_once </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b">foedus::DefaultInitializable</a>.</p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00102">102</a> of file <a class="el" href="cache__manager__pimpl_8cpp_source.html">cache_manager_pimpl.cpp</a>.</p>

<p>References <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00213">describe()</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00063">engine_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00093">hashtable_</a>, <a class="el" href="engine_8cpp_source.html#l00068">foedus::Engine::is_master()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00085">pool_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00106">reclaimed_pages_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00112">reclaimed_pages_count_</a>, <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00109">reclaimed_pages_memory_</a>, <a class="el" href="aligned__memory_8cpp_source.html#l00235">foedus::memory::AlignedMemory::release_block()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00198">stop_cleaner()</a>.</p>

<p>Referenced by <a class="el" href="cache__manager_8cpp_source.html#l00036">foedus::cache::CacheManager::uninitialize_once()</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                                {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a5a390a597023f4b5c8cbcdcdd95e17ee">is_master</a>()) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// nothing to do in master engine</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Uninitializing Snapshot Cache... &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">describe</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a913ee4a71391ff0261b6725ca658925a">stop_cleaner</a>());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">pool_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad04d70867dbd39a5ae1c00e3e8d3b150">hashtable_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">reclaimed_pages_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#aa7e849ef002da81240c4cb13c0d0083e">reclaimed_pages_memory_</a>.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">release_block</a>();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">reclaimed_pages_count_</a> = 0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_af806f450ee89c5881ad1670f8f5a14f2"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#af806f450ee89c5881ad1670f8f5a14f2">foedus::cache::CacheManagerPimpl::reclaimed_pages_</a></div><div class="ttdeci">memory::PagePoolOffset * reclaimed_pages_</div><div class="ttdoc">This buffers pages being reclaimed. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00106">cache_manager_pimpl.hpp:106</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_afd955f5f991e28943c72ecff1167c16b"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">foedus::memory::AlignedMemory::release_block</a></div><div class="ttdeci">void release_block()</div><div class="ttdoc">Releases the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8cpp_source.html#l00235">aligned_memory.cpp:235</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad04d70867dbd39a5ae1c00e3e8d3b150"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad04d70867dbd39a5ae1c00e3e8d3b150">foedus::cache::CacheManagerPimpl::hashtable_</a></div><div class="ttdeci">CacheHashtable * hashtable_</div><div class="ttdoc">The cache hashtable (SnapshotPageId -> offset in pool) on top of the page pool. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00093">cache_manager_pimpl.hpp:93</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a913ee4a71391ff0261b6725ca658925a"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a913ee4a71391ff0261b6725ca658925a">foedus::cache::CacheManagerPimpl::stop_cleaner</a></div><div class="ttdeci">ErrorStack stop_cleaner()</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8cpp_source.html#l00198">cache_manager_pimpl.cpp:198</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a2876d026b658af099cdf153ed1529369"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369">foedus::cache::CacheManagerPimpl::describe</a></div><div class="ttdeci">std::string describe() const </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8cpp_source.html#l00213">cache_manager_pimpl.cpp:213</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_ad60dcb46431ef158283b2923c03ed930"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#ad60dcb46431ef158283b2923c03ed930">foedus::cache::CacheManagerPimpl::pool_</a></div><div class="ttdeci">memory::PagePool * pool_</div><div class="ttdoc">The SOC-local snapshot page pool in this SOC engine. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00085">cache_manager_pimpl.hpp:85</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a5a390a597023f4b5c8cbcdcdd95e17ee"><div class="ttname"><a href="classfoedus_1_1Engine.html#a5a390a597023f4b5c8cbcdcdd95e17ee">foedus::Engine::is_master</a></div><div class="ttdeci">bool is_master() const </div><div class="ttdoc">Returns if this engine object is a master instance. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00068">engine.cpp:68</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_aa7e849ef002da81240c4cb13c0d0083e"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#aa7e849ef002da81240c4cb13c0d0083e">foedus::cache::CacheManagerPimpl::reclaimed_pages_memory_</a></div><div class="ttdeci">memory::AlignedMemory reclaimed_pages_memory_</div><div class="ttdoc">The memory backing reclaimed_pages_. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00109">cache_manager_pimpl.hpp:109</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a93843fcb689b82e4eb63c5b3cb51f2f6"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a93843fcb689b82e4eb63c5b3cb51f2f6">foedus::cache::CacheManagerPimpl::reclaimed_pages_count_</a></div><div class="ttdeci">uint64_t reclaimed_pages_count_</div><div class="ttdoc">Number of pages buffered so far. </div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00112">cache_manager_pimpl.hpp:112</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheManagerPimpl_html_a11b8ef3c07c8871cb34620976a39370c"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a11b8ef3c07c8871cb34620976a39370c">foedus::cache::CacheManagerPimpl::engine_</a></div><div class="ttdeci">Engine *const engine_</div><div class="ttdef"><b>Definition:</b> <a href="cache__manager__pimpl_8hpp_source.html#l00063">cache_manager_pimpl.hpp:63</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_a1322d8be16a7fe558bd83de18eb41c85_cgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_a1322d8be16a7fe558bd83de18eb41c85_cgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_a1322d8be16a7fe558bd83de18eb41c85_cgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_a1322d8be16a7fe558bd83de18eb41c85_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a2876d026b658af099cdf153ed1529369" title="foedus::cache::CacheManager\lPimpl::describe" alt="" coords="259,37,458,79"/>
<area shape="rect" id="node7" href="classfoedus_1_1Engine.html#a5a390a597023f4b5c8cbcdcdd95e17ee" title="Returns if this engine object is a master instance. " alt="" coords="295,103,422,144"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b" title="Releases the memory block. " alt="" coords="252,168,465,209"/>
<area shape="rect" id="node9" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html#a913ee4a71391ff0261b6725ca658925a" title="foedus::cache::CacheManager\lPimpl::stop_cleaner" alt="" coords="259,233,458,275"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html#a8d9a31e48aec9b73e16b64170c0250f9" title="If this is a child instance, returns its SOC ID (NUMA node). " alt="" coords="535,5,670,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1PagePool.html#aae17b661b01fd08a3019128c82227e7c" title="foedus::memory::PagePool\l::get_stat" alt="" coords="513,71,692,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a55ba648cb98718804a890ea3b4965e39" title="foedus::memory::PagePool\lPimpl::get_stat" alt="" coords="740,71,919,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="967,71,1145,112"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1cache_1_1CacheManagerPimpl_a1322d8be16a7fe558bd83de18eb41c85_icgraph.png" border="0" usemap="#classfoedus_1_1cache_1_1CacheManagerPimpl_a1322d8be16a7fe558bd83de18eb41c85_icgraph" alt=""/></div>
<map name="classfoedus_1_1cache_1_1CacheManagerPimpl_a1322d8be16a7fe558bd83de18eb41c85_icgraph" id="classfoedus_1_1cache_1_1CacheManagerPimpl_a1322d8be16a7fe558bd83de18eb41c85_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1cache_1_1CacheManager.html#ab7dbe48b7c06d1bcefcf787bce285c25" title="foedus::cache::CacheManager\l::uninitialize_once" alt="" coords="252,5,451,47"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a6d0888a1d0fd682cb1e42830b091044d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::thread foedus::cache::CacheManagerPimpl::cleaner_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The only cleaner thread in this SOC engine. </p>
<p>In a master engine, this is not used. </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00070">70</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00198">stop_cleaner()</a>.</p>

</div>
</div>
<a class="anchor" id="a3fc02bb6dc7405008fd2cf706ca6a47c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::cache::CacheManagerPimpl::cleaner_threshold_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the number of allocated pages above which cleaner starts cleaning </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00073">73</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00213">describe()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>.</p>

</div>
</div>
<a class="anchor" id="a11b8ef3c07c8871cb34620976a39370c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1Engine.html">Engine</a>* const foedus::cache::CacheManagerPimpl::engine_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00063">63</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00213">describe()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00102">uninitialize_once()</a>.</p>

</div>
</div>
<a class="anchor" id="ad04d70867dbd39a5ae1c00e3e8d3b150"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1cache_1_1CacheHashtable.html">CacheHashtable</a>* foedus::cache::CacheManagerPimpl::hashtable_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The cache hashtable (SnapshotPageId -&gt; offset in pool) on top of the page pool. </p>
<p>This cache manager keeps checking In a master engine, this is null. </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00093">93</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00190">handle_cleaner_evict_pages()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00102">uninitialize_once()</a>.</p>

</div>
</div>
<a class="anchor" id="ad60dcb46431ef158283b2923c03ed930"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1memory_1_1PagePool.html">memory::PagePool</a>* foedus::cache::CacheManagerPimpl::pool_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The SOC-local snapshot page pool in this SOC engine. </p>
<p>This passively (no thread by itself) holds used pages and free pages. In a master engine, this is null. </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00085">85</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00213">describe()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00102">uninitialize_once()</a>.</p>

</div>
</div>
<a class="anchor" id="af806f450ee89c5881ad1670f8f5a14f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a>* foedus::cache::CacheManagerPimpl::reclaimed_pages_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This buffers pages being reclaimed. </p>
<p>We reclaim pages after a grace period, rather than immediately after collecting them from the hashtable. Because of this epoch-based <em>grace-period</em>, we don't have to worry about thread-safety. This is super benefitial for simplicity and scalability. Because snapshot pages are immutable, that's all we have to do. Whereas, traditional bufferpools have to take care of dirty pages and singularity of page, so they can't just do grace-period. So far, the grace period is one epoch. </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00106">106</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00190">handle_cleaner_evict_pages()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00102">uninitialize_once()</a>.</p>

</div>
</div>
<a class="anchor" id="a93843fcb689b82e4eb63c5b3cb51f2f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::cache::CacheManagerPimpl::reclaimed_pages_count_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of pages buffered so far. </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00112">112</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00213">describe()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00190">handle_cleaner_evict_pages()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00102">uninitialize_once()</a>.</p>

</div>
</div>
<a class="anchor" id="aa7e849ef002da81240c4cb13c0d0083e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> foedus::cache::CacheManagerPimpl::reclaimed_pages_memory_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The memory backing reclaimed_pages_. </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00109">109</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00213">describe()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00102">uninitialize_once()</a>.</p>

</div>
</div>
<a class="anchor" id="a9b94264bea60c98e93556f7458d02385"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;bool&gt; foedus::cache::CacheManagerPimpl::stop_requested_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>to stop cleaner_ </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00077">77</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00198">stop_cleaner()</a>.</p>

</div>
</div>
<a class="anchor" id="ad30307affc38a5fa2b46f1cc3316053a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::cache::CacheManagerPimpl::total_pages_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00071">71</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>.</p>

</div>
</div>
<a class="anchor" id="a1cfa4137e2243f7e8bb43a1b11441bf6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::cache::CacheManagerPimpl::urgent_threshold_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the number of allocated pages above which cleaner advances epoch to release pages </p>

<p>Definition at line <a class="el" href="cache__manager__pimpl_8hpp_source.html#l00075">75</a> of file <a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a>.</p>

<p>Referenced by <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00213">describe()</a>, <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00119">handle_cleaner()</a>, and <a class="el" href="cache__manager__pimpl_8cpp_source.html#l00047">initialize_once()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/cache/<a class="el" href="cache__manager__pimpl_8hpp_source.html">cache_manager_pimpl.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/cache/<a class="el" href="cache__manager__pimpl_8cpp_source.html">cache_manager_pimpl.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1cache.html">cache</a></li><li class="navelem"><a class="el" href="classfoedus_1_1cache_1_1CacheManagerPimpl.html">CacheManagerPimpl</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

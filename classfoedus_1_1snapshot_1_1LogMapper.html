<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::snapshot::LogMapper Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1snapshot_1_1LogMapper.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfoedus_1_1snapshot_1_1LogMapper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::snapshot::LogMapper Class Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__SNAPSHOT.html">Snapshot Manager</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A log mapper, which reads log files from one logger and sends them to corresponding log reducers.  
 <a href="classfoedus_1_1snapshot_1_1LogMapper.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A log mapper, which reads log files from one logger and sends them to corresponding log reducers. </p>
<h1><a class="anchor" id="MAPPER_OVERVIEW"></a>
Overview</h1>
<p>Mappers read logs per epoch. As log files are guaranteed to be strictly ordered by epoch (see Logger code), we can simply read log files sequentially to achieve this.</p>
<p>Mappers send logs to partitions as follows: </p><ul>
<li>Engine-wide and Storage-wide logs (eg DROP STORAGE) are centrally processed at the end of epoch. So, mappers just buffer them and send all of them back to <a class="el" href="classfoedus_1_1snapshot_1_1LogGleaner.html" title="A log-gleaner, which constructs a new set of snapshot files during snapshotting. ">LogGleaner</a>, which will process all of them. </li>
<li>Record-wise logs always have storage-id. Mappers bucketize logs by storage ID to do the following in a batched fashion. </li>
<li>For each storage batch, mappers check the partitioning information, creating one if not exists (see <a class="el" href="classfoedus_1_1snapshot_1_1LogGleaner.html" title="A log-gleaner, which constructs a new set of snapshot files during snapshotting. ">LogGleaner</a>). </li>
<li>Mappers send logs to corresponding reducers with a compact metadata for each storage.</li>
</ul>
<h1><a class="anchor" id="MAPPER_OPTIMIZATION"></a>
Possible Optimization</h1>
<p>The log gleaner so far simply reads from log files. We have a plan to optimize its behavior when we have a large amount of DRAM by directly reading from the log buffer if it is not blown away yet. ThreadLogBuffer has an additional marker "head" for this purpose, but so far we don't use it to simplify the implementation.</p>
<dl class="section note"><dt>Note</dt><dd>This is a private implementation-details of <a class="el" href="group__SNAPSHOT.html">Snapshot Manager</a>, thus file name ends with _impl. Do not include this header from a client program. There is no case client program needs to access this internal class. </dd></dl>

<p>Definition at line <a class="el" href="log__mapper__impl_8hpp_source.html#l00073">73</a> of file <a class="el" href="log__mapper__impl_8hpp_source.html">log_mapper_impl.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="log__mapper__impl_8hpp_source.html">log_mapper_impl.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for foedus::snapshot::LogMapper:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogMapper__inherit__graph.png" border="0" usemap="#foedus_1_1snapshot_1_1LogMapper_inherit__map" alt="Inheritance graph"/></div>
<map name="foedus_1_1snapshot_1_1LogMapper_inherit__map" id="foedus_1_1snapshot_1_1LogMapper_inherit__map">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1MapReduceBase.html" title="Base class for LogMapper and LogReducer to share common code. " alt="" coords="5,155,233,181"/>
<area shape="rect" id="node3" href="classfoedus_1_1DefaultInitializable.html" title="Typical implementation of Initializable as a skeleton base class. " alt="" coords="33,80,205,107"/>
<area shape="rect" id="node4" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="53,5,185,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for foedus::snapshot::LogMapper:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogMapper__coll__graph.png" border="0" usemap="#foedus_1_1snapshot_1_1LogMapper_coll__map" alt="Collaboration graph"/></div>
<map name="foedus_1_1snapshot_1_1LogMapper_coll__map" id="foedus_1_1snapshot_1_1LogMapper_coll__map">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1MapReduceBase.html" title="Base class for LogMapper and LogReducer to share common code. " alt="" coords="1679,79,1907,105"/>
<area shape="rect" id="node3" href="classfoedus_1_1DefaultInitializable.html" title="Typical implementation of Initializable as a skeleton base class. " alt="" coords="808,5,980,32"/>
<area shape="rect" id="node4" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="294,23,426,49"/>
<area shape="rect" id="node10" href="classfoedus_1_1Engine.html" title="Database engine object that holds all resources and provides APIs. " alt="" coords="633,56,741,83"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html" title="A remote view of LogGleaner from all engines. " alt="" coords="1368,111,1583,137"/>
<area shape="rect" id="node6" href="classfoedus_1_1Attachable.html" title="foedus::Attachable\l\&lt; LogGleanerControlBlock \&gt;" alt="" coords="1004,107,1191,149"/>
<area shape="rect" id="node7" href="structfoedus_1_1snapshot_1_1LogGleanerControlBlock.html" title="Shared data for LogGleaner. " alt="" coords="589,122,784,163"/>
<area shape="rect" id="node8" href="structfoedus_1_1snapshot_1_1Snapshot.html" title="Represents one snapshot that converts all logs from base epoch to valid_until epoch into snapshot fil..." alt="" coords="268,129,452,156"/>
<area shape="rect" id="node9" href="classfoedus_1_1Epoch.html" title="Represents a time epoch. " alt="" coords="5,129,111,156"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1PartitionerMetadata.html" title="Tiny metadata of partitioner for every storage used while log gleaning. " alt="" coords="1008,181,1187,222"/>
<area shape="rect" id="node12" href="classfoedus_1_1soc_1_1SharedMutex.html" title="A mutex that can be placed in shared memory and used from multiple processes. " alt="" coords="599,188,774,215"/>
<area shape="rect" id="node13" title="STL class. " alt="" coords="1433,161,1517,188"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aca751cbfffcf70c4233c5d82b73bfbaa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogMapper.html#aca751cbfffcf70c4233c5d82b73bfbaa">LogMapper</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, uint16_t local_ordinal)</td></tr>
<tr class="separator:aca751cbfffcf70c4233c5d82b73bfbaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58b8ae141fb701e5d30911e8057d904e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogMapper.html#a58b8ae141fb701e5d30911e8057d904e">initialize_once</a> () override</td></tr>
<tr class="separator:a58b8ae141fb701e5d30911e8057d904e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a222a4846aeb6bf9f743bb300fe9dcc70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogMapper.html#a222a4846aeb6bf9f743bb300fe9dcc70">uninitialize_once</a> () override</td></tr>
<tr class="separator:a222a4846aeb6bf9f743bb300fe9dcc70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ede6520368c235c2b98200db0063eb7"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7">to_string</a> () const  override</td></tr>
<tr class="memdesc:a2ede6520368c235c2b98200db0063eb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expects "LogReducer-x", "LogMapper-y" etc.  <a href="#a2ede6520368c235c2b98200db0063eb7">More...</a><br /></td></tr>
<tr class="separator:a2ede6520368c235c2b98200db0063eb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">foedus::snapshot::MapReduceBase</a></td></tr>
<tr class="memitem:a578d7b4aec1f63e400e42fcb265831d3 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a578d7b4aec1f63e400e42fcb265831d3">MapReduceBase</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, uint16_t id)</td></tr>
<tr class="separator:a578d7b4aec1f63e400e42fcb265831d3 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39f91a709d8086fc702cf13e648ab149 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a39f91a709d8086fc702cf13e648ab149">MapReduceBase</a> ()=delete</td></tr>
<tr class="separator:a39f91a709d8086fc702cf13e648ab149 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd843d0d59ba29071a5d1f0f09b3c73e inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#acd843d0d59ba29071a5d1f0f09b3c73e">MapReduceBase</a> (const <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">MapReduceBase</a> &amp;other)=delete</td></tr>
<tr class="separator:acd843d0d59ba29071a5d1f0f09b3c73e inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed433d7f533dafba97af9c500827bb6a inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">MapReduceBase</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aed433d7f533dafba97af9c500827bb6a">operator=</a> (const <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">MapReduceBase</a> &amp;other)=delete</td></tr>
<tr class="separator:aed433d7f533dafba97af9c500827bb6a inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc7581a3f7b95b4893c1a75b123fa76 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html">LogGleanerRef</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a1cc7581a3f7b95b4893c1a75b123fa76">get_parent</a> ()</td></tr>
<tr class="separator:a1cc7581a3f7b95b4893c1a75b123fa76 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3711faba6c5e0191c3edf66ea88805f inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ab3711faba6c5e0191c3edf66ea88805f">get_id</a> () const </td></tr>
<tr class="separator:ab3711faba6c5e0191c3edf66ea88805f inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a649cad8103f0e450c68866e7f44bea74 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a649cad8103f0e450c68866e7f44bea74">get_numa_node</a> () const </td></tr>
<tr class="separator:a649cad8103f0e450c68866e7f44bea74 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb73ed60ea4202f906f63f203b467ff inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a4bb73ed60ea4202f906f63f203b467ff">launch_thread</a> ()</td></tr>
<tr class="memdesc:a4bb73ed60ea4202f906f63f203b467ff inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start executing.  <a href="#a4bb73ed60ea4202f906f63f203b467ff">More...</a><br /></td></tr>
<tr class="separator:a4bb73ed60ea4202f906f63f203b467ff inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af685ecd4f6aa00202e875c4d4780ad38 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#af685ecd4f6aa00202e875c4d4780ad38">join_thread</a> ()</td></tr>
<tr class="separator:af685ecd4f6aa00202e875c4d4780ad38 inherit pub_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1DefaultInitializable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1DefaultInitializable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1DefaultInitializable.html">foedus::DefaultInitializable</a></td></tr>
<tr class="memitem:a5e0a2679baa030e297c1a51847352945 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a5e0a2679baa030e297c1a51847352945">DefaultInitializable</a> ()</td></tr>
<tr class="separator:a5e0a2679baa030e297c1a51847352945 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe7a18ec3e5edd143eb7d6a75d65ef9b inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#afe7a18ec3e5edd143eb7d6a75d65ef9b">~DefaultInitializable</a> ()</td></tr>
<tr class="separator:afe7a18ec3e5edd143eb7d6a75d65ef9b inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd6a8f8296ab570b545430593287d454 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#afd6a8f8296ab570b545430593287d454">DefaultInitializable</a> (const <a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;)=delete</td></tr>
<tr class="separator:afd6a8f8296ab570b545430593287d454 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31eb5acadf0544b97414efd33aed08c7 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a31eb5acadf0544b97414efd33aed08c7">operator=</a> (const <a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;)=delete</td></tr>
<tr class="separator:a31eb5acadf0544b97414efd33aed08c7 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff">initialize</a> () override final</td></tr>
<tr class="memdesc:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typical implementation of <a class="el" href="classfoedus_1_1Initializable.html#aa087b096d1edaeb0304c250eadb0d7e1" title="Acquires resources in this object, usually called right after constructor. ">Initializable::initialize()</a> that provides initialize-once semantics.  <a href="#a22a0dc3bbbca682c3bc41eace9b6d1ff">More...</a><br /></td></tr>
<tr class="separator:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb">uninitialize</a> () override final</td></tr>
<tr class="memdesc:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typical implementation of <a class="el" href="classfoedus_1_1Initializable.html#afbe5738b0bc85362fba80bdf788fd3c3" title="An idempotent method to release all resources of this object, if any. ">Initializable::uninitialize()</a> that provides uninitialize-once semantics.  <a href="#ab14b136a7d26f9f499ab9dc15a45a8cb">More...</a><br /></td></tr>
<tr class="separator:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e">is_initialized</a> () const  override final</td></tr>
<tr class="memdesc:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the object has been already initialized or not.  <a href="#a1abda1e84b8af8bd6916e52fd0a09f3e">More...</a><br /></td></tr>
<tr class="separator:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1Initializable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1Initializable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1Initializable.html">foedus::Initializable</a></td></tr>
<tr class="memitem:aff308260543d18b3fd1367fd9017b176 inherit pub_methods_classfoedus_1_1Initializable"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Initializable.html#aff308260543d18b3fd1367fd9017b176">~Initializable</a> ()</td></tr>
<tr class="separator:aff308260543d18b3fd1367fd9017b176 inherit pub_methods_classfoedus_1_1Initializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a661014d4832400f072544ff4b7e74a45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogMapper.html#a661014d4832400f072544ff4b7e74a45">handle_process</a> () override</td></tr>
<tr class="memdesc:a661014d4832400f072544ff4b7e74a45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the specific logics in derived class.  <a href="#a661014d4832400f072544ff4b7e74a45">More...</a><br /></td></tr>
<tr class="separator:a661014d4832400f072544ff4b7e74a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classfoedus_1_1snapshot_1_1MapReduceBase')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">foedus::snapshot::MapReduceBase</a></td></tr>
<tr class="memitem:a3ba06a325855ed48539cd6f7d40a0412 inherit pro_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a3ba06a325855ed48539cd6f7d40a0412">check_cancelled</a> () const </td></tr>
<tr class="memdesc:a3ba06a325855ed48539cd6f7d40a0412 inherit pro_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derived class's <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae296d44aff3ed68f31958f46089526a0" title="Implements the specific logics in derived class. ">handle_process()</a> should occasionally call this to exit if it's cancelled.  <a href="#a3ba06a325855ed48539cd6f7d40a0412">More...</a><br /></td></tr>
<tr class="separator:a3ba06a325855ed48539cd6f7d40a0412 inherit pro_methods_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:ab47d292b66080365be5362ea2f9eb7e7"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogMapper.html#ab47d292b66080365be5362ea2f9eb7e7">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="classfoedus_1_1snapshot_1_1LogMapper.html">LogMapper</a> &amp;v)</td></tr>
<tr class="separator:ab47d292b66080365be5362ea2f9eb7e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html">foedus::snapshot::MapReduceBase</a></td></tr>
<tr class="memitem:afa57df91188b9ce05a71ceab488f9395 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">engine_</a></td></tr>
<tr class="separator:afa57df91188b9ce05a71ceab488f9395 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f3ce7311cab6118e780bd933e3f407 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html">LogGleanerRef</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae5f3ce7311cab6118e780bd933e3f407">parent_</a></td></tr>
<tr class="separator:ae5f3ce7311cab6118e780bd933e3f407 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad999cfc08cc7d7072ae6e0ed73651fca inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">const uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ad999cfc08cc7d7072ae6e0ed73651fca">id_</a></td></tr>
<tr class="memdesc:ad999cfc08cc7d7072ae6e0ed73651fca inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unique ID of this mapper or reducer.  <a href="#ad999cfc08cc7d7072ae6e0ed73651fca">More...</a><br /></td></tr>
<tr class="separator:ad999cfc08cc7d7072ae6e0ed73651fca inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed7f9c509c71fc238b1b794b54b839f inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">const uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a></td></tr>
<tr class="separator:aeed7f9c509c71fc238b1b794b54b839f inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94fd638dfbeec596f032f1942499c551 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a94fd638dfbeec596f032f1942499c551">running_</a></td></tr>
<tr class="memdesc:a94fd638dfbeec596f032f1942499c551 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">only for sanity check  <a href="#a94fd638dfbeec596f032f1942499c551">More...</a><br /></td></tr>
<tr class="separator:a94fd638dfbeec596f032f1942499c551 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e750423125af9fc0cd82935732f7b03 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memItemLeft" align="right" valign="top">std::thread&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a2e750423125af9fc0cd82935732f7b03">thread_</a></td></tr>
<tr class="separator:a2e750423125af9fc0cd82935732f7b03 inherit pro_attribs_classfoedus_1_1snapshot_1_1MapReduceBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aca751cbfffcf70c4233c5d82b73bfbaa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">foedus::snapshot::LogMapper::LogMapper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>local_ordinal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__mapper__impl_8cpp_source.html#l00058">58</a> of file <a class="el" href="log__mapper__impl_8cpp_source.html">log_mapper_impl.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  : <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a39f91a709d8086fc702cf13e648ab149">MapReduceBase</a>(engine, <a class="code" href="namespacefoedus_1_1snapshot.html#a66cdf0fb3cc0cff4a78335b8f1ee4756">calculate_logger_id</a>(engine, local_ordinal)),</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    processed_log_count_(0) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  clear_storage_buckets();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_a39f91a709d8086fc702cf13e648ab149"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a39f91a709d8086fc702cf13e648ab149">foedus::snapshot::MapReduceBase::MapReduceBase</a></div><div class="ttdeci">MapReduceBase()=delete</div></div>
<div class="ttc" id="namespacefoedus_1_1snapshot_html_a66cdf0fb3cc0cff4a78335b8f1ee4756"><div class="ttname"><a href="namespacefoedus_1_1snapshot.html#a66cdf0fb3cc0cff4a78335b8f1ee4756">foedus::snapshot::calculate_logger_id</a></div><div class="ttdeci">uint16_t calculate_logger_id(Engine *engine, uint16_t local_ordinal)</div><div class="ttdoc">Unique ID of this log mapper. </div><div class="ttdef"><b>Definition:</b> <a href="log__mapper__impl_8cpp_source.html#l00054">log_mapper_impl.cpp:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a661014d4832400f072544ff4b7e74a45"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::snapshot::LogMapper::handle_process </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements the specific logics in derived class. </p>

<p>Implements <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae296d44aff3ed68f31958f46089526a0">foedus::snapshot::MapReduceBase</a>.</p>

<p>Definition at line <a class="el" href="log__mapper__impl_8cpp_source.html#l00140">140</a> of file <a class="el" href="log__mapper__impl_8cpp_source.html">log_mapper_impl.cpp</a>.</p>

<p>References <a class="el" href="log__mapper__impl_8cpp_source.html#l00138">foedus::snapshot::align_io_ceil()</a>, <a class="el" href="log__mapper__impl_8cpp_source.html#l00137">foedus::snapshot::align_io_floor()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="log__id_8hpp_source.html#l00053">foedus::log::LogRange::begin_file_ordinal</a>, <a class="el" href="log__id_8hpp_source.html#l00055">foedus::log::LogRange::begin_offset</a>, <a class="el" href="mapreduce__base__impl_8cpp_source.html#l00054">foedus::snapshot::MapReduceBase::check_cancelled()</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="log__options_8cpp_source.html#l00041">foedus::log::LogOptions::construct_suffixed_log_path()</a>, <a class="el" href="stop__watch_8hpp_source.html#l00051">foedus::debugging::StopWatch::elapsed_sec()</a>, <a class="el" href="snapshot__options_8hpp_source.html#l00147">foedus::snapshot::SnapshotOptions::emulation_</a>, <a class="el" href="log__id_8hpp_source.html#l00054">foedus::log::LogRange::end_file_ordinal</a>, <a class="el" href="log__id_8hpp_source.html#l00056">foedus::log::LogRange::end_offset</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00071">foedus::snapshot::MapReduceBase::engine_</a>, <a class="el" href="filesystem_8cpp_source.html#l00120">foedus::fs::file_size()</a>, <a class="el" href="log__gleaner__ref_8cpp_source.html#l00077">foedus::snapshot::LogGleanerRef::get_base_epoch()</a>, <a class="el" href="engine_8cpp_source.html#l00049">foedus::Engine::get_log_manager()</a>, <a class="el" href="logger__ref_8cpp_source.html#l00091">foedus::log::LoggerRef::get_log_range()</a>, <a class="el" href="log__manager_8cpp_source.html#l00049">foedus::log::LogManager::get_logger()</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00172">foedus::memory::AlignedMemory::get_size()</a>, <a class="el" href="log__gleaner__ref_8cpp_source.html#l00078">foedus::snapshot::LogGleanerRef::get_valid_until_epoch()</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00074">foedus::snapshot::MapReduceBase::id_</a>, <a class="el" href="log__id_8hpp_source.html#l00057">foedus::log::LogRange::is_empty()</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00061">foedus::fs::DirectIoFile::kDirectIoSeekSet</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="engine__options_8hpp_source.html#l00138">foedus::EngineOptions::log_</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00075">foedus::snapshot::MapReduceBase::numa_node_</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00072">foedus::snapshot::MapReduceBase::parent_</a>, <a class="el" href="engine__options_8hpp_source.html#l00143">foedus::EngineOptions::snapshot_</a>, <a class="el" href="filesystem_8cpp_source.html#l00045">foedus::fs::status()</a>, <a class="el" href="stop__watch_8cpp_source.html#l00035">foedus::debugging::StopWatch::stop()</a>, <a class="el" href="log__mapper__impl_8hpp_source.html#l00080">to_string()</a>, and <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                     {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keyword">const</span> Epoch base_epoch = <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae5f3ce7311cab6118e780bd933e3f407">parent_</a>.<a class="code" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#a93148c754cfdf2f0beaa1d98b00eb985">get_base_epoch</a>();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keyword">const</span> Epoch until_epoch = <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae5f3ce7311cab6118e780bd933e3f407">parent_</a>.<a class="code" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#a6e1882e28b982377e1fc0968c62e1395">get_valid_until_epoch</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  log::LoggerRef logger = <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc">get_log_manager</a>()-&gt;<a class="code" href="classfoedus_1_1log_1_1LogManager.html#af649e09d5ffe1db37deab5215aaf85f8">get_logger</a>(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ad999cfc08cc7d7072ae6e0ed73651fca">id_</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keyword">const</span> log::LogRange log_range = logger.<a class="code" href="classfoedus_1_1log_1_1LoggerRef.html#a99e27a7bd4247f0729ae154c5a2262b5">get_log_range</a>(base_epoch, until_epoch);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// uint64_t cur_offset = log_range.begin_offset;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">if</span> (log_range.is_empty()) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    LOG(INFO) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; has no logs to process&quot;</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    report_completion(0);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// open the file and seek to there. be careful on page boundary.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// as we use direct I/O, all I/O must be 4kb-aligned. when the read range is not</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// a multiply of 4kb, we read a little bit more (at most 4kb per read, so negligible).</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">// to clarify, here we use the following suffixes</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">//   &quot;infile&quot;/&quot;inbuf&quot; : the offset is an offset in entire file/IO buffer</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">//   &quot;aligned&quot; : the offset is 4kb-aligned (careful on floor vs ceil)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">// Lengthy, but otherwise it&#39;s so confusing.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  processed_log_count_ = 0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  IoBufStatus <a class="code" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd">status</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  status.size_inbuf_aligned_ = io_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">get_size</a>();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  status.cur_file_ordinal_ = log_range.begin_file_ordinal;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  status.ended_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  status.first_read_ = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  debugging::StopWatch watch;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">while</span> (!status.ended_) {  <span class="comment">// loop for log file switch</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    fs::Path path(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#aee56a2e02a140b766a74d9e9c3088ddb">log_</a>.<a class="code" href="structfoedus_1_1log_1_1LogOptions.html#ad583679a01a8e4cc2ae87306efb73216">construct_suffixed_log_path</a>(</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a>,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ad999cfc08cc7d7072ae6e0ed73651fca">id_</a>,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      status.cur_file_ordinal_));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    uint64_t <a class="code" href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8">file_size</a> = <a class="code" href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8">fs::file_size</a>(path);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (file_size % <a class="code" href="namespacefoedus_1_1snapshot.html#ab89839c441708b28c071de9c34378421">kIoAlignment</a> != 0) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      LOG(WARNING) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; Interesting, non-aligned file size, which probably means&quot;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; previous writes didn&#39;t flush. file path=&quot;</span> &lt;&lt; path &lt;&lt; <span class="stringliteral">&quot;, file size=&quot;</span> &lt;&lt; <a class="code" href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8">file_size</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      file_size = <a class="code" href="namespacefoedus_1_1snapshot.html#a55a5a7f9b4c2a9bde992df8ce496c05e">align_io_floor</a>(file_size);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(file_size % <a class="code" href="namespacefoedus_1_1snapshot.html#ab89839c441708b28c071de9c34378421">kIoAlignment</a> == 0);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    status.size_infile_aligned_ = <a class="code" href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8">file_size</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// If this is the first file to read, we might be reading from non-zero position.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// In that case, be careful on alignment.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (status.cur_file_ordinal_ == log_range.begin_file_ordinal) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      status.next_infile_ = log_range.begin_offset;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      status.next_infile_ = 0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (status.cur_file_ordinal_ == log_range.end_file_ordinal) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(log_range.end_offset &lt;= file_size);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      status.end_infile_ = log_range.end_offset;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      status.end_infile_ = <a class="code" href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8">file_size</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    DVLOG(1) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; file path=&quot;</span> &lt;&lt; path &lt;&lt; <span class="stringliteral">&quot;, file size=&quot;</span> &lt;&lt; assorted::Hex(file_size)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;, read_end=&quot;</span> &lt;&lt; assorted::Hex(status.end_infile_);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    fs::DirectIoFile file(path, <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">snapshot_</a>.<a class="code" href="structfoedus_1_1snapshot_1_1SnapshotOptions.html#ac1b18bc1cd4db02607e21b6fb7a42b00">emulation_</a>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(file.open(<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    DVLOG(1) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7">to_string</a>() &lt;&lt; <span class="stringliteral">&quot;opened log file &quot;</span> &lt;&lt; file;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a3ba06a325855ed48539cd6f7d40a0412">check_cancelled</a>());  <span class="comment">// check per each read</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      status.buf_infile_aligned_ = <a class="code" href="namespacefoedus_1_1snapshot.html#a55a5a7f9b4c2a9bde992df8ce496c05e">align_io_floor</a>(status.next_infile_);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(file.seek(status.buf_infile_aligned_, <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84">fs::DirectIoFile::kDirectIoSeekSet</a>));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      DVLOG(1) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; seeked to: &quot;</span> &lt;&lt; assorted::Hex(status.buf_infile_aligned_);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      status.end_inbuf_aligned_ = std::min(</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        io_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">get_size</a>(),</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <a class="code" href="namespacefoedus_1_1snapshot.html#aa683c40c30267d3f0bdc27b1f626deaa">align_io_ceil</a>(status.end_infile_ - status.buf_infile_aligned_));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(status.end_inbuf_aligned_ % <a class="code" href="namespacefoedus_1_1snapshot.html#ab89839c441708b28c071de9c34378421">kIoAlignment</a> == 0);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(file.read(status.end_inbuf_aligned_, &amp;io_buffer_));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      status.cur_inbuf_ = 0;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">if</span> (status.next_infile_ != status.buf_infile_aligned_) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(status.next_infile_ &gt; status.buf_infile_aligned_);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        status.cur_inbuf_ = status.next_infile_ - status.buf_infile_aligned_;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        status.cur_inbuf_ = status.next_infile_ - status.buf_infile_aligned_;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        DVLOG(1) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; skipped &quot;</span> &lt;&lt; status.cur_inbuf_ &lt;&lt; <span class="stringliteral">&quot; bytes for aligned read&quot;</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(handle_process_buffer(file, &amp;status));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">if</span> (status.more_in_the_file_) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(status.next_infile_ &gt; status.buf_infile_aligned_);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">if</span> (log_range.end_file_ordinal == status.cur_file_ordinal_) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          status.ended_ = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          ++status.cur_file_ordinal_;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          status.next_infile_ = 0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          LOG(INFO) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7">to_string</a>()</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; moved on to next log file ordinal &quot;</span> &lt;&lt; status.cur_file_ordinal_;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    file.close();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  watch.stop();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  LOG(INFO) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; processed &quot;</span> &lt;&lt; processed_log_count_ &lt;&lt; <span class="stringliteral">&quot; log entries in &quot;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    &lt;&lt; watch.elapsed_sec() &lt;&lt; <span class="stringliteral">&quot;s&quot;</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  report_completion(watch.elapsed_sec());</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1log_1_1LogManager_html_af649e09d5ffe1db37deab5215aaf85f8"><div class="ttname"><a href="classfoedus_1_1log_1_1LogManager.html#af649e09d5ffe1db37deab5215aaf85f8">foedus::log::LogManager::get_logger</a></div><div class="ttdeci">LoggerRef get_logger(LoggerId logger_id)</div><div class="ttdoc">Returns a reference to the logger of the given ID. </div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8cpp_source.html#l00049">log_manager.cpp:49</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1LogOptions_html_ad583679a01a8e4cc2ae87306efb73216"><div class="ttname"><a href="structfoedus_1_1log_1_1LogOptions.html#ad583679a01a8e4cc2ae87306efb73216">foedus::log::LogOptions::construct_suffixed_log_path</a></div><div class="ttdeci">std::string construct_suffixed_log_path(int node, int logger, LogFileOrdinal ordinal) const </div><div class="ttdoc">construct full path of individual log file (log_folder/LOGGERID_ORDINAL.log) </div><div class="ttdef"><b>Definition:</b> <a href="log__options_8cpp_source.html#l00041">log_options.cpp:41</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_a3ba06a325855ed48539cd6f7d40a0412"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a3ba06a325855ed48539cd6f7d40a0412">foedus::snapshot::MapReduceBase::check_cancelled</a></div><div class="ttdeci">ErrorCode check_cancelled() const </div><div class="ttdoc">Derived class&#39;s handle_process() should occasionally call this to exit if it&#39;s cancelled. </div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8cpp_source.html#l00054">mapreduce_base_impl.cpp:54</a></div></div>
<div class="ttc" id="namespacefoedus_1_1snapshot_html_ab89839c441708b28c071de9c34378421"><div class="ttname"><a href="namespacefoedus_1_1snapshot.html#ab89839c441708b28c071de9c34378421">foedus::snapshot::kIoAlignment</a></div><div class="ttdeci">const uint64_t kIoAlignment</div><div class="ttdef"><b>Definition:</b> <a href="log__mapper__impl_8cpp_source.html#l00136">log_mapper_impl.cpp:136</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1SnapshotOptions_html_ac1b18bc1cd4db02607e21b6fb7a42b00"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1SnapshotOptions.html#ac1b18bc1cd4db02607e21b6fb7a42b00">foedus::snapshot::SnapshotOptions::emulation_</a></div><div class="ttdeci">foedus::fs::DeviceEmulationOptions emulation_</div><div class="ttdoc">Settings to emulate slower data device. </div><div class="ttdef"><b>Definition:</b> <a href="snapshot__options_8hpp_source.html#l00147">snapshot_options.hpp:147</a></div></div>
<div class="ttc" id="group__FILESYSTEM_html_gaaa833e3af93824a2485400b32dab7bcd"><div class="ttname"><a href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd">foedus::fs::status</a></div><div class="ttdeci">FileStatus status(const Path &amp;p)</div><div class="ttdoc">Returns the status of the file. </div><div class="ttdef"><b>Definition:</b> <a href="filesystem_8cpp_source.html#l00045">filesystem.cpp:45</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="namespacefoedus_1_1snapshot_html_a55a5a7f9b4c2a9bde992df8ce496c05e"><div class="ttname"><a href="namespacefoedus_1_1snapshot.html#a55a5a7f9b4c2a9bde992df8ce496c05e">foedus::snapshot::align_io_floor</a></div><div class="ttdeci">uint64_t align_io_floor(uint64_t offset)</div><div class="ttdef"><b>Definition:</b> <a href="log__mapper__impl_8cpp_source.html#l00137">log_mapper_impl.cpp:137</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogMapper_html_a2ede6520368c235c2b98200db0063eb7"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7">foedus::snapshot::LogMapper::to_string</a></div><div class="ttdeci">std::string to_string() const  override</div><div class="ttdoc">Expects "LogReducer-x", "LogMapper-y" etc. </div><div class="ttdef"><b>Definition:</b> <a href="log__mapper__impl_8hpp_source.html#l00080">log_mapper_impl.hpp:80</a></div></div>
<div class="ttc" id="classfoedus_1_1log_1_1LoggerRef_html_a99e27a7bd4247f0729ae154c5a2262b5"><div class="ttname"><a href="classfoedus_1_1log_1_1LoggerRef.html#a99e27a7bd4247f0729ae154c5a2262b5">foedus::log::LoggerRef::get_log_range</a></div><div class="ttdeci">LogRange get_log_range(Epoch prev_epoch, Epoch until_epoch)</div><div class="ttdoc">Constructs the range of log entries that represent the given epoch ranges. </div><div class="ttdef"><b>Definition:</b> <a href="logger__ref_8cpp_source.html#l00091">logger_ref.cpp:91</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_aa27f031bd1e256d38e616ec9a499eefc"><div class="ttname"><a href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc">foedus::Engine::get_log_manager</a></div><div class="ttdeci">log::LogManager * get_log_manager() const </div><div class="ttdoc">See Log Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00049">engine.cpp:49</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_ac8febbe3a3d3015c9b93cc1afb8154c1"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">foedus::EngineOptions::snapshot_</a></div><div class="ttdeci">snapshot::SnapshotOptions snapshot_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00143">engine_options.hpp:143</a></div></div>
<div class="ttc" id="namespacefoedus_1_1snapshot_html_aa683c40c30267d3f0bdc27b1f626deaa"><div class="ttname"><a href="namespacefoedus_1_1snapshot.html#aa683c40c30267d3f0bdc27b1f626deaa">foedus::snapshot::align_io_ceil</a></div><div class="ttdeci">uint64_t align_io_ceil(uint64_t offset)</div><div class="ttdef"><b>Definition:</b> <a href="log__mapper__impl_8cpp_source.html#l00138">log_mapper_impl.cpp:138</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_ae5f3ce7311cab6118e780bd933e3f407"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ae5f3ce7311cab6118e780bd933e3f407">foedus::snapshot::MapReduceBase::parent_</a></div><div class="ttdeci">LogGleanerRef parent_</div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00072">mapreduce_base_impl.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogGleanerRef_html_a6e1882e28b982377e1fc0968c62e1395"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#a6e1882e28b982377e1fc0968c62e1395">foedus::snapshot::LogGleanerRef::get_valid_until_epoch</a></div><div class="ttdeci">Epoch get_valid_until_epoch() const </div><div class="ttdef"><b>Definition:</b> <a href="log__gleaner__ref_8cpp_source.html#l00078">log_gleaner_ref.cpp:78</a></div></div>
<div class="ttc" id="group__FILESYSTEM_html_ga1048a33bafe4dcea89991112ae2660d8"><div class="ttname"><a href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8">foedus::fs::file_size</a></div><div class="ttdeci">uint64_t file_size(const Path &amp;p)</div><div class="ttdoc">Returns size of the file. </div><div class="ttdef"><b>Definition:</b> <a href="filesystem_8cpp_source.html#l00120">filesystem.cpp:120</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogGleanerRef_html_a93148c754cfdf2f0beaa1d98b00eb985"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#a93148c754cfdf2f0beaa1d98b00eb985">foedus::snapshot::LogGleanerRef::get_base_epoch</a></div><div class="ttdeci">Epoch get_base_epoch() const </div><div class="ttdef"><b>Definition:</b> <a href="log__gleaner__ref_8cpp_source.html#l00077">log_gleaner_ref.cpp:77</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_ad999cfc08cc7d7072ae6e0ed73651fca"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ad999cfc08cc7d7072ae6e0ed73651fca">foedus::snapshot::MapReduceBase::id_</a></div><div class="ttdeci">const uint16_t id_</div><div class="ttdoc">Unique ID of this mapper or reducer. </div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00074">mapreduce_base_impl.hpp:74</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a8db2e188293eaeebdf36cf39920efedd"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">foedus::memory::AlignedMemory::get_size</a></div><div class="ttdeci">uint64_t get_size() const </div><div class="ttdoc">Returns the byte size of the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00172">aligned_memory.hpp:172</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_aeed7f9c509c71fc238b1b794b54b839f"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">foedus::snapshot::MapReduceBase::numa_node_</a></div><div class="ttdeci">const uint16_t numa_node_</div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00075">mapreduce_base_impl.hpp:75</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_afa57df91188b9ce05a71ceab488f9395"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">foedus::snapshot::MapReduceBase::engine_</a></div><div class="ttdeci">Engine *const engine_</div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00071">mapreduce_base_impl.hpp:71</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_aee56a2e02a140b766a74d9e9c3088ddb"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#aee56a2e02a140b766a74d9e9c3088ddb">foedus::EngineOptions::log_</a></div><div class="ttdeci">log::LogOptions log_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00138">engine_options.hpp:138</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84">foedus::fs::DirectIoFile::kDirectIoSeekSet</a></div><div class="ttdoc">The offset is set to offset bytes. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00061">direct_io_file.hpp:61</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogMapper_a661014d4832400f072544ff4b7e74a45_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogMapper_a661014d4832400f072544ff4b7e74a45_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogMapper_a661014d4832400f072544ff4b7e74a45_cgraph" id="classfoedus_1_1snapshot_1_1LogMapper_a661014d4832400f072544ff4b7e74a45_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1snapshot.html#aa683c40c30267d3f0bdc27b1f626deaa" title="foedus::snapshot::align\l_io_ceil" alt="" coords="275,61,431,102"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1snapshot.html#a55a5a7f9b4c2a9bde992df8ce496c05e" title="foedus::snapshot::align\l_io_floor" alt="" coords="527,27,683,69"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#a3ba06a325855ed48539cd6f7d40a0412" title="Derived class&#39;s handle_process() should occasionally call this to exit if it&#39;s cancelled. " alt="" coords="254,126,453,167"/>
<area shape="rect" id="node6" href="structfoedus_1_1log_1_1LogOptions.html#ad583679a01a8e4cc2ae87306efb73216" title="construct full path of individual log file (log_folder/LOGGERID_ORDINAL.log) " alt="" coords="258,191,449,233"/>
<area shape="rect" id="node10" href="classfoedus_1_1debugging_1_1StopWatch.html#acc122593c59aa99c4bed52c0cb8e9a20" title="foedus::debugging::\lStopWatch::elapsed_sec" alt="" coords="269,257,437,298"/>
<area shape="rect" id="node11" href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8" title="Returns size of the file. " alt="" coords="287,897,420,924"/>
<area shape="rect" id="node13" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#a93148c754cfdf2f0beaa1d98b00eb985" title="foedus::snapshot::LogGleaner\lRef::get_base_epoch" alt="" coords="256,387,451,429"/>
<area shape="rect" id="node15" href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc" title="See Log Manager. " alt="" coords="286,453,421,494"/>
<area shape="rect" id="node16" href="classfoedus_1_1log_1_1LoggerRef.html#a99e27a7bd4247f0729ae154c5a2262b5" title="Constructs the range of log entries that represent the given epoch ranges. " alt="" coords="278,322,429,363"/>
<area shape="rect" id="node19" href="classfoedus_1_1log_1_1LogManager.html#af649e09d5ffe1db37deab5215aaf85f8" title="Returns a reference to the logger of the given ID. " alt="" coords="271,583,435,625"/>
<area shape="rect" id="node20" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="286,649,421,690"/>
<area shape="rect" id="node21" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="247,714,460,755"/>
<area shape="rect" id="node22" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#a6e1882e28b982377e1fc0968c62e1395" title="foedus::snapshot::LogGleaner\lRef::get_valid_until_epoch" alt="" coords="256,518,451,559"/>
<area shape="rect" id="node23" href="structfoedus_1_1log_1_1LogRange.html#a3ec255c876dc2e1b0f87110c3c8e2dd3" title="foedus::log::LogRange\l::is_empty" alt="" coords="278,831,429,873"/>
<area shape="rect" id="node24" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="292,780,415,807"/>
<area shape="rect" id="node25" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="286,949,421,990"/>
<area shape="rect" id="node28" href="classfoedus_1_1snapshot_1_1LogMapper.html#a2ede6520368c235c2b98200db0063eb7" title="Expects &quot;LogReducer&#45;x&quot;, &quot;LogMapper&#45;y&quot; etc. " alt="" coords="257,1014,450,1055"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#ac5b28bcfdc09bd7fe48cd7dd1e687fd1" title="foedus::snapshot::LogGleaner\lRef::is_error" alt="" coords="508,122,703,163"/>
<area shape="rect" id="node7" href="structfoedus_1_1log_1_1LogOptions.html#aad38e1d1b3d55acc3f4f4702f9848dbc" title="converts folder_path_pattern_ into a string with the given IDs. " alt="" coords="526,188,685,244"/>
<area shape="rect" id="node8" href="group__ASSORTED.html#gaa64b5d5356e69e9d0efa80590617c795" title="target.replaceAll(search, replacement). " alt="" coords="764,177,952,204"/>
<area shape="rect" id="node9" href="classfoedus_1_1assorted_1_1FixedString.html#a16f6de0859f599127e2d4a51a6537a01" title="Convert to a std::string object. " alt="" coords="751,228,965,255"/>
<area shape="rect" id="node12" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="530,823,681,849"/>
<area shape="rect" id="node14" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#aa21d824a0cd1489c832ed6d6b7105331" title="foedus::snapshot::LogGleaner\lRef::get_cur_snapshot" alt="" coords="508,467,703,509"/>
<area shape="rect" id="node17" href="classfoedus_1_1log_1_1LoggerRef.html#a66297efce7a73131e0e0ffc83df0b469" title="Returns this logger&#39;s durable epoch. " alt="" coords="530,351,681,393"/>
<area shape="rect" id="node18" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="528,300,683,327"/>
<area shape="rect" id="node26" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="525,981,686,1022"/>
<area shape="rect" id="node27" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="538,915,673,957"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a58b8ae141fb701e5d30911e8057d904e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::snapshot::LogMapper::initialize_once </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classfoedus_1_1DefaultInitializable.html#ab8ae37e5f20f312f8b945fc40d3e0250">foedus::DefaultInitializable</a>.</p>

<p>Definition at line <a class="el" href="log__mapper__impl_8cpp_source.html#l00064">64</a> of file <a class="el" href="log__mapper__impl_8cpp_source.html">log_mapper_impl.cpp</a>.</p>

<p>References <a class="el" href="aligned__memory_8cpp_source.html#l00113">foedus::memory::AlignedMemory::alloc()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00071">foedus::snapshot::MapReduceBase::engine_</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00170">foedus::memory::AlignedMemory::is_null()</a>, <a class="el" href="memory__id_8hpp_source.html#l00050">foedus::memory::kHugepageSize</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00083">foedus::memory::AlignedMemory::kNumaAllocOnnode</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="snapshot__options_8hpp_source.html#l00087">foedus::snapshot::SnapshotOptions::log_mapper_bucket_kb_</a>, <a class="el" href="snapshot__options_8hpp_source.html#l00095">foedus::snapshot::SnapshotOptions::log_mapper_io_buffer_mb_</a>, <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00075">foedus::snapshot::MapReduceBase::numa_node_</a>, and <a class="el" href="engine__options_8hpp_source.html#l00143">foedus::EngineOptions::snapshot_</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                      {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keyword">const</span> SnapshotOptions&amp; option = <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">snapshot_</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  uint64_t io_buffer_size = <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(option.log_mapper_io_buffer_mb_) &lt;&lt; 20;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  io_buffer_size = assorted::align&lt;uint64_t, memory::kHugepageSize&gt;(io_buffer_size);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  io_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    io_buffer_size,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!io_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0">is_null</a>());</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  uint64_t bucket_size = <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(option.log_mapper_bucket_kb_) &lt;&lt; 10;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  buckets_memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    bucket_size,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!buckets_memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0">is_null</a>());</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keyword">const</span> uint64_t tmp_memory_size = <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  tmp_memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    tmp_memory_size,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!tmp_memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0">is_null</a>());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// these automatically expand</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  presort_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    1U &lt;&lt; 21,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  presort_ouputs_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">alloc</a>(</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    1U &lt;&lt; 21,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">memory::kHugepageSize</a>,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">numa_node_</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  uint64_t tmp_offset = 0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  tmp_send_buffer_slice_ = memory::AlignedMemorySlice(&amp;tmp_memory_, tmp_offset, kSendBufferSize);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  tmp_offset += kSendBufferSize;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  tmp_position_array_slice_ = memory::AlignedMemorySlice(&amp;tmp_memory_, tmp_offset, kBucketSize);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  tmp_offset += kBucketSize;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  tmp_sort_array_slice_ = memory::AlignedMemorySlice(&amp;tmp_memory_, tmp_offset, kBucketSize &lt;&lt; 1);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  tmp_offset += kBucketSize &lt;&lt; 1;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keyword">const</span> uint64_t hashlist_bytesize = kBucketHashListMaxCount * <span class="keyword">sizeof</span>(BucketHashList);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  tmp_hashlist_buffer_slice_ = memory::AlignedMemorySlice(</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    &amp;tmp_memory_, tmp_offset, hashlist_bytesize);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  tmp_offset += hashlist_bytesize;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  tmp_partition_array_slice_ = memory::AlignedMemorySlice(&amp;tmp_memory_, tmp_offset, kBucketSize);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  tmp_offset += kBucketSize;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (tmp_memory_size &lt; tmp_offset) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;tmp_memory_size is too small. some contant values are messed up&quot;</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  processed_log_count_ = 0;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  clear_storage_buckets();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">foedus::memory::AlignedMemory::kNumaAllocOnnode</a></div><div class="ttdoc">numa_alloc_onnode() and numa_free(). </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00083">aligned_memory.hpp:83</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a5166bae2fdad9ffa0d5c279edfd3307e"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e">foedus::memory::AlignedMemory::alloc</a></div><div class="ttdeci">void alloc(uint64_t size, uint64_t alignment, AllocType alloc_type, int numa_node) noexcept</div><div class="ttdoc">Allocate a memory, releasing the current memory if exists. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8cpp_source.html#l00113">aligned_memory.cpp:113</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="group__MEMORY_html_gad3fad11cbb0632c8613fd4a3375100b2"><div class="ttname"><a href="group__MEMORY.html#gad3fad11cbb0632c8613fd4a3375100b2">foedus::memory::kHugepageSize</a></div><div class="ttdeci">const uint64_t kHugepageSize</div><div class="ttdoc">So far 2MB is the only page size available via Transparent Huge Page (THP). </div><div class="ttdef"><b>Definition:</b> <a href="memory__id_8hpp_source.html#l00050">memory_id.hpp:50</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_ac8febbe3a3d3015c9b93cc1afb8154c1"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">foedus::EngineOptions::snapshot_</a></div><div class="ttdeci">snapshot::SnapshotOptions snapshot_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00143">engine_options.hpp:143</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_aeed7f9c509c71fc238b1b794b54b839f"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#aeed7f9c509c71fc238b1b794b54b839f">foedus::snapshot::MapReduceBase::numa_node_</a></div><div class="ttdeci">const uint16_t numa_node_</div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00075">mapreduce_base_impl.hpp:75</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_afa57df91188b9ce05a71ceab488f9395"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#afa57df91188b9ce05a71ceab488f9395">foedus::snapshot::MapReduceBase::engine_</a></div><div class="ttdeci">Engine *const engine_</div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00071">mapreduce_base_impl.hpp:71</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_ad11d2289458b26db2aaef9de984045a0"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0">foedus::memory::AlignedMemory::is_null</a></div><div class="ttdeci">bool is_null() const </div><div class="ttdoc">Returns if this object doesn&#39;t hold a valid memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00170">aligned_memory.hpp:170</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogMapper_a58b8ae141fb701e5d30911e8057d904e_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogMapper_a58b8ae141fb701e5d30911e8057d904e_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogMapper_a58b8ae141fb701e5d30911e8057d904e_cgraph" id="classfoedus_1_1snapshot_1_1LogMapper_a58b8ae141fb701e5d30911e8057d904e_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e" title="Allocate a memory, releasing the current memory if exists. " alt="" coords="247,206,460,247"/>
<area shape="rect" id="node15" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="286,271,421,313"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="247,337,460,378"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1memory.html#ac2422aa4fe378da8a9594901762e17df" title="foedus::memory::alloc_mmap" alt="" coords="707,43,900,69"/>
<area shape="rect" id="node5" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="961,97,1101,138"/>
<area shape="rect" id="node6" href="namespacefoedus_1_1memory.html#ae51e4a90f52316ba9dce8ff783f30d84" title="foedus::memory::alloc\l_mmap_1gb_pages" alt="" coords="508,38,659,79"/>
<area shape="rect" id="node7" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="723,315,884,357"/>
<area shape="rect" id="node8" href="group__ASSORTED.html#gab3d1892edaa7db4b02029567b7993f37" title="In order to run even on a non&#45;numa machine or a machine with fewer sockets, we allow specifying arbit..." alt="" coords="508,206,659,247"/>
<area shape="rect" id="node9" href="numa_8h.html#a413cadd87796fff247c83d9ad817cc7e" title="numa_available" alt="" coords="748,155,859,181"/>
<area shape="rect" id="node11" href="numa_8h.html#aba49c14c68d23dc05d046db02766b928" title="numa_preferred" alt="" coords="528,323,639,349"/>
<area shape="rect" id="node12" href="numa_8h.html#a56f33968932f6550e5e5eb4d1acc67b3" title="numa_set_preferred" alt="" coords="515,373,651,400"/>
<area shape="rect" id="node13" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="516,425,651,466"/>
<area shape="rect" id="node4" href="namespacefoedus_1_1memory.html#af6145d9296231995c84badafb6a2a0a9" title="Returns if 1GB hugepages were enabled. " alt="" coords="948,31,1113,73"/>
<area shape="rect" id="node10" href="numa_8h.html#a22585176d6e08c221de8377637bd72a7" title="numa_num_configured\l_nodes" alt="" coords="727,206,879,247"/>
<area shape="rect" id="node14" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="736,425,871,466"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2ede6520368c235c2b98200db0063eb7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string foedus::snapshot::LogMapper::to_string </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Expects "LogReducer-x", "LogMapper-y" etc. </p>
<p>Used only for logging/debugging. </p>

<p>Implements <a class="el" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ac6e7366e9f890077872aea8f2c16099b">foedus::snapshot::MapReduceBase</a>.</p>

<p>Definition at line <a class="el" href="log__mapper__impl_8hpp_source.html#l00080">80</a> of file <a class="el" href="log__mapper__impl_8hpp_source.html">log_mapper_impl.hpp</a>.</p>

<p>References <a class="el" href="mapreduce__base__impl_8hpp_source.html#l00074">foedus::snapshot::MapReduceBase::id_</a>.</p>

<p>Referenced by <a class="el" href="log__mapper__impl_8cpp_source.html#l00140">handle_process()</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                                   {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;LogMapper-&quot;</span>) + std::to_string(<a class="code" href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ad999cfc08cc7d7072ae6e0ed73651fca">id_</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1MapReduceBase_html_ad999cfc08cc7d7072ae6e0ed73651fca"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1MapReduceBase.html#ad999cfc08cc7d7072ae6e0ed73651fca">foedus::snapshot::MapReduceBase::id_</a></div><div class="ttdeci">const uint16_t id_</div><div class="ttdoc">Unique ID of this mapper or reducer. </div><div class="ttdef"><b>Definition:</b> <a href="mapreduce__base__impl_8hpp_source.html#l00074">mapreduce_base_impl.hpp:74</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogMapper_a2ede6520368c235c2b98200db0063eb7_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogMapper_a2ede6520368c235c2b98200db0063eb7_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogMapper_a2ede6520368c235c2b98200db0063eb7_icgraph" id="classfoedus_1_1snapshot_1_1LogMapper_a2ede6520368c235c2b98200db0063eb7_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogMapper.html#a661014d4832400f072544ff4b7e74a45" title="Implements the specific logics in derived class. " alt="" coords="247,5,440,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a222a4846aeb6bf9f743bb300fe9dcc70"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::snapshot::LogMapper::uninitialize_once </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b">foedus::DefaultInitializable</a>.</p>

<p>Definition at line <a class="el" href="log__mapper__impl_8cpp_source.html#l00127">127</a> of file <a class="el" href="log__mapper__impl_8cpp_source.html">log_mapper_impl.cpp</a>.</p>

<p>References <a class="el" href="aligned__memory_8cpp_source.html#l00235">foedus::memory::AlignedMemory::release_block()</a>, and <a class="el" href="error__stack__batch_8hpp_source.html#l00136">SUMMARIZE_ERROR_BATCH</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                        {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  ErrorStackBatch batch;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  io_buffer_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">release_block</a>();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  buckets_memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">release_block</a>();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  tmp_memory_.<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">release_block</a>();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  clear_storage_buckets();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga67390b22b0afbe5a4938df9847eafda9">SUMMARIZE_ERROR_BATCH</a>(batch);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_afd955f5f991e28943c72ecff1167c16b"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b">foedus::memory::AlignedMemory::release_block</a></div><div class="ttdeci">void release_block()</div><div class="ttdoc">Releases the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8cpp_source.html#l00235">aligned_memory.cpp:235</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga67390b22b0afbe5a4938df9847eafda9"><div class="ttname"><a href="group__ERRORCODES.html#ga67390b22b0afbe5a4938df9847eafda9">SUMMARIZE_ERROR_BATCH</a></div><div class="ttdeci">#define SUMMARIZE_ERROR_BATCH(x)</div><div class="ttdoc">This macro calls ErrorStackBatch::summarize() with automatically provided parameters. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack__batch_8hpp_source.html#l00136">error_stack_batch.hpp:136</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogMapper_a222a4846aeb6bf9f743bb300fe9dcc70_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogMapper_a222a4846aeb6bf9f743bb300fe9dcc70_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogMapper_a222a4846aeb6bf9f743bb300fe9dcc70_cgraph" id="classfoedus_1_1snapshot_1_1LogMapper_a222a4846aeb6bf9f743bb300fe9dcc70_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b" title="Releases the memory block. " alt="" coords="247,5,460,47"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="ab47d292b66080365be5362ea2f9eb7e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1snapshot_1_1LogMapper.html">LogMapper</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__mapper__impl_8cpp_source.html#l00700">700</a> of file <a class="el" href="log__mapper__impl_8cpp_source.html">log_mapper_impl.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                                          {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;LogMapper&gt;&quot;</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;id_&gt;&quot;</span> &lt;&lt; v.id_ &lt;&lt; <span class="stringliteral">&quot;&lt;/id_&gt;&quot;</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;numa_node_&gt;&quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(v.numa_node_) &lt;&lt; <span class="stringliteral">&quot;&lt;/numa_node_&gt;&quot;</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;buckets_allocated_count_&gt;&quot;</span> &lt;&lt; v.buckets_allocated_count_ &lt;&lt; <span class="stringliteral">&quot;&lt;/buckets_allocated_count_&gt;&quot;</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;hashlist_allocated_count&gt;&quot;</span> &lt;&lt; v.hashlist_allocated_count_ &lt;&lt; <span class="stringliteral">&quot;&lt;/hashlist_allocated_count&gt;&quot;</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;processed_log_count_&gt;&quot;</span> &lt;&lt; v.processed_log_count_ &lt;&lt; <span class="stringliteral">&quot;&lt;/processed_log_count_&gt;&quot;</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;/LogMapper&gt;&quot;</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/snapshot/<a class="el" href="log__mapper__impl_8hpp_source.html">log_mapper_impl.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/snapshot/<a class="el" href="log__mapper__impl_8cpp_source.html">log_mapper_impl.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1snapshot.html">snapshot</a></li><li class="navelem"><a class="el" href="classfoedus_1_1snapshot_1_1LogMapper.html">LogMapper</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

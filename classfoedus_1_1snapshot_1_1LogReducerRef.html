<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::snapshot::LogReducerRef Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1snapshot_1_1LogReducerRef.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfoedus_1_1snapshot_1_1LogReducerRef-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::snapshot::LogReducerRef Class Reference<div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__SNAPSHOT.html">Snapshot Manager</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A remote view of <a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html" title="A log reducer, which receives log entries sent from mappers and applies them to construct new snapsho...">LogReducer</a> from all engines.  
 <a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A remote view of <a class="el" href="classfoedus_1_1snapshot_1_1LogReducer.html" title="A log reducer, which receives log entries sent from mappers and applies them to construct new snapsho...">LogReducer</a> from all engines. </p>

<p>Definition at line <a class="el" href="log__reducer__ref_8hpp_source.html#l00040">40</a> of file <a class="el" href="log__reducer__ref_8hpp_source.html">log_reducer_ref.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="log__reducer__ref_8hpp_source.html">log_reducer_ref.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for foedus::snapshot::LogReducerRef:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef__coll__graph.png" border="0" usemap="#foedus_1_1snapshot_1_1LogReducerRef_coll__map" alt="Collaboration graph"/></div>
<map name="foedus_1_1snapshot_1_1LogReducerRef_coll__map" id="foedus_1_1snapshot_1_1LogReducerRef_coll__map">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1Page.html" title="Just a marker to denote that the memory region represents a data page. " alt="" coords="5,89,155,115"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html" title="Database engine object that holds all resources and provides APIs. " alt="" coords="179,89,287,115"/>
<area shape="rect" id="node4" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="167,5,299,32"/>
<area shape="rect" id="node5" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html" title="Shared data for LogReducer. " alt="" coords="311,81,510,123"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad68fd639c7b9bd3c9d62edf80b74f94d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#ad68fd639c7b9bd3c9d62edf80b74f94d">LogReducerRef</a> ()</td></tr>
<tr class="separator:ad68fd639c7b9bd3c9d62edf80b74f94d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48fa59b1bcce029bc8a7e5fd3f688068"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a48fa59b1bcce029bc8a7e5fd3f688068">LogReducerRef</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, uint16_t node)</td></tr>
<tr class="separator:a48fa59b1bcce029bc8a7e5fd3f688068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab473882f640fcd29c56af54ffb9957a1"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#ab473882f640fcd29c56af54ffb9957a1">get_id</a> () const </td></tr>
<tr class="separator:ab473882f640fcd29c56af54ffb9957a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bb712be85bef103cc9d1bb5f81ee6db"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9bb712be85bef103cc9d1bb5f81ee6db">to_string</a> () const </td></tr>
<tr class="separator:a9bb712be85bef103cc9d1bb5f81ee6db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d4e8aef4ca07ffe0bc59610335f136"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a88d4e8aef4ca07ffe0bc59610335f136">clear</a> ()</td></tr>
<tr class="separator:a88d4e8aef4ca07ffe0bc59610335f136"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdc2218c6d4914cf5e1395413c1c8d75"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#abdc2218c6d4914cf5e1395413c1c8d75">get_total_storage_count</a> () const </td></tr>
<tr class="separator:abdc2218c6d4914cf5e1395413c1c8d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd6cedd726ef9991558e7460f6eb06b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#acd6cedd726ef9991558e7460f6eb06b1">get_root_info_pages</a> ()</td></tr>
<tr class="separator:acd6cedd726ef9991558e7460f6eb06b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ea0f6f073f92ff447cc34429adafbda"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a4ea0f6f073f92ff447cc34429adafbda">append_log_chunk</a> (<a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">storage::StorageId</a> storage_id, const char *send_buffer, uint32_t log_count, uint64_t send_buffer_size, uint32_t shortest_key_length, uint32_t longest_key_length)</td></tr>
<tr class="memdesc:a4ea0f6f073f92ff447cc34429adafbda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append the log entries of one storage in the given buffer to this reducer's buffer.  <a href="#a4ea0f6f073f92ff447cc34429adafbda">More...</a><br /></td></tr>
<tr class="separator:a4ea0f6f073f92ff447cc34429adafbda"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aa4a57d52ef10b270b50d0e00511b24e5"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structfoedus_1_1snapshot_1_1Snapshot.html">Snapshot</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#aa4a57d52ef10b270b50d0e00511b24e5">get_cur_snapshot</a> () const </td></tr>
<tr class="separator:aa4a57d52ef10b270b50d0e00511b24e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0caf4a8a65cb0278425414b581cd9b"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a3e0caf4a8a65cb0278425414b581cd9b">get_buffer_size</a> () const </td></tr>
<tr class="separator:a3e0caf4a8a65cb0278425414b581cd9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b01584170849f37da7780d8480c7bd"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af2b01584170849f37da7780d8480c7bd">get_current_buffer_index_atomic</a> () const </td></tr>
<tr class="separator:af2b01584170849f37da7780d8480c7bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01c6454d8099e0d74a325af05718dc12"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a01c6454d8099e0d74a325af05718dc12">get_buffer</a> (uint32_t index) const </td></tr>
<tr class="separator:a01c6454d8099e0d74a325af05718dc12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a493bf984062f2615c6788b4c4f6b36df"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a493bf984062f2615c6788b4c4f6b36df">verify_log_chunk</a> (<a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">storage::StorageId</a> storage_id, const char *send_buffer, uint32_t log_count, uint64_t send_buffer_size) const </td></tr>
<tr class="memdesc:a493bf984062f2615c6788b4c4f6b36df"><td class="mdescLeft">&#160;</td><td class="mdescRight">used only in debug mode  <a href="#a493bf984062f2615c6788b4c4f6b36df">More...</a><br /></td></tr>
<tr class="separator:a493bf984062f2615c6788b4c4f6b36df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a9db563f9ba8f57f14354b1b1858485e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">engine_</a></td></tr>
<tr class="separator:a9db563f9ba8f57f14354b1b1858485e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35a5c8c8ef82671b0d5b051fe8c45e7e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html">LogReducerControlBlock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a></td></tr>
<tr class="separator:a35a5c8c8ef82671b0d5b051fe8c45e7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3ee5fbe4d4720e30375756b7fcbc0ad"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af3ee5fbe4d4720e30375756b7fcbc0ad">buffers_</a> [2]</td></tr>
<tr class="separator:af3ee5fbe4d4720e30375756b7fcbc0ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6175a1ff4a6f9020a421e4114335d254"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a6175a1ff4a6f9020a421e4114335d254">root_info_pages_</a></td></tr>
<tr class="separator:a6175a1ff4a6f9020a421e4114335d254"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a8576edaceffaf41744f66b27aa51c60a"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a8576edaceffaf41744f66b27aa51c60a">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html">LogReducerRef</a> &amp;v)</td></tr>
<tr class="separator:a8576edaceffaf41744f66b27aa51c60a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ad68fd639c7b9bd3c9d62edf80b74f94d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::snapshot::LogReducerRef::LogReducerRef </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8hpp_source.html#l00042">42</a> of file <a class="el" href="log__reducer__ref_8hpp_source.html">log_reducer_ref.hpp</a>.</p>

<p>References <a class="el" href="log__reducer__ref_8hpp_source.html#l00096">buffers_</a>, <a class="el" href="log__reducer__ref_8hpp_source.html#l00095">control_block_</a>, <a class="el" href="cxx11_8hpp_source.html#l00132">CXX11_NULLPTR</a>, <a class="el" href="log__reducer__ref_8hpp_source.html#l00094">engine_</a>, and <a class="el" href="log__reducer__ref_8hpp_source.html#l00097">root_info_pages_</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                  {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">engine_</a> = <a class="code" href="group__CXX11.html#ga213f92e16813051c59cdccf6d28baa78">CXX11_NULLPTR</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a> = <a class="code" href="group__CXX11.html#ga213f92e16813051c59cdccf6d28baa78">CXX11_NULLPTR</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af3ee5fbe4d4720e30375756b7fcbc0ad">buffers_</a>[0] = <a class="code" href="group__CXX11.html#ga213f92e16813051c59cdccf6d28baa78">CXX11_NULLPTR</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af3ee5fbe4d4720e30375756b7fcbc0ad">buffers_</a>[1] = <a class="code" href="group__CXX11.html#ga213f92e16813051c59cdccf6d28baa78">CXX11_NULLPTR</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a6175a1ff4a6f9020a421e4114335d254">root_info_pages_</a> = <a class="code" href="group__CXX11.html#ga213f92e16813051c59cdccf6d28baa78">CXX11_NULLPTR</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  }</div>
<div class="ttc" id="group__CXX11_html_ga213f92e16813051c59cdccf6d28baa78"><div class="ttname"><a href="group__CXX11.html#ga213f92e16813051c59cdccf6d28baa78">CXX11_NULLPTR</a></div><div class="ttdeci">#define CXX11_NULLPTR</div><div class="ttdoc">Used in public headers in place of "nullptr" of C++11. </div><div class="ttdef"><b>Definition:</b> <a href="cxx11_8hpp_source.html#l00132">cxx11.hpp:132</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a6175a1ff4a6f9020a421e4114335d254"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a6175a1ff4a6f9020a421e4114335d254">foedus::snapshot::LogReducerRef::root_info_pages_</a></div><div class="ttdeci">storage::Page * root_info_pages_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00097">log_reducer_ref.hpp:97</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_af3ee5fbe4d4720e30375756b7fcbc0ad"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af3ee5fbe4d4720e30375756b7fcbc0ad">foedus::snapshot::LogReducerRef::buffers_</a></div><div class="ttdeci">void * buffers_[2]</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00096">log_reducer_ref.hpp:96</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a35a5c8c8ef82671b0d5b051fe8c45e7e"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">foedus::snapshot::LogReducerRef::control_block_</a></div><div class="ttdeci">LogReducerControlBlock * control_block_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00095">log_reducer_ref.hpp:95</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a9db563f9ba8f57f14354b1b1858485e3"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">foedus::snapshot::LogReducerRef::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00094">log_reducer_ref.hpp:94</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a48fa59b1bcce029bc8a7e5fd3f688068"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">foedus::snapshot::LogReducerRef::LogReducerRef </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00036">36</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="log__reducer__ref_8hpp_source.html#l00096">buffers_</a>, <a class="el" href="log__reducer__ref_8hpp_source.html#l00095">control_block_</a>, <a class="el" href="log__reducer__ref_8hpp_source.html#l00094">engine_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00521">foedus::soc::SharedMemoryRepo::get_node_memory_anchors()</a>, <a class="el" href="soc__manager_8cpp_source.html#l00038">foedus::soc::SocManager::get_shared_memory_repo()</a>, <a class="el" href="engine_8cpp_source.html#l00059">foedus::Engine::get_soc_manager()</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00373">foedus::soc::NodeMemoryAnchors::log_reducer_buffers_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00367">foedus::soc::NodeMemoryAnchors::log_reducer_memory_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00380">foedus::soc::NodeMemoryAnchors::log_reducer_root_info_pages_</a>, and <a class="el" href="log__reducer__ref_8hpp_source.html#l00097">root_info_pages_</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                                          {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">engine_</a> = engine;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  soc::NodeMemoryAnchors* anchors</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    = <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e">get_soc_manager</a>()-&gt;<a class="code" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c">get_shared_memory_repo</a>()-&gt;<a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e5d1a0a78c66ac6e1c8ef166d2965c3">get_node_memory_anchors</a>(node);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a> = anchors-&gt;log_reducer_memory_;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af3ee5fbe4d4720e30375756b7fcbc0ad">buffers_</a>[0] = anchors-&gt;log_reducer_buffers_[0];</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af3ee5fbe4d4720e30375756b7fcbc0ad">buffers_</a>[1] = anchors-&gt;log_reducer_buffers_[1];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a6175a1ff4a6f9020a421e4114335d254">root_info_pages_</a> = anchors-&gt;log_reducer_root_info_pages_;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a6175a1ff4a6f9020a421e4114335d254"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a6175a1ff4a6f9020a421e4114335d254">foedus::snapshot::LogReducerRef::root_info_pages_</a></div><div class="ttdeci">storage::Page * root_info_pages_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00097">log_reducer_ref.hpp:97</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_a2e5d1a0a78c66ac6e1c8ef166d2965c3"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e5d1a0a78c66ac6e1c8ef166d2965c3">foedus::soc::SharedMemoryRepo::get_node_memory_anchors</a></div><div class="ttdeci">NodeMemoryAnchors * get_node_memory_anchors(SocId node)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00521">shared_memory_repo.hpp:521</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_af3ee5fbe4d4720e30375756b7fcbc0ad"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af3ee5fbe4d4720e30375756b7fcbc0ad">foedus::snapshot::LogReducerRef::buffers_</a></div><div class="ttdeci">void * buffers_[2]</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00096">log_reducer_ref.hpp:96</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a35a5c8c8ef82671b0d5b051fe8c45e7e"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">foedus::snapshot::LogReducerRef::control_block_</a></div><div class="ttdeci">LogReducerControlBlock * control_block_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00095">log_reducer_ref.hpp:95</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_ae9ad7ab6a3df52b0e9f0e50ede6faa2e"><div class="ttname"><a href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e">foedus::Engine::get_soc_manager</a></div><div class="ttdeci">soc::SocManager * get_soc_manager() const </div><div class="ttdoc">See SOC and IPC. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00059">engine.cpp:59</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a9db563f9ba8f57f14354b1b1858485e3"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">foedus::snapshot::LogReducerRef::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00094">log_reducer_ref.hpp:94</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SocManager_html_a627cf434892c441c90c2de7c20637e9c"><div class="ttname"><a href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c">foedus::soc::SocManager::get_shared_memory_repo</a></div><div class="ttdeci">SharedMemoryRepo * get_shared_memory_repo()</div><div class="ttdoc">Returns the shared memories maintained across SOCs. </div><div class="ttdef"><b>Definition:</b> <a href="soc__manager_8cpp_source.html#l00038">soc_manager.cpp:38</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a48fa59b1bcce029bc8a7e5fd3f688068_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a48fa59b1bcce029bc8a7e5fd3f688068_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a48fa59b1bcce029bc8a7e5fd3f688068_cgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a48fa59b1bcce029bc8a7e5fd3f688068_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e5d1a0a78c66ac6e1c8ef166d2965c3" title="foedus::soc::SharedMemory\lRepo::get_node_memory_anchors" alt="" coords="252,5,472,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="272,71,452,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="295,136,429,177"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4ea0f6f073f92ff447cc34429adafbda"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::snapshot::LogReducerRef::append_log_chunk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">storage::StorageId</a>&#160;</td>
          <td class="paramname"><em>storage_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>send_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>log_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>send_buffer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>shortest_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>longest_key_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Append the log entries of one storage in the given buffer to this reducer's buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">storage_id</td><td>all log entries are of this storage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">send_buffer</td><td>contains log entries to copy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">log_count</td><td>number of log entries to copy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">send_buffer_size</td><td>byte count to copy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shortest_key_length</td><td>[masstree/hash] shortest key length in the log entries </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">longest_key_length</td><td>[masstree/hash] longest key length in the log entries</td></tr>
  </table>
  </dd>
</dl>
<p>This is the interface via which mappers send log entries to reducers. Internally, this atomically changes the status of the current reducer buffer to reserve a contiguous space and then copy without blocking other mappers. If this methods hits a situation where the current buffer becomes full, this methods wakes up the reducer and lets it switch the current buffer. All log entries are contiguously copied. One block doesn't span two buffers. </p>

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00121">121</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="log__reducer__impl_8hpp_source.html#l00072">foedus::snapshot::ReducerBufferStatus::Components::active_writers_</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00119">foedus::snapshot::BlockHeaderBase::block_length_</a>, <a class="el" href="log__reducer__ref_8hpp_source.html#l00096">buffers_</a>, <a class="el" href="unionfoedus_1_1snapshot_1_1ReducerBufferStatus.html#acf1de9dfdc97fdfc44bfdde0237b39c7">foedus::snapshot::ReducerBufferStatus::components</a>, <a class="el" href="log__reducer__ref_8hpp_source.html#l00095">control_block_</a>, <a class="el" href="rdtsc__watch_8hpp_source.html#l00052">foedus::debugging::RdtscWatch::elapsed()</a>, <a class="el" href="log__reducer__ref_8hpp_source.html#l00094">engine_</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00073">foedus::snapshot::ReducerBufferStatus::Components::flags_</a>, <a class="el" href="snapshot__id_8hpp_source.html#l00078">foedus::snapshot::from_buffer_position()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00071">get_buffer()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00065">get_buffer_size()</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00181">foedus::snapshot::LogReducerControlBlock::get_buffer_status_address()</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00176">foedus::snapshot::LogReducerControlBlock::get_buffer_status_atomic()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00061">get_current_buffer_index_atomic()</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00060">foedus::snapshot::kFlagNoMoreWriters</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00096">foedus::snapshot::BlockHeaderBase::kFullBlockHeaderMagicWord</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00130">foedus::snapshot::FullBlockHeader::log_count_</a>, <a class="el" href="snapshot__options_8hpp_source.html#l00115">foedus::snapshot::SnapshotOptions::log_reducer_buffer_mb_</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00134">foedus::snapshot::FullBlockHeader::longest_key_length_</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00117">foedus::snapshot::BlockHeaderBase::magic_word_</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00132">foedus::snapshot::FullBlockHeader::shortest_key_length_</a>, <a class="el" href="engine__options_8hpp_source.html#l00143">foedus::EngineOptions::snapshot_</a>, <a class="el" href="rdtsc__watch_8hpp_source.html#l00047">foedus::debugging::RdtscWatch::stop()</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00129">foedus::snapshot::FullBlockHeader::storage_id_</a>, <a class="el" href="log__reducer__impl_8hpp_source.html#l00074">foedus::snapshot::ReducerBufferStatus::Components::tail_position_</a>, <a class="el" href="snapshot__id_8hpp_source.html#l00074">foedus::snapshot::to_buffer_position()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00049">to_string()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00082">verify_log_chunk()</a>, and <a class="el" href="log__reducer__impl_8hpp_source.html#l00070">foedus::snapshot::ReducerBufferStatus::word</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                               {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  DVLOG(1) &lt;&lt; <span class="stringliteral">&quot;Appending a block of &quot;</span> &lt;&lt; send_buffer_size &lt;&lt; <span class="stringliteral">&quot; bytes (&quot;</span> &lt;&lt; log_count</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; entries) to &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9bb712be85bef103cc9d1bb5f81ee6db">to_string</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;s buffer for storage-&quot;</span> &lt;&lt; storage_id;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a493bf984062f2615c6788b4c4f6b36df">verify_log_chunk</a>(storage_id, send_buffer, log_count, send_buffer_size));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  debugging::RdtscWatch stop_watch;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keyword">const</span> uint64_t required_size = send_buffer_size + <span class="keyword">sizeof</span>(FullBlockHeader);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  uint32_t buffer_index = 0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  uint64_t begin_position = 0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    buffer_index = <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af2b01584170849f37da7780d8480c7bd">get_current_buffer_index_atomic</a>();</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    std::atomic&lt;uint64_t&gt;* status_address = <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a35ab8a50220c6e05a6c9685d74fd461c">get_buffer_status_address</a>(buffer_index);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// If even the current buffer is marked as no more writers, the reducer is getting behind.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// Mappers have to wait, potentially for a long time. So, let&#39;s just sleep.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    ReducerBufferStatus cur_status = <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a7c8feb59a8368bdae9ffea4b2e3fa8e8">get_buffer_status_atomic</a>(buffer_index);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">if</span> (cur_status.components.flags_ &amp; <a class="code" href="namespacefoedus_1_1snapshot.html#a4f25261ad53b056011203342a22b40d0aff1acff80c35cb454d09cdd425e7f1a7">kFlagNoMoreWriters</a>) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Both buffers full in&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9bb712be85bef103cc9d1bb5f81ee6db">to_string</a>() &lt;&lt; <span class="stringliteral">&quot;. I&#39;ll sleep for a while..&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">while</span> (<a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af2b01584170849f37da7780d8480c7bd">get_current_buffer_index_atomic</a>() == buffer_index) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        std::this_thread::sleep_for(std::chrono::milliseconds(1));</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Buffer switched in&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9bb712be85bef103cc9d1bb5f81ee6db">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; after sleep. Let&#39;s resume.&quot;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// the buffer is now full. let&#39;s mark this buffer full and</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// then wake up reducer to do switch.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    uint64_t buffer_size = <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a3e0caf4a8a65cb0278425414b581cd9b">get_buffer_size</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(buffer_size</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      == <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">snapshot_</a>.<a class="code" href="structfoedus_1_1snapshot_1_1SnapshotOptions.html#a8a66eec37c6f549733a44d126785c591">log_reducer_buffer_mb_</a> * (1ULL &lt;&lt; 19));</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="namespacefoedus_1_1snapshot.html#a499edf9829f41f833e2057346e8bbf3a">from_buffer_position</a>(cur_status.components.tail_position_) &lt;= buffer_size);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(reinterpret_cast&lt;char*&gt;(<a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af3ee5fbe4d4720e30375756b7fcbc0ad">buffers_</a>[0]) + buffer_size</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      == reinterpret_cast&lt;char*&gt;(<a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af3ee5fbe4d4720e30375756b7fcbc0ad">buffers_</a>[1]));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacefoedus_1_1snapshot.html#a499edf9829f41f833e2057346e8bbf3a">from_buffer_position</a>(cur_status.components.tail_position_) + required_size &gt; buffer_size) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      ReducerBufferStatus new_status = cur_status;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      new_status.components.flags_ |= <a class="code" href="namespacefoedus_1_1snapshot.html#a4f25261ad53b056011203342a22b40d0aff1acff80c35cb454d09cdd425e7f1a7">kFlagNoMoreWriters</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordflow">if</span> (!status_address-&gt;compare_exchange_strong(cur_status.word, new_status.word)) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">// if CAS fails, someone else might have already done it. retry</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="comment">// Buffer switch won&#39;t be that often, so we simply wait without waking up the reducer.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// okay, &quot;looks like&quot; we can append our log. make it sure with atomic CAS</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    ReducerBufferStatus new_status = cur_status;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    ++new_status.components.active_writers_;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    new_status.components.tail_position_ += <a class="code" href="namespacefoedus_1_1snapshot.html#a6ecb433ddae550c78d00cbbbdc510301">to_buffer_position</a>(required_size);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="namespacefoedus_1_1snapshot.html#a499edf9829f41f833e2057346e8bbf3a">from_buffer_position</a>(cur_status.components.tail_position_) &lt;= buffer_size);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (!status_address-&gt;compare_exchange_strong(cur_status.word, new_status.word)) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="comment">// someone else did something. retry</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// okay, we atomically reserved the space.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    begin_position = <a class="code" href="namespacefoedus_1_1snapshot.html#a499edf9829f41f833e2057346e8bbf3a">from_buffer_position</a>(cur_status.components.tail_position_);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// now start copying. this might take a few tens of microseconds if it&#39;s 1MB and on another</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// NUMA node.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordtype">void</span>* buffer = <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a01c6454d8099e0d74a325af05718dc12">get_buffer</a>(buffer_index);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  debugging::RdtscWatch copy_watch;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">char</span>* destination = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(buffer) + begin_position;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(begin_position + <span class="keyword">sizeof</span>(FullBlockHeader) + send_buffer_size</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    &lt;= <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">snapshot_</a>.<a class="code" href="structfoedus_1_1snapshot_1_1SnapshotOptions.html#a8a66eec37c6f549733a44d126785c591">log_reducer_buffer_mb_</a> * (1ULL &lt;&lt; 19));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  FullBlockHeader header;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  header.storage_id_ = storage_id;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  header.log_count_ = log_count;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  header.block_length_ = <a class="code" href="namespacefoedus_1_1snapshot.html#a6ecb433ddae550c78d00cbbbdc510301">to_buffer_position</a>(required_size);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  header.magic_word_ = <a class="code" href="structfoedus_1_1snapshot_1_1BlockHeaderBase.html#a697f96f550c7b60ea6e04cb69a5e8b82a849b43b33dbfa0c41fa4066017066ad1">BlockHeaderBase::kFullBlockHeaderMagicWord</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  header.shortest_key_length_ = shortest_key_length;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  header.longest_key_length_ = longest_key_length;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  std::memcpy(destination, &amp;header, <span class="keyword">sizeof</span>(FullBlockHeader));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  std::memcpy(destination + <span class="keyword">sizeof</span>(FullBlockHeader), send_buffer, send_buffer_size);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  copy_watch.stop();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  DVLOG(1) &lt;&lt; <span class="stringliteral">&quot;memcpy of &quot;</span> &lt;&lt; send_buffer_size &lt;&lt; <span class="stringliteral">&quot; bytes took &quot;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    &lt;&lt; copy_watch.elapsed() &lt;&lt; <span class="stringliteral">&quot; cycles&quot;</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">// done, let&#39;s decrement the active_writers_ to declare we are done.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    std::atomic&lt;uint64_t&gt;* status_address = <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a35ab8a50220c6e05a6c9685d74fd461c">get_buffer_status_address</a>(buffer_index);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    ReducerBufferStatus cur_status = <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a7c8feb59a8368bdae9ffea4b2e3fa8e8">get_buffer_status_atomic</a>(buffer_index);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    ReducerBufferStatus new_status = cur_status;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(new_status.components.active_writers_ &gt; 0);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    --new_status.components.active_writers_;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (!status_address-&gt;compare_exchange_strong(cur_status.word, new_status.word)) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="comment">// if CAS fails, someone else might have already done it. retry</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// okay, decremented. let&#39;s exit.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// Disabled. for now the reducer does spin. so no need for wakeup</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// if (new_status.components.active_writers_ == 0</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">//   &amp;&amp; (new_status.components.flags_ &amp; kFlagNoMoreWriters)) {</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">//   // if this was the last writer and the buffer was already closed for new writers,</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">//   // the reducer might be waiting for us. let&#39;s wake her up</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">//   thread_.wakeup();</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  stop_watch.stop();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  DVLOG(1) &lt;&lt; <span class="stringliteral">&quot;Completed appending a block of &quot;</span> &lt;&lt; send_buffer_size &lt;&lt; <span class="stringliteral">&quot; bytes to &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9bb712be85bef103cc9d1bb5f81ee6db">to_string</a>()</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&#39;s buffer for storage-&quot;</span> &lt;&lt; storage_id &lt;&lt; <span class="stringliteral">&quot; in &quot;</span> &lt;&lt; stop_watch.elapsed() &lt;&lt; <span class="stringliteral">&quot; cycles&quot;</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(reinterpret_cast&lt;FullBlockHeader*&gt;(destination)-&gt;is_full_block());</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(reinterpret_cast&lt;FullBlockHeader*&gt;(destination)-&gt;storage_id_ == storage_id);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(reinterpret_cast&lt;FullBlockHeader*&gt;(destination)-&gt;block_length_</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    == <a class="code" href="namespacefoedus_1_1snapshot.html#a6ecb433ddae550c78d00cbbbdc510301">to_buffer_position</a>(required_size));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_a35ab8a50220c6e05a6c9685d74fd461c"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a35ab8a50220c6e05a6c9685d74fd461c">foedus::snapshot::LogReducerControlBlock::get_buffer_status_address</a></div><div class="ttdeci">std::atomic&lt; uint64_t &gt; * get_buffer_status_address(uint32_t index)</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00181">log_reducer_impl.hpp:181</a></div></div>
<div class="ttc" id="namespacefoedus_1_1snapshot_html_a6ecb433ddae550c78d00cbbbdc510301"><div class="ttname"><a href="namespacefoedus_1_1snapshot.html#a6ecb433ddae550c78d00cbbbdc510301">foedus::snapshot::to_buffer_position</a></div><div class="ttdeci">BufferPosition to_buffer_position(uint64_t byte_position)</div><div class="ttdef"><b>Definition:</b> <a href="snapshot__id_8hpp_source.html#l00074">snapshot_id.hpp:74</a></div></div>
<div class="ttc" id="namespacefoedus_1_1snapshot_html_a4f25261ad53b056011203342a22b40d0aff1acff80c35cb454d09cdd425e7f1a7"><div class="ttname"><a href="namespacefoedus_1_1snapshot.html#a4f25261ad53b056011203342a22b40d0aff1acff80c35cb454d09cdd425e7f1a7">foedus::snapshot::kFlagNoMoreWriters</a></div><div class="ttdoc">A bit-wise flag in ReducerBufferStatus&#39;s flags_. </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00060">log_reducer_impl.hpp:60</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_a7c8feb59a8368bdae9ffea4b2e3fa8e8"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a7c8feb59a8368bdae9ffea4b2e3fa8e8">foedus::snapshot::LogReducerControlBlock::get_buffer_status_atomic</a></div><div class="ttdeci">ReducerBufferStatus get_buffer_status_atomic(uint32_t index) const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00176">log_reducer_impl.hpp:176</a></div></div>
<div class="ttc" id="namespacefoedus_1_1snapshot_html_a499edf9829f41f833e2057346e8bbf3a"><div class="ttname"><a href="namespacefoedus_1_1snapshot.html#a499edf9829f41f833e2057346e8bbf3a">foedus::snapshot::from_buffer_position</a></div><div class="ttdeci">uint64_t from_buffer_position(BufferPosition buffer_position)</div><div class="ttdef"><b>Definition:</b> <a href="snapshot__id_8hpp_source.html#l00078">snapshot_id.hpp:78</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_af3ee5fbe4d4720e30375756b7fcbc0ad"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af3ee5fbe4d4720e30375756b7fcbc0ad">foedus::snapshot::LogReducerRef::buffers_</a></div><div class="ttdeci">void * buffers_[2]</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00096">log_reducer_ref.hpp:96</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_af2b01584170849f37da7780d8480c7bd"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af2b01584170849f37da7780d8480c7bd">foedus::snapshot::LogReducerRef::get_current_buffer_index_atomic</a></div><div class="ttdeci">uint32_t get_current_buffer_index_atomic() const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8cpp_source.html#l00061">log_reducer_ref.cpp:61</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_ac8febbe3a3d3015c9b93cc1afb8154c1"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">foedus::EngineOptions::snapshot_</a></div><div class="ttdeci">snapshot::SnapshotOptions snapshot_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00143">engine_options.hpp:143</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a35a5c8c8ef82671b0d5b051fe8c45e7e"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">foedus::snapshot::LogReducerRef::control_block_</a></div><div class="ttdeci">LogReducerControlBlock * control_block_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00095">log_reducer_ref.hpp:95</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a9bb712be85bef103cc9d1bb5f81ee6db"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9bb712be85bef103cc9d1bb5f81ee6db">foedus::snapshot::LogReducerRef::to_string</a></div><div class="ttdeci">std::string to_string() const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8cpp_source.html#l00049">log_reducer_ref.cpp:49</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1SnapshotOptions_html_a8a66eec37c6f549733a44d126785c591"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1SnapshotOptions.html#a8a66eec37c6f549733a44d126785c591">foedus::snapshot::SnapshotOptions::log_reducer_buffer_mb_</a></div><div class="ttdeci">uint32_t log_reducer_buffer_mb_</div><div class="ttdoc">The size in MB of a buffer to store log entries in reducer (partition). </div><div class="ttdef"><b>Definition:</b> <a href="snapshot__options_8hpp_source.html#l00115">snapshot_options.hpp:115</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a3e0caf4a8a65cb0278425414b581cd9b"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a3e0caf4a8a65cb0278425414b581cd9b">foedus::snapshot::LogReducerRef::get_buffer_size</a></div><div class="ttdeci">uint64_t get_buffer_size() const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8cpp_source.html#l00065">log_reducer_ref.cpp:65</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1BlockHeaderBase_html_a697f96f550c7b60ea6e04cb69a5e8b82a849b43b33dbfa0c41fa4066017066ad1"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1BlockHeaderBase.html#a697f96f550c7b60ea6e04cb69a5e8b82a849b43b33dbfa0c41fa4066017066ad1">foedus::snapshot::BlockHeaderBase::kFullBlockHeaderMagicWord</a></div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00096">log_reducer_impl.hpp:96</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a01c6454d8099e0d74a325af05718dc12"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a01c6454d8099e0d74a325af05718dc12">foedus::snapshot::LogReducerRef::get_buffer</a></div><div class="ttdeci">void * get_buffer(uint32_t index) const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8cpp_source.html#l00071">log_reducer_ref.cpp:71</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a493bf984062f2615c6788b4c4f6b36df"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a493bf984062f2615c6788b4c4f6b36df">foedus::snapshot::LogReducerRef::verify_log_chunk</a></div><div class="ttdeci">bool verify_log_chunk(storage::StorageId storage_id, const char *send_buffer, uint32_t log_count, uint64_t send_buffer_size) const </div><div class="ttdoc">used only in debug mode </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8cpp_source.html#l00082">log_reducer_ref.cpp:82</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a9db563f9ba8f57f14354b1b1858485e3"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">foedus::snapshot::LogReducerRef::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00094">log_reducer_ref.hpp:94</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a4ea0f6f073f92ff447cc34429adafbda_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a4ea0f6f073f92ff447cc34429adafbda_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a4ea0f6f073f92ff447cc34429adafbda_cgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a4ea0f6f073f92ff447cc34429adafbda_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1debugging_1_1RdtscWatch.html#afc5d436b00dfd6af4727e4975e84aa75" title="foedus::debugging::\lRdtscWatch::elapsed" alt="" coords="535,10,682,51"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1snapshot.html#a499edf9829f41f833e2057346e8bbf3a" title="foedus::snapshot::from\l_buffer_position" alt="" coords="274,308,429,350"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a01c6454d8099e0d74a325af05718dc12" title="foedus::snapshot::LogReducer\lRef::get_buffer" alt="" coords="252,614,451,655"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a3e0caf4a8a65cb0278425414b581cd9b" title="foedus::snapshot::LogReducer\lRef::get_buffer_size" alt="" coords="252,796,451,838"/>
<area shape="rect" id="node10" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="541,803,676,844"/>
<area shape="rect" id="node11" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a35ab8a50220c6e05a6c9685d74fd461c" title="foedus::snapshot::LogReducer\lControlBlock::get_buffer\l_status_address" alt="" coords="252,862,451,918"/>
<area shape="rect" id="node12" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a7c8feb59a8368bdae9ffea4b2e3fa8e8" title="foedus::snapshot::LogReducer\lControlBlock::get_buffer\l_status_atomic" alt="" coords="252,942,451,998"/>
<area shape="rect" id="node13" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#af2b01584170849f37da7780d8480c7bd" title="foedus::snapshot::LogReducer\lRef::get_current_buffer\l_index_atomic" alt="" coords="252,1022,451,1078"/>
<area shape="rect" id="node14" href="classfoedus_1_1debugging_1_1RdtscWatch.html#a0f5961269d79e636777d722ade37dd2e" title="Take another current time tick. " alt="" coords="284,75,419,116"/>
<area shape="rect" id="node16" href="namespacefoedus_1_1snapshot.html#a6ecb433ddae550c78d00cbbbdc510301" title="foedus::snapshot::to\l_buffer_position" alt="" coords="281,1103,421,1144"/>
<area shape="rect" id="node17" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9bb712be85bef103cc9d1bb5f81ee6db" title="foedus::snapshot::LogReducer\lRef::to_string" alt="" coords="252,679,451,720"/>
<area shape="rect" id="node18" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a493bf984062f2615c6788b4c4f6b36df" title="used only in debug mode " alt="" coords="252,374,451,415"/>
<area shape="rect" id="node5" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="792,607,927,648"/>
<area shape="rect" id="node6" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="769,520,949,562"/>
<area shape="rect" id="node7" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e5d1a0a78c66ac6e1c8ef166d2965c3" title="foedus::soc::SharedMemory\lRepo::get_node_memory_anchors" alt="" coords="499,672,719,714"/>
<area shape="rect" id="node8" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#ab473882f640fcd29c56af54ffb9957a1" title="foedus::snapshot::LogReducer\lRef::get_id" alt="" coords="509,738,708,779"/>
<area shape="rect" id="node15" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="541,75,676,116"/>
<area shape="rect" id="node19" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#aa4a57d52ef10b270b50d0e00511b24e5" title="foedus::snapshot::LogReducer\lRef::get_cur_snapshot" alt="" coords="509,308,708,350"/>
<area shape="rect" id="node21" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="531,192,686,218"/>
<area shape="rect" id="node22" href="structfoedus_1_1log_1_1LogHeader.html#a6ebe3b99442f2a58a4adeeb60f9a37e0" title="Convenience method to cast into LogCode. " alt="" coords="782,152,937,194"/>
<area shape="rect" id="node23" href="structfoedus_1_1log_1_1LogHeader.html#ab54b6d5754b5543e7de5b49c6c317499" title="Convenience method to get LogCodeKind. " alt="" coords="531,243,686,284"/>
<area shape="rect" id="node25" href="structfoedus_1_1xct_1_1XctId.html#a449da7fea452dd81c194f94b28e7a7e2" title="foedus::xct::XctId\l::is_valid" alt="" coords="547,439,670,480"/>
<area shape="rect" id="node27" href="structfoedus_1_1xct_1_1XctId.html#a936888dbc82de6e76194b72c28c9a10f" title="foedus::xct::XctId\l::get_ordinal" alt="" coords="547,374,670,415"/>
<area shape="rect" id="node28" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="547,504,670,546"/>
<area shape="rect" id="node20" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb" title="foedus::soc::SharedMemory\lRepo::get_global_memory\l_anchors" alt="" coords="767,305,952,361"/>
<area shape="rect" id="node24" href="group__LOGTYPE.html#gaa283974b1bc0fdbf11e034f8a11c4b9c" title="Returns the kind of the given log code. " alt="" coords="792,239,927,280"/>
<area shape="rect" id="node26" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="798,444,921,486"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a88d4e8aef4ca07ffe0bc59610335f136"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::snapshot::LogReducerRef::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00053">53</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="log__reducer__impl_8hpp_source.html#l00167">foedus::snapshot::LogReducerControlBlock::clear()</a>, and <a class="el" href="log__reducer__ref_8hpp_source.html#l00095">control_block_</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                          {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a10138591711bd165e6605de2b9d43b10">clear</a>();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a35a5c8c8ef82671b0d5b051fe8c45e7e"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">foedus::snapshot::LogReducerRef::control_block_</a></div><div class="ttdeci">LogReducerControlBlock * control_block_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00095">log_reducer_ref.hpp:95</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_a10138591711bd165e6605de2b9d43b10"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a10138591711bd165e6605de2b9d43b10">foedus::snapshot::LogReducerControlBlock::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00167">log_reducer_impl.hpp:167</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a88d4e8aef4ca07ffe0bc59610335f136_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a88d4e8aef4ca07ffe0bc59610335f136_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a88d4e8aef4ca07ffe0bc59610335f136_cgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a88d4e8aef4ca07ffe0bc59610335f136_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a10138591711bd165e6605de2b9d43b10" title="foedus::snapshot::LogReducer\lControlBlock::clear" alt="" coords="252,5,451,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a01c6454d8099e0d74a325af05718dc12"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void * foedus::snapshot::LogReducerRef::get_buffer </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00071">71</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="log__reducer__ref_8hpp_source.html#l00094">engine_</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00046">get_id()</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00521">foedus::soc::SharedMemoryRepo::get_node_memory_anchors()</a>, <a class="el" href="soc__manager_8cpp_source.html#l00038">foedus::soc::SocManager::get_shared_memory_repo()</a>, <a class="el" href="engine_8cpp_source.html#l00059">foedus::Engine::get_soc_manager()</a>, and <a class="el" href="shared__memory__repo_8hpp_source.html#l00373">foedus::soc::NodeMemoryAnchors::log_reducer_buffers_</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00121">append_log_chunk()</a>.</p>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                                          {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  soc::NodeMemoryAnchors* anchors</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    = <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e">get_soc_manager</a>()-&gt;<a class="code" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c">get_shared_memory_repo</a>()-&gt;<a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e5d1a0a78c66ac6e1c8ef166d2965c3">get_node_memory_anchors</a>(<a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#ab473882f640fcd29c56af54ffb9957a1">get_id</a>());</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">return</span> anchors-&gt;<a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a451156830bcc4ab7c0db05e984410823">log_reducer_buffers_</a>[index % 2];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_a2e5d1a0a78c66ac6e1c8ef166d2965c3"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e5d1a0a78c66ac6e1c8ef166d2965c3">foedus::soc::SharedMemoryRepo::get_node_memory_anchors</a></div><div class="ttdeci">NodeMemoryAnchors * get_node_memory_anchors(SocId node)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00521">shared_memory_repo.hpp:521</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_a451156830bcc4ab7c0db05e984410823"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a451156830bcc4ab7c0db05e984410823">foedus::soc::NodeMemoryAnchors::log_reducer_buffers_</a></div><div class="ttdeci">void * log_reducer_buffers_[2]</div><div class="ttdoc">Actual buffers for LogReducer. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00373">shared_memory_repo.hpp:373</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_ab473882f640fcd29c56af54ffb9957a1"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#ab473882f640fcd29c56af54ffb9957a1">foedus::snapshot::LogReducerRef::get_id</a></div><div class="ttdeci">uint16_t get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8cpp_source.html#l00046">log_reducer_ref.cpp:46</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_ae9ad7ab6a3df52b0e9f0e50ede6faa2e"><div class="ttname"><a href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e">foedus::Engine::get_soc_manager</a></div><div class="ttdeci">soc::SocManager * get_soc_manager() const </div><div class="ttdoc">See SOC and IPC. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00059">engine.cpp:59</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a9db563f9ba8f57f14354b1b1858485e3"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">foedus::snapshot::LogReducerRef::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00094">log_reducer_ref.hpp:94</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SocManager_html_a627cf434892c441c90c2de7c20637e9c"><div class="ttname"><a href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c">foedus::soc::SocManager::get_shared_memory_repo</a></div><div class="ttdeci">SharedMemoryRepo * get_shared_memory_repo()</div><div class="ttdoc">Returns the shared memories maintained across SOCs. </div><div class="ttdef"><b>Definition:</b> <a href="soc__manager_8cpp_source.html#l00038">soc_manager.cpp:38</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a01c6454d8099e0d74a325af05718dc12_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a01c6454d8099e0d74a325af05718dc12_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a01c6454d8099e0d74a325af05718dc12_cgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a01c6454d8099e0d74a325af05718dc12_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#ab473882f640fcd29c56af54ffb9957a1" title="foedus::snapshot::LogReducer\lRef::get_id" alt="" coords="263,5,461,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e5d1a0a78c66ac6e1c8ef166d2965c3" title="foedus::soc::SharedMemory\lRepo::get_node_memory_anchors" alt="" coords="252,71,472,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="272,136,452,177"/>
<area shape="rect" id="node5" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="295,201,429,243"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a01c6454d8099e0d74a325af05718dc12_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a01c6454d8099e0d74a325af05718dc12_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a01c6454d8099e0d74a325af05718dc12_icgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a01c6454d8099e0d74a325af05718dc12_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a4ea0f6f073f92ff447cc34429adafbda" title="Append the log entries of one storage in the given buffer to this reducer&#39;s buffer. " alt="" coords="252,5,451,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3e0caf4a8a65cb0278425414b581cd9b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::snapshot::LogReducerRef::get_buffer_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00065">65</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="log__reducer__ref_8hpp_source.html#l00094">engine_</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="snapshot__options_8hpp_source.html#l00115">foedus::snapshot::SnapshotOptions::log_reducer_buffer_mb_</a>, and <a class="el" href="engine__options_8hpp_source.html#l00143">foedus::EngineOptions::snapshot_</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00121">append_log_chunk()</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                                 {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">// the value is in total of two buffers. (&lt;&lt; 20) / 2 == &lt;&lt; 19</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(<a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">snapshot_</a>.<a class="code" href="structfoedus_1_1snapshot_1_1SnapshotOptions.html#a8a66eec37c6f549733a44d126785c591">log_reducer_buffer_mb_</a>) &lt;&lt; 19;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_ac8febbe3a3d3015c9b93cc1afb8154c1"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">foedus::EngineOptions::snapshot_</a></div><div class="ttdeci">snapshot::SnapshotOptions snapshot_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00143">engine_options.hpp:143</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1SnapshotOptions_html_a8a66eec37c6f549733a44d126785c591"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1SnapshotOptions.html#a8a66eec37c6f549733a44d126785c591">foedus::snapshot::SnapshotOptions::log_reducer_buffer_mb_</a></div><div class="ttdeci">uint32_t log_reducer_buffer_mb_</div><div class="ttdoc">The size in MB of a buffer to store log entries in reducer (partition). </div><div class="ttdef"><b>Definition:</b> <a href="snapshot__options_8hpp_source.html#l00115">snapshot_options.hpp:115</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a9db563f9ba8f57f14354b1b1858485e3"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">foedus::snapshot::LogReducerRef::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00094">log_reducer_ref.hpp:94</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a3e0caf4a8a65cb0278425414b581cd9b_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a3e0caf4a8a65cb0278425414b581cd9b_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a3e0caf4a8a65cb0278425414b581cd9b_cgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a3e0caf4a8a65cb0278425414b581cd9b_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="252,5,387,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a3e0caf4a8a65cb0278425414b581cd9b_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a3e0caf4a8a65cb0278425414b581cd9b_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a3e0caf4a8a65cb0278425414b581cd9b_icgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a3e0caf4a8a65cb0278425414b581cd9b_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a4ea0f6f073f92ff447cc34429adafbda" title="Append the log entries of one storage in the given buffer to this reducer&#39;s buffer. " alt="" coords="252,5,451,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa4a57d52ef10b270b50d0e00511b24e5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structfoedus_1_1snapshot_1_1Snapshot.html">Snapshot</a> &amp; foedus::snapshot::LogReducerRef::get_cur_snapshot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00077">77</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="log__reducer__ref_8hpp_source.html#l00094">engine_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00514">foedus::soc::SharedMemoryRepo::get_global_memory_anchors()</a>, <a class="el" href="soc__manager_8cpp_source.html#l00038">foedus::soc::SocManager::get_shared_memory_repo()</a>, and <a class="el" href="engine_8cpp_source.html#l00059">foedus::Engine::get_soc_manager()</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00082">verify_log_chunk()</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                                      {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e">get_soc_manager</a>()-&gt;<a class="code" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c">get_shared_memory_repo</a>()-&gt;<a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb">get_global_memory_anchors</a>()-&gt;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    snapshot_manager_memory_-&gt;gleaner_.cur_snapshot_;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_a1c21cc6a27cabaf4a8c9dc26985aacfb"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb">foedus::soc::SharedMemoryRepo::get_global_memory_anchors</a></div><div class="ttdeci">GlobalMemoryAnchors * get_global_memory_anchors()</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00514">shared_memory_repo.hpp:514</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_ae9ad7ab6a3df52b0e9f0e50ede6faa2e"><div class="ttname"><a href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e">foedus::Engine::get_soc_manager</a></div><div class="ttdeci">soc::SocManager * get_soc_manager() const </div><div class="ttdoc">See SOC and IPC. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00059">engine.cpp:59</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a9db563f9ba8f57f14354b1b1858485e3"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9db563f9ba8f57f14354b1b1858485e3">foedus::snapshot::LogReducerRef::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00094">log_reducer_ref.hpp:94</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SocManager_html_a627cf434892c441c90c2de7c20637e9c"><div class="ttname"><a href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c">foedus::soc::SocManager::get_shared_memory_repo</a></div><div class="ttdeci">SharedMemoryRepo * get_shared_memory_repo()</div><div class="ttdoc">Returns the shared memories maintained across SOCs. </div><div class="ttdef"><b>Definition:</b> <a href="soc__manager_8cpp_source.html#l00038">soc_manager.cpp:38</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_aa4a57d52ef10b270b50d0e00511b24e5_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_aa4a57d52ef10b270b50d0e00511b24e5_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_aa4a57d52ef10b270b50d0e00511b24e5_cgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_aa4a57d52ef10b270b50d0e00511b24e5_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb" title="foedus::soc::SharedMemory\lRepo::get_global_memory\l_anchors" alt="" coords="252,5,437,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="255,86,435,127"/>
<area shape="rect" id="node4" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="277,151,412,193"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_aa4a57d52ef10b270b50d0e00511b24e5_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_aa4a57d52ef10b270b50d0e00511b24e5_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_aa4a57d52ef10b270b50d0e00511b24e5_icgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_aa4a57d52ef10b270b50d0e00511b24e5_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a493bf984062f2615c6788b4c4f6b36df" title="used only in debug mode " alt="" coords="252,5,451,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a4ea0f6f073f92ff447cc34429adafbda" title="Append the log entries of one storage in the given buffer to this reducer&#39;s buffer. " alt="" coords="499,5,697,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af2b01584170849f37da7780d8480c7bd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::snapshot::LogReducerRef::get_current_buffer_index_atomic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00061">61</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="log__reducer__ref_8hpp_source.html#l00095">control_block_</a>, and <a class="el" href="log__reducer__impl_8hpp_source.html#l00202">foedus::snapshot::LogReducerControlBlock::current_buffer_</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00121">append_log_chunk()</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                                                 {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a2e5f8d0f9222e8c716b74edff4afe3b7">current_buffer_</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_a2e5f8d0f9222e8c716b74edff4afe3b7"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a2e5f8d0f9222e8c716b74edff4afe3b7">foedus::snapshot::LogReducerControlBlock::current_buffer_</a></div><div class="ttdeci">std::atomic&lt; uint32_t &gt; current_buffer_</div><div class="ttdoc">buffers_[current_buffer_ % 2] is the buffer mappers should append to. </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00202">log_reducer_impl.hpp:202</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a35a5c8c8ef82671b0d5b051fe8c45e7e"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">foedus::snapshot::LogReducerRef::control_block_</a></div><div class="ttdeci">LogReducerControlBlock * control_block_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00095">log_reducer_ref.hpp:95</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_af2b01584170849f37da7780d8480c7bd_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_af2b01584170849f37da7780d8480c7bd_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_af2b01584170849f37da7780d8480c7bd_icgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_af2b01584170849f37da7780d8480c7bd_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a4ea0f6f073f92ff447cc34429adafbda" title="Append the log entries of one storage in the given buffer to this reducer&#39;s buffer. " alt="" coords="252,13,451,54"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab473882f640fcd29c56af54ffb9957a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t foedus::snapshot::LogReducerRef::get_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00046">46</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="log__reducer__ref_8hpp_source.html#l00095">control_block_</a>, and <a class="el" href="log__reducer__impl_8hpp_source.html#l00212">foedus::snapshot::LogReducerControlBlock::id_</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00071">get_buffer()</a>, and <a class="el" href="log__reducer__ref_8cpp_source.html#l00049">to_string()</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                        {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#af2a537aa1d0ef7b0c08d9f9c736e1cab">id_</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a35a5c8c8ef82671b0d5b051fe8c45e7e"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">foedus::snapshot::LogReducerRef::control_block_</a></div><div class="ttdeci">LogReducerControlBlock * control_block_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00095">log_reducer_ref.hpp:95</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_af2a537aa1d0ef7b0c08d9f9c736e1cab"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#af2a537aa1d0ef7b0c08d9f9c736e1cab">foedus::snapshot::LogReducerControlBlock::id_</a></div><div class="ttdeci">uint16_t id_</div><div class="ttdoc">ID of this reducer (or numa node ID). </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00212">log_reducer_impl.hpp:212</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_ab473882f640fcd29c56af54ffb9957a1_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_ab473882f640fcd29c56af54ffb9957a1_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_ab473882f640fcd29c56af54ffb9957a1_icgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_ab473882f640fcd29c56af54ffb9957a1_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a01c6454d8099e0d74a325af05718dc12" title="foedus::snapshot::LogReducer\lRef::get_buffer" alt="" coords="252,5,451,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a9bb712be85bef103cc9d1bb5f81ee6db" title="foedus::snapshot::LogReducer\lRef::to_string" alt="" coords="252,71,451,112"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a4ea0f6f073f92ff447cc34429adafbda" title="Append the log entries of one storage in the given buffer to this reducer&#39;s buffer. " alt="" coords="499,39,697,80"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acd6cedd726ef9991558e7460f6eb06b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* foedus::snapshot::LogReducerRef::get_root_info_pages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8hpp_source.html#l00055">55</a> of file <a class="el" href="log__reducer__ref_8hpp_source.html">log_reducer_ref.hpp</a>.</p>

<p>References <a class="el" href="log__reducer__ref_8hpp_source.html#l00097">root_info_pages_</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a6175a1ff4a6f9020a421e4114335d254">root_info_pages_</a>; }</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a6175a1ff4a6f9020a421e4114335d254"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a6175a1ff4a6f9020a421e4114335d254">foedus::snapshot::LogReducerRef::root_info_pages_</a></div><div class="ttdeci">storage::Page * root_info_pages_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00097">log_reducer_ref.hpp:97</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abdc2218c6d4914cf5e1395413c1c8d75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::snapshot::LogReducerRef::get_total_storage_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00057">57</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="log__reducer__ref_8hpp_source.html#l00095">control_block_</a>, and <a class="el" href="log__reducer__impl_8hpp_source.html#l00209">foedus::snapshot::LogReducerControlBlock::total_storage_count_</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                                      {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a54a1ec2612036dcdfa7513949eb861ff">total_storage_count_</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_a35a5c8c8ef82671b0d5b051fe8c45e7e"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a35a5c8c8ef82671b0d5b051fe8c45e7e">foedus::snapshot::LogReducerRef::control_block_</a></div><div class="ttdeci">LogReducerControlBlock * control_block_</div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8hpp_source.html#l00095">log_reducer_ref.hpp:95</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1LogReducerControlBlock_html_a54a1ec2612036dcdfa7513949eb861ff"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html#a54a1ec2612036dcdfa7513949eb861ff">foedus::snapshot::LogReducerControlBlock::total_storage_count_</a></div><div class="ttdeci">std::atomic&lt; uint32_t &gt; total_storage_count_</div><div class="ttdoc">Set at the end of merge_sort(). </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__impl_8hpp_source.html#l00209">log_reducer_impl.hpp:209</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9bb712be85bef103cc9d1bb5f81ee6db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string foedus::snapshot::LogReducerRef::to_string </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00049">49</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="log__reducer__ref_8cpp_source.html#l00046">get_id()</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00121">append_log_chunk()</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                         {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;LogReducer-&quot;</span>) + std::to_string(<a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#ab473882f640fcd29c56af54ffb9957a1">get_id</a>());</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_ab473882f640fcd29c56af54ffb9957a1"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#ab473882f640fcd29c56af54ffb9957a1">foedus::snapshot::LogReducerRef::get_id</a></div><div class="ttdeci">uint16_t get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8cpp_source.html#l00046">log_reducer_ref.cpp:46</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a9bb712be85bef103cc9d1bb5f81ee6db_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a9bb712be85bef103cc9d1bb5f81ee6db_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a9bb712be85bef103cc9d1bb5f81ee6db_cgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a9bb712be85bef103cc9d1bb5f81ee6db_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#ab473882f640fcd29c56af54ffb9957a1" title="foedus::snapshot::LogReducer\lRef::get_id" alt="" coords="252,5,451,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a9bb712be85bef103cc9d1bb5f81ee6db_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a9bb712be85bef103cc9d1bb5f81ee6db_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a9bb712be85bef103cc9d1bb5f81ee6db_icgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a9bb712be85bef103cc9d1bb5f81ee6db_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a4ea0f6f073f92ff447cc34429adafbda" title="Append the log entries of one storage in the given buffer to this reducer&#39;s buffer. " alt="" coords="252,5,451,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a493bf984062f2615c6788b4c4f6b36df"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::snapshot::LogReducerRef::verify_log_chunk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">storage::StorageId</a>&#160;</td>
          <td class="paramname"><em>storage_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>send_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>log_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>send_buffer_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>used only in debug mode </p>

<p>Definition at line <a class="el" href="log__reducer__ref_8cpp_source.html#l00082">82</a> of file <a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="snapshot_8hpp_source.html#l00049">foedus::snapshot::Snapshot::base_epoch_</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00077">get_cur_snapshot()</a>, <a class="el" href="xct__id_8hpp_source.html#l00964">foedus::xct::XctId::get_epoch()</a>, <a class="el" href="common__log__types_8hpp_source.html#l00080">foedus::log::LogHeader::get_kind()</a>, <a class="el" href="xct__id_8hpp_source.html#l00976">foedus::xct::XctId::get_ordinal()</a>, <a class="el" href="common__log__types_8hpp_source.html#l00078">foedus::log::LogHeader::get_type()</a>, <a class="el" href="common__log__types_8hpp_source.html#l00113">foedus::log::BaseLogType::header_</a>, <a class="el" href="snapshot_8hpp_source.html#l00043">foedus::snapshot::Snapshot::id_</a>, <a class="el" href="epoch_8hpp_source.html#l00096">foedus::Epoch::is_valid()</a>, <a class="el" href="xct__id_8hpp_source.html#l00973">foedus::xct::XctId::is_valid()</a>, <a class="el" href="log__type_8hpp_source.html#l00112">foedus::log::kLogCodeEpochMarker</a>, <a class="el" href="log__type_8hpp_source.html#l00111">foedus::log::kLogCodeFiller</a>, <a class="el" href="log__type_8hpp_source.html#l00089">foedus::log::kLogCodeInvalid</a>, <a class="el" href="snapshot__id_8hpp_source.html#l00045">foedus::snapshot::kNullSnapshotId</a>, <a class="el" href="log__type_8hpp_source.html#l00103">foedus::log::kRecordLogs</a>, <a class="el" href="common__log__types_8hpp_source.html#l00061">foedus::log::LogHeader::log_length_</a>, <a class="el" href="snapshot_8hpp_source.html#l00058">foedus::snapshot::Snapshot::max_storage_id_</a>, <a class="el" href="common__log__types_8hpp_source.html#l00066">foedus::log::LogHeader::storage_id_</a>, <a class="el" href="snapshot_8hpp_source.html#l00055">foedus::snapshot::Snapshot::valid_until_epoch_</a>, and <a class="el" href="common__log__types_8hpp_source.html#l00075">foedus::log::LogHeader::xct_id_</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00121">append_log_chunk()</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                   {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  uint32_t real_log_count = 0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  uint64_t cur = 0;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">const</span> Snapshot&amp; cur_snapshot = <a class="code" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#aa4a57d52ef10b270b50d0e00511b24e5">get_cur_snapshot</a>();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur_snapshot.id_ != <a class="code" href="namespacefoedus_1_1snapshot.html#a26a2120f7b28c565f2d22ff799ee2280">kNullSnapshotId</a>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur_snapshot.valid_until_epoch_.is_valid());</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur_snapshot.max_storage_id_ &gt; 0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur_snapshot.max_storage_id_ &gt;= storage_id);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">while</span> (cur &lt; send_buffer_size) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">const</span> log::BaseLogType* entry = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>log::BaseLogType*<span class="keyword">&gt;</span>(send_buffer + cur);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="group__LOGTYPE.html#gafeea30298c4f7a9586bddec3663fc4f3">log::LogCode</a> type = entry-&gt;header_.get_type();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="group__LOGTYPE.html#ga05e31670e673d9327598ed59829d7504">log::LogCodeKind</a> kind = entry-&gt;header_.get_kind();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(type != <a class="code" href="namespacefoedus_1_1log.html#gafeea30298c4f7a9586bddec3663fc4f3a1b142fb931718a7481c4ceb54636202e">log::kLogCodeInvalid</a>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(type != <a class="code" href="namespacefoedus_1_1log.html#gafeea30298c4f7a9586bddec3663fc4f3a2a91facdca74b0ec869ccdc6ca4edb14">log::kLogCodeEpochMarker</a>);  <span class="comment">// should have been skipped in mapper.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(entry-&gt;header_.log_length_ &gt; 0);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(entry-&gt;header_.log_length_ % 8 == 0);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    cur += entry-&gt;header_.log_length_;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    ++real_log_count;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (type == <a class="code" href="namespacefoedus_1_1log.html#gafeea30298c4f7a9586bddec3663fc4f3a3d7f18ba1071b16b4b627e206dbeda90">log::kLogCodeFiller</a>) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(entry-&gt;header_.storage_id_ == storage_id);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(entry-&gt;header_.xct_id_.is_valid());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(entry-&gt;header_.xct_id_.get_ordinal() &gt; 0);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(kind == <a class="code" href="namespacefoedus_1_1log.html#ga05e31670e673d9327598ed59829d7504ab48324580d80a3bcba2de48a308b80b5">log::kRecordLogs</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      Epoch epoch = entry-&gt;header_.xct_id_.get_epoch();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!cur_snapshot.base_epoch_.is_valid() || epoch &gt; cur_snapshot.base_epoch_);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(epoch &lt;= cur_snapshot.valid_until_epoch_);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(real_log_count == log_count);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur == send_buffer_size);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
<div class="ttc" id="group__LOGTYPE_html_gafeea30298c4f7a9586bddec3663fc4f3"><div class="ttname"><a href="group__LOGTYPE.html#gafeea30298c4f7a9586bddec3663fc4f3">foedus::log::LogCode</a></div><div class="ttdeci">LogCode</div><div class="ttdoc">A unique identifier of all log types. </div><div class="ttdef"><b>Definition:</b> <a href="log__type_8hpp_source.html#l00087">log_type.hpp:87</a></div></div>
<div class="ttc" id="group__LOGTYPE_html_ga05e31670e673d9327598ed59829d7504"><div class="ttname"><a href="group__LOGTYPE.html#ga05e31670e673d9327598ed59829d7504">foedus::log::LogCodeKind</a></div><div class="ttdeci">LogCodeKind</div><div class="ttdoc">Represents the kind of log types. </div><div class="ttdef"><b>Definition:</b> <a href="log__type_8hpp_source.html#l00101">log_type.hpp:101</a></div></div>
<div class="ttc" id="namespacefoedus_1_1log_html_ga05e31670e673d9327598ed59829d7504ab48324580d80a3bcba2de48a308b80b5"><div class="ttname"><a href="namespacefoedus_1_1log.html#ga05e31670e673d9327598ed59829d7504ab48324580d80a3bcba2de48a308b80b5">foedus::log::kRecordLogs</a></div><div class="ttdoc">record targetted logs </div><div class="ttdef"><b>Definition:</b> <a href="log__type_8hpp_source.html#l00103">log_type.hpp:103</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1LogReducerRef_html_aa4a57d52ef10b270b50d0e00511b24e5"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1LogReducerRef.html#aa4a57d52ef10b270b50d0e00511b24e5">foedus::snapshot::LogReducerRef::get_cur_snapshot</a></div><div class="ttdeci">const Snapshot &amp; get_cur_snapshot() const </div><div class="ttdef"><b>Definition:</b> <a href="log__reducer__ref_8cpp_source.html#l00077">log_reducer_ref.cpp:77</a></div></div>
<div class="ttc" id="namespacefoedus_1_1snapshot_html_a26a2120f7b28c565f2d22ff799ee2280"><div class="ttname"><a href="namespacefoedus_1_1snapshot.html#a26a2120f7b28c565f2d22ff799ee2280">foedus::snapshot::kNullSnapshotId</a></div><div class="ttdeci">const SnapshotId kNullSnapshotId</div><div class="ttdef"><b>Definition:</b> <a href="snapshot__id_8hpp_source.html#l00045">snapshot_id.hpp:45</a></div></div>
<div class="ttc" id="namespacefoedus_1_1log_html_gafeea30298c4f7a9586bddec3663fc4f3a1b142fb931718a7481c4ceb54636202e"><div class="ttname"><a href="namespacefoedus_1_1log.html#gafeea30298c4f7a9586bddec3663fc4f3a1b142fb931718a7481c4ceb54636202e">foedus::log::kLogCodeInvalid</a></div><div class="ttdoc">0 is reserved as a non-existing log type. </div><div class="ttdef"><b>Definition:</b> <a href="log__type_8hpp_source.html#l00089">log_type.hpp:89</a></div></div>
<div class="ttc" id="namespacefoedus_1_1log_html_gafeea30298c4f7a9586bddec3663fc4f3a3d7f18ba1071b16b4b627e206dbeda90"><div class="ttname"><a href="namespacefoedus_1_1log.html#gafeea30298c4f7a9586bddec3663fc4f3a3d7f18ba1071b16b4b627e206dbeda90">foedus::log::kLogCodeFiller</a></div><div class="ttdoc">0x3001 : foedus::log::FillerLogType . </div><div class="ttdef"><b>Definition:</b> <a href="log__type_8hpp_source.html#l00111">log_type.hpp:111</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="namespacefoedus_1_1log_html_gafeea30298c4f7a9586bddec3663fc4f3a2a91facdca74b0ec869ccdc6ca4edb14"><div class="ttname"><a href="namespacefoedus_1_1log.html#gafeea30298c4f7a9586bddec3663fc4f3a2a91facdca74b0ec869ccdc6ca4edb14">foedus::log::kLogCodeEpochMarker</a></div><div class="ttdoc">0x3002 : foedus::log::EpochMarkerLogType . </div><div class="ttdef"><b>Definition:</b> <a href="log__type_8hpp_source.html#l00112">log_type.hpp:112</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a493bf984062f2615c6788b4c4f6b36df_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a493bf984062f2615c6788b4c4f6b36df_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a493bf984062f2615c6788b4c4f6b36df_cgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a493bf984062f2615c6788b4c4f6b36df_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#aa4a57d52ef10b270b50d0e00511b24e5" title="foedus::snapshot::LogReducer\lRef::get_cur_snapshot" alt="" coords="252,119,451,161"/>
<area shape="rect" id="node6" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="290,334,413,375"/>
<area shape="rect" id="node8" href="structfoedus_1_1log_1_1LogHeader.html#ab54b6d5754b5543e7de5b49c6c317499" title="Convenience method to get LogCodeKind. " alt="" coords="274,217,429,258"/>
<area shape="rect" id="node10" href="structfoedus_1_1log_1_1LogHeader.html#a6ebe3b99442f2a58a4adeeb60f9a37e0" title="Convenience method to cast into LogCode. " alt="" coords="514,282,669,323"/>
<area shape="rect" id="node11" href="structfoedus_1_1xct_1_1XctId.html#a936888dbc82de6e76194b72c28c9a10f" title="foedus::xct::XctId\l::get_ordinal" alt="" coords="290,399,413,441"/>
<area shape="rect" id="node12" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="274,465,429,492"/>
<area shape="rect" id="node13" href="structfoedus_1_1xct_1_1XctId.html#a449da7fea452dd81c194f94b28e7a7e2" title="foedus::xct::XctId\l::is_valid" alt="" coords="290,517,413,558"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb" title="foedus::soc::SharedMemory\lRepo::get_global_memory\l_anchors" alt="" coords="499,5,684,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="501,86,681,127"/>
<area shape="rect" id="node5" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="524,151,659,193"/>
<area shape="rect" id="node7" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="530,433,653,474"/>
<area shape="rect" id="node9" href="group__LOGTYPE.html#gaa283974b1bc0fdbf11e034f8a11c4b9c" title="Returns the kind of the given log code. " alt="" coords="524,217,659,258"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1LogReducerRef_a493bf984062f2615c6788b4c4f6b36df_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1LogReducerRef_a493bf984062f2615c6788b4c4f6b36df_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1LogReducerRef_a493bf984062f2615c6788b4c4f6b36df_icgraph" id="classfoedus_1_1snapshot_1_1LogReducerRef_a493bf984062f2615c6788b4c4f6b36df_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a4ea0f6f073f92ff447cc34429adafbda" title="Append the log entries of one storage in the given buffer to this reducer&#39;s buffer. " alt="" coords="252,5,451,47"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a8576edaceffaf41744f66b27aa51c60a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html">LogReducerRef</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="af3ee5fbe4d4720e30375756b7fcbc0ad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* foedus::snapshot::LogReducerRef::buffers_[2]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8hpp_source.html#l00096">96</a> of file <a class="el" href="log__reducer__ref_8hpp_source.html">log_reducer_ref.hpp</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00121">append_log_chunk()</a>, and <a class="el" href="log__reducer__ref_8hpp_source.html#l00042">LogReducerRef()</a>.</p>

</div>
</div>
<a class="anchor" id="a35a5c8c8ef82671b0d5b051fe8c45e7e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1snapshot_1_1LogReducerControlBlock.html">LogReducerControlBlock</a>* foedus::snapshot::LogReducerRef::control_block_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8hpp_source.html#l00095">95</a> of file <a class="el" href="log__reducer__ref_8hpp_source.html">log_reducer_ref.hpp</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00121">append_log_chunk()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00053">clear()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00061">get_current_buffer_index_atomic()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00046">get_id()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00057">get_total_storage_count()</a>, and <a class="el" href="log__reducer__ref_8hpp_source.html#l00042">LogReducerRef()</a>.</p>

</div>
</div>
<a class="anchor" id="a9db563f9ba8f57f14354b1b1858485e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1Engine.html">Engine</a>* foedus::snapshot::LogReducerRef::engine_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8hpp_source.html#l00094">94</a> of file <a class="el" href="log__reducer__ref_8hpp_source.html">log_reducer_ref.hpp</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00121">append_log_chunk()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00071">get_buffer()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00065">get_buffer_size()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00077">get_cur_snapshot()</a>, and <a class="el" href="log__reducer__ref_8hpp_source.html#l00042">LogReducerRef()</a>.</p>

</div>
</div>
<a class="anchor" id="a6175a1ff4a6f9020a421e4114335d254"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* foedus::snapshot::LogReducerRef::root_info_pages_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="log__reducer__ref_8hpp_source.html#l00097">97</a> of file <a class="el" href="log__reducer__ref_8hpp_source.html">log_reducer_ref.hpp</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8hpp_source.html#l00055">get_root_info_pages()</a>, and <a class="el" href="log__reducer__ref_8hpp_source.html#l00042">LogReducerRef()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/snapshot/<a class="el" href="log__reducer__ref_8hpp_source.html">log_reducer_ref.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/snapshot/<a class="el" href="log__reducer__ref_8cpp_source.html">log_reducer_ref.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1snapshot.html">snapshot</a></li><li class="navelem"><a class="el" href="classfoedus_1_1snapshot_1_1LogReducerRef.html">LogReducerRef</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::assorted::ConstDiv Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('structfoedus_1_1assorted_1_1ConstDiv.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structfoedus_1_1assorted_1_1ConstDiv-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::assorted::ConstDiv Struct Reference<div class="ingroups"><a class="el" href="group__IDIOMS.html">FOEDUS Programming Idioms</a> &raquo; <a class="el" href="group__ASSORTED.html">Assorted Methods/Classes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The pre-calculated p-m pair for optimized integer division by constant.  
 <a href="structfoedus_1_1assorted_1_1ConstDiv.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The pre-calculated p-m pair for optimized integer division by constant. </p>
<p>This object implements the optimized integer division described in [HACKER] Chap 10. We assume the divisor is within 32bit and dividee is either 32bit or 64bit. This is a bit different assumption from existing library; libdivide.</p>
<h1><a class="anchor" id="USE"></a>
Usecases</h1>
<p>This is used in places where integer division by a constant integer is the bottleneck. So far the only such place is partitioning and array storage (<a class="el" href="group__ARRAY.html">Array Storage</a>). In read-only experiments on array storage, we did observe more than 20% overhead in std::lldiv(). It's a division by fan-out, so of course we can afford to pre-calculate <em>p</em> and <em>m</em>. Hence, we added this object.</p>
<h1><a class="anchor" id="EXAMPLE"></a>
Example</h1>
<p>For example, use it as follows. </p><div class="fragment"><div class="line"><a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#acf9493a290140aa915ad6a87b8f0f21c">ConstDiv</a> div(254);  <span class="comment">// to divide by constant 254. This object should be precalculated.</span></div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;0x12345678/254=&quot;</span> &lt;&lt; div.div32(0x12345678) &lt;&lt; std::endl;</div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;0x123456789ABCDEF/254=&quot;</span> &lt;&lt; div.div64(0x123456789ABCDEFULL) &lt;&lt; std::endl;</div>
</div><!-- fragment --><h1><a class="anchor" id="ETC"></a>
Etc</h1>
<p>This object is totally header-only. This object is totally immutable, so . This object is POD and can trivially copy/move.</p>
<h1><a class="anchor" id="REF"></a>
References</h1>
<p>For more details, read the following: </p><ul>
<li>[HACKER] "Hacker's delight 2nd ed." If you don't own a copy, you are not a real programmer. </li>
<li>[libdivide] <a href="https://github.com/ridiculousfish/libdivide">https://github.com/ridiculousfish/libdivide</a> </li>
<li>[libdivide-pdf] <a href="http://ridiculousfish.com/files/faster_unsigned_division_by_constants.pdf">http://ridiculousfish.com/files/faster_unsigned_division_by_constants.pdf</a> </li>
</ul>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00067">67</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:aa40d41b933f101b32c2125921a93ede1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1">Constants</a> { <a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">kFlagPowerOfTwo</a> = 0x01, 
<a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b">kFlagAdd32</a> = 0x02, 
<a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa">kFlagAdd64</a> = 0x04
 }<tr class="separator:aa40d41b933f101b32c2125921a93ede1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a920f60bf41315a774df11da8c44e4e38"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#a920f60bf41315a774df11da8c44e4e38">ConstDiv</a> (uint32_t d)</td></tr>
<tr class="memdesc:a920f60bf41315a774df11da8c44e4e38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pre-calculate the p-m pair for the given divisor.  <a href="#a920f60bf41315a774df11da8c44e4e38">More...</a><br /></td></tr>
<tr class="separator:a920f60bf41315a774df11da8c44e4e38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf9493a290140aa915ad6a87b8f0f21c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#acf9493a290140aa915ad6a87b8f0f21c">ConstDiv</a> ()</td></tr>
<tr class="separator:acf9493a290140aa915ad6a87b8f0f21c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4c20f98aa8e98622437e82e25b4041b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa4c20f98aa8e98622437e82e25b4041b">init</a> (uint32_t d)</td></tr>
<tr class="separator:aa4c20f98aa8e98622437e82e25b4041b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6892a2d35b9ae08a00190c9440e22a21"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6892a2d35b9ae08a00190c9440e22a21">div32</a> (uint32_t n) const </td></tr>
<tr class="memdesc:a6892a2d35b9ae08a00190c9440e22a21"><td class="mdescLeft">&#160;</td><td class="mdescRight">32-bit integer division that outputs both quotient and remainder.  <a href="#a6892a2d35b9ae08a00190c9440e22a21">More...</a><br /></td></tr>
<tr class="separator:a6892a2d35b9ae08a00190c9440e22a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbfa08664902f9b633edbd395706b230"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#afbfa08664902f9b633edbd395706b230">rem32</a> (uint32_t n, uint32_t d, uint32_t q) const </td></tr>
<tr class="memdesc:afbfa08664902f9b633edbd395706b230"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate remainder.  <a href="#afbfa08664902f9b633edbd395706b230">More...</a><br /></td></tr>
<tr class="separator:afbfa08664902f9b633edbd395706b230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4bed598404eda88cd7d0929afeea28e"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#ac4bed598404eda88cd7d0929afeea28e">div64</a> (uint64_t n) const </td></tr>
<tr class="memdesc:ac4bed598404eda88cd7d0929afeea28e"><td class="mdescLeft">&#160;</td><td class="mdescRight">64-bit integer division that outputs both quotient and remainder.  <a href="#ac4bed598404eda88cd7d0929afeea28e">More...</a><br /></td></tr>
<tr class="separator:ac4bed598404eda88cd7d0929afeea28e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6705d71ba3796d588bd40a83afe9f00c"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6705d71ba3796d588bd40a83afe9f00c">rem64</a> (uint64_t n, uint32_t d, uint64_t q) const </td></tr>
<tr class="memdesc:a6705d71ba3796d588bd40a83afe9f00c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate remainder.  <a href="#a6705d71ba3796d588bd40a83afe9f00c">More...</a><br /></td></tr>
<tr class="separator:a6705d71ba3796d588bd40a83afe9f00c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a6d6c6f222d9fa8c49dbe1354769dd83b"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a></td></tr>
<tr class="memdesc:a6d6c6f222d9fa8c49dbe1354769dd83b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Highest bits to represent d.  <a href="#a6d6c6f222d9fa8c49dbe1354769dd83b">More...</a><br /></td></tr>
<tr class="separator:a6d6c6f222d9fa8c49dbe1354769dd83b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba0244ae4b37a3c1fb0ba1aaf395bac8"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#aba0244ae4b37a3c1fb0ba1aaf395bac8">shift32_</a></td></tr>
<tr class="memdesc:aba0244ae4b37a3c1fb0ba1aaf395bac8"><td class="mdescLeft">&#160;</td><td class="mdescRight">"s" for 32 bit division.  <a href="#aba0244ae4b37a3c1fb0ba1aaf395bac8">More...</a><br /></td></tr>
<tr class="separator:aba0244ae4b37a3c1fb0ba1aaf395bac8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ace58f23a2711ef9650ce52dc853530"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#a5ace58f23a2711ef9650ce52dc853530">shift64_</a></td></tr>
<tr class="memdesc:a5ace58f23a2711ef9650ce52dc853530"><td class="mdescLeft">&#160;</td><td class="mdescRight">"s" for 64 bit division.  <a href="#a5ace58f23a2711ef9650ce52dc853530">More...</a><br /></td></tr>
<tr class="separator:a5ace58f23a2711ef9650ce52dc853530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6baa65852937164d9dc4ab45c471f036"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a></td></tr>
<tr class="memdesc:a6baa65852937164d9dc4ab45c471f036"><td class="mdescLeft">&#160;</td><td class="mdescRight">misc flags.  <a href="#a6baa65852937164d9dc4ab45c471f036">More...</a><br /></td></tr>
<tr class="separator:a6baa65852937164d9dc4ab45c471f036"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3585294314189bf2f28ba9c5c4a1ef3c"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#a3585294314189bf2f28ba9c5c4a1ef3c">magic32_</a></td></tr>
<tr class="memdesc:a3585294314189bf2f28ba9c5c4a1ef3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">magic number for 32 bit division.  <a href="#a3585294314189bf2f28ba9c5c4a1ef3c">More...</a><br /></td></tr>
<tr class="separator:a3585294314189bf2f28ba9c5c4a1ef3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a736c487c5bb823f38c478827c48d41d1"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#a736c487c5bb823f38c478827c48d41d1">magic64_</a></td></tr>
<tr class="memdesc:a736c487c5bb823f38c478827c48d41d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">magic number for 64 bit division.  <a href="#a736c487c5bb823f38c478827c48d41d1">More...</a><br /></td></tr>
<tr class="separator:a736c487c5bb823f38c478827c48d41d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2798d6656af0c1a496ce7864218feb6"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#ad2798d6656af0c1a496ce7864218feb6">d_</a></td></tr>
<tr class="memdesc:ad2798d6656af0c1a496ce7864218feb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Oridinal divisor.  <a href="#ad2798d6656af0c1a496ce7864218feb6">More...</a><br /></td></tr>
<tr class="separator:ad2798d6656af0c1a496ce7864218feb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a878bcc0664730927450e22b9a99bbc"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#a3a878bcc0664730927450e22b9a99bbc">dummy_</a></td></tr>
<tr class="separator:a3a878bcc0664730927450e22b9a99bbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="aa40d41b933f101b32c2125921a93ede1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1">foedus::assorted::ConstDiv::Constants</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4"></a>kFlagPowerOfTwo&#160;</td><td class="fielddoc">
<p>Whether the divisor is a power of 2. </p>
<p>When this flag is on, we just shift bits. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b"></a>kFlagAdd32&#160;</td><td class="fielddoc">
<p>Add inidicator for 32bit division. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa"></a>kFlagAdd64&#160;</td><td class="fielddoc">
<p>Add inidicator for 64bit division. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00068">68</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                 {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">kFlagPowerOfTwo</a> = 0x01,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b">kFlagAdd32</a> = 0x02,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa">kFlagAdd64</a> = 0x04,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  };</div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa">foedus::assorted::ConstDiv::kFlagAdd64</a></div><div class="ttdoc">Add inidicator for 64bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00074">const_div.hpp:74</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">foedus::assorted::ConstDiv::kFlagPowerOfTwo</a></div><div class="ttdoc">Whether the divisor is a power of 2. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00070">const_div.hpp:70</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b">foedus::assorted::ConstDiv::kFlagAdd32</a></div><div class="ttdoc">Add inidicator for 32bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00072">const_div.hpp:72</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a920f60bf41315a774df11da8c44e4e38"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::assorted::ConstDiv::ConstDiv </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pre-calculate the p-m pair for the given divisor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>divisor </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00081">81</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>References <a class="el" href="const__div_8hpp_source.html#l00137">init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa4c20f98aa8e98622437e82e25b4041b">init</a>(d);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  }</div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa4c20f98aa8e98622437e82e25b4041b"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa4c20f98aa8e98622437e82e25b4041b">foedus::assorted::ConstDiv::init</a></div><div class="ttdeci">void init(uint32_t d)</div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00137">const_div.hpp:137</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1assorted_1_1ConstDiv_a920f60bf41315a774df11da8c44e4e38_cgraph.png" border="0" usemap="#structfoedus_1_1assorted_1_1ConstDiv_a920f60bf41315a774df11da8c44e4e38_cgraph" alt=""/></div>
<map name="structfoedus_1_1assorted_1_1ConstDiv_a920f60bf41315a774df11da8c44e4e38_cgraph" id="structfoedus_1_1assorted_1_1ConstDiv_a920f60bf41315a774df11da8c44e4e38_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa4c20f98aa8e98622437e82e25b4041b" title="foedus::assorted::ConstDiv\l::init" alt="" coords="231,5,408,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acf9493a290140aa915ad6a87b8f0f21c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::assorted::ConstDiv::ConstDiv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00085">85</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>References <a class="el" href="const__div_8hpp_source.html#l00137">init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;             {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa4c20f98aa8e98622437e82e25b4041b">init</a>(1);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa4c20f98aa8e98622437e82e25b4041b"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa4c20f98aa8e98622437e82e25b4041b">foedus::assorted::ConstDiv::init</a></div><div class="ttdeci">void init(uint32_t d)</div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00137">const_div.hpp:137</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1assorted_1_1ConstDiv_acf9493a290140aa915ad6a87b8f0f21c_cgraph.png" border="0" usemap="#structfoedus_1_1assorted_1_1ConstDiv_acf9493a290140aa915ad6a87b8f0f21c_cgraph" alt=""/></div>
<map name="structfoedus_1_1assorted_1_1ConstDiv_acf9493a290140aa915ad6a87b8f0f21c_cgraph" id="structfoedus_1_1assorted_1_1ConstDiv_acf9493a290140aa915ad6a87b8f0f21c_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa4c20f98aa8e98622437e82e25b4041b" title="foedus::assorted::ConstDiv\l::init" alt="" coords="231,5,408,47"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a6892a2d35b9ae08a00190c9440e22a21"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::assorted::ConstDiv::div32 </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>32-bit integer division that outputs both quotient and remainder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>dividee </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>quotient</dd></dl>
<p>Calculation of remainder is separated below. If the caller calls the two functions in a row, I believe compiler is smart enough to get rid of extra multiplication. </p>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00228">228</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>References <a class="el" href="const__div_8hpp_source.html#l00113">d_highest_bits_</a>, <a class="el" href="const__div_8hpp_source.html#l00122">flags_</a>, <a class="el" href="const__div_8hpp_source.html#l00072">kFlagAdd32</a>, <a class="el" href="const__div_8hpp_source.html#l00070">kFlagPowerOfTwo</a>, <a class="el" href="const__div_8hpp_source.html#l00125">magic32_</a>, and <a class="el" href="const__div_8hpp_source.html#l00116">shift32_</a>.</p>

<p>Referenced by <a class="el" href="const__div_8hpp_source.html#l00241">div64()</a>, and <a class="el" href="cache__hashtable_8hpp_source.html#l00110">foedus::cache::HashFunc::get_bucket_number()</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                                {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a> &amp; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">kFlagPowerOfTwo</a>) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> n &gt;&gt; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    uint64_t product = <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(n) * <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a3585294314189bf2f28ba9c5c4a1ef3c">magic32_</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    uint32_t quotient = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(product &gt;&gt; 32);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a> &amp; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b">kFlagAdd32</a>) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      quotient += (n - quotient) &gt;&gt; 1;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> quotient &gt;&gt; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aba0244ae4b37a3c1fb0ba1aaf395bac8">shift32_</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6baa65852937164d9dc4ab45c471f036"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">foedus::assorted::ConstDiv::flags_</a></div><div class="ttdeci">uint8_t flags_</div><div class="ttdoc">misc flags. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00122">const_div.hpp:122</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a3585294314189bf2f28ba9c5c4a1ef3c"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a3585294314189bf2f28ba9c5c4a1ef3c">foedus::assorted::ConstDiv::magic32_</a></div><div class="ttdeci">uint32_t magic32_</div><div class="ttdoc">magic number for 32 bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00125">const_div.hpp:125</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">foedus::assorted::ConstDiv::kFlagPowerOfTwo</a></div><div class="ttdoc">Whether the divisor is a power of 2. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00070">const_div.hpp:70</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b">foedus::assorted::ConstDiv::kFlagAdd32</a></div><div class="ttdoc">Add inidicator for 32bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00072">const_div.hpp:72</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6d6c6f222d9fa8c49dbe1354769dd83b"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">foedus::assorted::ConstDiv::d_highest_bits_</a></div><div class="ttdeci">uint8_t d_highest_bits_</div><div class="ttdoc">Highest bits to represent d. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00113">const_div.hpp:113</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aba0244ae4b37a3c1fb0ba1aaf395bac8"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aba0244ae4b37a3c1fb0ba1aaf395bac8">foedus::assorted::ConstDiv::shift32_</a></div><div class="ttdeci">uint8_t shift32_</div><div class="ttdoc">"s" for 32 bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00116">const_div.hpp:116</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1assorted_1_1ConstDiv_a6892a2d35b9ae08a00190c9440e22a21_icgraph.png" border="0" usemap="#structfoedus_1_1assorted_1_1ConstDiv_a6892a2d35b9ae08a00190c9440e22a21_icgraph" alt=""/></div>
<map name="structfoedus_1_1assorted_1_1ConstDiv_a6892a2d35b9ae08a00190c9440e22a21_icgraph" id="structfoedus_1_1assorted_1_1ConstDiv_a6892a2d35b9ae08a00190c9440e22a21_icgraph">
<area shape="rect" id="node2" href="structfoedus_1_1assorted_1_1ConstDiv.html#ac4bed598404eda88cd7d0929afeea28e" title="64&#45;bit integer division that outputs both quotient and remainder. " alt="" coords="231,834,408,875"/>
<area shape="rect" id="node36" href="structfoedus_1_1cache_1_1HashFunc.html#a19737fa3c91676f9c85536f5928b7501" title="Returns a bucket number the given snapshot page ID should belong to. " alt="" coords="234,945,405,986"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1array_1_1LookupRouteFinder.html#a9acd8da755296ccc35526dacd8ba8d73" title="foedus::storage::array\l::LookupRouteFinder::find_route" alt="" coords="459,662,666,703"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1array_1_1LookupRouteFinder.html#ab5e3279b0293620e7a215dfdc8c4f9b6" title="find_route() plus calculates where page switches. " alt="" coords="477,789,648,845"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1array_1_1ArrayPartitioner.html#a69580ef7442b8b75d49f3e277614210f" title="foedus::storage::array\l::ArrayPartitioner::partition_batch" alt="" coords="456,870,669,911"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7f9205c706c8be3ad4f0c030a285d884" title="foedus::storage::array\l::ArrayStoragePimpl::lookup\l_for_read" alt="" coords="728,245,913,301"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a10c44402ff1533f5fee533cc13119759" title="This version always returns a volatile page, installing a new one if needed. " alt="" coords="728,485,913,541"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a86a1e1fb54d44f15bc17c3f622f9f279" title="foedus::storage::array\l::ArrayStoragePimpl::lookup\l_for_read_batch" alt="" coords="728,655,913,711"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a77af2675acbbf1c831925b3a2c972aa6" title="foedus::storage::array\l::ArrayStoragePimpl::lookup\l_for_write_batch" alt="" coords="728,753,913,809"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#aa649c9d971f17fa39848d4c1a1bcb50f" title="foedus::storage::array\l::ArrayStoragePimpl::locate\l_record_for_read" alt="" coords="985,125,1168,181"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#aa9de7dd9ec971f2011cc84d72aa32521" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record" alt="" coords="1251,5,1417,61"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#abdf449a053e85072d1236f47364b484d" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_primitive" alt="" coords="1251,85,1417,141"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a22b2486d4531522d5949034232e90f32" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_payload" alt="" coords="1251,165,1417,221"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#ae5da0aa4f609d2b80a64a6fcaf4e6d81" title="Retrieves a part of record of the given offset in this array storage. " alt="" coords="1496,13,1671,54"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a1b9cd919a7b95297f1ad5ef5d5971be7" title="Retrieves a part of record of the given offset as a primitive type in this array storage. " alt="" coords="1496,85,1671,141"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a35580e9eb07d46212c1cf0a15520cb24" title="Retrieves a pointer to the entire payload. " alt="" coords="1496,165,1671,221"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#adeff9d74f6979c888a0155e67466cf2a" title="foedus::storage::array\l::ArrayStoragePimpl::locate\l_record_for_write" alt="" coords="985,445,1168,501"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#ac3d0167bd2765ad6cea232fd999e9d5f" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_for_write" alt="" coords="1251,245,1417,301"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7d21cd23923f93d072a1a182cae6f412" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record" alt="" coords="1235,325,1433,381"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a3ee9fdf4da9f172082841c1774a761da" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record_primitive" alt="" coords="1235,405,1433,461"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a435ff8b148161ca7296b12eea744a344" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record" alt="" coords="1232,485,1436,541"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af77ff710cf2f8ef3800e97861ea94e8f" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record_oneshot" alt="" coords="1232,565,1436,621"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#acb10150d96e7a6fe9c7bc00da6a13e80" title="Retrieves a pointer to the entire record for write (thus always in volatile page). " alt="" coords="1496,245,1671,301"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a5fe59a512f951b17e2524fd153a9d991" title="Overwrites a part of one record of the given offset in this array storage. " alt="" coords="1501,325,1665,381"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#aaa646f67578c221ef982e28fffdd76e4" title="Overwrites a part of record of the given offset as a primitive type in this array storage..." alt="" coords="1501,405,1665,461"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a3cfbd23c4239f8a63ac5719007a8305b" title="This one further optimizes overwrite_record_primitive() for the frequent use case of incrementing som..." alt="" coords="1498,485,1669,541"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a5093ba18b241e5179a363476bdd20066" title="This is a faster increment that does not return the value after increment. " alt="" coords="1498,565,1669,621"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a617e3f91fe74f5215ae4f0081e30ab6d" title="foedus::storage::array\l::ArrayStoragePimpl::locate\l_record_for_read_batch" alt="" coords="985,655,1168,711"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a23cc3a8049590a9c4be3177ab9b5661b" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_primitive_batch" alt="" coords="1251,645,1417,701"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#ae4373a9f195884ab885458e9c1a18ee7" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_payload_batch" alt="" coords="1251,725,1417,781"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a7a0a99eb452ebc4ec0e2e86d520d315f" title="batched interface " alt="" coords="1496,645,1671,701"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a69f548ffc92c96cc52238068d781bbf8" title="foedus::storage::array\l::ArrayStorage::get_record\l_payload_batch" alt="" coords="1496,725,1671,781"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#ad4da0329b11bd50970765c7d4b1f669a" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_for_write_batch" alt="" coords="994,780,1159,836"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a58183bfb0f5e70653f7f450ecac9f501" title="foedus::storage::array\l::ArrayStorage::get_record\l_for_write_batch" alt="" coords="1247,805,1421,861"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1Partitioner.html#a8c7b2f626b460815615663be4d22427f" title="Identifies the partition of each log record in a batched fashion. " alt="" coords="731,870,910,911"/>
<area shape="rect" id="node37" href="classfoedus_1_1cache_1_1CacheHashtable.html#a30b6a0b28cce30d50da7e0419c8cad20" title="Returns a bucket number the given page ID should belong to. " alt="" coords="459,991,666,1033"/>
<area shape="rect" id="node38" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="717,949,924,990"/>
<area shape="rect" id="node46" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="717,1014,924,1055"/>
<area shape="rect" id="node50" href="classfoedus_1_1cache_1_1CacheHashtable.html#a8e48716623ca44e83cc5ef871c10b131" title="Batched version of find(). " alt="" coords="717,1079,924,1121"/>
<area shape="rect" id="node39" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="972,955,1181,997"/>
<area shape="rect" id="node40" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1229,887,1439,929"/>
<area shape="rect" id="node44" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="1242,955,1426,997"/>
<area shape="rect" id="node45" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1491,1017,1675,1058"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af22fe9e661763ca3225eeedf7fa62879" title="foedus::storage::array\l::ArrayStoragePimpl::prefetch\l_pages_recurse" alt="" coords="1487,805,1680,861"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="1728,911,1941,953"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="1494,936,1673,992"/>
<area shape="rect" id="node47" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a98de2aa47bebca5add3e0550f2c602bf" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="985,1072,1169,1128"/>
<area shape="rect" id="node48" href="classfoedus_1_1thread_1_1Thread.html#a878c3aa228a6e8925e21a3b7b0592349" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="1254,1072,1414,1128"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a89fe2af2a31e70a89e143cbc2d687ffb" title="Batched version of follow_page_pointer with will_modify==false. " alt="" coords="1242,1152,1426,1208"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac4bed598404eda88cd7d0929afeea28e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::assorted::ConstDiv::div64 </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>64-bit integer division that outputs both quotient and remainder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>dividee </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>quotient </dd></dl>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00241">241</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="const__div_8hpp_source.html#l00113">d_highest_bits_</a>, <a class="el" href="const__div_8hpp_source.html#l00228">div32()</a>, <a class="el" href="const__div_8hpp_source.html#l00122">flags_</a>, <a class="el" href="const__div_8hpp_source.html#l00074">kFlagAdd64</a>, <a class="el" href="const__div_8hpp_source.html#l00070">kFlagPowerOfTwo</a>, <a class="el" href="const__div_8hpp_source.html#l00128">magic64_</a>, and <a class="el" href="const__div_8hpp_source.html#l00119">shift64_</a>.</p>

<p>Referenced by <a class="el" href="array__route_8hpp_source.html#l00134">foedus::storage::array::LookupRouteFinder::find_route()</a>, <a class="el" href="array__route_8hpp_source.html#l00154">foedus::storage::array::LookupRouteFinder::find_route_and_switch()</a>, and <a class="el" href="array__partitioner__impl_8cpp_source.html#l00175">foedus::storage::array::ArrayPartitioner::partition_batch()</a>.</p>
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                                {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a> &amp; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">kFlagPowerOfTwo</a>) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">return</span> n &gt;&gt; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">if</span> (n &lt; (1ULL &lt;&lt; 32)) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// cheap case</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6892a2d35b9ae08a00190c9440e22a21">div32</a>(static_cast&lt;uint32_t&gt;(n));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(n &gt;= (1ULL &lt;&lt; 32));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// At least GCC and clang supports __uint128_t</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  __uint128_t product = <span class="keyword">static_cast&lt;</span>__uint128_t<span class="keyword">&gt;</span>(n) * <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a736c487c5bb823f38c478827c48d41d1">magic64_</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  uint64_t quotient = <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(product &gt;&gt; 64);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a> &amp; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa">kFlagAdd64</a>) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    quotient += (n - quotient) &gt;&gt; 1;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">return</span> quotient &gt;&gt; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a5ace58f23a2711ef9650ce52dc853530">shift64_</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6baa65852937164d9dc4ab45c471f036"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">foedus::assorted::ConstDiv::flags_</a></div><div class="ttdeci">uint8_t flags_</div><div class="ttdoc">misc flags. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00122">const_div.hpp:122</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa">foedus::assorted::ConstDiv::kFlagAdd64</a></div><div class="ttdoc">Add inidicator for 64bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00074">const_div.hpp:74</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">foedus::assorted::ConstDiv::kFlagPowerOfTwo</a></div><div class="ttdoc">Whether the divisor is a power of 2. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00070">const_div.hpp:70</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a736c487c5bb823f38c478827c48d41d1"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a736c487c5bb823f38c478827c48d41d1">foedus::assorted::ConstDiv::magic64_</a></div><div class="ttdeci">uint64_t magic64_</div><div class="ttdoc">magic number for 64 bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00128">const_div.hpp:128</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6d6c6f222d9fa8c49dbe1354769dd83b"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">foedus::assorted::ConstDiv::d_highest_bits_</a></div><div class="ttdeci">uint8_t d_highest_bits_</div><div class="ttdoc">Highest bits to represent d. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00113">const_div.hpp:113</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a5ace58f23a2711ef9650ce52dc853530"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a5ace58f23a2711ef9650ce52dc853530">foedus::assorted::ConstDiv::shift64_</a></div><div class="ttdeci">uint8_t shift64_</div><div class="ttdoc">"s" for 64 bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00119">const_div.hpp:119</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6892a2d35b9ae08a00190c9440e22a21"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6892a2d35b9ae08a00190c9440e22a21">foedus::assorted::ConstDiv::div32</a></div><div class="ttdeci">uint32_t div32(uint32_t n) const </div><div class="ttdoc">32-bit integer division that outputs both quotient and remainder. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00228">const_div.hpp:228</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1assorted_1_1ConstDiv_ac4bed598404eda88cd7d0929afeea28e_cgraph.png" border="0" usemap="#structfoedus_1_1assorted_1_1ConstDiv_ac4bed598404eda88cd7d0929afeea28e_cgraph" alt=""/></div>
<map name="structfoedus_1_1assorted_1_1ConstDiv_ac4bed598404eda88cd7d0929afeea28e_cgraph" id="structfoedus_1_1assorted_1_1ConstDiv_ac4bed598404eda88cd7d0929afeea28e_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6892a2d35b9ae08a00190c9440e22a21" title="32&#45;bit integer division that outputs both quotient and remainder. " alt="" coords="231,5,408,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1assorted_1_1ConstDiv_ac4bed598404eda88cd7d0929afeea28e_icgraph.png" border="0" usemap="#structfoedus_1_1assorted_1_1ConstDiv_ac4bed598404eda88cd7d0929afeea28e_icgraph" alt=""/></div>
<map name="structfoedus_1_1assorted_1_1ConstDiv_ac4bed598404eda88cd7d0929afeea28e_icgraph" id="structfoedus_1_1assorted_1_1ConstDiv_ac4bed598404eda88cd7d0929afeea28e_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1LookupRouteFinder.html#a9acd8da755296ccc35526dacd8ba8d73" title="foedus::storage::array\l::LookupRouteFinder::find_route" alt="" coords="234,593,441,634"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1array_1_1LookupRouteFinder.html#ab5e3279b0293620e7a215dfdc8c4f9b6" title="find_route() plus calculates where page switches. " alt="" coords="252,660,423,716"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1array_1_1ArrayPartitioner.html#a69580ef7442b8b75d49f3e277614210f" title="foedus::storage::array\l::ArrayPartitioner::partition_batch" alt="" coords="231,743,444,785"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7f9205c706c8be3ad4f0c030a285d884" title="foedus::storage::array\l::ArrayStoragePimpl::lookup\l_for_read" alt="" coords="492,245,677,301"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a10c44402ff1533f5fee533cc13119759" title="This version always returns a volatile page, installing a new one if needed. " alt="" coords="492,465,677,521"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a86a1e1fb54d44f15bc17c3f622f9f279" title="foedus::storage::array\l::ArrayStoragePimpl::lookup\l_for_read_batch" alt="" coords="492,585,677,641"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a77af2675acbbf1c831925b3a2c972aa6" title="foedus::storage::array\l::ArrayStoragePimpl::lookup\l_for_write_batch" alt="" coords="492,665,677,721"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#aa649c9d971f17fa39848d4c1a1bcb50f" title="foedus::storage::array\l::ArrayStoragePimpl::locate\l_record_for_read" alt="" coords="725,125,908,181"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#aa9de7dd9ec971f2011cc84d72aa32521" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record" alt="" coords="975,5,1141,61"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#abdf449a053e85072d1236f47364b484d" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_primitive" alt="" coords="975,85,1141,141"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a22b2486d4531522d5949034232e90f32" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_payload" alt="" coords="975,165,1141,221"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#ae5da0aa4f609d2b80a64a6fcaf4e6d81" title="Retrieves a part of record of the given offset in this array storage. " alt="" coords="1208,13,1383,54"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a1b9cd919a7b95297f1ad5ef5d5971be7" title="Retrieves a part of record of the given offset as a primitive type in this array storage. " alt="" coords="1208,85,1383,141"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a35580e9eb07d46212c1cf0a15520cb24" title="Retrieves a pointer to the entire payload. " alt="" coords="1208,165,1383,221"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#adeff9d74f6979c888a0155e67466cf2a" title="foedus::storage::array\l::ArrayStoragePimpl::locate\l_record_for_write" alt="" coords="725,445,908,501"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#ac3d0167bd2765ad6cea232fd999e9d5f" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_for_write" alt="" coords="975,245,1141,301"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7d21cd23923f93d072a1a182cae6f412" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record" alt="" coords="959,325,1157,381"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a3ee9fdf4da9f172082841c1774a761da" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record_primitive" alt="" coords="959,405,1157,461"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a435ff8b148161ca7296b12eea744a344" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record" alt="" coords="956,485,1160,541"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af77ff710cf2f8ef3800e97861ea94e8f" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record_oneshot" alt="" coords="956,565,1160,621"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#acb10150d96e7a6fe9c7bc00da6a13e80" title="Retrieves a pointer to the entire record for write (thus always in volatile page). " alt="" coords="1208,245,1383,301"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a5fe59a512f951b17e2524fd153a9d991" title="Overwrites a part of one record of the given offset in this array storage. " alt="" coords="1213,325,1377,381"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#aaa646f67578c221ef982e28fffdd76e4" title="Overwrites a part of record of the given offset as a primitive type in this array storage..." alt="" coords="1213,405,1377,461"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a3cfbd23c4239f8a63ac5719007a8305b" title="This one further optimizes overwrite_record_primitive() for the frequent use case of incrementing som..." alt="" coords="1210,485,1381,541"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a5093ba18b241e5179a363476bdd20066" title="This is a faster increment that does not return the value after increment. " alt="" coords="1210,565,1381,621"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a617e3f91fe74f5215ae4f0081e30ab6d" title="foedus::storage::array\l::ArrayStoragePimpl::locate\l_record_for_read_batch" alt="" coords="725,645,908,701"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a23cc3a8049590a9c4be3177ab9b5661b" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_primitive_batch" alt="" coords="975,645,1141,701"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#ae4373a9f195884ab885458e9c1a18ee7" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_payload_batch" alt="" coords="975,725,1141,781"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a7a0a99eb452ebc4ec0e2e86d520d315f" title="batched interface " alt="" coords="1208,645,1383,701"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a69f548ffc92c96cc52238068d781bbf8" title="foedus::storage::array\l::ArrayStorage::get_record\l_payload_batch" alt="" coords="1208,725,1383,781"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#ad4da0329b11bd50970765c7d4b1f669a" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_record_for_write_batch" alt="" coords="734,765,899,821"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a58183bfb0f5e70653f7f450ecac9f501" title="foedus::storage::array\l::ArrayStorage::get_record\l_for_write_batch" alt="" coords="971,805,1145,861"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1Partitioner.html#a8c7b2f626b460815615663be4d22427f" title="Identifies the partition of each log record in a batched fashion. " alt="" coords="495,746,674,787"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa4c20f98aa8e98622437e82e25b4041b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::assorted::ConstDiv::init </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00137">137</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="const__div_8hpp_source.html#l00132">d_</a>, <a class="el" href="const__div_8hpp_source.html#l00113">d_highest_bits_</a>, <a class="el" href="const__div_8hpp_source.html#l00133">dummy_</a>, <a class="el" href="const__div_8hpp_source.html#l00122">flags_</a>, <a class="el" href="const__div_8hpp_source.html#l00072">kFlagAdd32</a>, <a class="el" href="const__div_8hpp_source.html#l00074">kFlagAdd64</a>, <a class="el" href="const__div_8hpp_source.html#l00070">kFlagPowerOfTwo</a>, <a class="el" href="const__div_8hpp_source.html#l00125">magic32_</a>, <a class="el" href="const__div_8hpp_source.html#l00128">magic64_</a>, <a class="el" href="const__div_8hpp_source.html#l00116">shift32_</a>, and <a class="el" href="const__div_8hpp_source.html#l00119">shift64_</a>.</p>

<p>Referenced by <a class="el" href="const__div_8hpp_source.html#l00081">ConstDiv()</a>.</p>
<div class="fragment"><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                     {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">// this one is inlined just to avoid multiple-definition, not for performance.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(d);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a> = 31 - __builtin_clz(d);  <span class="comment">// TASK(Hideaki): non-GCC support</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#ad2798d6656af0c1a496ce7864218feb6">d_</a> = d;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a3a878bcc0664730927450e22b9a99bbc">dummy_</a> = 0;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#endif  // NDEBUG</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// power of 2 is a bit special.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">if</span> ((d &amp; (d - 1)) == 0) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(d == (1U &lt;&lt; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aba0244ae4b37a3c1fb0ba1aaf395bac8">shift32_</a> = 0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a5ace58f23a2711ef9650ce52dc853530">shift64_</a> = 0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a> = <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">kFlagPowerOfTwo</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a3585294314189bf2f28ba9c5c4a1ef3c">magic32_</a> = 0;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a736c487c5bb823f38c478827c48d41d1">magic64_</a> = 0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a> = 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// calculate 32bit/64bit magic numbers and add indicator, this part is based on [libdivide-pdf]</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">// rather than [HACKERS] although it is also based on [HACKERS].</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aba0244ae4b37a3c1fb0ba1aaf395bac8">shift32_</a> = <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    uint32_t m = (1ULL &lt;&lt; (32 + <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>)) / d;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    uint32_t rem = (1ULL &lt;&lt; (32 + <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>)) % d;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(rem &gt; 0 &amp;&amp; rem &lt; d);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    uint32_t e = d - rem;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> (e &gt;= (1U &lt;&lt; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>)) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">// we have add indicator (2^W &lt;= M &lt; 2^(W+1), m = M - 2^W).</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="comment">// here is a nice idea in libdivide.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="comment">// We let it overflow, but we do so for remainder too, thus even with overflow</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="comment">// we can correctly calculate the quotient!</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="comment">// We use the magic number for this case with divide-by-2 in div32 to account for this.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a> |= <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b">kFlagAdd32</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      m *= 2;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      uint32_t twice_rem = rem * 2;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">if</span> (twice_rem &gt;= d || twice_rem &lt; rem) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        ++m;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a3585294314189bf2f28ba9c5c4a1ef3c">magic32_</a> = m + 1;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// then 64bit version.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a5ace58f23a2711ef9650ce52dc853530">shift64_</a> = <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// At least GCC and clang supports __uint128_t</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    __uint128_t numer = 1;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    numer &lt;&lt;= 64 + <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    uint64_t m = numer / d;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    uint32_t rem = numer % d;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(rem &gt; 0 &amp;&amp; rem &lt; d);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    uint32_t e = d - rem;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span> (e &gt;= (1ULL &lt;&lt; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>)) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a> |= <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa">kFlagAdd64</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      m *= 2;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      uint32_t twice_rem = rem * 2;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">if</span> (twice_rem &gt;= d || twice_rem &lt; rem) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        ++m;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a736c487c5bb823f38c478827c48d41d1">magic64_</a> = m + 1;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6baa65852937164d9dc4ab45c471f036"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">foedus::assorted::ConstDiv::flags_</a></div><div class="ttdeci">uint8_t flags_</div><div class="ttdoc">misc flags. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00122">const_div.hpp:122</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1acf4f35bb22be78e8a0fe327901631ffa">foedus::assorted::ConstDiv::kFlagAdd64</a></div><div class="ttdoc">Add inidicator for 64bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00074">const_div.hpp:74</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a3a878bcc0664730927450e22b9a99bbc"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a3a878bcc0664730927450e22b9a99bbc">foedus::assorted::ConstDiv::dummy_</a></div><div class="ttdeci">uint32_t dummy_</div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00133">const_div.hpp:133</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a3585294314189bf2f28ba9c5c4a1ef3c"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a3585294314189bf2f28ba9c5c4a1ef3c">foedus::assorted::ConstDiv::magic32_</a></div><div class="ttdeci">uint32_t magic32_</div><div class="ttdoc">magic number for 32 bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00125">const_div.hpp:125</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_ad2798d6656af0c1a496ce7864218feb6"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#ad2798d6656af0c1a496ce7864218feb6">foedus::assorted::ConstDiv::d_</a></div><div class="ttdeci">uint32_t d_</div><div class="ttdoc">Oridinal divisor. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00132">const_div.hpp:132</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">foedus::assorted::ConstDiv::kFlagPowerOfTwo</a></div><div class="ttdoc">Whether the divisor is a power of 2. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00070">const_div.hpp:70</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a91e38a7533ea080359eb91302b3d803b">foedus::assorted::ConstDiv::kFlagAdd32</a></div><div class="ttdoc">Add inidicator for 32bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00072">const_div.hpp:72</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a736c487c5bb823f38c478827c48d41d1"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a736c487c5bb823f38c478827c48d41d1">foedus::assorted::ConstDiv::magic64_</a></div><div class="ttdeci">uint64_t magic64_</div><div class="ttdoc">magic number for 64 bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00128">const_div.hpp:128</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6d6c6f222d9fa8c49dbe1354769dd83b"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">foedus::assorted::ConstDiv::d_highest_bits_</a></div><div class="ttdeci">uint8_t d_highest_bits_</div><div class="ttdoc">Highest bits to represent d. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00113">const_div.hpp:113</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aba0244ae4b37a3c1fb0ba1aaf395bac8"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aba0244ae4b37a3c1fb0ba1aaf395bac8">foedus::assorted::ConstDiv::shift32_</a></div><div class="ttdeci">uint8_t shift32_</div><div class="ttdoc">"s" for 32 bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00116">const_div.hpp:116</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a5ace58f23a2711ef9650ce52dc853530"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a5ace58f23a2711ef9650ce52dc853530">foedus::assorted::ConstDiv::shift64_</a></div><div class="ttdeci">uint8_t shift64_</div><div class="ttdoc">"s" for 64 bit division. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00119">const_div.hpp:119</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1assorted_1_1ConstDiv_aa4c20f98aa8e98622437e82e25b4041b_icgraph.png" border="0" usemap="#structfoedus_1_1assorted_1_1ConstDiv_aa4c20f98aa8e98622437e82e25b4041b_icgraph" alt=""/></div>
<map name="structfoedus_1_1assorted_1_1ConstDiv_aa4c20f98aa8e98622437e82e25b4041b_icgraph" id="structfoedus_1_1assorted_1_1ConstDiv_aa4c20f98aa8e98622437e82e25b4041b_icgraph">
<area shape="rect" id="node2" href="structfoedus_1_1assorted_1_1ConstDiv.html#a920f60bf41315a774df11da8c44e4e38" title="Pre&#45;calculate the p&#45;m pair for the given divisor. " alt="" coords="231,5,408,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afbfa08664902f9b633edbd395706b230"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::assorted::ConstDiv::rem32 </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate remainder. </p>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00205">205</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="const__div_8hpp_source.html#l00132">d_</a>, <a class="el" href="const__div_8hpp_source.html#l00113">d_highest_bits_</a>, <a class="el" href="const__div_8hpp_source.html#l00122">flags_</a>, and <a class="el" href="const__div_8hpp_source.html#l00070">kFlagPowerOfTwo</a>.</p>

<p>Referenced by <a class="el" href="cache__hashtable_8hpp_source.html#l00110">foedus::cache::HashFunc::get_bucket_number()</a>.</p>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                                                        {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(d == <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#ad2798d6656af0c1a496ce7864218feb6">d_</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#endif  // NDEBUG</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(n / d == q);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a> &amp; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">kFlagPowerOfTwo</a>) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">return</span> n &amp; ((1 &lt;&lt; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>) - 1);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span> n - d * q;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6baa65852937164d9dc4ab45c471f036"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">foedus::assorted::ConstDiv::flags_</a></div><div class="ttdeci">uint8_t flags_</div><div class="ttdoc">misc flags. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00122">const_div.hpp:122</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_ad2798d6656af0c1a496ce7864218feb6"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#ad2798d6656af0c1a496ce7864218feb6">foedus::assorted::ConstDiv::d_</a></div><div class="ttdeci">uint32_t d_</div><div class="ttdoc">Oridinal divisor. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00132">const_div.hpp:132</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">foedus::assorted::ConstDiv::kFlagPowerOfTwo</a></div><div class="ttdoc">Whether the divisor is a power of 2. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00070">const_div.hpp:70</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6d6c6f222d9fa8c49dbe1354769dd83b"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">foedus::assorted::ConstDiv::d_highest_bits_</a></div><div class="ttdeci">uint8_t d_highest_bits_</div><div class="ttdoc">Highest bits to represent d. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00113">const_div.hpp:113</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1assorted_1_1ConstDiv_afbfa08664902f9b633edbd395706b230_icgraph.png" border="0" usemap="#structfoedus_1_1assorted_1_1ConstDiv_afbfa08664902f9b633edbd395706b230_icgraph" alt=""/></div>
<map name="structfoedus_1_1assorted_1_1ConstDiv_afbfa08664902f9b633edbd395706b230_icgraph" id="structfoedus_1_1assorted_1_1ConstDiv_afbfa08664902f9b633edbd395706b230_icgraph">
<area shape="rect" id="node2" href="structfoedus_1_1cache_1_1HashFunc.html#a19737fa3c91676f9c85536f5928b7501" title="Returns a bucket number the given snapshot page ID should belong to. " alt="" coords="231,620,401,661"/>
<area shape="rect" id="node3" href="classfoedus_1_1cache_1_1CacheHashtable.html#a30b6a0b28cce30d50da7e0419c8cad20" title="Returns a bucket number the given page ID should belong to. " alt="" coords="449,620,656,661"/>
<area shape="rect" id="node4" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="704,555,911,596"/>
<area shape="rect" id="node44" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="704,620,911,661"/>
<area shape="rect" id="node50" href="classfoedus_1_1cache_1_1CacheHashtable.html#a8e48716623ca44e83cc5ef871c10b131" title="Batched version of find(). " alt="" coords="704,685,911,727"/>
<area shape="rect" id="node5" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="959,555,1168,596"/>
<area shape="rect" id="node6" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1680,213,1889,255"/>
<area shape="rect" id="node27" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="1216,525,1400,567"/>
<area shape="rect" id="node29" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1448,595,1632,636"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af22fe9e661763ca3225eeedf7fa62879" title="foedus::storage::array\l::ArrayStoragePimpl::prefetch\l_pages_recurse" alt="" coords="1937,93,2131,149"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="2189,395,2403,436"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="1945,383,2123,439"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="1943,173,2125,229"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#abe8cbf3d8edfb47a32d460029707aace" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::prefetch_pages_follow" alt="" coords="1947,13,2121,69"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#adbf75cfe4ac8c4c5e1e8a32342b66d00" title="defined in array_storage_prefetch.cpp " alt="" coords="2179,329,2413,371"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#af420e19da8ee4ed731ae387932cc991e" title="Prefetch data pages in this storage. " alt="" coords="2463,329,2665,371"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="2461,395,2667,436"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a222e0d485305f3253b0e1c97720dc0c8" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record" alt="" coords="2734,118,2898,174"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_part" alt="" coords="2734,198,2898,254"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="2727,278,2905,334"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="2725,358,2907,414"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="2725,438,2907,494"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="2718,518,2914,574"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="2715,38,2917,94"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="2205,173,2387,229"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa8d098fb8e3b997b1dc52ede62b8acb6" title="locate_record()&#39;s physical_only version. " alt="" coords="2473,249,2655,305"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="2473,169,2655,225"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::prefetch_pages_normalized\l_recurse" alt="" coords="2202,5,2390,76"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a99bb085d9e427fc36182b13bb20371e9" title="defined in masstree_storage_prefetch.cpp " alt="" coords="2470,86,2658,142"/>
<area shape="rect" id="node28" href="classfoedus_1_1thread_1_1Thread.html#a13d14670c512a2f2f85ff6519a28488c" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="1705,100,1864,141"/>
<area shape="rect" id="node41" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aac3821c478965e40c60c819a7e5a83e5" title="Batched version of follow_page_pointer with will_modify==true and tolerate_null_pointer==true. " alt="" coords="1448,514,1632,570"/>
<area shape="rect" id="node30" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1709,599,1860,640"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#ae0f40ca19aa9b9ac924542746e1b53c1" title="foedus::storage::array\l::ArrayStoragePimpl::follow\l_pointer" alt="" coords="1945,754,2123,810"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#abae9ebd099ebba507d98b8df782bd143" title="foedus::storage::array\l::ArrayStoragePimpl::get\l_root_page" alt="" coords="1951,674,2117,730"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="2214,834,2378,890"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="1947,303,2121,359"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="1947,594,2121,650"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7f9205c706c8be3ad4f0c030a285d884" title="foedus::storage::array\l::ArrayStoragePimpl::lookup\l_for_read" alt="" coords="2203,674,2389,730"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a10c44402ff1533f5fee533cc13119759" title="This version always returns a volatile page, installing a new one if needed. " alt="" coords="2203,754,2389,810"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a86a1e1fb54d44f15bc17c3f622f9f279" title="foedus::storage::array\l::ArrayStoragePimpl::lookup\l_for_read_batch" alt="" coords="2203,914,2389,970"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a77af2675acbbf1c831925b3a2c972aa6" title="foedus::storage::array\l::ArrayStoragePimpl::lookup\l_for_write_batch" alt="" coords="2203,514,2389,570"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#ac612c67d7e9e1a68dcccce98648cad0c" title="foedus::storage::array\l::ArrayStoragePimpl::verify\l_single_thread" alt="" coords="2208,594,2384,650"/>
<area shape="rect" id="node42" href="classfoedus_1_1thread_1_1Thread.html#a2b375e7de4d6c9c7b222c45b271126dc" title="Batched version of follow_page_pointer with will_modify==true and tolerate_null_pointer==true. " alt="" coords="1709,514,1860,570"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#ad0c8eb92d19915b679137e594bdfae31" title="foedus::storage::array\l::ArrayStoragePimpl::follow\l_pointers_for_write_batch" alt="" coords="1945,514,2123,570"/>
<area shape="rect" id="node45" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a98de2aa47bebca5add3e0550f2c602bf" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="971,678,1155,734"/>
<area shape="rect" id="node46" href="classfoedus_1_1thread_1_1Thread.html#a878c3aa228a6e8925e21a3b7b0592349" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="1228,678,1388,734"/>
<area shape="rect" id="node47" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a89fe2af2a31e70a89e143cbc2d687ffb" title="Batched version of follow_page_pointer with will_modify==false. " alt="" coords="1216,838,1400,894"/>
<area shape="rect" id="node48" href="classfoedus_1_1thread_1_1Thread.html#abb36cf6186f747e38d98a13c6419e128" title="Batched version of follow_page_pointer with will_modify==false. " alt="" coords="1465,845,1615,901"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#ac71ccdf1742ae0e9a7119cc92fcac092" title="foedus::storage::array\l::ArrayStoragePimpl::follow\l_pointers_for_read_batch" alt="" coords="1695,885,1874,941"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6705d71ba3796d588bd40a83afe9f00c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::assorted::ConstDiv::rem64 </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate remainder. </p>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00216">216</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="const__div_8hpp_source.html#l00132">d_</a>, <a class="el" href="const__div_8hpp_source.html#l00113">d_highest_bits_</a>, <a class="el" href="const__div_8hpp_source.html#l00122">flags_</a>, and <a class="el" href="const__div_8hpp_source.html#l00070">kFlagPowerOfTwo</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                                                        {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(d == <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#ad2798d6656af0c1a496ce7864218feb6">d_</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">#endif  // NDEBUG</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(n / d == q);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">flags_</a> &amp; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">kFlagPowerOfTwo</a>) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">return</span> n &amp; ((1ULL &lt;&lt; <a class="code" href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">d_highest_bits_</a>) - 1ULL);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">return</span> n - d * q;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6baa65852937164d9dc4ab45c471f036"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6baa65852937164d9dc4ab45c471f036">foedus::assorted::ConstDiv::flags_</a></div><div class="ttdeci">uint8_t flags_</div><div class="ttdoc">misc flags. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00122">const_div.hpp:122</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_ad2798d6656af0c1a496ce7864218feb6"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#ad2798d6656af0c1a496ce7864218feb6">foedus::assorted::ConstDiv::d_</a></div><div class="ttdeci">uint32_t d_</div><div class="ttdoc">Oridinal divisor. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00132">const_div.hpp:132</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#aa40d41b933f101b32c2125921a93ede1a666e4bec3a9a13df3deb03e876814cc4">foedus::assorted::ConstDiv::kFlagPowerOfTwo</a></div><div class="ttdoc">Whether the divisor is a power of 2. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00070">const_div.hpp:70</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ConstDiv_html_a6d6c6f222d9fa8c49dbe1354769dd83b"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ConstDiv.html#a6d6c6f222d9fa8c49dbe1354769dd83b">foedus::assorted::ConstDiv::d_highest_bits_</a></div><div class="ttdeci">uint8_t d_highest_bits_</div><div class="ttdoc">Highest bits to represent d. </div><div class="ttdef"><b>Definition:</b> <a href="const__div_8hpp_source.html#l00113">const_div.hpp:113</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ad2798d6656af0c1a496ce7864218feb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::assorted::ConstDiv::d_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Oridinal divisor. </p>
<p>For sanity check. </p>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00132">132</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>Referenced by <a class="el" href="const__div_8hpp_source.html#l00137">init()</a>, <a class="el" href="const__div_8hpp_source.html#l00205">rem32()</a>, and <a class="el" href="const__div_8hpp_source.html#l00216">rem64()</a>.</p>

</div>
</div>
<a class="anchor" id="a6d6c6f222d9fa8c49dbe1354769dd83b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t foedus::assorted::ConstDiv::d_highest_bits_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Highest bits to represent d. </p>
<p>2^(d_highest_bits_) &lt;= d &lt; 2^(d_highest_bits_+1). </p>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00113">113</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>Referenced by <a class="el" href="const__div_8hpp_source.html#l00228">div32()</a>, <a class="el" href="const__div_8hpp_source.html#l00241">div64()</a>, <a class="el" href="const__div_8hpp_source.html#l00137">init()</a>, <a class="el" href="const__div_8hpp_source.html#l00205">rem32()</a>, and <a class="el" href="const__div_8hpp_source.html#l00216">rem64()</a>.</p>

</div>
</div>
<a class="anchor" id="a3a878bcc0664730927450e22b9a99bbc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::assorted::ConstDiv::dummy_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00133">133</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>Referenced by <a class="el" href="const__div_8hpp_source.html#l00137">init()</a>.</p>

</div>
</div>
<a class="anchor" id="a6baa65852937164d9dc4ab45c471f036"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t foedus::assorted::ConstDiv::flags_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>misc flags. </p>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00122">122</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>Referenced by <a class="el" href="const__div_8hpp_source.html#l00228">div32()</a>, <a class="el" href="const__div_8hpp_source.html#l00241">div64()</a>, <a class="el" href="const__div_8hpp_source.html#l00137">init()</a>, <a class="el" href="const__div_8hpp_source.html#l00205">rem32()</a>, and <a class="el" href="const__div_8hpp_source.html#l00216">rem64()</a>.</p>

</div>
</div>
<a class="anchor" id="a3585294314189bf2f28ba9c5c4a1ef3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::assorted::ConstDiv::magic32_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>magic number for 32 bit division. </p>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00125">125</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>Referenced by <a class="el" href="const__div_8hpp_source.html#l00228">div32()</a>, and <a class="el" href="const__div_8hpp_source.html#l00137">init()</a>.</p>

</div>
</div>
<a class="anchor" id="a736c487c5bb823f38c478827c48d41d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::assorted::ConstDiv::magic64_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>magic number for 64 bit division. </p>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00128">128</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>Referenced by <a class="el" href="const__div_8hpp_source.html#l00241">div64()</a>, and <a class="el" href="const__div_8hpp_source.html#l00137">init()</a>.</p>

</div>
</div>
<a class="anchor" id="aba0244ae4b37a3c1fb0ba1aaf395bac8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t foedus::assorted::ConstDiv::shift32_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"s" for 32 bit division. </p>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00116">116</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>Referenced by <a class="el" href="const__div_8hpp_source.html#l00228">div32()</a>, and <a class="el" href="const__div_8hpp_source.html#l00137">init()</a>.</p>

</div>
</div>
<a class="anchor" id="a5ace58f23a2711ef9650ce52dc853530"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t foedus::assorted::ConstDiv::shift64_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"s" for 64 bit division. </p>

<p>Definition at line <a class="el" href="const__div_8hpp_source.html#l00119">119</a> of file <a class="el" href="const__div_8hpp_source.html">const_div.hpp</a>.</p>

<p>Referenced by <a class="el" href="const__div_8hpp_source.html#l00241">div64()</a>, and <a class="el" href="const__div_8hpp_source.html#l00137">init()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/assorted/<a class="el" href="const__div_8hpp_source.html">const_div.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1assorted.html">assorted</a></li><li class="navelem"><a class="el" href="structfoedus_1_1assorted_1_1ConstDiv.html">ConstDiv</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

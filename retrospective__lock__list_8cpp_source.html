<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: /home/shino/foedus_code/foedus-core/src/foedus/xct/retrospective_lock_list.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('retrospective__lock__list_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">retrospective_lock_list.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="retrospective__lock__list_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2014-2015, Hewlett-Packard Development Company, LP.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify it</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * under the terms of the GNU General Public License as published by the Free</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Software Foundation; either version 2 of the License, or (at your option)</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * any later version.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * more details. You should have received a copy of the GNU General Public</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * License along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * HP designates this particular file as subject to the &quot;Classpath&quot; exception</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * as provided by HP in the LICENSE.txt file that accompanied this code.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="retrospective__lock__list_8hpp.html">foedus/xct/retrospective_lock_list.hpp</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;glog/logging.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="page__resolver_8hpp.html">foedus/memory/page_resolver.hpp</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="page_8hpp.html">foedus/storage/page.hpp</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread_8hpp.html">foedus/thread/thread.hpp</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__pimpl_8hpp.html">foedus/thread/thread_pimpl.hpp</a>&quot;</span>       <span class="comment">// only for explicit template instantiation</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xct_8hpp.html">foedus/xct/xct.hpp</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xct__mcs__adapter__impl_8hpp.html">foedus/xct/xct_mcs_adapter_impl.hpp</a>&quot;</span>  <span class="comment">// only for explicit template instantiation</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xct__mcs__impl_8hpp.html">foedus/xct/xct_mcs_impl.hpp</a>&quot;</span>          <span class="comment">// only for explicit template instantiation</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacefoedus.html">foedus</a> {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">namespace </span>xct {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#ae5243dadf1989a036c762589ac12ac13">   39</a></span>&#160;<a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#ae5243dadf1989a036c762589ac12ac13">RetrospectiveLockList::RetrospectiveLockList</a>() {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  array_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  capacity_ = 0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#acdd6c3ee6c1e8b0da192818e70fec846">clear_entries</a>();</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a483e36fdf16824e1c72b37cc140b4930">   45</a></span>&#160;<a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a483e36fdf16824e1c72b37cc140b4930">RetrospectiveLockList::~RetrospectiveLockList</a>() {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a6c7bc64fe85e2d2173c67b6bd8efc9e5">uninit</a>();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a94b7a86ff61fec046d3c0645023fb535">   49</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a94b7a86ff61fec046d3c0645023fb535">RetrospectiveLockList::init</a>(</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>* array,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  uint32_t capacity,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keyword">const</span> <a class="code" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html">memory::GlobalVolatilePageResolver</a>&amp; resolver) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  array_ = array;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  capacity_ = capacity;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  volatile_page_resolver_ = resolver;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#acdd6c3ee6c1e8b0da192818e70fec846">clear_entries</a>();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#acdd6c3ee6c1e8b0da192818e70fec846">   59</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#acdd6c3ee6c1e8b0da192818e70fec846">RetrospectiveLockList::clear_entries</a>() {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  last_active_entry_ = <a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span> (array_) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// Dummy entry</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    array_[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#ac4dd063e8f157e49b468d9acb3efa276">universal_lock_id_</a> = 0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    array_[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a1a081cde83f98cb29241c65708ac84ed">lock_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    array_[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a6dd08e0e30b67bb07a86dfd66dba2fd1">preferred_mode_</a> = <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    array_[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a045022b5415f8fa093fe7ec0ff17b565">taken_mode_</a> = <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a6c7bc64fe85e2d2173c67b6bd8efc9e5">   70</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a6c7bc64fe85e2d2173c67b6bd8efc9e5">RetrospectiveLockList::uninit</a>() {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  array_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  capacity_ = 0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#acdd6c3ee6c1e8b0da192818e70fec846">clear_entries</a>();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#a706b0c0a7f4c44b0f9dd395154873780">   76</a></span>&#160;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a706b0c0a7f4c44b0f9dd395154873780">CurrentLockList::CurrentLockList</a>() {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  array_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  capacity_ = 0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#abb020fdb3951460f9c283d4700696ad2">clear_entries</a>();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#a040661fef567664e4f223f327d4e6a90">   82</a></span>&#160;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a040661fef567664e4f223f327d4e6a90">CurrentLockList::~CurrentLockList</a>() {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a55773472fd16796b2b28cc6ca4840ec4">uninit</a>();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#ac79149bb167fa69b2afc7861c0c70483">   86</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#ac79149bb167fa69b2afc7861c0c70483">CurrentLockList::init</a>(</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>* array,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  uint32_t capacity,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">const</span> <a class="code" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html">memory::GlobalVolatilePageResolver</a>&amp; resolver) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  array_ = array;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  capacity_ = capacity;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  volatile_page_resolver_ = resolver;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#abb020fdb3951460f9c283d4700696ad2">clear_entries</a>();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#abb020fdb3951460f9c283d4700696ad2">   96</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#abb020fdb3951460f9c283d4700696ad2">CurrentLockList::clear_entries</a>() {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  last_active_entry_ = <a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  last_locked_entry_ = <a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span> (array_) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Dummy entry</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    array_[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#ac4dd063e8f157e49b468d9acb3efa276">universal_lock_id_</a> = 0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    array_[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a1a081cde83f98cb29241c65708ac84ed">lock_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    array_[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a6dd08e0e30b67bb07a86dfd66dba2fd1">preferred_mode_</a> = <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    array_[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a045022b5415f8fa093fe7ec0ff17b565">taken_mode_</a> = <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#a55773472fd16796b2b28cc6ca4840ec4">  109</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a55773472fd16796b2b28cc6ca4840ec4">CurrentLockList::uninit</a>() {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  array_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  capacity_ = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#abb020fdb3951460f9c283d4700696ad2">clear_entries</a>();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="namespacefoedus_1_1xct.html#a616967518f17dd3edaa2c6ef7495851a">  118</a></span>&#160;std::ostream&amp; <a class="code" href="namespacefoedus_1_1xct.html#a616967518f17dd3edaa2c6ef7495851a">operator&lt;&lt;</a>(std::ostream&amp; o, <span class="keyword">const</span> <a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>&amp; v) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;LockEntry&gt;&quot;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;LockId&gt;&quot;</span> &lt;&lt; v.<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#ac4dd063e8f157e49b468d9acb3efa276">universal_lock_id_</a> &lt;&lt; <span class="stringliteral">&quot;&lt;/LockId&gt;&quot;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;PreferredMode&gt;&quot;</span> &lt;&lt; v.<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a6dd08e0e30b67bb07a86dfd66dba2fd1">preferred_mode_</a> &lt;&lt; <span class="stringliteral">&quot;&lt;/PreferredMode&gt;&quot;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;TakenMode&gt;&quot;</span> &lt;&lt; v.<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a045022b5415f8fa093fe7ec0ff17b565">taken_mode_</a> &lt;&lt; <span class="stringliteral">&quot;&lt;/TakenMode&gt;&quot;</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (v.<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a1a081cde83f98cb29241c65708ac84ed">lock_</a>) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    o &lt;&lt; *(v.<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a1a081cde83f98cb29241c65708ac84ed">lock_</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;Lock&gt;nullptr&lt;/Lock&gt;&quot;</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;/LockEntry&gt;&quot;</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="namespacefoedus_1_1xct.html#ac0a5c1395eca07edfdf88dcd1030c702">  132</a></span>&#160;std::ostream&amp; <a class="code" href="namespacefoedus_1_1xct.html#a616967518f17dd3edaa2c6ef7495851a">operator&lt;&lt;</a>(std::ostream&amp; o, <span class="keyword">const</span> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html">CurrentLockList</a>&amp; v) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;CurrentLockList&gt;&quot;</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;Capacity&gt;&quot;</span> &lt;&lt; v.capacity_ &lt;&lt; <span class="stringliteral">&quot;&lt;/Capacity&gt;&quot;</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;LastActiveEntry&gt;&quot;</span> &lt;&lt; v.last_active_entry_ &lt;&lt; <span class="stringliteral">&quot;&lt;/LastActiveEntry&gt;&quot;</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;LastLockedEntry&gt;&quot;</span> &lt;&lt; v.last_locked_entry_ &lt;&lt; <span class="stringliteral">&quot;&lt;/LastLockedEntry&gt;&quot;</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keyword">const</span> uint32_t kMaxShown = 32U;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = 1U; i &lt;= std::min(v.last_active_entry_, kMaxShown); ++i) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    o &lt;&lt; v.array_[i];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;/CurrentLockList&gt;&quot;</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="namespacefoedus_1_1xct.html#af504a96c84aa598fe48f27fb0c93dadd">  145</a></span>&#160;std::ostream&amp; <a class="code" href="namespacefoedus_1_1xct.html#a616967518f17dd3edaa2c6ef7495851a">operator&lt;&lt;</a>(std::ostream&amp; o, <span class="keyword">const</span> <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html">RetrospectiveLockList</a>&amp; v) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;RetrospectiveLockList&gt;&quot;</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;Capacity&gt;&quot;</span> &lt;&lt; v.capacity_ &lt;&lt; <span class="stringliteral">&quot;&lt;/Capacity&gt;&quot;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;LastActiveEntry&gt;&quot;</span> &lt;&lt; v.last_active_entry_ &lt;&lt; <span class="stringliteral">&quot;&lt;/LastActiveEntry&gt;&quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keyword">const</span> uint32_t kMaxShown = 32U;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = 1U; i &lt;= std::min(v.last_active_entry_, kMaxShown); ++i) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    o &lt;&lt; v.array_[i];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;/RetrospectiveLockList&gt;&quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> LOCK_LIST&gt;</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="namespacefoedus_1_1xct.html#a736225e9852f9c75b92e134dbbe40a68">  159</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacefoedus_1_1xct.html#a736225e9852f9c75b92e134dbbe40a68">lock_assert_sorted</a>(<span class="keyword">const</span> LOCK_LIST&amp; list) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keyword">const</span> <a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>* array = list.get_array();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].universal_lock_id_ == 0);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].lock_ == <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].taken_mode_ == <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array[<a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>].preferred_mode_ == <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keyword">const</span> <a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> last_active_entry = list.get_last_active_entry();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> pos = 2U; pos &lt;= last_active_entry; ++pos) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array[pos - 1U].universal_lock_id_ &lt; array[pos].universal_lock_id_);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array[pos].universal_lock_id_ != 0);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array[pos].lock_ != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">const</span> <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* page = <a class="code" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25">storage::to_page</a>(array[pos].lock_);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    uintptr_t lock_addr = <span class="keyword">reinterpret_cast&lt;</span>uintptr_t<span class="keyword">&gt;</span>(array[pos].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a1a081cde83f98cb29241c65708ac84ed">lock_</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keyword">auto</span> page_id = page-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#ac2a6248866335cc84b16bb0530eb76f4">get_volatile_page_id</a>();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array[pos].universal_lock_id_</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      == <a class="code" href="namespacefoedus_1_1xct.html#a94b21516b530d0be271c6005a72009ad">to_universal_lock_id</a>(page_id.get_numa_node(), page_id.get_offset(), lock_addr));</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#a7485f0d26810767b3bef18e12233daa7">  178</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a7485f0d26810767b3bef18e12233daa7">CurrentLockList::assert_sorted_impl</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#aed99dee60f9529d5cfabb5e1742038da">assert_last_locked_entry</a>();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="namespacefoedus_1_1xct.html#a736225e9852f9c75b92e134dbbe40a68">lock_assert_sorted</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a14d555cbd9ddee31c68c9c81ff84c129">  182</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a14d555cbd9ddee31c68c9c81ff84c129">RetrospectiveLockList::assert_sorted_impl</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="namespacefoedus_1_1xct.html#a736225e9852f9c75b92e134dbbe40a68">lock_assert_sorted</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#a3cb71937e25bc68318ef0c9808a4a482">  189</a></span>&#160;<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a3cb71937e25bc68318ef0c9808a4a482">CurrentLockList::binary_search</a>(<a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">UniversalLockId</a> lock)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#aed99dee60f9529d5cfabb5e1742038da">assert_last_locked_entry</a>();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">return</span> lock_binary_search&lt;CurrentLockList, LockEntry&gt;(*<span class="keyword">this</span>, lock);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#aa962bee534789c572b6c38984c5d5d38">  193</a></span>&#160;<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#aa962bee534789c572b6c38984c5d5d38">RetrospectiveLockList::binary_search</a>(<a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">UniversalLockId</a> lock)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">return</span> lock_binary_search&lt;RetrospectiveLockList, LockEntry&gt;(*<span class="keyword">this</span>, lock);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#af0b8f0d95e3ae99293ffc14cf4067573">  196</a></span>&#160;<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#af0b8f0d95e3ae99293ffc14cf4067573">CurrentLockList::lower_bound</a>(<a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">UniversalLockId</a> lock)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#aed99dee60f9529d5cfabb5e1742038da">assert_last_locked_entry</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">return</span> lock_lower_bound&lt;CurrentLockList, LockEntry&gt;(*<span class="keyword">this</span>, lock);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a67a3371918f47951ef47af35c2979697">  200</a></span>&#160;<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a67a3371918f47951ef47af35c2979697">RetrospectiveLockList::lower_bound</a>(<a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">UniversalLockId</a> lock)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">return</span> lock_lower_bound&lt;RetrospectiveLockList, LockEntry&gt;(*<span class="keyword">this</span>, lock);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#a6db689767722f1d30821d63144bf8bde">  204</a></span>&#160;<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a6db689767722f1d30821d63144bf8bde">CurrentLockList::get_or_add_entry</a>(</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">UniversalLockId</a> <span class="keywordtype">id</span>,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1RwLockableXctId.html">RwLockableXctId</a>* lock,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="group__XCT.html#gae2b82bc723691c581c22944ef3cef43c">LockMode</a> preferred_mode) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#aed99dee60f9529d5cfabb5e1742038da">assert_last_locked_entry</a>();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<span class="keywordtype">id</span> == <a class="code" href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748">xct_id_to_universal_lock_id</a>(volatile_page_resolver_, lock));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">// Easy case? (lock &gt;= the last entry)</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> insert_pos = <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#af0b8f0d95e3ae99293ffc14cf4067573">lower_bound</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(insert_pos != <a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// Larger than all existing entries? Append to the last!</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">if</span> (insert_pos &gt; last_active_entry_) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(insert_pos == last_active_entry_ + 1U);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> new_pos = issue_new_position();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    array_[new_pos].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a54190c5faf4f6943043c1d83ed435f44">set</a>(<span class="keywordtype">id</span>, lock, preferred_mode, <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(new_pos == insert_pos);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">return</span> new_pos;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// lower_bound returns the first entry that is NOT less than. is it equal?</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array_[insert_pos].universal_lock_id_ &gt;= <span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span> (array_[insert_pos].universal_lock_id_ == <span class="keywordtype">id</span>) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// Found existing!</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (array_[insert_pos].preferred_mode_ &lt; preferred_mode) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      array_[insert_pos].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a6dd08e0e30b67bb07a86dfd66dba2fd1">preferred_mode_</a> = preferred_mode;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> insert_pos;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  DVLOG(1) &lt;&lt; <span class="stringliteral">&quot;not an easy case. We need to adjust the order. This is costly!&quot;</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(insert_pos &lt;= last_active_entry_);  <span class="comment">// otherwise we went into the 1st branch</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array_[insert_pos].universal_lock_id_ &gt; <span class="keywordtype">id</span>);  <span class="comment">// if ==, we went into the 2nd branch</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(insert_pos == 1U || array_[insert_pos - 1U].universal_lock_id_ &lt; <span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> new_last_pos = issue_new_position();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(new_last_pos &gt; insert_pos);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  uint64_t moved_bytes = <span class="keyword">sizeof</span>(<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>) * (new_last_pos - insert_pos);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  std::memmove(array_ + insert_pos + 1U, array_ + insert_pos, moved_bytes);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  DVLOG(1) &lt;&lt; <span class="stringliteral">&quot;Re-sorted. hope this won&#39;t happen often&quot;</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  array_[insert_pos].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a54190c5faf4f6943043c1d83ed435f44">set</a>(<span class="keywordtype">id</span>, lock, preferred_mode, <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">if</span> (last_locked_entry_ &gt;= insert_pos) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    ++last_locked_entry_;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#acbed8e324b88389217b42a132e0547b8">assert_sorted</a>();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">return</span> insert_pos;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a38d217000e4df1d2d8e829c37218f93e">  252</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a38d217000e4df1d2d8e829c37218f93e">RetrospectiveLockList::construct</a>(<a class="code" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a>* context, uint32_t read_lock_threshold) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1Xct.html">Xct</a>* xct = &amp;context-&gt;<a class="code" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3">get_current_xct</a>();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(xct-&gt;<a class="code" href="classfoedus_1_1xct_1_1Xct.html#a9a76be25f22fd49683d2a4138ab7b199">is_active</a>());</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="comment">// We currently hold read/write-set separately. So, we need to sort and merge them.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1ReadXctAccess.html">ReadXctAccess</a>* read_set = xct-&gt;<a class="code" href="classfoedus_1_1xct_1_1Xct.html#ae523b00cead387e6addb1366fe08546a">get_read_set</a>();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keyword">const</span> uint32_t read_set_size = xct-&gt;<a class="code" href="classfoedus_1_1xct_1_1Xct.html#af7b9c43800807db798d2e58bc07ad5cd">get_read_set_size</a>();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1WriteXctAccess.html">WriteXctAccess</a>* write_set = xct-&gt;<a class="code" href="classfoedus_1_1xct_1_1Xct.html#ae5fa3dcdb891b99e5bc7d83ff2029f46">get_write_set</a>();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keyword">const</span> uint32_t write_set_size = xct-&gt;<a class="code" href="classfoedus_1_1xct_1_1Xct.html#a674e3ce0252c1c9d2f73edf3b3c4307e">get_write_set_size</a>();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(capacity_ &gt;= read_set_size + write_set_size);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  last_active_entry_ = <a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">if</span> (read_set_size == 0 &amp;&amp; write_set_size == 0) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; read_set_size; ++i) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="structfoedus_1_1xct_1_1RwLockableXctId.html">RwLockableXctId</a>* lock = read_set[i].owner_id_address_;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* page = <a class="code" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25">storage::to_page</a>(lock);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> (page-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#a640f2815b10642380b272863a516b6c7">hotness_</a>.<a class="code" href="structfoedus_1_1assorted_1_1ProbCounter.html#ab3155d870c9b9c5b431f4404fa09b76a">value_</a> &lt; read_lock_threshold</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      &amp;&amp; lock-&gt;<a class="code" href="structfoedus_1_1xct_1_1RwLockableXctId.html#a8735d5698123b41317b3c5970ffd1e50">xct_id_</a> == read_set[i].observed_owner_id_) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="comment">// We also add it to RLL whenever we observed a verification error.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keyword">auto</span> pos = issue_new_position();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      read_set[i].owner_lock_id_ ==</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748">xct_id_to_universal_lock_id</a>(volatile_page_resolver_, lock));</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    array_[pos].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a54190c5faf4f6943043c1d83ed435f44">set</a>(read_set[i].owner_lock_id_, lock, <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca86b3d42905f04dcb855f26eb27fd9a85">kReadLock</a>, <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  DVLOG(1) &lt;&lt; <span class="stringliteral">&quot;Added &quot;</span> &lt;&lt; last_active_entry_ &lt;&lt; <span class="stringliteral">&quot; to RLL for read-locks&quot;</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// Writes are always added to RLL.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; write_set_size; ++i) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keyword">auto</span> pos = issue_new_position();</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      write_set[i].owner_lock_id_ ==</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <a class="code" href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748">xct_id_to_universal_lock_id</a>(volatile_page_resolver_, write_set[i].owner_id_address_));</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    array_[pos].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a54190c5faf4f6943043c1d83ed435f44">set</a>(</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      write_set[i].owner_lock_id_,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      write_set[i].owner_id_address_,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca05c9c6b8c4d5e6e6cb32d7d407189826">kWriteLock</a>,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// Now, the entries are not sorted and we might have duplicates.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// Sort them, and merge entries for the same record.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// std::set? no joke. we can&#39;t afford heap allocation here.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(last_active_entry_ != <a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  std::sort(array_ + 1U, array_ + last_active_entry_ + 1U);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> prev_pos = 1U;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  uint32_t merged_count = 0U;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> pos = 2U; pos &lt;= last_active_entry_; ++pos) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(prev_pos &lt; pos);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(array_[prev_pos].universal_lock_id_ &lt;= array_[pos].universal_lock_id_);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (array_[prev_pos].universal_lock_id_ == array_[pos].universal_lock_id_) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">// Merge!</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">if</span> (array_[pos].preferred_mode_ == <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca05c9c6b8c4d5e6e6cb32d7d407189826">kWriteLock</a>) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        array_[prev_pos].<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a6dd08e0e30b67bb07a86dfd66dba2fd1">preferred_mode_</a> = <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca05c9c6b8c4d5e6e6cb32d7d407189826">kWriteLock</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      ++merged_count;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">// No merge.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">if</span> (prev_pos + 1U &lt; pos) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        std::memcpy(array_ + prev_pos + 1U, array_ + pos, <span class="keyword">sizeof</span>(<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>));</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      ++prev_pos;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// For example, last_active_entry_ was 3 (0=Dummy, 1=A, 2=A, 3=B),</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// prev_pos becomes 2 while merged count is 1.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(prev_pos + merged_count == last_active_entry_);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  last_active_entry_ = prev_pos;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a1397c6847c1ee46ba9c09457b4f5866e">assert_sorted</a>();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;}</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#abaacdb674d1296394cff252f995ce001">  329</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#abaacdb674d1296394cff252f995ce001">CurrentLockList::batch_insert_write_placeholders</a>(</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keyword">const</span> <a class="code" href="structfoedus_1_1xct_1_1WriteXctAccess.html">WriteXctAccess</a>* write_set,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  uint32_t write_set_size) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">// We want to avoid full-sorting and minimize the number of copies/shifts.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// Luckily, write_set is already sorted, so is our array_. Just merge them in order.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">if</span> (write_set_size == 0) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 1; i &lt; write_set_size; ++i) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(write_set[i - 1].ordinal_ != write_set[i].ordinal_);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (write_set[i].owner_lock_id_ == write_set[i - 1].owner_lock_id_) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(write_set[i - 1].ordinal_ &lt; write_set[i].ordinal_);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(write_set[i - 1].owner_lock_id_ &lt; write_set[i].owner_lock_id_);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#acbed8e324b88389217b42a132e0547b8">assert_sorted</a>();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#endif  // NDEBUG</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">// Implementation note: I considered a few approaches to efficiently do the merge.</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">//  1) insertion-sort: that sounds expensive... we might be inserting several</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">//  2) a bit complex. first path to identify the number of new entries, then second path to</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">//   merge from the end, not the beginning, to copy/shift only what we need to.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">//  3) insert all write-sets at the end then invoke std::sort once.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// For now I picked 3) for simplicity. Revisit laster if CPU profile tells something.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">if</span> (last_active_entry_ == <a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// If CLL is now empty, it&#39;s even easier. Just add all write-sets</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    uint32_t added = 0;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">for</span> (uint32_t write_pos = 0; write_pos &lt; write_set_size; ++write_pos) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keyword">const</span> <a class="code" href="structfoedus_1_1xct_1_1WriteXctAccess.html">WriteXctAccess</a>* write = write_set + write_pos;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">if</span> (write_pos &gt; 0) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keyword">const</span> <a class="code" href="structfoedus_1_1xct_1_1WriteXctAccess.html">WriteXctAccess</a>* prev = write_set + write_pos - 1;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#aabd9a9dc321b9512df6740dac7738a0b">ordinal_</a> != prev-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#aabd9a9dc321b9512df6740dac7738a0b">ordinal_</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#a5241ed56ea64a05f4e0464c29261f6b6">owner_lock_id_</a> &gt;= prev-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#a5241ed56ea64a05f4e0464c29261f6b6">owner_lock_id_</a>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">if</span> (write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#a5241ed56ea64a05f4e0464c29261f6b6">owner_lock_id_</a> == prev-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#a5241ed56ea64a05f4e0464c29261f6b6">owner_lock_id_</a>) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;          <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#aabd9a9dc321b9512df6740dac7738a0b">ordinal_</a> &gt; prev-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#aabd9a9dc321b9512df6740dac7738a0b">ordinal_</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      ++added;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>* new_entry = array_ + added;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      new_entry-&gt;<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a54190c5faf4f6943043c1d83ed435f44">set</a>(write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#a5241ed56ea64a05f4e0464c29261f6b6">owner_lock_id_</a>, write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#abd33c0a264f750c327845dd6e88eb1ff">owner_id_address_</a>, <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca05c9c6b8c4d5e6e6cb32d7d407189826">kWriteLock</a>, <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    last_active_entry_ = added;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    uint32_t write_pos = 0;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    uint32_t added = 0;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">LockListPosition</a> pos = 1U; pos &lt;= last_active_entry_ &amp;&amp; write_pos &lt; write_set_size;) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>* existing = array_ + pos;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keyword">const</span> <a class="code" href="structfoedus_1_1xct_1_1WriteXctAccess.html">WriteXctAccess</a>* write = write_set + write_pos;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">UniversalLockId</a> write_lock_id = write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#a5241ed56ea64a05f4e0464c29261f6b6">owner_lock_id_</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">if</span> (existing-&gt;<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#ac4dd063e8f157e49b468d9acb3efa276">universal_lock_id_</a> &lt; write_lock_id) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        ++pos;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (existing-&gt;<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#ac4dd063e8f157e49b468d9acb3efa276">universal_lock_id_</a> == write_lock_id) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">if</span> (existing-&gt;<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a6dd08e0e30b67bb07a86dfd66dba2fd1">preferred_mode_</a> != <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca05c9c6b8c4d5e6e6cb32d7d407189826">kWriteLock</a>) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          existing-&gt;<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a6dd08e0e30b67bb07a86dfd66dba2fd1">preferred_mode_</a> = <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca05c9c6b8c4d5e6e6cb32d7d407189826">kWriteLock</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        ++write_pos;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">// yuppy, new entry.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(existing-&gt;<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#ac4dd063e8f157e49b468d9acb3efa276">universal_lock_id_</a> &gt; write_lock_id);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        ++added;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>* new_entry = array_ + last_active_entry_ + added;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        new_entry-&gt;<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a54190c5faf4f6943043c1d83ed435f44">set</a>(write_lock_id, write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#abd33c0a264f750c327845dd6e88eb1ff">owner_id_address_</a>, <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca05c9c6b8c4d5e6e6cb32d7d407189826">kWriteLock</a>, <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// be careful on duplicate in write-set.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">// It might contain multiple writes to one record.</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">for</span> (++write_pos; write_pos &lt; write_set_size; ++write_pos) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;          <span class="keyword">const</span> <a class="code" href="structfoedus_1_1xct_1_1WriteXctAccess.html">WriteXctAccess</a>* next_write = write_set + write_pos;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">UniversalLockId</a> next_write_id = next_write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#a5241ed56ea64a05f4e0464c29261f6b6">owner_lock_id_</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;          <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(next_write_id &gt;= write_lock_id);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          <span class="keywordflow">if</span> (next_write_id &gt; write_lock_id) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">while</span> (write_pos &lt; write_set_size) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="comment">// After iterating over all existing entries, still some write-set entry remains.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="comment">// Hence they are all after the existing entries.</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keyword">const</span> <a class="code" href="structfoedus_1_1xct_1_1WriteXctAccess.html">WriteXctAccess</a>* write = write_set + write_pos;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">UniversalLockId</a> write_lock_id = write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#a5241ed56ea64a05f4e0464c29261f6b6">owner_lock_id_</a>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(last_active_entry_ == <a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        || array_[last_active_entry_].universal_lock_id_ &lt; write_lock_id);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="comment">// Again, be careful on duplicate in write set.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      ++added;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>* new_entry = array_ + last_active_entry_ + added;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      new_entry-&gt;<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html#a54190c5faf4f6943043c1d83ed435f44">set</a>(write_lock_id, write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#abd33c0a264f750c327845dd6e88eb1ff">owner_id_address_</a>, <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca05c9c6b8c4d5e6e6cb32d7d407189826">kWriteLock</a>, <a class="code" href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">kNoLock</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">for</span> (++write_pos; write_pos &lt; write_set_size; ++write_pos) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keyword">const</span> <a class="code" href="structfoedus_1_1xct_1_1WriteXctAccess.html">WriteXctAccess</a>* next_write = write_set + write_pos;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">UniversalLockId</a> next_write_id = next_write-&gt;<a class="code" href="structfoedus_1_1xct_1_1RecordXctAccess.html#a5241ed56ea64a05f4e0464c29261f6b6">owner_lock_id_</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(next_write_id &gt;= write_lock_id);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordflow">if</span> (next_write_id &gt; write_lock_id) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> (added &gt; 0) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      last_active_entry_ += added;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      std::sort(array_ + 1U, array_ + 1U + last_active_entry_);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// Adjusting last_locked_entry_ is not impossible.. but let&#39;s just recalculate. Not too often.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  last_locked_entry_ = <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a1a668d5dd1b711abed1a9962a8cb4ec1">calculate_last_locked_entry</a>();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#acbed8e324b88389217b42a132e0547b8">assert_sorted</a>();</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; write_set_size; ++i) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a3cb71937e25bc68318ef0c9808a4a482">binary_search</a>(write_set[i].owner_lock_id_) != <a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="preprocessor">#endif  // NDEBUG</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="classfoedus_1_1xct_1_1CurrentLockList.html#a4a10e19f1d603ab47e74c605a9909fb5">  445</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a4a10e19f1d603ab47e74c605a9909fb5">CurrentLockList::prepopulate_for_retrospective_lock_list</a>(<span class="keyword">const</span> <a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html">RetrospectiveLockList</a>&amp; rll) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a761b506c86d1d8e5681cab34fac1ad29">is_empty</a>());</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!rll.<a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a6c96bb5725be6694030bd8ce88d68698">is_empty</a>());</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  rll.<a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a1397c6847c1ee46ba9c09457b4f5866e">assert_sorted</a>();</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// Because now we use LockEntry for both RLL and CLL, we can do just one memcpy</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  std::memcpy(array_ + 1U, rll.<a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#acd7b6530aeff7f5323880bf0b6b14ce0">get_array</a>() + 1U, <span class="keyword">sizeof</span>(<a class="code" href="structfoedus_1_1xct_1_1LockEntry.html">LockEntry</a>) * rll.<a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#afeae5ce72d1c324ecc32dce36459340a">get_last_active_entry</a>());</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  last_active_entry_ = rll.<a class="code" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#afeae5ce72d1c324ecc32dce36459340a">get_last_active_entry</a>();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  last_locked_entry_ = <a class="code" href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">kLockListPositionInvalid</a>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#acbed8e324b88389217b42a132e0547b8">assert_sorted</a>();</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keywordtype">void</span> CurrentLockList::release_all_after_debuglog(</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  uint32_t released_read_locks,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  uint32_t released_write_locks,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  uint32_t already_released_locks,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  uint32_t canceled_async_read_locks,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  uint32_t canceled_async_write_locks)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  DVLOG(1) &lt;&lt; <span class="stringliteral">&quot; Unlocked &quot;</span> &lt;&lt; released_read_locks &lt;&lt; <span class="stringliteral">&quot; read locks and&quot;</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; released_write_locks &lt;&lt; <span class="stringliteral">&quot; write locks. &quot;</span> &lt;&lt; already_released_locks</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; Also cancelled &quot;</span> &lt;&lt; canceled_async_read_locks &lt;&lt; <span class="stringliteral">&quot; async-waiting read locks, &quot;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; canceled_async_write_locks &lt;&lt; <span class="stringliteral">&quot; async-waiting write locks. &quot;</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; already_released_locks &lt;&lt; <span class="stringliteral">&quot; were already unlocked&quot;</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordtype">void</span> CurrentLockList::giveup_all_after_debuglog(</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  uint32_t givenup_read_locks,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  uint32_t givenup_write_locks,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  uint32_t givenup_upgrades,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  uint32_t already_enough_locks,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  uint32_t canceled_async_read_locks,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  uint32_t canceled_async_write_locks)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  DVLOG(1) &lt;&lt; <span class="stringliteral">&quot; Gave up &quot;</span> &lt;&lt; givenup_read_locks &lt;&lt; <span class="stringliteral">&quot; read locks and&quot;</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; givenup_write_locks &lt;&lt; <span class="stringliteral">&quot; write locks, &quot;</span> &lt;&lt; givenup_upgrades &lt;&lt; <span class="stringliteral">&quot; upgrades.&quot;</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; Also cancelled &quot;</span> &lt;&lt; canceled_async_read_locks &lt;&lt; <span class="stringliteral">&quot; async-waiting read locks, &quot;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; canceled_async_write_locks &lt;&lt; <span class="stringliteral">&quot; async-waiting write locks. &quot;</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; already_enough_locks &lt;&lt; <span class="stringliteral">&quot; already had enough lock mode&quot;</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}  <span class="comment">// namespace xct</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;}  <span class="comment">// namespace foedus</span></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a55773472fd16796b2b28cc6ca4840ec4"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a55773472fd16796b2b28cc6ca4840ec4">foedus::xct::CurrentLockList::uninit</a></div><div class="ttdeci">void uninit()</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00109">retrospective_lock_list.cpp:109</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_ac48c54832becbaa9141926af14705ba3"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3">foedus::thread::Thread::get_current_xct</a></div><div class="ttdeci">xct::Xct &amp; get_current_xct()</div><div class="ttdoc">Returns the transaction that is currently running on this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8cpp_source.html#l00075">thread.cpp:75</a></div></div>
<div class="ttc" id="group__XCT_html_ggae2b82bc723691c581c22944ef3cef43ca86b3d42905f04dcb855f26eb27fd9a85"><div class="ttname"><a href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca86b3d42905f04dcb855f26eb27fd9a85">foedus::xct::kReadLock</a></div><div class="ttdoc">taken_mode_: we took a read-lock, not write-lock yet. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00105">xct_id.hpp:105</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1LockEntry_html_ac4dd063e8f157e49b468d9acb3efa276"><div class="ttname"><a href="structfoedus_1_1xct_1_1LockEntry.html#ac4dd063e8f157e49b468d9acb3efa276">foedus::xct::LockEntry::universal_lock_id_</a></div><div class="ttdeci">UniversalLockId universal_lock_id_</div><div class="ttdoc">Used to order locks in canonical order. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00125">retrospective_lock_list.hpp:125</a></div></div>
<div class="ttc" id="namespacefoedus_1_1xct_html_a616967518f17dd3edaa2c6ef7495851a"><div class="ttname"><a href="namespacefoedus_1_1xct.html#a616967518f17dd3edaa2c6ef7495851a">foedus::xct::operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;o, const LockEntry &amp;v)</div><div class="ttdoc">Debugging. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00118">retrospective_lock_list.cpp:118</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_abb020fdb3951460f9c283d4700696ad2"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#abb020fdb3951460f9c283d4700696ad2">foedus::xct::CurrentLockList::clear_entries</a></div><div class="ttdeci">void clear_entries()</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00096">retrospective_lock_list.cpp:96</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_aa962bee534789c572b6c38984c5d5d38"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#aa962bee534789c572b6c38984c5d5d38">foedus::xct::RetrospectiveLockList::binary_search</a></div><div class="ttdeci">LockListPosition binary_search(UniversalLockId lock) const </div><div class="ttdoc">Analogous to std::binary_search() for the given lock. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00193">retrospective_lock_list.cpp:193</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a706b0c0a7f4c44b0f9dd395154873780"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a706b0c0a7f4c44b0f9dd395154873780">foedus::xct::CurrentLockList::CurrentLockList</a></div><div class="ttdeci">CurrentLockList()</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00076">retrospective_lock_list.cpp:76</a></div></div>
<div class="ttc" id="group__STORAGE_html_gaa114fc1859c2d4cb8b9e2021cb11cb25"><div class="ttname"><a href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25">foedus::storage::to_page</a></div><div class="ttdeci">Page * to_page(const void *address)</div><div class="ttdoc">super-dirty way to obtain Page the address belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00395">page.hpp:395</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1LockEntry_html_a54190c5faf4f6943043c1d83ed435f44"><div class="ttname"><a href="structfoedus_1_1xct_1_1LockEntry.html#a54190c5faf4f6943043c1d83ed435f44">foedus::xct::LockEntry::set</a></div><div class="ttdeci">void set(UniversalLockId id, RwLockableXctId *lock, LockMode preferred_mode, LockMode taken_mode)</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00150">retrospective_lock_list.hpp:150</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_a674e3ce0252c1c9d2f73edf3b3c4307e"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#a674e3ce0252c1c9d2f73edf3b3c4307e">foedus::xct::Xct::get_write_set_size</a></div><div class="ttdeci">uint32_t get_write_set_size() const </div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00157">xct.hpp:157</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1RecordXctAccess_html_aabd9a9dc321b9512df6740dac7738a0b"><div class="ttname"><a href="structfoedus_1_1xct_1_1RecordXctAccess.html#aabd9a9dc321b9512df6740dac7738a0b">foedus::xct::RecordXctAccess::ordinal_</a></div><div class="ttdeci">uint32_t ordinal_</div><div class="ttdoc">Indicates the ordinal among ReadXctAccess/WriteXctAccess of this transaction. </div><div class="ttdef"><b>Definition:</b> <a href="xct__access_8hpp_source.html#l00096">xct_access.hpp:96</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_a38d217000e4df1d2d8e829c37218f93e"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a38d217000e4df1d2d8e829c37218f93e">foedus::xct::RetrospectiveLockList::construct</a></div><div class="ttdeci">void construct(thread::Thread *context, uint32_t read_lock_threshold)</div><div class="ttdoc">Fill out this retrospetive lock list for the next run of the given transaction. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00252">retrospective_lock_list.cpp:252</a></div></div>
<div class="ttc" id="namespacefoedus_html"><div class="ttname"><a href="namespacefoedus.html">foedus</a></div><div class="ttdoc">Root package of FOEDUS (Fast Optimistic Engine for Data Unification Services). </div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00044">assert_nd.hpp:44</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1WriteXctAccess_html"><div class="ttname"><a href="structfoedus_1_1xct_1_1WriteXctAccess.html">foedus::xct::WriteXctAccess</a></div><div class="ttdoc">Represents a record of write-access during a transaction. </div><div class="ttdef"><b>Definition:</b> <a href="xct__access_8hpp_source.html#l00168">xct_access.hpp:168</a></div></div>
<div class="ttc" id="thread__pimpl_8hpp_html"><div class="ttname"><a href="thread__pimpl_8hpp.html">thread_pimpl.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html">foedus::thread::Thread</a></div><div class="ttdoc">Represents one thread running on one NUMA core. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8hpp_source.html#l00048">thread.hpp:48</a></div></div>
<div class="ttc" id="xct_8hpp_html"><div class="ttname"><a href="xct_8hpp.html">xct.hpp</a></div></div>
<div class="ttc" id="page_8hpp_html"><div class="ttname"><a href="page_8hpp.html">page.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_a6c7bc64fe85e2d2173c67b6bd8efc9e5"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a6c7bc64fe85e2d2173c67b6bd8efc9e5">foedus::xct::RetrospectiveLockList::uninit</a></div><div class="ttdeci">void uninit()</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00070">retrospective_lock_list.cpp:70</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ProbCounter_html_ab3155d870c9b9c5b431f4404fa09b76a"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ProbCounter.html#ab3155d870c9b9c5b431f4404fa09b76a">foedus::assorted::ProbCounter::value_</a></div><div class="ttdeci">uint8_t value_</div><div class="ttdoc">Log arithmic counter of aborts. </div><div class="ttdef"><b>Definition:</b> <a href="prob__counter_8hpp_source.html#l00043">prob_counter.hpp:43</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html">foedus::xct::Xct</a></div><div class="ttdoc">Represents a user transaction. </div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00058">xct.hpp:58</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_afeae5ce72d1c324ecc32dce36459340a"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#afeae5ce72d1c324ecc32dce36459340a">foedus::xct::RetrospectiveLockList::get_last_active_entry</a></div><div class="ttdeci">LockListPosition get_last_active_entry() const </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00244">retrospective_lock_list.hpp:244</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_af0b8f0d95e3ae99293ffc14cf4067573"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#af0b8f0d95e3ae99293ffc14cf4067573">foedus::xct::CurrentLockList::lower_bound</a></div><div class="ttdeci">LockListPosition lower_bound(UniversalLockId lock) const </div><div class="ttdoc">Analogous to std::lower_bound() for the given lock. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00196">retrospective_lock_list.cpp:196</a></div></div>
<div class="ttc" id="namespacefoedus_1_1xct_html_a3882c3684e3adb4a6992ef230443a02c"><div class="ttname"><a href="namespacefoedus_1_1xct.html#a3882c3684e3adb4a6992ef230443a02c">foedus::xct::kLockListPositionInvalid</a></div><div class="ttdeci">const LockListPosition kLockListPositionInvalid</div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00149">xct_id.hpp:149</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1ReadXctAccess_html"><div class="ttname"><a href="structfoedus_1_1xct_1_1ReadXctAccess.html">foedus::xct::ReadXctAccess</a></div><div class="ttdoc">Represents a record of read-access during a transaction. </div><div class="ttdef"><b>Definition:</b> <a href="xct__access_8hpp_source.html#l00139">xct_access.hpp:139</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_a9a76be25f22fd49683d2a4138ab7b199"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#a9a76be25f22fd49683d2a4138ab7b199">foedus::xct::Xct::is_active</a></div><div class="ttdeci">bool is_active() const </div><div class="ttdoc">Returns whether the object is an active transaction. </div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00121">xct.hpp:121</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1RwLockableXctId_html_a8735d5698123b41317b3c5970ffd1e50"><div class="ttname"><a href="structfoedus_1_1xct_1_1RwLockableXctId.html#a8735d5698123b41317b3c5970ffd1e50">foedus::xct::RwLockableXctId::xct_id_</a></div><div class="ttdeci">XctId xct_id_</div><div class="ttdoc">the second 64bit: Persistent status part of TID. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l01137">xct_id.hpp:1137</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1LockEntry_html"><div class="ttname"><a href="structfoedus_1_1xct_1_1LockEntry.html">foedus::xct::LockEntry</a></div><div class="ttdoc">An entry in CLL and RLL, representing a lock that is taken or will be taken. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00120">retrospective_lock_list.hpp:120</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a4a10e19f1d603ab47e74c605a9909fb5"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a4a10e19f1d603ab47e74c605a9909fb5">foedus::xct::CurrentLockList::prepopulate_for_retrospective_lock_list</a></div><div class="ttdeci">void prepopulate_for_retrospective_lock_list(const RetrospectiveLockList &amp;rll)</div><div class="ttdoc">Another batch-insert method used at the beginning of a transaction. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00445">retrospective_lock_list.cpp:445</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_ae523b00cead387e6addb1366fe08546a"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#ae523b00cead387e6addb1366fe08546a">foedus::xct::Xct::get_read_set</a></div><div class="ttdeci">ReadXctAccess * get_read_set()</div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00162">xct.hpp:162</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_a483e36fdf16824e1c72b37cc140b4930"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a483e36fdf16824e1c72b37cc140b4930">foedus::xct::RetrospectiveLockList::~RetrospectiveLockList</a></div><div class="ttdeci">~RetrospectiveLockList()</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00045">retrospective_lock_list.cpp:45</a></div></div>
<div class="ttc" id="group__XCT_html_ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c"><div class="ttname"><a href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca46a4f32dedfe259835e730a34150e07c">foedus::xct::kNoLock</a></div><div class="ttdoc">taken_mode_: Not taken the lock yet. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00100">xct_id.hpp:100</a></div></div>
<div class="ttc" id="group__XCT_html_ga21ce32adf787156f3dd820273426026a"><div class="ttname"><a href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">foedus::xct::UniversalLockId</a></div><div class="ttdeci">uintptr_t UniversalLockId</div><div class="ttdoc">Universally ordered identifier of each lock. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00134">xct_id.hpp:134</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1RwLockableXctId_html"><div class="ttname"><a href="structfoedus_1_1xct_1_1RwLockableXctId.html">foedus::xct::RwLockableXctId</a></div><div class="ttdoc">The MCS reader-writer lock variant of LockableXctId. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l01132">xct_id.hpp:1132</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a7485f0d26810767b3bef18e12233daa7"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a7485f0d26810767b3bef18e12233daa7">foedus::xct::CurrentLockList::assert_sorted_impl</a></div><div class="ttdeci">void assert_sorted_impl() const </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00178">retrospective_lock_list.cpp:178</a></div></div>
<div class="ttc" id="namespacefoedus_1_1xct_html_a94b21516b530d0be271c6005a72009ad"><div class="ttname"><a href="namespacefoedus_1_1xct.html#a94b21516b530d0be271c6005a72009ad">foedus::xct::to_universal_lock_id</a></div><div class="ttdeci">UniversalLockId to_universal_lock_id(storage::VolatilePagePointer page_id, uintptr_t addr)</div><div class="ttdef"><b>Definition:</b> <a href="sysxct__impl_8hpp_source.html#l00063">sysxct_impl.hpp:63</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1Page_html_ac2a6248866335cc84b16bb0530eb76f4"><div class="ttname"><a href="structfoedus_1_1storage_1_1Page.html#ac2a6248866335cc84b16bb0530eb76f4">foedus::storage::Page::get_volatile_page_id</a></div><div class="ttdeci">VolatilePagePointer get_volatile_page_id() const </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00339">page.hpp:339</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_acdd6c3ee6c1e8b0da192818e70fec846"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#acdd6c3ee6c1e8b0da192818e70fec846">foedus::xct::RetrospectiveLockList::clear_entries</a></div><div class="ttdeci">void clear_entries()</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00059">retrospective_lock_list.cpp:59</a></div></div>
<div class="ttc" id="namespacefoedus_1_1xct_html_ae36b3307af22f430a8f11765e3e57748"><div class="ttname"><a href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748">foedus::xct::xct_id_to_universal_lock_id</a></div><div class="ttdeci">UniversalLockId xct_id_to_universal_lock_id(const memory::GlobalVolatilePageResolver &amp;resolver, RwLockableXctId *lock)</div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l01226">xct_id.hpp:1226</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_af7b9c43800807db798d2e58bc07ad5cd"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#af7b9c43800807db798d2e58bc07ad5cd">foedus::xct::Xct::get_read_set_size</a></div><div class="ttdeci">uint32_t get_read_set_size() const </div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00156">xct.hpp:156</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1RecordXctAccess_html_abd33c0a264f750c327845dd6e88eb1ff"><div class="ttname"><a href="structfoedus_1_1xct_1_1RecordXctAccess.html#abd33c0a264f750c327845dd6e88eb1ff">foedus::xct::RecordXctAccess::owner_id_address_</a></div><div class="ttdeci">RwLockableXctId * owner_id_address_</div><div class="ttdoc">Pointer to the accessed record. </div><div class="ttdef"><b>Definition:</b> <a href="xct__access_8hpp_source.html#l00102">xct_access.hpp:102</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_a6c96bb5725be6694030bd8ce88d68698"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a6c96bb5725be6694030bd8ce88d68698">foedus::xct::RetrospectiveLockList::is_empty</a></div><div class="ttdeci">bool is_empty() const </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00248">retrospective_lock_list.hpp:248</a></div></div>
<div class="ttc" id="group__XCT_html_gaf1e1817b6663c210b329ce1ea57e63fb"><div class="ttname"><a href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">foedus::xct::LockListPosition</a></div><div class="ttdeci">uint32_t LockListPosition</div><div class="ttdoc">Index in a lock-list, either RLL or CLL. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00148">xct_id.hpp:148</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a3cb71937e25bc68318ef0c9808a4a482"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a3cb71937e25bc68318ef0c9808a4a482">foedus::xct::CurrentLockList::binary_search</a></div><div class="ttdeci">LockListPosition binary_search(UniversalLockId lock) const </div><div class="ttdoc">Analogous to std::binary_search() for the given lock. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00189">retrospective_lock_list.cpp:189</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a040661fef567664e4f223f327d4e6a90"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a040661fef567664e4f223f327d4e6a90">foedus::xct::CurrentLockList::~CurrentLockList</a></div><div class="ttdeci">~CurrentLockList()</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00082">retrospective_lock_list.cpp:82</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a1a668d5dd1b711abed1a9962a8cb4ec1"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a1a668d5dd1b711abed1a9962a8cb4ec1">foedus::xct::CurrentLockList::calculate_last_locked_entry</a></div><div class="ttdeci">LockListPosition calculate_last_locked_entry() const </div><div class="ttdoc">Calculate last_locked_entry_ by really checking the whole list. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00393">retrospective_lock_list.hpp:393</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1LockEntry_html_a6dd08e0e30b67bb07a86dfd66dba2fd1"><div class="ttname"><a href="structfoedus_1_1xct_1_1LockEntry.html#a6dd08e0e30b67bb07a86dfd66dba2fd1">foedus::xct::LockEntry::preferred_mode_</a></div><div class="ttdeci">LockMode preferred_mode_</div><div class="ttdoc">Whick lock mode we should take according to RLL. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00136">retrospective_lock_list.hpp:136</a></div></div>
<div class="ttc" id="group__XCT_html_ggae2b82bc723691c581c22944ef3cef43ca05c9c6b8c4d5e6e6cb32d7d407189826"><div class="ttname"><a href="group__XCT.html#ggae2b82bc723691c581c22944ef3cef43ca05c9c6b8c4d5e6e6cb32d7d407189826">foedus::xct::kWriteLock</a></div><div class="ttdoc">taken_mode_: we took a write-lock. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00110">xct_id.hpp:110</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_a67a3371918f47951ef47af35c2979697"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a67a3371918f47951ef47af35c2979697">foedus::xct::RetrospectiveLockList::lower_bound</a></div><div class="ttdeci">LockListPosition lower_bound(UniversalLockId lock) const </div><div class="ttdoc">Analogous to std::lower_bound() for the given lock. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00200">retrospective_lock_list.cpp:200</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_aed99dee60f9529d5cfabb5e1742038da"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#aed99dee60f9529d5cfabb5e1742038da">foedus::xct::CurrentLockList::assert_last_locked_entry</a></div><div class="ttdeci">void assert_last_locked_entry() const </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00405">retrospective_lock_list.hpp:405</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1LockEntry_html_a045022b5415f8fa093fe7ec0ff17b565"><div class="ttname"><a href="structfoedus_1_1xct_1_1LockEntry.html#a045022b5415f8fa093fe7ec0ff17b565">foedus::xct::LockEntry::taken_mode_</a></div><div class="ttdeci">LockMode taken_mode_</div><div class="ttdoc">Whick lock mode we have taken during the current run (of course initially kNoLock) ...</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00139">retrospective_lock_list.hpp:139</a></div></div>
<div class="ttc" id="xct__mcs__impl_8hpp_html"><div class="ttname"><a href="xct__mcs__impl_8hpp.html">xct_mcs_impl.hpp</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1Page_html"><div class="ttname"><a href="structfoedus_1_1storage_1_1Page.html">foedus::storage::Page</a></div><div class="ttdoc">Just a marker to denote that the memory region represents a data page. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00334">page.hpp:334</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_ac79149bb167fa69b2afc7861c0c70483"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#ac79149bb167fa69b2afc7861c0c70483">foedus::xct::CurrentLockList::init</a></div><div class="ttdeci">void init(LockEntry *array, uint32_t capacity, const memory::GlobalVolatilePageResolver &amp;resolver)</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00086">retrospective_lock_list.cpp:86</a></div></div>
<div class="ttc" id="retrospective__lock__list_8hpp_html"><div class="ttname"><a href="retrospective__lock__list_8hpp.html">retrospective_lock_list.hpp</a></div></div>
<div class="ttc" id="thread_8hpp_html"><div class="ttname"><a href="thread_8hpp.html">thread.hpp</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1LockEntry_html_a1a081cde83f98cb29241c65708ac84ed"><div class="ttname"><a href="structfoedus_1_1xct_1_1LockEntry.html#a1a081cde83f98cb29241c65708ac84ed">foedus::xct::LockEntry::lock_</a></div><div class="ttdeci">RwLockableXctId * lock_</div><div class="ttdoc">Virtual address of the lock. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00130">retrospective_lock_list.hpp:130</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_acd7b6530aeff7f5323880bf0b6b14ce0"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#acd7b6530aeff7f5323880bf0b6b14ce0">foedus::xct::RetrospectiveLockList::get_array</a></div><div class="ttdeci">const LockEntry * get_array() const </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00234">retrospective_lock_list.hpp:234</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_ae5fa3dcdb891b99e5bc7d83ff2029f46"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#ae5fa3dcdb891b99e5bc7d83ff2029f46">foedus::xct::Xct::get_write_set</a></div><div class="ttdeci">WriteXctAccess * get_write_set()</div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00163">xct.hpp:163</a></div></div>
<div class="ttc" id="namespacefoedus_1_1xct_html_a736225e9852f9c75b92e134dbbe40a68"><div class="ttname"><a href="namespacefoedus_1_1xct.html#a736225e9852f9c75b92e134dbbe40a68">foedus::xct::lock_assert_sorted</a></div><div class="ttdeci">void lock_assert_sorted(const LOCK_LIST &amp;list)</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00159">retrospective_lock_list.cpp:159</a></div></div>
<div class="ttc" id="page__resolver_8hpp_html"><div class="ttname"><a href="page__resolver_8hpp.html">page_resolver.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_ae5243dadf1989a036c762589ac12ac13"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#ae5243dadf1989a036c762589ac12ac13">foedus::xct::RetrospectiveLockList::RetrospectiveLockList</a></div><div class="ttdeci">RetrospectiveLockList()</div><div class="ttdoc">Init/Uninit. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00039">retrospective_lock_list.cpp:39</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_abaacdb674d1296394cff252f995ce001"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#abaacdb674d1296394cff252f995ce001">foedus::xct::CurrentLockList::batch_insert_write_placeholders</a></div><div class="ttdeci">void batch_insert_write_placeholders(const WriteXctAccess *write_set, uint32_t write_set_size)</div><div class="ttdoc">Create entries for all write-sets in one-shot. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00329">retrospective_lock_list.cpp:329</a></div></div>
<div class="ttc" id="group__XCT_html_gae2b82bc723691c581c22944ef3cef43c"><div class="ttname"><a href="group__XCT.html#gae2b82bc723691c581c22944ef3cef43c">foedus::xct::LockMode</a></div><div class="ttdeci">LockMode</div><div class="ttdoc">Represents a mode of lock. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00095">xct_id.hpp:95</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_a94b7a86ff61fec046d3c0645023fb535"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a94b7a86ff61fec046d3c0645023fb535">foedus::xct::RetrospectiveLockList::init</a></div><div class="ttdeci">void init(LockEntry *array, uint32_t capacity, const memory::GlobalVolatilePageResolver &amp;resolver)</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00049">retrospective_lock_list.cpp:49</a></div></div>
<div class="ttc" id="structfoedus_1_1memory_1_1GlobalVolatilePageResolver_html"><div class="ttname"><a href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html">foedus::memory::GlobalVolatilePageResolver</a></div><div class="ttdoc">Resolves an offset in a volatile page pool to an actual pointer and vice versa. </div><div class="ttdef"><b>Definition:</b> <a href="page__resolver_8hpp_source.html#l00092">page_resolver.hpp:92</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1Page_html_abee44ea141b30e613f3de40831d6ff8e"><div class="ttname"><a href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">foedus::storage::Page::get_header</a></div><div class="ttdeci">PageHeader &amp; get_header()</div><div class="ttdoc">At least the basic header exists in all pages. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00336">page.hpp:336</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html">foedus::xct::CurrentLockList</a></div><div class="ttdoc">Sorted list of all locks, either read-lock or write-lock, taken in the current run. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00309">retrospective_lock_list.hpp:309</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PageHeader_html_a640f2815b10642380b272863a516b6c7"><div class="ttname"><a href="structfoedus_1_1storage_1_1PageHeader.html#a640f2815b10642380b272863a516b6c7">foedus::storage::PageHeader::hotness_</a></div><div class="ttdeci">assorted::ProbCounter hotness_</div><div class="ttdoc">Loosely maintained statistics on data temperature. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00268">page.hpp:268</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_a1397c6847c1ee46ba9c09457b4f5866e"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a1397c6847c1ee46ba9c09457b4f5866e">foedus::xct::RetrospectiveLockList::assert_sorted</a></div><div class="ttdeci">void assert_sorted() const __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00548">retrospective_lock_list.hpp:548</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1RecordXctAccess_html_a5241ed56ea64a05f4e0464c29261f6b6"><div class="ttname"><a href="structfoedus_1_1xct_1_1RecordXctAccess.html#a5241ed56ea64a05f4e0464c29261f6b6">foedus::xct::RecordXctAccess::owner_lock_id_</a></div><div class="ttdeci">UniversalLockId owner_lock_id_</div><div class="ttdoc">Universal Lock ID of the lock in the record. </div><div class="ttdef"><b>Definition:</b> <a href="xct__access_8hpp_source.html#l00105">xct_access.hpp:105</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html_a14d555cbd9ddee31c68c9c81ff84c129"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a14d555cbd9ddee31c68c9c81ff84c129">foedus::xct::RetrospectiveLockList::assert_sorted_impl</a></div><div class="ttdeci">void assert_sorted_impl() const </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00182">retrospective_lock_list.cpp:182</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_acbed8e324b88389217b42a132e0547b8"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#acbed8e324b88389217b42a132e0547b8">foedus::xct::CurrentLockList::assert_sorted</a></div><div class="ttdeci">void assert_sorted() const __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00555">retrospective_lock_list.hpp:555</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1RetrospectiveLockList_html"><div class="ttname"><a href="classfoedus_1_1xct_1_1RetrospectiveLockList.html">foedus::xct::RetrospectiveLockList</a></div><div class="ttdoc">Retrospective lock list. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00189">retrospective_lock_list.hpp:189</a></div></div>
<div class="ttc" id="xct__mcs__adapter__impl_8hpp_html"><div class="ttname"><a href="xct__mcs__adapter__impl_8hpp.html">xct_mcs_adapter_impl.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a761b506c86d1d8e5681cab34fac1ad29"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a761b506c86d1d8e5681cab34fac1ad29">foedus::xct::CurrentLockList::is_empty</a></div><div class="ttdeci">bool is_empty() const </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00365">retrospective_lock_list.hpp:365</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a6db689767722f1d30821d63144bf8bde"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a6db689767722f1d30821d63144bf8bde">foedus::xct::CurrentLockList::get_or_add_entry</a></div><div class="ttdeci">LockListPosition get_or_add_entry(UniversalLockId lock_id, RwLockableXctId *lock, LockMode preferred_mode)</div><div class="ttdoc">Adds an entry to this list, re-sorting part of the list if necessary to keep the sortedness. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8cpp_source.html#l00204">retrospective_lock_list.cpp:204</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_8937f9425540f92243ad585d5de884fc.html">foedus-core</a></li><li class="navelem"><a class="el" href="dir_d7a805ee636aca3e828841913b8fee6f.html">src</a></li><li class="navelem"><a class="el" href="dir_69f399cb2d64e6ca2c29e4a5a8e5672b.html">foedus</a></li><li class="navelem"><a class="el" href="dir_bed9952cd06e1cbb15806325a50f478f.html">xct</a></li><li class="navelem"><a class="el" href="retrospective__lock__list_8cpp.html">retrospective_lock_list.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

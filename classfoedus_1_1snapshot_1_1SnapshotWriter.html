<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::snapshot::SnapshotWriter Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1snapshot_1_1SnapshotWriter.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfoedus_1_1snapshot_1_1SnapshotWriter-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::snapshot::SnapshotWriter Class Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__SNAPSHOT.html">Snapshot Manager</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Writes out one snapshot file for all data pages in one reducer.  
 <a href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Writes out one snapshot file for all data pages in one reducer. </p>
<p>In a nutshell, snapshot writer is a in-memory page pool that dumps out some or all of the pages to a snapshot file. It consists of 3 phases <em>for</em> <em>each</em> <em>storage</em>.</p>
<dl class="section user"><dt>Compose Phase</dt><dd>This first phase is invoked by the composers, loading prior snapshot pages and modifying them. Here, snapshot writers behave just as a usual in-memory page pool. This part depends on composer, so the snapshot writer calls composer's method.</dd></dl>
<dl class="section user"><dt>Fix Phase</dt><dd>Next phase is invoked at the end of composer for the storage, finalizing page ID in the snapshot file for each modified page and replacing volatile page pointers with snapshot pointers. This part also depends on composer (or page format of the storage), so this is done by composer.</dd></dl>
<dl class="section user"><dt>Dump Phase</dt><dd>The last phase simply dumps out the pages to snapshot file. This is a sequential write because no two storages have overlapping pages. This is independent from storage type, thus done in snapshot writer.</dd></dl>
<dl class="section user"><dt>Conquer already-divided</dt><dd><a class="el" href="structfoedus_1_1snapshot_1_1Snapshot.html" title="Represents one snapshot that converts all logs from base epoch to valid_until epoch into snapshot fil...">Snapshot</a> writer might not have enough pages to hold all pages of the storage modified in this snapshot. This can happen for a large storage with lots of changes. No worry, we have already sorted log entries by keys for this reason. When the page pool becomes fully occupied, we go on to the fix/dump phase, only keeping the <b>right-most</b> pages in all levels. After dumping everything else, we repeat the compose phase just like moving on to another storage.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is a private implementation-details of <a class="el" href="group__SNAPSHOT.html">Snapshot Manager</a>, thus file name ends with _impl. Do not include this header from a client program. There is no case client program needs to access this internal class. </dd></dl>

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00076">76</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab8c41c242cf759f8d169f0dd64c181b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab8c41c242cf759f8d169f0dd64c181b1">SnapshotWriter</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, uint16_t numa_node, <a class="el" href="group__SNAPSHOT.html#gaec32eb05303ebec1048d120f73295031">SnapshotId</a> snapshot_id, <a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> *pool_memory, <a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> *intermediate_memory, bool append=false)</td></tr>
<tr class="separator:ab8c41c242cf759f8d169f0dd64c181b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c24b7f707e02abf63c2708b0090c02e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a3c24b7f707e02abf63c2708b0090c02e">~SnapshotWriter</a> ()</td></tr>
<tr class="separator:a3c24b7f707e02abf63c2708b0090c02e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d71f940f088efa51d0b5769d4fdd31f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a7d71f940f088efa51d0b5769d4fdd31f">open</a> ()</td></tr>
<tr class="memdesc:a7d71f940f088efa51d0b5769d4fdd31f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open the file so that the writer can start writing.  <a href="#a7d71f940f088efa51d0b5769d4fdd31f">More...</a><br /></td></tr>
<tr class="separator:a7d71f940f088efa51d0b5769d4fdd31f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b246ce80a2d92b89b79ff8dd6671e8c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a5b246ce80a2d92b89b79ff8dd6671e8c">is_opened</a> () const </td></tr>
<tr class="separator:a5b246ce80a2d92b89b79ff8dd6671e8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4944523eeeba60c3b677a8147b1f9e42"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4944523eeeba60c3b677a8147b1f9e42">close</a> ()</td></tr>
<tr class="memdesc:a4944523eeeba60c3b677a8147b1f9e42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the file and makes sure all writes become durable (including the directory entry).  <a href="#a4944523eeeba60c3b677a8147b1f9e42">More...</a><br /></td></tr>
<tr class="separator:a4944523eeeba60c3b677a8147b1f9e42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07f548504859ed329e7ec0a94a1824e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a07f548504859ed329e7ec0a94a1824e8">SnapshotWriter</a> ()=delete</td></tr>
<tr class="separator:a07f548504859ed329e7ec0a94a1824e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa978c4b5b0422c956825d854bbc0f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a3fa978c4b5b0422c956825d854bbc0f3">SnapshotWriter</a> (const <a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">SnapshotWriter</a> &amp;other)=delete</td></tr>
<tr class="separator:a3fa978c4b5b0422c956825d854bbc0f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade9d44005dba0784807588a4ba3ab3c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">SnapshotWriter</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ade9d44005dba0784807588a4ba3ab3c7">operator=</a> (const <a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">SnapshotWriter</a> &amp;other)=delete</td></tr>
<tr class="separator:ade9d44005dba0784807588a4ba3ab3c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e0233463f813ec7a645e970bbe499c"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a31e0233463f813ec7a645e970bbe499c">get_numa_node</a> () const </td></tr>
<tr class="separator:a31e0233463f813ec7a645e970bbe499c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f72263ae71f34fad0130151328d6720"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720">get_page_base</a> () __attribute__((always_inline))</td></tr>
<tr class="separator:a4f72263ae71f34fad0130151328d6720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab547f0a3936d5cb0c0ee827ea77edd09"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09">get_page_size</a> () const __attribute__((always_inline))</td></tr>
<tr class="separator:ab547f0a3936d5cb0c0ee827ea77edd09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a340a320860a56dd850c5f8e02a44278b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a340a320860a56dd850c5f8e02a44278b">get_intermediate_base</a> () __attribute__((always_inline))</td></tr>
<tr class="separator:a340a320860a56dd850c5f8e02a44278b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb899ef232610546cd5a017a817fba45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#adb899ef232610546cd5a017a817fba45">get_intermediate_size</a> () const __attribute__((always_inline))</td></tr>
<tr class="separator:adb899ef232610546cd5a017a817fba45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9bcb8a605aecbbc3eabdc6664f6b163"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">storage::SnapshotPagePointer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#af9bcb8a605aecbbc3eabdc6664f6b163">get_next_page_id</a> () const </td></tr>
<tr class="separator:af9bcb8a605aecbbc3eabdc6664f6b163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4209f06409d52c010aac8bf98660dbe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__SNAPSHOT.html#gaec32eb05303ebec1048d120f73295031">SnapshotId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ad4209f06409d52c010aac8bf98660dbe">get_snapshot_id</a> () const </td></tr>
<tr class="separator:ad4209f06409d52c010aac8bf98660dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52a9a0e1900d6613471425c5610935de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a52a9a0e1900d6613471425c5610935de">resolve</a> (<a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> offset) __attribute__((always_inline))</td></tr>
<tr class="separator:a52a9a0e1900d6613471425c5610935de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c46afe7bfeb2a5a3fec3adc4032dd78"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a7c46afe7bfeb2a5a3fec3adc4032dd78">resolve</a> (<a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a> *page) __attribute__((always_inline))</td></tr>
<tr class="separator:a7c46afe7bfeb2a5a3fec3adc4032dd78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ba9fc4a87f71b3991bba1c39948cc9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a55ba9fc4a87f71b3991bba1c39948cc9">dump_pages</a> (<a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> from_page, uint32_t count)</td></tr>
<tr class="memdesc:a55ba9fc4a87f71b3991bba1c39948cc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write out pages that are contiguous in the main page pool.  <a href="#a55ba9fc4a87f71b3991bba1c39948cc9">More...</a><br /></td></tr>
<tr class="separator:a55ba9fc4a87f71b3991bba1c39948cc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41d6b67196e96c9b574093002c7e2f0e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a41d6b67196e96c9b574093002c7e2f0e">dump_intermediates</a> (<a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> from_page, uint32_t count)</td></tr>
<tr class="memdesc:a41d6b67196e96c9b574093002c7e2f0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write out pages that are contiguous in the sub intermediate page pool.  <a href="#a41d6b67196e96c9b574093002c7e2f0e">More...</a><br /></td></tr>
<tr class="separator:a41d6b67196e96c9b574093002c7e2f0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6febb6c4b078b4ac27af1fe469ff5025"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a6febb6c4b078b4ac27af1fe469ff5025">to_string</a> () const </td></tr>
<tr class="separator:a6febb6c4b078b4ac27af1fe469ff5025"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83a280a87143b712b78fb321f0c54bb8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a83a280a87143b712b78fb321f0c54bb8">expand_pool_memory</a> (uint32_t required_pages, bool retain_content)</td></tr>
<tr class="memdesc:a83a280a87143b712b78fb321f0c54bb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expands pool_memory_ in case it is too small.  <a href="#a83a280a87143b712b78fb321f0c54bb8">More...</a><br /></td></tr>
<tr class="separator:a83a280a87143b712b78fb321f0c54bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad43c975601c7bced5a548c4872c498e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ad43c975601c7bced5a548c4872c498e4">expand_intermediate_memory</a> (uint32_t required_pages, bool retain_content)</td></tr>
<tr class="memdesc:ad43c975601c7bced5a548c4872c498e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expands intermediate_memory_ in case it is too small.  <a href="#ad43c975601c7bced5a548c4872c498e4">More...</a><br /></td></tr>
<tr class="separator:ad43c975601c7bced5a548c4872c498e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a81f13429d9d0af51890b6563885c3aec"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a81f13429d9d0af51890b6563885c3aec">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">SnapshotWriter</a> &amp;v)</td></tr>
<tr class="separator:a81f13429d9d0af51890b6563885c3aec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab8c41c242cf759f8d169f0dd64c181b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">foedus::snapshot::SnapshotWriter::SnapshotWriter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>numa_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SNAPSHOT.html#gaec32eb05303ebec1048d120f73295031">SnapshotId</a>&#160;</td>
          <td class="paramname"><em>snapshot_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> *&#160;</td>
          <td class="paramname"><em>pool_memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> *&#160;</td>
          <td class="paramname"><em>intermediate_memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>append</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00036">36</a> of file <a class="el" href="snapshot__writer__impl_8cpp_source.html">snapshot_writer_impl.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  : engine_(engine),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  numa_node_(numa_node),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  append_(append),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  snapshot_id_(snapshot_id),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  pool_memory_(pool_memory),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  intermediate_memory_(intermediate_memory),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  snapshot_file_(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  next_page_id_(0) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3c24b7f707e02abf63c2708b0090c02e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::snapshot::SnapshotWriter::~SnapshotWriter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00085">85</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>References <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00053">close()</a>.</p>
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{ <a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4944523eeeba60c3b677a8147b1f9e42">close</a>(); }</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1SnapshotWriter_html_a4944523eeeba60c3b677a8147b1f9e42"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4944523eeeba60c3b677a8147b1f9e42">foedus::snapshot::SnapshotWriter::close</a></div><div class="ttdeci">bool close()</div><div class="ttdoc">Close the file and makes sure all writes become durable (including the directory entry). </div><div class="ttdef"><b>Definition:</b> <a href="snapshot__writer__impl_8cpp_source.html#l00053">snapshot_writer_impl.cpp:53</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a3c24b7f707e02abf63c2708b0090c02e_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a3c24b7f707e02abf63c2708b0090c02e_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a3c24b7f707e02abf63c2708b0090c02e_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a3c24b7f707e02abf63c2708b0090c02e_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4944523eeeba60c3b677a8147b1f9e42" title="Close the file and makes sure all writes become durable (including the directory entry). " alt="" coords="237,71,421,112"/>
<area shape="rect" id="node3" href="classfoedus_1_1fs_1_1DirectIoFile.html#a91315b18dee7b839ba47cfa80116295c" title="foedus::fs::DirectIoFile\l::get_path" alt="" coords="469,5,620,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267" title="Close the file if not yet closed. " alt="" coords="469,71,620,112"/>
<area shape="rect" id="node6" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e" title="Makes the content and metadata of the file durable all the way up to devices. " alt="" coords="486,166,603,193"/>
<area shape="rect" id="node5" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="693,56,833,97"/>
<area shape="rect" id="node7" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="1101,181,1252,207"/>
<area shape="rect" id="node8" href="group__FILESYSTEM.html#ga87c90d834f65aad6f7b6540ae226f305" title="Returns if the file is a directory. " alt="" coords="686,181,839,207"/>
<area shape="rect" id="node11" href="classfoedus_1_1fs_1_1Path.html#a9859706102ecca097e723d762ec468ae" title="foedus::fs::Path::parent_path" alt="" coords="668,261,857,287"/>
<area shape="rect" id="node9" href="structfoedus_1_1fs_1_1FileStatus.html#a7b8858f191dee3d9a92cae0cd759c1e5" title="foedus::fs::FileStatus\l::is_directory" alt="" coords="907,173,1052,215"/>
<area shape="rect" id="node10" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="918,239,1041,266"/>
<area shape="rect" id="node12" href="classfoedus_1_1fs_1_1Path.html#a95efbd1ef2b5f97560bdc964ab0b00ed" title="foedus::fs::Path::Path" alt="" coords="905,290,1053,317"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a07f548504859ed329e7ec0a94a1824e8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::snapshot::SnapshotWriter::SnapshotWriter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3fa978c4b5b0422c956825d854bbc0f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::snapshot::SnapshotWriter::SnapshotWriter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">SnapshotWriter</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4944523eeeba60c3b677a8147b1f9e42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::snapshot::SnapshotWriter::close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the file and makes sure all writes become durable (including the directory entry). </p>
<dl class="section return"><dt>Returns</dt><dd>whether successfully closed and synced. </dd></dl>

<p>Definition at line <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00053">53</a> of file <a class="el" href="snapshot__writer__impl_8cpp_source.html">snapshot_writer_impl.cpp</a>.</p>

<p>References <a class="el" href="direct__io__file_8cpp_source.html#l00129">foedus::fs::DirectIoFile::close()</a>, <a class="el" href="filesystem_8cpp_source.html#l00203">foedus::fs::fsync()</a>, and <a class="el" href="direct__io__file_8hpp_source.html#l00170">foedus::fs::DirectIoFile::get_path()</a>.</p>

<p>Referenced by <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00082">open()</a>, and <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00085">~SnapshotWriter()</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                           {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">if</span> (snapshot_file_) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">bool</span> success = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    fs::Path path = snapshot_file_-&gt;<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a91315b18dee7b839ba47cfa80116295c">get_path</a>();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">bool</span> closed = snapshot_file_-&gt;<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267">close</a>();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (!closed) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;Failed to close a snapshot file: &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      success = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// also fsync the file.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e">fs::fsync</a>(path, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;Failed to fsync a snapshot file: &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      success = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">delete</span> snapshot_file_;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    snapshot_file_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">return</span> success;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a7888a3b0c169fbc6b2e6e83c86d5f267"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267">foedus::fs::DirectIoFile::close</a></div><div class="ttdeci">bool close()</div><div class="ttdoc">Close the file if not yet closed. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00129">direct_io_file.cpp:129</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a91315b18dee7b839ba47cfa80116295c"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a91315b18dee7b839ba47cfa80116295c">foedus::fs::DirectIoFile::get_path</a></div><div class="ttdeci">Path get_path() const </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00170">direct_io_file.hpp:170</a></div></div>
<div class="ttc" id="group__FILESYSTEM_html_ga08865450d848cb894243005bdd226d1e"><div class="ttname"><a href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e">foedus::fs::fsync</a></div><div class="ttdeci">bool fsync(const Path &amp;path, bool sync_parent_directory=false)</div><div class="ttdoc">Makes the content and metadata of the file durable all the way up to devices. </div><div class="ttdef"><b>Definition:</b> <a href="filesystem_8cpp_source.html#l00203">filesystem.cpp:203</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a4944523eeeba60c3b677a8147b1f9e42_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a4944523eeeba60c3b677a8147b1f9e42_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a4944523eeeba60c3b677a8147b1f9e42_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a4944523eeeba60c3b677a8147b1f9e42_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267" title="Close the file if not yet closed. " alt="" coords="237,35,388,76"/>
<area shape="rect" id="node4" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e" title="Makes the content and metadata of the file durable all the way up to devices. " alt="" coords="254,115,371,142"/>
<area shape="rect" id="node11" href="classfoedus_1_1fs_1_1DirectIoFile.html#a91315b18dee7b839ba47cfa80116295c" title="foedus::fs::DirectIoFile\l::get_path" alt="" coords="237,167,388,208"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="461,5,601,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="869,130,1020,157"/>
<area shape="rect" id="node6" href="group__FILESYSTEM.html#ga87c90d834f65aad6f7b6540ae226f305" title="Returns if the file is a directory. " alt="" coords="454,130,607,157"/>
<area shape="rect" id="node9" href="classfoedus_1_1fs_1_1Path.html#a9859706102ecca097e723d762ec468ae" title="foedus::fs::Path::parent_path" alt="" coords="436,210,625,237"/>
<area shape="rect" id="node7" href="structfoedus_1_1fs_1_1FileStatus.html#a7b8858f191dee3d9a92cae0cd759c1e5" title="foedus::fs::FileStatus\l::is_directory" alt="" coords="675,123,820,164"/>
<area shape="rect" id="node8" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="686,189,809,215"/>
<area shape="rect" id="node10" href="classfoedus_1_1fs_1_1Path.html#a95efbd1ef2b5f97560bdc964ab0b00ed" title="foedus::fs::Path::Path" alt="" coords="673,239,821,266"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a4944523eeeba60c3b677a8147b1f9e42_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a4944523eeeba60c3b677a8147b1f9e42_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a4944523eeeba60c3b677a8147b1f9e42_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a4944523eeeba60c3b677a8147b1f9e42_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a7d71f940f088efa51d0b5769d4fdd31f" title="Open the file so that the writer can start writing. " alt="" coords="237,5,421,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a3c24b7f707e02abf63c2708b0090c02e" title="foedus::snapshot::Snapshot\lWriter::~SnapshotWriter" alt="" coords="237,71,421,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a41d6b67196e96c9b574093002c7e2f0e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::snapshot::SnapshotWriter::dump_intermediates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a>&#160;</td>
          <td class="paramname"><em>from_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write out pages that are contiguous in the sub intermediate page pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">from_page</td><td>beginning of contiguous in-memory pages to fix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">count</td><td>number of pages to write out </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00144">144</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                                                               {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">return</span> dump_general(intermediate_memory_, from_page, count);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a55ba9fc4a87f71b3991bba1c39948cc9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::snapshot::SnapshotWriter::dump_pages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a>&#160;</td>
          <td class="paramname"><em>from_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write out pages that are contiguous in the main page pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">from_page</td><td>beginning of contiguous in-memory pages to fix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">count</td><td>number of pages to write out </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00135">135</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00290">foedus::storage::hash::ComposedBinsMergedStream::assure_writer_buffer()</a>, <a class="el" href="array__composer__impl_8cpp_source.html#l00095">foedus::storage::array::ArrayComposer::construct_root()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l00126">foedus::storage::hash::HashComposer::construct_root()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l00111">foedus::storage::masstree::MasstreeComposer::construct_root()</a>, and <a class="el" href="sequential__composer__impl_8cpp_source.html#l00230">foedus::storage::sequential::SequentialComposer::construct_root()</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                                       {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">return</span> dump_general(pool_memory_, from_page, count);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a55ba9fc4a87f71b3991bba1c39948cc9_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a55ba9fc4a87f71b3991bba1c39948cc9_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a55ba9fc4a87f71b3991bba1c39948cc9_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a55ba9fc4a87f71b3991bba1c39948cc9_icgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#adbaff9aeb65615f7af84b820fd3bf241" title="Subroutine to flush the writer if needed to make sure it has enough room. " alt="" coords="257,35,459,91"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#a2c812e46a7502abe6f506ecda0edf9ab" title="foedus::storage::array\l::ArrayComposer::construct_root" alt="" coords="253,116,463,157"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#ac5ad2e7fa792d58965a05be6bd43e43c" title="foedus::storage::hash\l::HashComposer::construct_root" alt="" coords="253,181,463,223"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#a45eb1cba6ccf8f51c973030848a47a9d" title="foedus::storage::masstree\l::MasstreeComposer::construct_root" alt="" coords="241,247,475,288"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a91db842a6ef8780d3fe4ba2f0f625da7" title="foedus::storage::sequential\l::SequentialComposer::construct_root" alt="" coords="237,312,479,353"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="527,35,729,91"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="777,5,1005,47"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="790,71,993,127"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c" title="Construct root page(s) for one storage based on the ouputs of compose(). " alt="" coords="539,215,717,256"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad43c975601c7bced5a548c4872c498e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::snapshot::SnapshotWriter::expand_intermediate_memory </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>required_pages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>retain_content</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Expands intermediate_memory_ in case it is too small. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">required_pages</td><td>number of pages that are guaranteed after expansion. The actual size will probably be larger than this value to avoid frequent expansion. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">retain_content</td><td>whether to copy the content of old memory to new memory </td></tr>
  </table>
  </dd>
</dl>
<dl class="section post"><dt>Postcondition</dt><dd><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#adb899ef232610546cd5a017a817fba45">get_intermediate_size()</a> &gt;= required_pages </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>only possible error is out of memory </dd></dl>
<dl class="section note"><dt>Note</dt><dd>intermediate_base will be also changed, so do not forget to re-obtain it.</dd></dl>
<p>Does nothing if it's already enough large. We use this method to make sure intermediate pool (which some composer assumes sufficiently large) can contain all intermediate pages. </p>

<p>Definition at line <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00163">163</a> of file <a class="el" href="snapshot__writer__impl_8cpp_source.html">snapshot_writer_impl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="aligned__memory_8cpp_source.html#l00182">foedus::memory::AlignedMemory::assure_capacity()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00111">get_intermediate_size()</a>, and <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>.</p>

<p>Referenced by <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00290">foedus::storage::hash::ComposedBinsMergedStream::assure_writer_buffer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                                                                                 {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">if</span> (required_pages &lt;= <a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#adb899ef232610546cd5a017a817fba45">get_intermediate_size</a>()) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  uint64_t bytes = required_pages * <span class="keyword">sizeof</span>(storage::Page);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(intermediate_memory_-&gt;<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad79701492d232cb5aec1ad4d8c99eb5d">assure_capacity</a>(bytes, 2.0, retain_content));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#adb899ef232610546cd5a017a817fba45">get_intermediate_size</a>() &gt;= required_pages);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_ad79701492d232cb5aec1ad4d8c99eb5d"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#ad79701492d232cb5aec1ad4d8c99eb5d">foedus::memory::AlignedMemory::assure_capacity</a></div><div class="ttdeci">ErrorCode assure_capacity(uint64_t required_size, double expand_margin=2.0, bool retain_content=false) noexcept</div><div class="ttdoc">If the current size is smaller than the given size, automatically expands. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8cpp_source.html#l00182">aligned_memory.cpp:182</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1SnapshotWriter_html_adb899ef232610546cd5a017a817fba45"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#adb899ef232610546cd5a017a817fba45">foedus::snapshot::SnapshotWriter::get_intermediate_size</a></div><div class="ttdeci">memory::PagePoolOffset get_intermediate_size() const __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="snapshot__writer__impl_8hpp_source.html#l00111">snapshot_writer_impl.hpp:111</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_ad43c975601c7bced5a548c4872c498e4_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_ad43c975601c7bced5a548c4872c498e4_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_ad43c975601c7bced5a548c4872c498e4_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_ad43c975601c7bced5a548c4872c498e4_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad79701492d232cb5aec1ad4d8c99eb5d" title="If the current size is smaller than the given size, automatically expands. " alt="" coords="292,71,505,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#adb899ef232610546cd5a017a817fba45" title="foedus::snapshot::Snapshot\lWriter::get_intermediate_size" alt="" coords="303,136,495,177"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="553,5,767,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b" title="Releases the memory block. " alt="" coords="553,71,767,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="553,136,767,177"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_ad43c975601c7bced5a548c4872c498e4_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_ad43c975601c7bced5a548c4872c498e4_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_ad43c975601c7bced5a548c4872c498e4_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_ad43c975601c7bced5a548c4872c498e4_icgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#adbaff9aeb65615f7af84b820fd3bf241" title="Subroutine to flush the writer if needed to make sure it has enough room. " alt="" coords="292,35,495,91"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="543,35,745,91"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="793,5,1021,47"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="806,71,1009,127"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a83a280a87143b712b78fb321f0c54bb8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::snapshot::SnapshotWriter::expand_pool_memory </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>required_pages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>retain_content</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Expands pool_memory_ in case it is too small. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">required_pages</td><td>number of pages that are guaranteed after expansion. The actual size will probably be larger than this value to avoid frequent expansion. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">retain_content</td><td>whether to copy the content of old memory to new memory </td></tr>
  </table>
  </dd>
</dl>
<dl class="section post"><dt>Postcondition</dt><dd><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09">get_page_size()</a> &gt;= required_pages </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>only possible error is out of memory </dd></dl>
<dl class="section note"><dt>Note</dt><dd>page_base will be also changed, so do not forget to re-obtain it.</dd></dl>
<p>Does nothing if it's already enough large. Most likely we don't have to use this method as composers should be able to run even when the number of leaf (content) pages is large. </p>

<p>Definition at line <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00150">150</a> of file <a class="el" href="snapshot__writer__impl_8cpp_source.html">snapshot_writer_impl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="aligned__memory_8cpp_source.html#l00182">foedus::memory::AlignedMemory::assure_capacity()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00105">get_page_size()</a>, and <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                                                                         {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">if</span> (required_pages &lt;= <a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09">get_page_size</a>()) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  uint64_t bytes = required_pages * <span class="keyword">sizeof</span>(storage::Page);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(pool_memory_-&gt;<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad79701492d232cb5aec1ad4d8c99eb5d">assure_capacity</a>(bytes, 2.0, retain_content));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09">get_page_size</a>() &gt;= required_pages);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1SnapshotWriter_html_ab547f0a3936d5cb0c0ee827ea77edd09"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09">foedus::snapshot::SnapshotWriter::get_page_size</a></div><div class="ttdeci">memory::PagePoolOffset get_page_size() const __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="snapshot__writer__impl_8hpp_source.html#l00105">snapshot_writer_impl.hpp:105</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_ad79701492d232cb5aec1ad4d8c99eb5d"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#ad79701492d232cb5aec1ad4d8c99eb5d">foedus::memory::AlignedMemory::assure_capacity</a></div><div class="ttdeci">ErrorCode assure_capacity(uint64_t required_size, double expand_margin=2.0, bool retain_content=false) noexcept</div><div class="ttdoc">If the current size is smaller than the given size, automatically expands. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8cpp_source.html#l00182">aligned_memory.cpp:182</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a83a280a87143b712b78fb321f0c54bb8_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a83a280a87143b712b78fb321f0c54bb8_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a83a280a87143b712b78fb321f0c54bb8_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a83a280a87143b712b78fb321f0c54bb8_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad79701492d232cb5aec1ad4d8c99eb5d" title="If the current size is smaller than the given size, automatically expands. " alt="" coords="245,71,459,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09" title="foedus::snapshot::Snapshot\lWriter::get_page_size" alt="" coords="260,136,444,177"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="507,5,720,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b" title="Releases the memory block. " alt="" coords="507,71,720,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="507,136,720,177"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a340a320860a56dd850c5f8e02a44278b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* foedus::snapshot::SnapshotWriter::get_intermediate_base </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00108">108</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>References <a class="el" href="aligned__memory_8hpp_source.html#l00168">foedus::memory::AlignedMemory::get_block()</a>.</p>

<p>Referenced by <a class="el" href="array__composer__impl_8cpp_source.html#l00191">foedus::storage::array::ArrayComposeContext::ArrayComposeContext()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l00436">foedus::storage::hash::HashComposeContext::HashComposeContext()</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">foedus::storage::hash::ComposedBinsMergedStream::open_path()</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                                                     {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span>storage::Page*<span class="keyword">&gt;</span>(intermediate_memory_-&gt;<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1">get_block</a>());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_af306ba60622e2a87f75ae93dc6c597b1"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1">foedus::memory::AlignedMemory::get_block</a></div><div class="ttdeci">void * get_block() const </div><div class="ttdoc">Returns the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00168">aligned_memory.hpp:168</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a340a320860a56dd850c5f8e02a44278b_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a340a320860a56dd850c5f8e02a44278b_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a340a320860a56dd850c5f8e02a44278b_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a340a320860a56dd850c5f8e02a44278b_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="249,5,463,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a340a320860a56dd850c5f8e02a44278b_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a340a320860a56dd850c5f8e02a44278b_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a340a320860a56dd850c5f8e02a44278b_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a340a320860a56dd850c5f8e02a44278b_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposeContext.html#ae70f8ca9a8540b78619ac770e2bbbec9" title="ArrayComposeContext methods. " alt="" coords="270,5,431,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashComposeContext.html#ad74a8746a4e10c3931ab206db17f0667" title="HashComposeContext methods. " alt="" coords="271,85,431,141"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="249,165,452,221"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="500,135,728,177"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="513,201,715,257"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adb899ef232610546cd5a017a817fba45"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> foedus::snapshot::SnapshotWriter::get_intermediate_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00111">111</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>References <a class="el" href="aligned__memory_8hpp_source.html#l00172">foedus::memory::AlignedMemory::get_size()</a>, and <a class="el" href="storage__id_8hpp_source.html#l00045">foedus::storage::kPageSize</a>.</p>

<p>Referenced by <a class="el" href="array__composer__impl_8cpp_source.html#l00191">foedus::storage::array::ArrayComposeContext::ArrayComposeContext()</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00290">foedus::storage::hash::ComposedBinsMergedStream::assure_writer_buffer()</a>, <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00163">expand_intermediate_memory()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l00436">foedus::storage::hash::HashComposeContext::HashComposeContext()</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">foedus::storage::hash::ComposedBinsMergedStream::open_path()</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                                                           {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">return</span> intermediate_memory_-&gt;<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">get_size</a>() / <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">storage::kPageSize</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a8db2e188293eaeebdf36cf39920efedd"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">foedus::memory::AlignedMemory::get_size</a></div><div class="ttdeci">uint64_t get_size() const </div><div class="ttdoc">Returns the byte size of the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00172">aligned_memory.hpp:172</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga1a3c05fe1d44455fc3e761947c6e21e6"><div class="ttname"><a href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">foedus::storage::kPageSize</a></div><div class="ttdeci">const uint16_t kPageSize</div><div class="ttdoc">A constant defining the page size (in bytes) of both snapshot pages and volatile pages. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00045">storage_id.hpp:45</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_adb899ef232610546cd5a017a817fba45_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_adb899ef232610546cd5a017a817fba45_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_adb899ef232610546cd5a017a817fba45_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_adb899ef232610546cd5a017a817fba45_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="245,5,459,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_adb899ef232610546cd5a017a817fba45_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_adb899ef232610546cd5a017a817fba45_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_adb899ef232610546cd5a017a817fba45_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_adb899ef232610546cd5a017a817fba45_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposeContext.html#ae70f8ca9a8540b78619ac770e2bbbec9" title="ArrayComposeContext methods. " alt="" coords="284,5,445,61"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#adbaff9aeb65615f7af84b820fd3bf241" title="Subroutine to flush the writer if needed to make sure it has enough room. " alt="" coords="532,123,735,179"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="783,156,985,212"/>
<area shape="rect" id="node7" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ad43c975601c7bced5a548c4872c498e4" title="Expands intermediate_memory_ in case it is too small. " alt="" coords="245,137,484,178"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashComposeContext.html#ad74a8746a4e10c3931ab206db17f0667" title="HashComposeContext methods. " alt="" coords="285,253,445,309"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="1033,126,1261,167"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="1046,192,1249,248"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af9bcb8a605aecbbc3eabdc6664f6b163"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">storage::SnapshotPagePointer</a> foedus::snapshot::SnapshotWriter::get_next_page_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00115">115</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="array__composer__impl_8cpp_source.html#l00095">foedus::storage::array::ArrayComposer::construct_root()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l00126">foedus::storage::hash::HashComposer::construct_root()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l00111">foedus::storage::masstree::MasstreeComposer::construct_root()</a>, <a class="el" href="sequential__composer__impl_8cpp_source.html#l00230">foedus::storage::sequential::SequentialComposer::construct_root()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l00291">foedus::storage::masstree::MasstreeComposeContext::MasstreeComposeContext()</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">foedus::storage::hash::ComposedBinsMergedStream::open_path()</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{ <span class="keywordflow">return</span> next_page_id_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_af9bcb8a605aecbbc3eabdc6664f6b163_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_af9bcb8a605aecbbc3eabdc6664f6b163_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_af9bcb8a605aecbbc3eabdc6664f6b163_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_af9bcb8a605aecbbc3eabdc6664f6b163_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#a2c812e46a7502abe6f506ecda0edf9ab" title="foedus::storage::array\l::ArrayComposer::construct_root" alt="" coords="253,5,463,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#ac5ad2e7fa792d58965a05be6bd43e43c" title="foedus::storage::hash\l::HashComposer::construct_root" alt="" coords="253,71,463,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#a45eb1cba6ccf8f51c973030848a47a9d" title="foedus::storage::masstree\l::MasstreeComposer::construct_root" alt="" coords="241,136,475,177"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a91db842a6ef8780d3fe4ba2f0f625da7" title="foedus::storage::sequential\l::SequentialComposer::construct_root" alt="" coords="237,201,479,243"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposeContext.html#a6f661b87d63bc26620c7317b289b7f34" title="MasstreeComposeContext methods. " alt="" coords="266,267,450,323"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="257,347,459,403"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c" title="Construct root page(s) for one storage based on the ouputs of compose(). " alt="" coords="551,104,730,145"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="527,317,755,359"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="539,383,742,439"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a31e0233463f813ec7a645e970bbe499c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t foedus::snapshot::SnapshotWriter::get_numa_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00101">101</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="sequential__composer__impl_8cpp_source.html#l00154">foedus::storage::sequential::SequentialComposer::compose()</a>, <a class="el" href="sequential__composer__impl_8cpp_source.html#l00230">foedus::storage::sequential::SequentialComposer::construct_root()</a>, and <a class="el" href="array__composer__impl_8cpp_source.html#l00230">foedus::storage::array::ArrayComposeContext::execute()</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{ <span class="keywordflow">return</span> numa_node_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a31e0233463f813ec7a645e970bbe499c_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a31e0233463f813ec7a645e970bbe499c_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a31e0233463f813ec7a645e970bbe499c_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a31e0233463f813ec7a645e970bbe499c_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a3e005713f9a1c12bb2a4771a192b47a5" title="foedus::storage::sequential\l::SequentialComposer::compose" alt="" coords="253,5,463,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a91db842a6ef8780d3fe4ba2f0f625da7" title="foedus::storage::sequential\l::SequentialComposer::construct_root" alt="" coords="237,71,479,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1array_1_1ArrayComposeContext.html#af8cf7022dc9e7592977e6dcc2b7a4d02" title="foedus::storage::array\l::ArrayComposeContext\l::execute" alt="" coords="277,137,439,193"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1Composer.html#a28c752ec784b85418c0bfafab7ee60c0" title="Construct snapshot pages from sorted run files of one storage. " alt="" coords="527,5,705,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c" title="Construct root page(s) for one storage based on the ouputs of compose(). " alt="" coords="527,71,705,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4f72263ae71f34fad0130151328d6720"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* foedus::snapshot::SnapshotWriter::get_page_base </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00102">102</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>References <a class="el" href="aligned__memory_8hpp_source.html#l00168">foedus::memory::AlignedMemory::get_block()</a>.</p>

<p>Referenced by <a class="el" href="array__composer__impl_8cpp_source.html#l00191">foedus::storage::array::ArrayComposeContext::ArrayComposeContext()</a>, <a class="el" href="sequential__composer__impl_8cpp_source.html#l00154">foedus::storage::sequential::SequentialComposer::compose()</a>, <a class="el" href="array__composer__impl_8cpp_source.html#l00095">foedus::storage::array::ArrayComposer::construct_root()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l00126">foedus::storage::hash::HashComposer::construct_root()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l00111">foedus::storage::masstree::MasstreeComposer::construct_root()</a>, <a class="el" href="sequential__composer__impl_8cpp_source.html#l00230">foedus::storage::sequential::SequentialComposer::construct_root()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l00436">foedus::storage::hash::HashComposeContext::HashComposeContext()</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">foedus::storage::hash::ComposedBinsMergedStream::open_path()</a>, and <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00118">resolve()</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                                      {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span>storage::Page*<span class="keyword">&gt;</span>(pool_memory_-&gt;<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1">get_block</a>());</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_af306ba60622e2a87f75ae93dc6c597b1"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1">foedus::memory::AlignedMemory::get_block</a></div><div class="ttdeci">void * get_block() const </div><div class="ttdoc">Returns the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00168">aligned_memory.hpp:168</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a4f72263ae71f34fad0130151328d6720_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a4f72263ae71f34fad0130151328d6720_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a4f72263ae71f34fad0130151328d6720_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a4f72263ae71f34fad0130151328d6720_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="237,5,451,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a4f72263ae71f34fad0130151328d6720_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a4f72263ae71f34fad0130151328d6720_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a4f72263ae71f34fad0130151328d6720_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a4f72263ae71f34fad0130151328d6720_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposeContext.html#ae70f8ca9a8540b78619ac770e2bbbec9" title="ArrayComposeContext methods. " alt="" coords="277,5,439,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a3e005713f9a1c12bb2a4771a192b47a5" title="foedus::storage::sequential\l::SequentialComposer::compose" alt="" coords="253,86,463,127"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#a2c812e46a7502abe6f506ecda0edf9ab" title="foedus::storage::array\l::ArrayComposer::construct_root" alt="" coords="253,151,463,193"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#ac5ad2e7fa792d58965a05be6bd43e43c" title="foedus::storage::hash\l::HashComposer::construct_root" alt="" coords="253,217,463,258"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#a45eb1cba6ccf8f51c973030848a47a9d" title="foedus::storage::masstree\l::MasstreeComposer::construct_root" alt="" coords="241,282,475,323"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a91db842a6ef8780d3fe4ba2f0f625da7" title="foedus::storage::sequential\l::SequentialComposer::construct_root" alt="" coords="237,347,479,389"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashComposeContext.html#ad74a8746a4e10c3931ab206db17f0667" title="HashComposeContext methods. " alt="" coords="278,413,438,469"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="257,493,459,549"/>
<area shape="rect" id="node14" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a52a9a0e1900d6613471425c5610935de" title="foedus::snapshot::Snapshot\lWriter::resolve" alt="" coords="266,574,450,615"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1Composer.html#a28c752ec784b85418c0bfafab7ee60c0" title="Construct snapshot pages from sorted run files of one storage. " alt="" coords="551,86,730,127"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c" title="Construct root page(s) for one storage based on the ouputs of compose(). " alt="" coords="551,250,730,291"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="527,463,755,505"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="539,529,742,585"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab547f0a3936d5cb0c0ee827ea77edd09"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> foedus::snapshot::SnapshotWriter::get_page_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00105">105</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>References <a class="el" href="aligned__memory_8hpp_source.html#l00172">foedus::memory::AlignedMemory::get_size()</a>, and <a class="el" href="storage__id_8hpp_source.html#l00045">foedus::storage::kPageSize</a>.</p>

<p>Referenced by <a class="el" href="array__composer__impl_8cpp_source.html#l00191">foedus::storage::array::ArrayComposeContext::ArrayComposeContext()</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00290">foedus::storage::hash::ComposedBinsMergedStream::assure_writer_buffer()</a>, <a class="el" href="sequential__composer__impl_8cpp_source.html#l00154">foedus::storage::sequential::SequentialComposer::compose()</a>, <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00150">expand_pool_memory()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l00436">foedus::storage::hash::HashComposeContext::HashComposeContext()</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">foedus::storage::hash::ComposedBinsMergedStream::open_path()</a>, and <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00118">resolve()</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                                                   {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">return</span> pool_memory_-&gt;<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">get_size</a>() / <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">storage::kPageSize</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a8db2e188293eaeebdf36cf39920efedd"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd">foedus::memory::AlignedMemory::get_size</a></div><div class="ttdeci">uint64_t get_size() const </div><div class="ttdoc">Returns the byte size of the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00172">aligned_memory.hpp:172</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga1a3c05fe1d44455fc3e761947c6e21e6"><div class="ttname"><a href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">foedus::storage::kPageSize</a></div><div class="ttdeci">const uint16_t kPageSize</div><div class="ttdoc">A constant defining the page size (in bytes) of both snapshot pages and volatile pages. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00045">storage_id.hpp:45</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_ab547f0a3936d5cb0c0ee827ea77edd09_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_ab547f0a3936d5cb0c0ee827ea77edd09_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_ab547f0a3936d5cb0c0ee827ea77edd09_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_ab547f0a3936d5cb0c0ee827ea77edd09_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="237,5,451,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_ab547f0a3936d5cb0c0ee827ea77edd09_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_ab547f0a3936d5cb0c0ee827ea77edd09_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_ab547f0a3936d5cb0c0ee827ea77edd09_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_ab547f0a3936d5cb0c0ee827ea77edd09_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposeContext.html#ae70f8ca9a8540b78619ac770e2bbbec9" title="ArrayComposeContext methods. " alt="" coords="262,5,423,61"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#adbaff9aeb65615f7af84b820fd3bf241" title="Subroutine to flush the writer if needed to make sure it has enough room. " alt="" coords="241,85,444,141"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="496,111,699,167"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a3e005713f9a1c12bb2a4771a192b47a5" title="foedus::storage::sequential\l::SequentialComposer::compose" alt="" coords="237,217,448,258"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a83a280a87143b712b78fb321f0c54bb8" title="Expands pool_memory_ in case it is too small. " alt="" coords="247,282,439,323"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashComposeContext.html#ad74a8746a4e10c3931ab206db17f0667" title="HashComposeContext methods. " alt="" coords="263,348,423,404"/>
<area shape="rect" id="node11" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a52a9a0e1900d6613471425c5610935de" title="foedus::snapshot::Snapshot\lWriter::resolve" alt="" coords="251,429,435,470"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="747,81,975,122"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="759,147,962,203"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1Composer.html#a28c752ec784b85418c0bfafab7ee60c0" title="Construct snapshot pages from sorted run files of one storage. " alt="" coords="508,217,687,258"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad4209f06409d52c010aac8bf98660dbe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__SNAPSHOT.html#gaec32eb05303ebec1048d120f73295031">SnapshotId</a> foedus::snapshot::SnapshotWriter::get_snapshot_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00116">116</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="sequential__composer__impl_8cpp_source.html#l00154">foedus::storage::sequential::SequentialComposer::compose()</a>, <a class="el" href="array__composer__impl_8cpp_source.html#l00095">foedus::storage::array::ArrayComposer::construct_root()</a>, <a class="el" href="sequential__composer__impl_8cpp_source.html#l00230">foedus::storage::sequential::SequentialComposer::construct_root()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l00102">foedus::storage::masstree::from_this_snapshot()</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00087">foedus::storage::hash::ComposedBinsMergedStream::init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{ <span class="keywordflow">return</span> snapshot_id_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_ad4209f06409d52c010aac8bf98660dbe_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_ad4209f06409d52c010aac8bf98660dbe_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_ad4209f06409d52c010aac8bf98660dbe_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_ad4209f06409d52c010aac8bf98660dbe_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a3e005713f9a1c12bb2a4771a192b47a5" title="foedus::storage::sequential\l::SequentialComposer::compose" alt="" coords="246,9,457,51"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#a2c812e46a7502abe6f506ecda0edf9ab" title="foedus::storage::array\l::ArrayComposer::construct_root" alt="" coords="529,71,739,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a91db842a6ef8780d3fe4ba2f0f625da7" title="foedus::storage::sequential\l::SequentialComposer::construct_root" alt="" coords="513,136,755,177"/>
<area shape="rect" id="node7" href="namespacefoedus_1_1storage_1_1masstree.html#ad5bde8a81bd922e388c91d1aaeac1411" title="foedus::storage::masstree\l::from_this_snapshot" alt="" coords="265,191,438,232"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="237,256,465,297"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1Composer.html#a28c752ec784b85418c0bfafab7ee60c0" title="Construct snapshot pages from sorted run files of one storage. " alt="" coords="545,5,723,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c" title="Construct root page(s) for one storage based on the ouputs of compose(). " alt="" coords="803,136,981,177"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#a45eb1cba6ccf8f51c973030848a47a9d" title="foedus::storage::masstree\l::MasstreeComposer::construct_root" alt="" coords="517,201,751,243"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5b246ce80a2d92b89b79ff8dd6671e8c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::snapshot::SnapshotWriter::is_opened </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00089">89</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{ <span class="keywordflow">return</span> snapshot_file_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d71f940f088efa51d0b5769d4fdd31f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::snapshot::SnapshotWriter::open </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open the file so that the writer can start writing. </p>

<p>Definition at line <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00082">82</a> of file <a class="el" href="snapshot__writer__impl_8cpp_source.html">snapshot_writer_impl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="page_8hpp_source.html#l00202">foedus::storage::PageHeader::checksum_</a>, <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00053">close()</a>, <a class="el" href="snapshot__options_8hpp_source.html#l00147">foedus::snapshot::SnapshotOptions::emulation_</a>, <a class="el" href="filesystem_8cpp_source.html#l00120">foedus::fs::file_size()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00168">foedus::memory::AlignedMemory::get_block()</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00173">foedus::fs::DirectIoFile::get_current_offset()</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00055">foedus::fs::DirectIoFile::open()</a>, <a class="el" href="page_8hpp_source.html#l00191">foedus::storage::PageHeader::page_id_</a>, <a class="el" href="engine__options_8hpp_source.html#l00143">foedus::EngineOptions::snapshot_</a>, <a class="el" href="page_8hpp_source.html#l00196">foedus::storage::PageHeader::storage_id_</a>, <a class="el" href="storage__id_8hpp_source.html#l00106">foedus::storage::to_snapshot_page_pointer()</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00148">to_string()</a>, <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>, and <a class="el" href="direct__io__file_8cpp_source.html#l00216">foedus::fs::DirectIoFile::write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4944523eeeba60c3b677a8147b1f9e42">close</a>();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  fs::Path path(get_snapshot_file_path());</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  snapshot_file_ = <span class="keyword">new</span> fs::DirectIoFile(path, engine_-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">snapshot_</a>.<a class="code" href="structfoedus_1_1snapshot_1_1SnapshotOptions.html#ac1b18bc1cd4db02607e21b6fb7a42b00">emulation_</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">bool</span> create_new_file = append_ ? <span class="keyword">false</span> : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(snapshot_file_-&gt;<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aaa3c1e50680d02783b61f5fe23f98b14">open</a>(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, create_new_file));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">if</span> (!append_) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// write page-0. this is a dummy page which will never be read</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">char</span>* first_page = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(pool_memory_-&gt;<a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1">get_block</a>());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// first 8 bytes have some data, but we would use them just for sanity checks and debugging</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    storage::PageHeader* first_page_header = <span class="keyword">reinterpret_cast&lt;</span>storage::PageHeader*<span class="keyword">&gt;</span>(first_page);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    first_page_header-&gt;page_id_ = <a class="code" href="namespacefoedus_1_1storage.html#ae3265a3229e0e80b662b00abb8457395">storage::to_snapshot_page_pointer</a>(snapshot_id_, numa_node_, 0);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    first_page_header-&gt;storage_id_ = 0x1BF0ED05;  <span class="comment">// something unusual</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    first_page_header-&gt;checksum_ = 0x1BF0ED05;  <span class="comment">// something unusual</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    std::memset(</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      first_page + <span class="keyword">sizeof</span>(storage::PageHeader),</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      0,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keyword">sizeof</span>(storage::Page) - <span class="keyword">sizeof</span>(storage::PageHeader));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    std::string duh(<span class="stringliteral">&quot;This is the first 4kb page of a snapshot file in libfoedus.&quot;</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="stringliteral">&quot; The first page is never used as data. It just has the common page header&quot;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="stringliteral">&quot; and these useless sentences. Maybe we put our complaints on our cafeteria here.&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    std::memcpy(first_page + <span class="keyword">sizeof</span>(storage::PageHeader), duh.data(), duh.size());</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(snapshot_file_-&gt;<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">write</a>(<span class="keyword">sizeof</span>(storage::Page), *pool_memory_));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    next_page_id_ = <a class="code" href="namespacefoedus_1_1storage.html#ae3265a3229e0e80b662b00abb8457395">storage::to_snapshot_page_pointer</a>(snapshot_id_, numa_node_, 1);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// if appending, nothing to do</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    uint64_t <a class="code" href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8">file_size</a> = snapshot_file_-&gt;<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a6848e9b0a2e9ecce1570c49803b3f375">get_current_offset</a>();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    LOG(INFO) &lt;&lt; <a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a6febb6c4b078b4ac27af1fe469ff5025">to_string</a>() &lt;&lt; <span class="stringliteral">&quot; Appending to &quot;</span> &lt;&lt; file_size &lt;&lt; <span class="stringliteral">&quot;th bytes&quot;</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(file_size &gt;= <span class="keyword">sizeof</span>(storage::Page));  <span class="comment">// have at least the dummy page</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(file_size % <span class="keyword">sizeof</span>(storage::Page) == 0);  <span class="comment">// must be aligned writes</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    uint64_t next_offset = file_size / <span class="keyword">sizeof</span>(storage::Page);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    next_page_id_ = <a class="code" href="namespacefoedus_1_1storage.html#ae3265a3229e0e80b662b00abb8457395">storage::to_snapshot_page_pointer</a>(snapshot_id_, numa_node_, next_offset);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1SnapshotWriter_html_a4944523eeeba60c3b677a8147b1f9e42"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4944523eeeba60c3b677a8147b1f9e42">foedus::snapshot::SnapshotWriter::close</a></div><div class="ttdeci">bool close()</div><div class="ttdoc">Close the file and makes sure all writes become durable (including the directory entry). </div><div class="ttdef"><b>Definition:</b> <a href="snapshot__writer__impl_8cpp_source.html#l00053">snapshot_writer_impl.cpp:53</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a9f19d10be82ac60706853e106a5de0e1"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">foedus::fs::DirectIoFile::write</a></div><div class="ttdeci">ErrorCode write(uint64_t desired_bytes, const foedus::memory::AlignedMemory &amp;buffer)</div><div class="ttdoc">Sequentially write the given amount of contents from the current position. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00216">direct_io_file.cpp:216</a></div></div>
<div class="ttc" id="structfoedus_1_1snapshot_1_1SnapshotOptions_html_ac1b18bc1cd4db02607e21b6fb7a42b00"><div class="ttname"><a href="structfoedus_1_1snapshot_1_1SnapshotOptions.html#ac1b18bc1cd4db02607e21b6fb7a42b00">foedus::snapshot::SnapshotOptions::emulation_</a></div><div class="ttdeci">foedus::fs::DeviceEmulationOptions emulation_</div><div class="ttdoc">Settings to emulate slower data device. </div><div class="ttdef"><b>Definition:</b> <a href="snapshot__options_8hpp_source.html#l00147">snapshot_options.hpp:147</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_html_ae3265a3229e0e80b662b00abb8457395"><div class="ttname"><a href="namespacefoedus_1_1storage.html#ae3265a3229e0e80b662b00abb8457395">foedus::storage::to_snapshot_page_pointer</a></div><div class="ttdeci">SnapshotPagePointer to_snapshot_page_pointer(uint16_t snapshot_id, uint8_t node, SnapshotLocalPageId local_page_id)</div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00106">storage_id.hpp:106</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_aaa3c1e50680d02783b61f5fe23f98b14"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#aaa3c1e50680d02783b61f5fe23f98b14">foedus::fs::DirectIoFile::open</a></div><div class="ttdeci">ErrorCode open(bool read, bool write, bool append, bool create)</div><div class="ttdoc">Tries to open the file for the specified volume. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00055">direct_io_file.cpp:55</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a6848e9b0a2e9ecce1570c49803b3f375"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a6848e9b0a2e9ecce1570c49803b3f375">foedus::fs::DirectIoFile::get_current_offset</a></div><div class="ttdeci">uint64_t get_current_offset() const </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00173">direct_io_file.hpp:173</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_ac8febbe3a3d3015c9b93cc1afb8154c1"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#ac8febbe3a3d3015c9b93cc1afb8154c1">foedus::EngineOptions::snapshot_</a></div><div class="ttdeci">snapshot::SnapshotOptions snapshot_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00143">engine_options.hpp:143</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_af306ba60622e2a87f75ae93dc6c597b1"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1">foedus::memory::AlignedMemory::get_block</a></div><div class="ttdeci">void * get_block() const </div><div class="ttdoc">Returns the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00168">aligned_memory.hpp:168</a></div></div>
<div class="ttc" id="group__FILESYSTEM_html_ga1048a33bafe4dcea89991112ae2660d8"><div class="ttname"><a href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8">foedus::fs::file_size</a></div><div class="ttdeci">uint64_t file_size(const Path &amp;p)</div><div class="ttdoc">Returns size of the file. </div><div class="ttdef"><b>Definition:</b> <a href="filesystem_8cpp_source.html#l00120">filesystem.cpp:120</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1SnapshotWriter_html_a6febb6c4b078b4ac27af1fe469ff5025"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a6febb6c4b078b4ac27af1fe469ff5025">foedus::snapshot::SnapshotWriter::to_string</a></div><div class="ttdeci">std::string to_string() const </div><div class="ttdef"><b>Definition:</b> <a href="snapshot__writer__impl_8hpp_source.html#l00148">snapshot_writer_impl.hpp:148</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a7d71f940f088efa51d0b5769d4fdd31f_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a7d71f940f088efa51d0b5769d4fdd31f_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a7d71f940f088efa51d0b5769d4fdd31f_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a7d71f940f088efa51d0b5769d4fdd31f_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4944523eeeba60c3b677a8147b1f9e42" title="Close the file and makes sure all writes become durable (including the directory entry). " alt="" coords="252,161,436,203"/>
<area shape="rect" id="node13" href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8" title="Returns size of the file. " alt="" coords="509,71,643,98"/>
<area shape="rect" id="node14" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="237,459,451,500"/>
<area shape="rect" id="node15" href="classfoedus_1_1fs_1_1DirectIoFile.html#a6848e9b0a2e9ecce1570c49803b3f375" title="foedus::fs::DirectIoFile\l::get_current_offset" alt="" coords="269,524,419,565"/>
<area shape="rect" id="node16" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="277,589,411,631"/>
<area shape="rect" id="node17" href="classfoedus_1_1fs_1_1DirectIoFile.html#aaa3c1e50680d02783b61f5fe23f98b14" title="Tries to open the file for the specified volume. " alt="" coords="269,341,419,383"/>
<area shape="rect" id="node24" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1" title="Sequentially write the given amount of contents from the current position. " alt="" coords="501,575,651,616"/>
<area shape="rect" id="node25" href="namespacefoedus_1_1storage.html#ae3265a3229e0e80b662b00abb8457395" title="foedus::storage::to\l_snapshot_page_pointer" alt="" coords="263,655,425,696"/>
<area shape="rect" id="node27" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a6febb6c4b078b4ac27af1fe469ff5025" title="foedus::snapshot::Snapshot\lWriter::to_string" alt="" coords="252,720,436,761"/>
<area shape="rect" id="node3" href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267" title="Close the file if not yet closed. " alt="" coords="501,173,651,215"/>
<area shape="rect" id="node5" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e" title="Makes the content and metadata of the file durable all the way up to devices. " alt="" coords="921,225,1038,251"/>
<area shape="rect" id="node12" href="classfoedus_1_1fs_1_1DirectIoFile.html#a91315b18dee7b839ba47cfa80116295c" title="foedus::fs::DirectIoFile\l::get_path" alt="" coords="501,5,651,47"/>
<area shape="rect" id="node4" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="710,180,850,221"/>
<area shape="rect" id="node6" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="1533,291,1684,318"/>
<area shape="rect" id="node7" href="group__FILESYSTEM.html#ga87c90d834f65aad6f7b6540ae226f305" title="Returns if the file is a directory. " alt="" coords="1118,225,1271,251"/>
<area shape="rect" id="node10" href="classfoedus_1_1fs_1_1Path.html#a9859706102ecca097e723d762ec468ae" title="foedus::fs::Path::parent_path" alt="" coords="1100,422,1289,449"/>
<area shape="rect" id="node8" href="structfoedus_1_1fs_1_1FileStatus.html#a7b8858f191dee3d9a92cae0cd759c1e5" title="foedus::fs::FileStatus\l::is_directory" alt="" coords="1339,225,1484,267"/>
<area shape="rect" id="node9" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="1350,174,1473,201"/>
<area shape="rect" id="node11" href="classfoedus_1_1fs_1_1Path.html#a95efbd1ef2b5f97560bdc964ab0b00ed" title="foedus::fs::Path::Path" alt="" coords="1337,422,1485,449"/>
<area shape="rect" id="node18" href="group__FILESYSTEM.html#gaca1dd0a627c83ff76e30603ea67c4816" title="Recursive mkdir (mkdirs). " alt="" coords="515,341,637,383"/>
<area shape="rect" id="node21" href="group__FILESYSTEM.html#ga4f8f53901e9c98fce72b6b3c52cf83a4" title="Returns if the file exists. " alt="" coords="719,254,841,281"/>
<area shape="rect" id="node23" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="501,407,651,448"/>
<area shape="rect" id="node19" href="group__FILESYSTEM.html#ga5cf40c936f78178ef58af0a900031b8b" title="mkdir. " alt="" coords="719,305,841,347"/>
<area shape="rect" id="node20" href="classfoedus_1_1fs_1_1Path.html#a4efe9caad4e61d844b04a90a4c43b3cb" title="foedus::fs::Path::empty" alt="" coords="701,371,859,398"/>
<area shape="rect" id="node22" href="structfoedus_1_1fs_1_1FileStatus.html#ac4ab24d4308aab673c8d1606a84367e5" title="foedus::fs::FileStatus\l::exists" alt="" coords="907,276,1052,317"/>
<area shape="rect" id="node26" href="namespacefoedus_1_1storage.html#ae8edbc0aca55caaab196c65e5c3b5aa9" title="foedus::storage::assert\l_valid_snapshot_local\l_page_id" alt="" coords="499,647,653,703"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ade9d44005dba0784807588a4ba3ab3c7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">SnapshotWriter</a>&amp; foedus::snapshot::SnapshotWriter::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">SnapshotWriter</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a52a9a0e1900d6613471425c5610935de"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* foedus::snapshot::SnapshotWriter::resolve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a>&#160;</td>
          <td class="paramname"><em>offset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00118">118</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00102">get_page_base()</a>, and <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00105">get_page_size()</a>.</p>
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                                                           {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offset &gt; 0);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offset &lt; <a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09">get_page_size</a>());</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720">get_page_base</a>() + offset;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1SnapshotWriter_html_ab547f0a3936d5cb0c0ee827ea77edd09"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09">foedus::snapshot::SnapshotWriter::get_page_size</a></div><div class="ttdeci">memory::PagePoolOffset get_page_size() const __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="snapshot__writer__impl_8hpp_source.html#l00105">snapshot_writer_impl.hpp:105</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1SnapshotWriter_html_a4f72263ae71f34fad0130151328d6720"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720">foedus::snapshot::SnapshotWriter::get_page_base</a></div><div class="ttdeci">storage::Page * get_page_base() __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="snapshot__writer__impl_8hpp_source.html#l00102">snapshot_writer_impl.hpp:102</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a52a9a0e1900d6613471425c5610935de_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a52a9a0e1900d6613471425c5610935de_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a52a9a0e1900d6613471425c5610935de_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a52a9a0e1900d6613471425c5610935de_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720" title="foedus::snapshot::Snapshot\lWriter::get_page_base" alt="" coords="237,5,421,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09" title="foedus::snapshot::Snapshot\lWriter::get_page_size" alt="" coords="237,71,421,112"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="469,5,683,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="469,71,683,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7c46afe7bfeb2a5a3fec3adc4032dd78"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> foedus::snapshot::SnapshotWriter::resolve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a> *&#160;</td>
          <td class="paramname"><em>page</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00123">123</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00102">get_page_base()</a>, and <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00105">get_page_size()</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                                                 {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> offset = page - <a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720">get_page_base</a>();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offset &gt; 0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offset &lt; <a class="code" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09">get_page_size</a>());</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">return</span> offset;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="ttc" id="group__MEMORY_html_gaf7ed7c23d184b14ce978b1775a86dfae"><div class="ttname"><a href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">foedus::memory::PagePoolOffset</a></div><div class="ttdeci">uint32_t PagePoolOffset</div><div class="ttdoc">Offset in PagePool that compactly represents the page address (unlike 8 bytes pointer). </div><div class="ttdef"><b>Definition:</b> <a href="memory__id_8hpp_source.html#l00044">memory_id.hpp:44</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1SnapshotWriter_html_ab547f0a3936d5cb0c0ee827ea77edd09"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09">foedus::snapshot::SnapshotWriter::get_page_size</a></div><div class="ttdeci">memory::PagePoolOffset get_page_size() const __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="snapshot__writer__impl_8hpp_source.html#l00105">snapshot_writer_impl.hpp:105</a></div></div>
<div class="ttc" id="classfoedus_1_1snapshot_1_1SnapshotWriter_html_a4f72263ae71f34fad0130151328d6720"><div class="ttname"><a href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720">foedus::snapshot::SnapshotWriter::get_page_base</a></div><div class="ttdeci">storage::Page * get_page_base() __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="snapshot__writer__impl_8hpp_source.html#l00102">snapshot_writer_impl.hpp:102</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a7c46afe7bfeb2a5a3fec3adc4032dd78_cgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a7c46afe7bfeb2a5a3fec3adc4032dd78_cgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a7c46afe7bfeb2a5a3fec3adc4032dd78_cgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a7c46afe7bfeb2a5a3fec3adc4032dd78_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720" title="foedus::snapshot::Snapshot\lWriter::get_page_base" alt="" coords="237,5,421,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09" title="foedus::snapshot::Snapshot\lWriter::get_page_size" alt="" coords="237,71,421,112"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="469,5,683,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="469,71,683,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6febb6c4b078b4ac27af1fe469ff5025"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string foedus::snapshot::SnapshotWriter::to_string </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00148">148</a> of file <a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00082">open()</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                          {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;SnapshotWriter-&quot;</span> + std::to_string(numa_node_) + (append_ ? <span class="stringliteral">&quot;(append)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1snapshot_1_1SnapshotWriter_a6febb6c4b078b4ac27af1fe469ff5025_icgraph.png" border="0" usemap="#classfoedus_1_1snapshot_1_1SnapshotWriter_a6febb6c4b078b4ac27af1fe469ff5025_icgraph" alt=""/></div>
<map name="classfoedus_1_1snapshot_1_1SnapshotWriter_a6febb6c4b078b4ac27af1fe469ff5025_icgraph" id="classfoedus_1_1snapshot_1_1SnapshotWriter_a6febb6c4b078b4ac27af1fe469ff5025_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a7d71f940f088efa51d0b5769d4fdd31f" title="Open the file so that the writer can start writing. " alt="" coords="237,5,421,47"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a81f13429d9d0af51890b6563885c3aec"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">SnapshotWriter</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00174">174</a> of file <a class="el" href="snapshot__writer__impl_8cpp_source.html">snapshot_writer_impl.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                                               {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;SnapshotWriter&gt;&quot;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;numa_node_&gt;&quot;</span> &lt;&lt; v.numa_node_ &lt;&lt; <span class="stringliteral">&quot;&lt;/numa_node_&gt;&quot;</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;append_&gt;&quot;</span> &lt;&lt; v.append_ &lt;&lt; <span class="stringliteral">&quot;&lt;/append_&gt;&quot;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;snapshot_id_&gt;&quot;</span> &lt;&lt; v.snapshot_id_ &lt;&lt; <span class="stringliteral">&quot;&lt;/snapshot_id_&gt;&quot;</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;pool_memory_&gt;&quot;</span> &lt;&lt; *v.pool_memory_ &lt;&lt; <span class="stringliteral">&quot;&lt;/pool_memory_&gt;&quot;</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;intermediate_memory_&gt;&quot;</span> &lt;&lt; *v.intermediate_memory_ &lt;&lt; <span class="stringliteral">&quot;&lt;/intermediate_memory_&gt;&quot;</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;next_page_id_&gt;&quot;</span> &lt;&lt; v.next_page_id_ &lt;&lt; <span class="stringliteral">&quot;&lt;/next_page_id_&gt;&quot;</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;/SnapshotWriter&gt;&quot;</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/snapshot/<a class="el" href="snapshot__writer__impl_8hpp_source.html">snapshot_writer_impl.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/snapshot/<a class="el" href="snapshot__writer__impl_8cpp_source.html">snapshot_writer_impl.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1snapshot.html">snapshot</a></li><li class="navelem"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">SnapshotWriter</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

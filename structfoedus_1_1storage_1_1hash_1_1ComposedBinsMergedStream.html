<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::storage::hash::ComposedBinsMergedStream Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::storage::hash::ComposedBinsMergedStream Struct Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__STORAGE.html">Storage Manager</a> &raquo; <a class="el" href="group__HASH.html">Hashtable Storage</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Packages all <a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html" title="Abstracts how we batch-read several HashComposedBinsPage emit from individual composers. ">ComposedBinsBuffer</a> to easily extract bins of current interest.  
 <a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Packages all <a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html" title="Abstracts how we batch-read several HashComposedBinsPage emit from individual composers. ">ComposedBinsBuffer</a> to easily extract bins of current interest. </p>
<p>This is the highest-level of the object hierarchy defined in this file. </p>

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00205">205</a> of file <a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for foedus::storage::hash::ComposedBinsMergedStream:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream__coll__graph.png" border="0" usemap="#foedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_coll__map" alt="Collaboration graph"/></div>
<map name="foedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_coll__map" id="foedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_coll__map">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html" title="Represents an intermediate page in Hashtable Storage. " alt="" coords="1753,33,1914,75"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html" title="Abstracts how we batch&#45;read several HashComposedBinsPage emit from individual composers. " alt="" coords="1512,113,1663,155"/>
<area shape="rect" id="node4" href="group__HASH.html#structfoedus_1_1storage_1_1hash_1_1HashComposedBinsPage" title="A page to pack many ComposedBin as an output of composer. " alt="" coords="1226,81,1405,123"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html" title="Represents a range of hash bins in a hash storage, such as what an intermediate page is responsible f..." alt="" coords="927,5,1074,47"/>
<area shape="rect" id="node6" href="group__HASH.html#structfoedus_1_1storage_1_1hash_1_1ComposedBin" title="Represents an output of composer on one bin. " alt="" coords="927,71,1074,112"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1PageHeader.html" title="Just a marker to denote that a memory region represents a data page. " alt="" coords="905,137,1096,163"/>
<area shape="rect" id="node8" href="structfoedus_1_1assorted_1_1ProbCounter.html" title="Implements a probabilistic counter [Morris 1978]. " alt="" coords="572,86,771,113"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1PageVersion.html" title="Just a synonym of XctId to be used as a page lock mechanism. " alt="" coords="575,137,767,163"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1PageVersionStatus.html" title="foedus::storage::PageVersion\lStatus" alt="" coords="284,107,476,148"/>
<area shape="rect" id="node11" href="structfoedus_1_1xct_1_1McsWwLock.html" title="An exclusive&#45;only (WW) MCS lock data structure. " alt="" coords="295,173,465,199"/>
<area shape="rect" id="node12" href="structfoedus_1_1xct_1_1McsWwBlockData.html" title="Exclusive&#45;only (WW) MCS lock classes. " alt="" coords="5,173,207,199"/>
<area shape="rect" id="node13" href="classfoedus_1_1cache_1_1SnapshotFileSet.html" title="Holds a set of read&#45;only file objects for snapshot files. " alt="" coords="1212,157,1419,183"/>
<area shape="rect" id="node14" href="classfoedus_1_1DefaultInitializable.html" title="Typical implementation of Initializable as a skeleton base class. " alt="" coords="915,187,1087,214"/>
<area shape="rect" id="node15" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="605,187,737,214"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a76fd54b958c7e6a74a1b600a79211e9d"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a></td></tr>
<tr class="separator:a76fd54b958c7e6a74a1b600a79211e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af617a04eb5df3795abfe4900a20a6db6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6">init</a> (const <a class="el" href="group__HASH.html#ga80112dcdbc2c32d5504356737f7808ee">HashRootInfoPage</a> *const *inputs, uint32_t input_count, <a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a> root_page, uint16_t root_child_index, <a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> *read_buffer, <a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *fileset, <a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">snapshot::SnapshotWriter</a> *writer, uint32_t *writer_buffer_pos, uint32_t *writer_higher_buffer_pos, bool *had_any_change)</td></tr>
<tr class="separator:af617a04eb5df3795abfe4900a20a6db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3a65cebf835d18357a69bd523a3bc9d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac3a65cebf835d18357a69bd523a3bc9d">process_a_bin</a> (uint32_t *installed_count, <a class="el" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a> *next_lowest_bin)</td></tr>
<tr class="memdesc:ac3a65cebf835d18357a69bd523a3bc9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Consumes inputs for the cur_path_[0] page and install snapshot pointers there.  <a href="#ac3a65cebf835d18357a69bd523a3bc9d">More...</a><br /></td></tr>
<tr class="separator:ac3a65cebf835d18357a69bd523a3bc9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d314f5d6c1a5f698ca623ef7d0188e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e">switch_path</a> (<a class="el" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a> lowest_bin, <a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *fileset, <a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">snapshot::SnapshotWriter</a> *writer, uint32_t *writer_buffer_pos, uint32_t *writer_higher_buffer_pos)</td></tr>
<tr class="memdesc:ad9d314f5d6c1a5f698ca623ef7d0188e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Moves cur_path_ to a page that cotains the specified bin.  <a href="#ad9d314f5d6c1a5f698ca623ef7d0188e">More...</a><br /></td></tr>
<tr class="separator:ad9d314f5d6c1a5f698ca623ef7d0188e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230f7dbb47f1b22e7295fe7c00a96fa4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4">open_path</a> (<a class="el" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a> bin, uint8_t fixed_upto_level, <a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *fileset, <a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">snapshot::SnapshotWriter</a> *writer, uint32_t *writer_buffer_pos, uint32_t *writer_higher_buffer_pos)</td></tr>
<tr class="memdesc:a230f7dbb47f1b22e7295fe7c00a96fa4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recursively opens pages down from fixed_upto_level.  <a href="#a230f7dbb47f1b22e7295fe7c00a96fa4">More...</a><br /></td></tr>
<tr class="separator:a230f7dbb47f1b22e7295fe7c00a96fa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbaff9aeb65615f7af84b820fd3bf241"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#adbaff9aeb65615f7af84b820fd3bf241">assure_writer_buffer</a> (<a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">snapshot::SnapshotWriter</a> *writer, uint32_t *writer_buffer_pos, uint32_t writer_higher_buffer_pos)</td></tr>
<tr class="memdesc:adbaff9aeb65615f7af84b820fd3bf241"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to flush the writer if needed to make sure it has enough room.  <a href="#adbaff9aeb65615f7af84b820fd3bf241">More...</a><br /></td></tr>
<tr class="separator:adbaff9aeb65615f7af84b820fd3bf241"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a50e596103c2e1b8bb4172dbbd013d87f"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html">ComposedBinsBuffer</a>[] &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a50e596103c2e1b8bb4172dbbd013d87f">inputs_memory_</a></td></tr>
<tr class="memdesc:a50e596103c2e1b8bb4172dbbd013d87f"><td class="mdescLeft">&#160;</td><td class="mdescRight">just for auto release  <a href="#a50e596103c2e1b8bb4172dbbd013d87f">More...</a><br /></td></tr>
<tr class="separator:a50e596103c2e1b8bb4172dbbd013d87f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a368530bdff21d82974fe381ff7047894"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html">ComposedBinsBuffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a368530bdff21d82974fe381ff7047894">inputs_</a></td></tr>
<tr class="separator:a368530bdff21d82974fe381ff7047894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af14890eca14b624933a31695301cfc54"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af14890eca14b624933a31695301cfc54">input_count_</a></td></tr>
<tr class="memdesc:af14890eca14b624933a31695301cfc54"><td class="mdescLeft">&#160;</td><td class="mdescRight">total number of buffers in inputs_  <a href="#af14890eca14b624933a31695301cfc54">More...</a><br /></td></tr>
<tr class="separator:af14890eca14b624933a31695301cfc54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4636fdc3d56e3e7bdeec76376110844"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__SNAPSHOT.html#gaec32eb05303ebec1048d120f73295031">snapshot::SnapshotId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac4636fdc3d56e3e7bdeec76376110844">snapshot_id_</a></td></tr>
<tr class="separator:ac4636fdc3d56e3e7bdeec76376110844"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44aee1c88cd9632da951affe0cd029e4"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a></td></tr>
<tr class="separator:a44aee1c88cd9632da951affe0cd029e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73307558c0f8b10b72196c1fc6394f0"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#aa73307558c0f8b10b72196c1fc6394f0">padding_</a></td></tr>
<tr class="separator:aa73307558c0f8b10b72196c1fc6394f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a624c99f582a4eba687bf61431c2a3434"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a> [<a class="el" href="group__HASH.html#gacb6faca61be6849c9cdb02447cb3edbe">kHashMaxLevels</a>]</td></tr>
<tr class="memdesc:a624c99f582a4eba687bf61431c2a3434"><td class="mdescLeft">&#160;</td><td class="mdescRight">The pages we are now composing.  <a href="#a624c99f582a4eba687bf61431c2a3434">More...</a><br /></td></tr>
<tr class="separator:a624c99f582a4eba687bf61431c2a3434"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a76fd54b958c7e6a74a1b600a79211e9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a>* <a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">foedus::storage::hash::ComposedBinsMergedStream::PagePtr</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00206">206</a> of file <a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="adbaff9aeb65615f7af84b820fd3bf241"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::ComposedBinsMergedStream::assure_writer_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">snapshot::SnapshotWriter</a> *&#160;</td>
          <td class="paramname"><em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>writer_buffer_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>writer_higher_buffer_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to flush the writer if needed to make sure it has enough room. </p>

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00290">290</a> of file <a class="el" href="hash__composed__bins__impl_8cpp_source.html">hash_composed_bins_impl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00135">foedus::snapshot::SnapshotWriter::dump_pages()</a>, <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00163">foedus::snapshot::SnapshotWriter::expand_intermediate_memory()</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00111">foedus::snapshot::SnapshotWriter::get_intermediate_size()</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00105">foedus::snapshot::SnapshotWriter::get_page_size()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00215">levels_</a>, and <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>.</p>

<p>Referenced by <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">open_path()</a>.</p>
<div class="fragment"><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                     {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(*writer_buffer_pos &lt;= writer-&gt;get_page_size());</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(writer_higher_buffer_pos &lt;= writer-&gt;get_intermediate_size());</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(*writer_buffer_pos == writer-&gt;get_page_size())) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(writer-&gt;dump_pages(0, *writer_buffer_pos));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    *writer_buffer_pos = 0;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(writer_higher_buffer_pos + <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a> &gt;= writer-&gt;get_intermediate_size())) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(writer-&gt;expand_intermediate_memory(writer_higher_buffer_pos + <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a>, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(writer_higher_buffer_pos + levels_ &lt; writer-&gt;get_intermediate_size());</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a44aee1c88cd9632da951affe0cd029e4"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">foedus::storage::hash::ComposedBinsMergedStream::levels_</a></div><div class="ttdeci">uint8_t levels_</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00215">hash_composed_bins_impl.hpp:215</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_adbaff9aeb65615f7af84b820fd3bf241_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_adbaff9aeb65615f7af84b820fd3bf241_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_adbaff9aeb65615f7af84b820fd3bf241_cgraph" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_adbaff9aeb65615f7af84b820fd3bf241_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a55ba9fc4a87f71b3991bba1c39948cc9" title="Write out pages that are contiguous in the main page pool. " alt="" coords="283,5,467,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ad43c975601c7bced5a548c4872c498e4" title="Expands intermediate_memory_ in case it is too small. " alt="" coords="256,71,495,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#adb899ef232610546cd5a017a817fba45" title="foedus::snapshot::Snapshot\lWriter::get_intermediate_size" alt="" coords="553,125,745,167"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09" title="foedus::snapshot::Snapshot\lWriter::get_page_size" alt="" coords="557,191,741,232"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad79701492d232cb5aec1ad4d8c99eb5d" title="If the current size is smaller than the given size, automatically expands. " alt="" coords="543,60,756,101"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="804,12,1017,53"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b" title="Releases the memory block. " alt="" coords="804,77,1017,119"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="804,175,1017,216"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_adbaff9aeb65615f7af84b820fd3bf241_icgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_adbaff9aeb65615f7af84b820fd3bf241_icgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_adbaff9aeb65615f7af84b820fd3bf241_icgraph" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_adbaff9aeb65615f7af84b820fd3bf241_icgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="256,35,459,91"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="507,5,735,47"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="519,71,722,127"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af617a04eb5df3795abfe4900a20a6db6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::ComposedBinsMergedStream::init </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__HASH.html#ga80112dcdbc2c32d5504356737f7808ee">HashRootInfoPage</a> *const *&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>input_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a>&#160;</td>
          <td class="paramname"><em>root_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>root_child_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">memory::AlignedMemory</a> *&#160;</td>
          <td class="paramname"><em>read_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *&#160;</td>
          <td class="paramname"><em>fileset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">snapshot::SnapshotWriter</a> *&#160;</td>
          <td class="paramname"><em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>writer_buffer_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>writer_higher_buffer_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>had_any_change</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00087">87</a> of file <a class="el" href="hash__composed__bins__impl_8cpp_source.html">hash_composed_bins_impl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00074">foedus::storage::hash::ComposedBinsBuffer::assure_read_buffer_size()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00086">foedus::storage::hash::ComposedBin::bin_</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00219">cur_path_</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00168">foedus::memory::AlignedMemory::get_block()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00190">foedus::storage::hash::ComposedBinsBuffer::get_cur_bin()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00105">foedus::storage::hash::HashIntermediatePage::get_level()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00080">foedus::storage::hash::HashIntermediatePage::get_pointer()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00172">foedus::memory::AlignedMemory::get_size()</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00116">foedus::snapshot::SnapshotWriter::get_snapshot_id()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00196">foedus::storage::hash::ComposedBinsBuffer::has_more()</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00033">foedus::storage::hash::ComposedBinsBuffer::init()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00213">input_count_</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00211">inputs_</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00209">inputs_memory_</a>, <a class="el" href="hash__id_8hpp_source.html#l00162">foedus::storage::hash::kInvalidHashBin</a>, <a class="el" href="storage__id_8hpp_source.html#l00045">foedus::storage::kPageSize</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00215">levels_</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">open_path()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00214">snapshot_id_</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>, <a class="el" href="storage__id_8hpp_source.html#l00195">foedus::storage::VolatilePagePointer::word</a>, and <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                            {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(root_page-&gt;get_level() &gt;= 1U);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac4636fdc3d56e3e7bdeec76376110844">snapshot_id_</a> = writer-&gt;get_snapshot_id();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  std::memset(<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a50e596103c2e1b8bb4172dbbd013d87f">inputs_memory_</a>.reset(<span class="keyword">new</span> ComposedBinsBuffer[input_count]);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a368530bdff21d82974fe381ff7047894">inputs_</a> = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a50e596103c2e1b8bb4172dbbd013d87f">inputs_memory_</a>.get();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af14890eca14b624933a31695301cfc54">input_count_</a> = input_count;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a10d0ce3242bd7bdcc9d9c2fe1520f56d">ComposedBinsBuffer::assure_read_buffer_size</a>(read_buffer, input_count);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  uint64_t buffer_piece_size = read_buffer-&gt;get_size() / <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">kPageSize</a> / input_count;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af14890eca14b624933a31695301cfc54">input_count_</a>; ++i) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">const</span> DualPagePointer&amp; root_child = inputs[i]-&gt;get_pointer(root_child_index);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">SnapshotPagePointer</a> head_page_id = root_child.snapshot_pointer_;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    uint32_t total_pages = root_child.volatile_pointer_.word;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(total_pages &gt; 0);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    HashComposedBinsPage* read_buffer_casted</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      = <span class="keyword">reinterpret_cast&lt;</span>HashComposedBinsPage*<span class="keyword">&gt;</span>(read_buffer-&gt;get_block());</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    HashComposedBinsPage* buffer_piece = read_buffer_casted + buffer_piece_size * i;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a368530bdff21d82974fe381ff7047894">inputs_</a>[i].<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a734b6a7df293ddbfdfea5b112958ea41">init</a>(fileset, head_page_id, total_pages, buffer_piece_size, buffer_piece);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a368530bdff21d82974fe381ff7047894">inputs_</a>[i].has_more()) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a368530bdff21d82974fe381ff7047894">inputs_</a>[i].next_pages());</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a> = root_page-&gt;get_level() + 1U;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[root_page-&gt;get_level()] = root_page;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// what&#39;s the bin we initially seek to?</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a> initial_bin = <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a1f04faaadf8a2eb07c654fbe116c3a11">kInvalidHashBin</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af14890eca14b624933a31695301cfc54">input_count_</a>; ++i) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    ComposedBinsBuffer* input = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a368530bdff21d82974fe381ff7047894">inputs_</a> + i;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (input-&gt;has_more()) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      initial_bin = std::min&lt;HashBin&gt;(initial_bin, input-&gt;get_cur_bin().bin_);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span> (initial_bin == <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a1f04faaadf8a2eb07c654fbe116c3a11">kInvalidHashBin</a>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    *had_any_change = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    *had_any_change = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4">open_path</a>(</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      initial_bin,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      root_page-&gt;get_level(),</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      fileset,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      writer,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      writer_buffer_pos,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      writer_higher_buffer_pos));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_ac4636fdc3d56e3e7bdeec76376110844"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac4636fdc3d56e3e7bdeec76376110844">foedus::storage::hash::ComposedBinsMergedStream::snapshot_id_</a></div><div class="ttdeci">snapshot::SnapshotId snapshot_id_</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00214">hash_composed_bins_impl.hpp:214</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_af14890eca14b624933a31695301cfc54"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af14890eca14b624933a31695301cfc54">foedus::storage::hash::ComposedBinsMergedStream::input_count_</a></div><div class="ttdeci">uint32_t input_count_</div><div class="ttdoc">total number of buffers in inputs_ </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00213">hash_composed_bins_impl.hpp:213</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a624c99f582a4eba687bf61431c2a3434"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">foedus::storage::hash::ComposedBinsMergedStream::cur_path_</a></div><div class="ttdeci">PagePtr cur_path_[kHashMaxLevels]</div><div class="ttdoc">The pages we are now composing. </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00219">hash_composed_bins_impl.hpp:219</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer_html_a734b6a7df293ddbfdfea5b112958ea41"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a734b6a7df293ddbfdfea5b112958ea41">foedus::storage::hash::ComposedBinsBuffer::init</a></div><div class="ttdeci">void init(cache::SnapshotFileSet *fileset, SnapshotPagePointer head_page_id, uint32_t total_pages, uint32_t buffer_size, HashComposedBinsPage *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8cpp_source.html#l00033">hash_composed_bins_impl.cpp:33</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga629d4b8103bfb83ef9c11b842a4fd398"><div class="ttname"><a href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">foedus::storage::SnapshotPagePointer</a></div><div class="ttdeci">uint64_t SnapshotPagePointer</div><div class="ttdoc">Page ID of a snapshot page. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00079">storage_id.hpp:79</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a44aee1c88cd9632da951affe0cd029e4"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">foedus::storage::hash::ComposedBinsMergedStream::levels_</a></div><div class="ttdeci">uint8_t levels_</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00215">hash_composed_bins_impl.hpp:215</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a368530bdff21d82974fe381ff7047894"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a368530bdff21d82974fe381ff7047894">foedus::storage::hash::ComposedBinsMergedStream::inputs_</a></div><div class="ttdeci">ComposedBinsBuffer * inputs_</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00211">hash_composed_bins_impl.hpp:211</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a50e596103c2e1b8bb4172dbbd013d87f"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a50e596103c2e1b8bb4172dbbd013d87f">foedus::storage::hash::ComposedBinsMergedStream::inputs_memory_</a></div><div class="ttdeci">std::unique_ptr&lt; ComposedBinsBuffer[] &gt; inputs_memory_</div><div class="ttdoc">just for auto release </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00209">hash_composed_bins_impl.hpp:209</a></div></div>
<div class="ttc" id="group__HASH_html_gacb9a1ea596bf0db3f6ded1710ab3b3d6"><div class="ttname"><a href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">foedus::storage::hash::HashBin</a></div><div class="ttdeci">uint64_t HashBin</div><div class="ttdoc">Represents a bin of a hash value. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00142">hash_id.hpp:142</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a230f7dbb47f1b22e7295fe7c00a96fa4"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4">foedus::storage::hash::ComposedBinsMergedStream::open_path</a></div><div class="ttdeci">ErrorCode open_path(HashBin bin, uint8_t fixed_upto_level, cache::SnapshotFileSet *fileset, snapshot::SnapshotWriter *writer, uint32_t *writer_buffer_pos, uint32_t *writer_higher_buffer_pos)</div><div class="ttdoc">Recursively opens pages down from fixed_upto_level. </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8cpp_source.html#l00225">hash_composed_bins_impl.cpp:225</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a1f04faaadf8a2eb07c654fbe116c3a11"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a1f04faaadf8a2eb07c654fbe116c3a11">foedus::storage::hash::kInvalidHashBin</a></div><div class="ttdeci">const HashBin kInvalidHashBin</div><div class="ttdoc">This value or larger never appears as a valid HashBin. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00162">hash_id.hpp:162</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer_html_a10d0ce3242bd7bdcc9d9c2fe1520f56d"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a10d0ce3242bd7bdcc9d9c2fe1520f56d">foedus::storage::hash::ComposedBinsBuffer::assure_read_buffer_size</a></div><div class="ttdeci">static void assure_read_buffer_size(memory::AlignedMemory *read_buffer, uint32_t inputs)</div><div class="ttdoc">If needed, expand the given read buffer to be used with the inputs. </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8cpp_source.html#l00074">hash_composed_bins_impl.cpp:74</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga1a3c05fe1d44455fc3e761947c6e21e6"><div class="ttname"><a href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">foedus::storage::kPageSize</a></div><div class="ttdeci">const uint16_t kPageSize</div><div class="ttdoc">A constant defining the page size (in bytes) of both snapshot pages and volatile pages. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00045">storage_id.hpp:45</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_af617a04eb5df3795abfe4900a20a6db6_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_af617a04eb5df3795abfe4900a20a6db6_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_af617a04eb5df3795abfe4900a20a6db6_cgraph" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_af617a04eb5df3795abfe4900a20a6db6_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a10d0ce3242bd7bdcc9d9c2fe1520f56d" title="If needed, expand the given read buffer to be used with the inputs. " alt="" coords="817,74,987,130"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="1331,420,1544,461"/>
<area shape="rect" id="node7" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="795,532,1009,573"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a27a70df0aa416ebe9560ab41e19de8fd" title="foedus::storage::hash\l::ComposedBinsBuffer\l::get_cur_bin" alt="" coords="307,266,458,322"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#aece2742172ad6ec69b66046362c2e265" title="foedus::storage::hash\l::ComposedBinsBuffer\l::has_more" alt="" coords="558,331,709,387"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="553,411,714,467"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="553,491,714,547"/>
<area shape="rect" id="node14" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ad4209f06409d52c010aac8bf98660dbe" title="foedus::snapshot::Snapshot\lWriter::get_snapshot_id" alt="" coords="291,499,475,540"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a734b6a7df293ddbfdfea5b112958ea41" title="foedus::storage::hash\l::ComposedBinsBuffer::init" alt="" coords="295,564,471,605"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="281,885,484,941"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad79701492d232cb5aec1ad4d8c99eb5d" title="If the current size is smaller than the given size, automatically expands. " alt="" coords="1069,37,1283,79"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="1331,5,1544,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b" title="Releases the memory block. " alt="" coords="1331,71,1544,112"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a1727fc002322da1b15f4e91f914fd35d" title="foedus::storage::hash\l::ComposedBinsBuffer\l::get_cur_page" alt="" coords="558,251,709,307"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="807,419,997,460"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#adbaff9aeb65615f7af84b820fd3bf241" title="Subroutine to flush the writer if needed to make sure it has enough room. " alt="" coords="532,703,735,759"/>
<area shape="rect" id="node20" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#adb899ef232610546cd5a017a817fba45" title="foedus::snapshot::Snapshot\lWriter::get_intermediate_size" alt="" coords="1080,692,1272,733"/>
<area shape="rect" id="node21" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09" title="foedus::snapshot::Snapshot\lWriter::get_page_size" alt="" coords="810,831,994,872"/>
<area shape="rect" id="node22" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a340a320860a56dd850c5f8e02a44278b" title="foedus::snapshot::Snapshot\lWriter::get_intermediate_base" alt="" coords="535,572,731,613"/>
<area shape="rect" id="node23" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720" title="foedus::snapshot::Snapshot\lWriter::get_page_base" alt="" coords="541,637,725,679"/>
<area shape="rect" id="node24" href="unionfoedus_1_1storage_1_1hash_1_1IntermediateRoute.html#a0212c25f878f45d0936d9df0271fd41b" title="Calculates the rout for the given hash bin. " alt="" coords="560,885,707,941"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="553,965,714,1021"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="553,1045,714,1101"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html#af492eb6df181653434b727ba29e5c833" title="foedus::storage::hash\l::HashBinRange::contains" alt="" coords="547,1125,720,1167"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html#ae2b145559047e486059fec93c35ebfc1" title="foedus::storage::hash\l::HashBinRange::length" alt="" coords="554,1191,713,1232"/>
<area shape="rect" id="node30" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#af9bcb8a605aecbbc3eabdc6664f6b163" title="foedus::snapshot::Snapshot\lWriter::get_next_page_id" alt="" coords="541,1256,725,1297"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6b20dce9484c09666d6cf1df866d00d3" title="foedus::storage::hash\l::HashIntermediatePage\l::initialize_snapshot_page" alt="" coords="547,1322,719,1378"/>
<area shape="rect" id="node39" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1081,1398,1271,1454"/>
<area shape="rect" id="node40" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="540,1533,727,1575"/>
<area shape="rect" id="node18" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a55ba9fc4a87f71b3991bba1c39948cc9" title="Write out pages that are contiguous in the main page pool. " alt="" coords="810,597,994,639"/>
<area shape="rect" id="node19" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ad43c975601c7bced5a548c4872c498e4" title="Expands intermediate_memory_ in case it is too small. " alt="" coords="783,663,1021,704"/>
<area shape="rect" id="node25" href="unionfoedus_1_1storage_1_1hash_1_1IntermediateRoute.html#a5c731b0f50eeabc808b77db3e7be71b7" title="foedus::storage::hash\l::IntermediateRoute::\lconvert_back" alt="" coords="829,897,975,953"/>
<area shape="rect" id="node32" href="structfoedus_1_1storage_1_1PageHeader.html#a65c4acd213d2f482eb29c6dee0818915" title="foedus::storage::PageHeader\l::init_snapshot" alt="" coords="807,1259,997,1300"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1PageHeader.html#a1956943904b68b6472f53b4e9ed6df87" title="foedus::storage::PageHeader\l::set_in_layer_level" alt="" coords="807,1329,997,1371"/>
<area shape="rect" id="node33" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1082,1318,1270,1374"/>
<area shape="rect" id="node34" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="1077,1187,1275,1228"/>
<area shape="rect" id="node35" href="structfoedus_1_1storage_1_1PageVersion.html#ae40168c82f16645e85bb66f9019e53cf" title="used only while page initialization " alt="" coords="1080,1252,1272,1293"/>
<area shape="rect" id="node36" href="structfoedus_1_1storage_1_1PageVersionStatus.html#af49ef4f3320148130f46f494f1c845aa" title="foedus::storage::PageVersion\lStatus::reset" alt="" coords="1341,1220,1533,1261"/>
<area shape="rect" id="node37" href="structfoedus_1_1xct_1_1McsWwLock.html#a4114c2dec151ad650a294dedac4f239d" title="used only while page initialization " alt="" coords="1353,1285,1522,1327"/>
<area shape="rect" id="node41" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="802,1453,1002,1509"/>
<area shape="rect" id="node42" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="809,1533,995,1575"/>
<area shape="rect" id="node43" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="827,1604,977,1645"/>
<area shape="rect" id="node50" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="827,1669,977,1711"/>
<area shape="rect" id="node44" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="1105,1609,1247,1651"/>
<area shape="rect" id="node45" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="1101,1479,1251,1520"/>
<area shape="rect" id="node46" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1106,1675,1246,1716"/>
<area shape="rect" id="node47" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="1101,1544,1251,1585"/>
<area shape="rect" id="node48" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="1109,1740,1243,1781"/>
<area shape="rect" id="node49" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="1370,1740,1505,1781"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a230f7dbb47f1b22e7295fe7c00a96fa4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::ComposedBinsMergedStream::open_path </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a>&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>fixed_upto_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *&#160;</td>
          <td class="paramname"><em>fileset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">snapshot::SnapshotWriter</a> *&#160;</td>
          <td class="paramname"><em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>writer_buffer_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>writer_higher_buffer_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recursively opens pages down from fixed_upto_level. </p>

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">225</a> of file <a class="el" href="hash__composed__bins__impl_8cpp_source.html">hash_composed_bins_impl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00290">assure_writer_buffer()</a>, <a class="el" href="hash__id_8hpp_source.html#l00191">foedus::storage::hash::HashBinRange::begin_</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__hashinate_8hpp_source.html#l00233">foedus::storage::hash::IntermediateRoute::construct()</a>, <a class="el" href="hash__id_8hpp_source.html#l00176">foedus::storage::hash::HashBinRange::contains()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00219">cur_path_</a>, <a class="el" href="storage__id_8hpp_source.html#l00098">foedus::storage::extract_snapshot_id_from_snapshot_pointer()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00104">foedus::storage::hash::HashIntermediatePage::get_bin_range()</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00108">foedus::snapshot::SnapshotWriter::get_intermediate_base()</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00111">foedus::snapshot::SnapshotWriter::get_intermediate_size()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00105">foedus::storage::hash::HashIntermediatePage::get_level()</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00115">foedus::snapshot::SnapshotWriter::get_next_page_id()</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00102">foedus::snapshot::SnapshotWriter::get_page_base()</a>, <a class="el" href="snapshot__writer__impl_8hpp_source.html#l00105">foedus::snapshot::SnapshotWriter::get_page_size()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00080">foedus::storage::hash::HashIntermediatePage::get_pointer()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00070">foedus::storage::hash::HashIntermediatePage::header()</a>, <a class="el" href="hash__page__impl_8cpp_source.html#l00058">foedus::storage::hash::HashIntermediatePage::initialize_snapshot_page()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="hash__id_8hpp_source.html#l00074">foedus::storage::hash::kHashMaxBins</a>, <a class="el" href="hash__id_8hpp_source.html#l00162">foedus::storage::hash::kInvalidHashBin</a>, <a class="el" href="hash__id_8hpp_source.html#l00185">foedus::storage::hash::HashBinRange::length()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00215">levels_</a>, <a class="el" href="page_8hpp_source.html#l00191">foedus::storage::PageHeader::page_id_</a>, <a class="el" href="snapshot__file__set_8cpp_source.html#l00095">foedus::cache::SnapshotFileSet::read_page()</a>, <a class="el" href="hash__hashinate_8hpp_source.html#l00203">foedus::storage::hash::IntermediateRoute::route</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00214">snapshot_id_</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, and <a class="el" href="page_8hpp_source.html#l00196">foedus::storage::PageHeader::storage_id_</a>.</p>

<p>Referenced by <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00087">init()</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00191">switch_path()</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                      {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin != <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a1f04faaadf8a2eb07c654fbe116c3a11">kInvalidHashBin</a>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[fixed_upto_level]-&gt;get_bin_range().contains(bin));</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(fixed_upto_level &lt; <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// we need a room for one-page in main buffer, and levels pages in higher-level buffer.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#adbaff9aeb65615f7af84b820fd3bf241">assure_writer_buffer</a>(writer, writer_buffer_pos, *writer_higher_buffer_pos));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a> higher_base = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a><span class="keyword">&gt;</span>(writer-&gt;get_intermediate_base());</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a> main_base = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a><span class="keyword">&gt;</span>(writer-&gt;get_page_base());</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  IntermediateRoute route = <a class="code" href="unionfoedus_1_1storage_1_1hash_1_1IntermediateRoute.html#a0212c25f878f45d0936d9df0271fd41b">IntermediateRoute::construct</a>(bin);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(route.route[<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a>] == 0);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keyword">const</span> <a class="code" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a> storage_id = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a> - 1U]-&gt;<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0">header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#a4a8c3c363862348530e4ea0be879f694">storage_id_</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// let&#39;s open the page that contains the bin. higher levels first.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">for</span> (uint8_t parent_level = fixed_upto_level; parent_level &gt; 0; --parent_level) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    uint8_t level = parent_level - 1U;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a> parent = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[parent_level];</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(parent-&gt;get_level() == parent_level);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(parent-&gt;get_bin_range().contains(bin));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keyword">const</span> uint16_t index = route.route[parent_level];</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a> range_begin = parent-&gt;get_bin_range().begin_ + index * <a class="code" href="group__HASH.html#ga0083e0d73570a990b862bb330f8d5831">kHashMaxBins</a>[parent_level];</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(parent-&gt;get_bin_range().length() == kHashMaxBins[parent_level + 1U]);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">SnapshotPagePointer</a> old_page_id = parent-&gt;get_pointer(index).snapshot_pointer_;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">SnapshotPagePointer</a> new_page_id;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a> new_page;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (level &gt; 0) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      new_page_id = *writer_higher_buffer_pos;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      new_page = higher_base + new_page_id;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      ++(*writer_higher_buffer_pos);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*writer_higher_buffer_pos) &lt;= writer-&gt;get_intermediate_size());</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="comment">// Unlike higher-levels, we can finalize the page ID for level-0 pages.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      new_page_id = writer-&gt;get_next_page_id() + (*writer_buffer_pos);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      new_page = main_base + *writer_buffer_pos;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      ++(*writer_buffer_pos);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*writer_buffer_pos) &lt;= writer-&gt;get_page_size());</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[level] = new_page;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">if</span> (old_page_id == 0) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="comment">// the page didn&#39;t exist before, create a new one.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      new_page-&gt;<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6b20dce9484c09666d6cf1df866d00d3">initialize_snapshot_page</a>(storage_id, new_page_id, level, range_begin);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="comment">// otherwise, start from the previous page image.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c">extract_snapshot_id_from_snapshot_pointer</a>(old_page_id) != <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac4636fdc3d56e3e7bdeec76376110844">snapshot_id_</a>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(fileset-&gt;read_page(old_page_id, new_page));</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(new_page-&gt;get_bin_range().begin_ == range_begin);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(new_page-&gt;get_level() == level);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      new_page-&gt;header().page_id_ = new_page_id;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    parent-&gt;get_pointer(index).snapshot_pointer_ = new_page_id;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_ac4636fdc3d56e3e7bdeec76376110844"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac4636fdc3d56e3e7bdeec76376110844">foedus::storage::hash::ComposedBinsMergedStream::snapshot_id_</a></div><div class="ttdeci">snapshot::SnapshotId snapshot_id_</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00214">hash_composed_bins_impl.hpp:214</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_adbaff9aeb65615f7af84b820fd3bf241"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#adbaff9aeb65615f7af84b820fd3bf241">foedus::storage::hash::ComposedBinsMergedStream::assure_writer_buffer</a></div><div class="ttdeci">ErrorCode assure_writer_buffer(snapshot::SnapshotWriter *writer, uint32_t *writer_buffer_pos, uint32_t writer_higher_buffer_pos)</div><div class="ttdoc">Subroutine to flush the writer if needed to make sure it has enough room. </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8cpp_source.html#l00290">hash_composed_bins_impl.cpp:290</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage_html_a134e444d2b945700fe14d0d6d3dd11f0"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0">foedus::storage::hash::HashIntermediatePage::header</a></div><div class="ttdeci">PageHeader &amp; header()</div><div class="ttdef"><b>Definition:</b> <a href="hash__page__impl_8hpp_source.html#l00070">hash_page_impl.hpp:70</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga595ca7fc4a3011a9704a883a25141e5f"><div class="ttname"><a href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">foedus::storage::StorageId</a></div><div class="ttdeci">uint32_t StorageId</div><div class="ttdoc">Unique ID for storage. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00055">storage_id.hpp:55</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PageHeader_html_a4a8c3c363862348530e4ea0be879f694"><div class="ttname"><a href="structfoedus_1_1storage_1_1PageHeader.html#a4a8c3c363862348530e4ea0be879f694">foedus::storage::PageHeader::storage_id_</a></div><div class="ttdeci">StorageId storage_id_</div><div class="ttdoc">ID of the storage this page belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00196">page.hpp:196</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a624c99f582a4eba687bf61431c2a3434"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">foedus::storage::hash::ComposedBinsMergedStream::cur_path_</a></div><div class="ttdeci">PagePtr cur_path_[kHashMaxLevels]</div><div class="ttdoc">The pages we are now composing. </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00219">hash_composed_bins_impl.hpp:219</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga629d4b8103bfb83ef9c11b842a4fd398"><div class="ttname"><a href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">foedus::storage::SnapshotPagePointer</a></div><div class="ttdeci">uint64_t SnapshotPagePointer</div><div class="ttdoc">Page ID of a snapshot page. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00079">storage_id.hpp:79</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a44aee1c88cd9632da951affe0cd029e4"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">foedus::storage::hash::ComposedBinsMergedStream::levels_</a></div><div class="ttdeci">uint8_t levels_</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00215">hash_composed_bins_impl.hpp:215</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_html_a82df0b3921d7c863275baf4f9c59959c"><div class="ttname"><a href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c">foedus::storage::extract_snapshot_id_from_snapshot_pointer</a></div><div class="ttdeci">uint16_t extract_snapshot_id_from_snapshot_pointer(SnapshotPagePointer pointer)</div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00098">storage_id.hpp:98</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage_html_a6b20dce9484c09666d6cf1df866d00d3"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6b20dce9484c09666d6cf1df866d00d3">foedus::storage::hash::HashIntermediatePage::initialize_snapshot_page</a></div><div class="ttdeci">void initialize_snapshot_page(StorageId storage_id, SnapshotPagePointer page_id, uint8_t level, HashBin start_bin)</div><div class="ttdef"><b>Definition:</b> <a href="hash__page__impl_8cpp_source.html#l00058">hash_page_impl.cpp:58</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__HASH_html_gacb9a1ea596bf0db3f6ded1710ab3b3d6"><div class="ttname"><a href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">foedus::storage::hash::HashBin</a></div><div class="ttdeci">uint64_t HashBin</div><div class="ttdoc">Represents a bin of a hash value. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00142">hash_id.hpp:142</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a1f04faaadf8a2eb07c654fbe116c3a11"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a1f04faaadf8a2eb07c654fbe116c3a11">foedus::storage::hash::kInvalidHashBin</a></div><div class="ttdeci">const HashBin kInvalidHashBin</div><div class="ttdoc">This value or larger never appears as a valid HashBin. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00162">hash_id.hpp:162</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a76fd54b958c7e6a74a1b600a79211e9d"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">foedus::storage::hash::ComposedBinsMergedStream::PagePtr</a></div><div class="ttdeci">HashIntermediatePage * PagePtr</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00206">hash_composed_bins_impl.hpp:206</a></div></div>
<div class="ttc" id="group__HASH_html_ga0083e0d73570a990b862bb330f8d5831"><div class="ttname"><a href="group__HASH.html#ga0083e0d73570a990b862bb330f8d5831">foedus::storage::hash::kHashMaxBins</a></div><div class="ttdeci">const uint64_t kHashMaxBins[]</div><div class="ttdoc">kHashTotalBins[n] gives the maximum number of hash bins n-level hash can hold. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00074">hash_id.hpp:74</a></div></div>
<div class="ttc" id="unionfoedus_1_1storage_1_1hash_1_1IntermediateRoute_html_a0212c25f878f45d0936d9df0271fd41b"><div class="ttname"><a href="unionfoedus_1_1storage_1_1hash_1_1IntermediateRoute.html#a0212c25f878f45d0936d9df0271fd41b">foedus::storage::hash::IntermediateRoute::construct</a></div><div class="ttdeci">static IntermediateRoute construct(HashBin bin)</div><div class="ttdoc">Calculates the rout for the given hash bin. </div><div class="ttdef"><b>Definition:</b> <a href="hash__hashinate_8hpp_source.html#l00233">hash_hashinate.hpp:233</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_a230f7dbb47f1b22e7295fe7c00a96fa4_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_a230f7dbb47f1b22e7295fe7c00a96fa4_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_a230f7dbb47f1b22e7295fe7c00a96fa4_cgraph" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_a230f7dbb47f1b22e7295fe7c00a96fa4_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#adbaff9aeb65615f7af84b820fd3bf241" title="Subroutine to flush the writer if needed to make sure it has enough room. " alt="" coords="256,107,459,163"/>
<area shape="rect" id="node8" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#adb899ef232610546cd5a017a817fba45" title="foedus::snapshot::Snapshot\lWriter::get_intermediate_size" alt="" coords="804,139,996,180"/>
<area shape="rect" id="node10" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09" title="foedus::snapshot::Snapshot\lWriter::get_page_size" alt="" coords="534,239,718,280"/>
<area shape="rect" id="node11" href="unionfoedus_1_1storage_1_1hash_1_1IntermediateRoute.html#a0212c25f878f45d0936d9df0271fd41b" title="Calculates the rout for the given hash bin. " alt="" coords="284,297,431,353"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html#af492eb6df181653434b727ba29e5c833" title="foedus::storage::hash\l::HashBinRange::contains" alt="" coords="271,377,444,419"/>
<area shape="rect" id="node14" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="805,550,995,606"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="277,641,438,697"/>
<area shape="rect" id="node16" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a340a320860a56dd850c5f8e02a44278b" title="foedus::snapshot::Snapshot\lWriter::get_intermediate_base" alt="" coords="259,721,455,763"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="277,853,438,909"/>
<area shape="rect" id="node20" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#af9bcb8a605aecbbc3eabdc6664f6b163" title="foedus::snapshot::Snapshot\lWriter::get_next_page_id" alt="" coords="265,933,449,975"/>
<area shape="rect" id="node21" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720" title="foedus::snapshot::Snapshot\lWriter::get_page_base" alt="" coords="265,787,449,828"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="277,999,438,1055"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="277,1079,438,1135"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6b20dce9484c09666d6cf1df866d00d3" title="foedus::storage::hash\l::HashIntermediatePage\l::initialize_snapshot_page" alt="" coords="271,443,443,499"/>
<area shape="rect" id="node33" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html#ae2b145559047e486059fec93c35ebfc1" title="foedus::storage::hash\l::HashBinRange::length" alt="" coords="278,1160,437,1201"/>
<area shape="rect" id="node34" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="264,575,451,616"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a55ba9fc4a87f71b3991bba1c39948cc9" title="Write out pages that are contiguous in the main page pool. " alt="" coords="534,5,718,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ad43c975601c7bced5a548c4872c498e4" title="Expands intermediate_memory_ in case it is too small. " alt="" coords="507,71,745,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad79701492d232cb5aec1ad4d8c99eb5d" title="If the current size is smaller than the given size, automatically expands. " alt="" coords="793,71,1007,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="1055,60,1268,101"/>
<area shape="rect" id="node7" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b" title="Releases the memory block. " alt="" coords="1055,125,1268,167"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="1055,209,1268,251"/>
<area shape="rect" id="node12" href="unionfoedus_1_1storage_1_1hash_1_1IntermediateRoute.html#a5c731b0f50eeabc808b77db3e7be71b7" title="foedus::storage::hash\l::IntermediateRoute::\lconvert_back" alt="" coords="553,305,699,361"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="519,844,733,885"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="531,909,721,951"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1PageHeader.html#a65c4acd213d2f482eb29c6dee0818915" title="foedus::storage::PageHeader\l::init_snapshot" alt="" coords="531,385,721,427"/>
<area shape="rect" id="node32" href="structfoedus_1_1storage_1_1PageHeader.html#a1956943904b68b6472f53b4e9ed6df87" title="foedus::storage::PageHeader\l::set_in_layer_level" alt="" coords="531,451,721,492"/>
<area shape="rect" id="node26" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="806,461,994,517"/>
<area shape="rect" id="node27" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="801,325,999,367"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1PageVersion.html#ae40168c82f16645e85bb66f9019e53cf" title="used only while page initialization " alt="" coords="804,391,996,432"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1PageVersionStatus.html#af49ef4f3320148130f46f494f1c845aa" title="foedus::storage::PageVersion\lStatus::reset" alt="" coords="1065,359,1257,400"/>
<area shape="rect" id="node30" href="structfoedus_1_1xct_1_1McsWwLock.html#a4114c2dec151ad650a294dedac4f239d" title="used only while page initialization " alt="" coords="1077,424,1246,465"/>
<area shape="rect" id="node31" href="structfoedus_1_1xct_1_1McsWwBlockData.html#a3161e47c41388e9c1b50929f585e366b" title="foedus::xct::McsWwBlockData\l::clear" alt="" coords="1316,424,1517,465"/>
<area shape="rect" id="node35" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="526,567,726,623"/>
<area shape="rect" id="node36" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="533,648,719,689"/>
<area shape="rect" id="node37" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="551,779,701,820"/>
<area shape="rect" id="node44" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="551,713,701,755"/>
<area shape="rect" id="node38" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="829,648,971,689"/>
<area shape="rect" id="node39" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="825,844,975,885"/>
<area shape="rect" id="node40" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="830,713,970,755"/>
<area shape="rect" id="node41" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="825,909,975,951"/>
<area shape="rect" id="node42" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="833,779,967,820"/>
<area shape="rect" id="node43" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="1094,779,1229,820"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_a230f7dbb47f1b22e7295fe7c00a96fa4_icgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_a230f7dbb47f1b22e7295fe7c00a96fa4_icgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_a230f7dbb47f1b22e7295fe7c00a96fa4_icgraph" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_a230f7dbb47f1b22e7295fe7c00a96fa4_icgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="256,5,484,47"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="269,71,471,127"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac3a65cebf835d18357a69bd523a3bc9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::ComposedBinsMergedStream::process_a_bin </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>installed_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a> *&#160;</td>
          <td class="paramname"><em>next_lowest_bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Consumes inputs for the cur_path_[0] page and install snapshot pointers there. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">installed_count</td><td>Increments the number of installed pointers </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">next_lowest_bin</td><td>The smallest bin out of all remaining inputs. kInvalidHashBin if all of them are depleted. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00150">150</a> of file <a class="el" href="hash__composed__bins__impl_8cpp_source.html">hash_composed_bins_impl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__id_8hpp_source.html#l00191">foedus::storage::hash::HashBinRange::begin_</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00086">foedus::storage::hash::ComposedBin::bin_</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00219">cur_path_</a>, <a class="el" href="hash__id_8hpp_source.html#l00193">foedus::storage::hash::HashBinRange::end_</a>, <a class="el" href="storage__id_8hpp_source.html#l00098">foedus::storage::extract_snapshot_id_from_snapshot_pointer()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00104">foedus::storage::hash::HashIntermediatePage::get_bin_range()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00190">foedus::storage::hash::ComposedBinsBuffer::get_cur_bin()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00105">foedus::storage::hash::HashIntermediatePage::get_level()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00082">foedus::storage::hash::HashIntermediatePage::get_pointer_address()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00196">foedus::storage::hash::ComposedBinsBuffer::has_more()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00070">foedus::storage::hash::HashIntermediatePage::header()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00213">input_count_</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00211">inputs_</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="hash__id_8hpp_source.html#l00049">foedus::storage::hash::kHashIntermediatePageFanout</a>, <a class="el" href="hash__id_8hpp_source.html#l00162">foedus::storage::hash::kInvalidHashBin</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00268">foedus::storage::hash::ComposedBinsBuffer::next_bin()</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00087">foedus::storage::hash::ComposedBin::page_id_</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00214">snapshot_id_</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                            {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  HashIntermediatePage* <span class="keyword">const</span> page = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[0];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keyword">const</span> HashBinRange&amp; cur_range = page-&gt;get_bin_range();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;get_level() == 0);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;header().snapshot_);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  *next_lowest_bin = <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a1f04faaadf8a2eb07c654fbe116c3a11">kInvalidHashBin</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  uint32_t installed_diff = 0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af14890eca14b624933a31695301cfc54">input_count_</a>; ++i) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    ComposedBinsBuffer* input = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a368530bdff21d82974fe381ff7047894">inputs_</a> + i;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">while</span> (input-&gt;has_more()) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keyword">const</span> ComposedBin&amp; entry = input-&gt;<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a27a70df0aa416ebe9560ab41e19de8fd">get_cur_bin</a>();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur_range.begin_ &lt;= entry.bin_);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(entry.page_id_ != 0);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c">extract_snapshot_id_from_snapshot_pointer</a>(entry.page_id_) == <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac4636fdc3d56e3e7bdeec76376110844">snapshot_id_</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keywordflow">if</span> (entry.bin_ &gt;= cur_range.end_) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">// no more bins for this page from this input</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        *next_lowest_bin = std::min&lt;HashBin&gt;(*next_lowest_bin, entry.bin_);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      uint16_t index = entry.bin_ - cur_range.begin_;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(index &lt; <a class="code" href="group__HASH.html#ga4398665205e13bd71e8b2c1691ba1ba3">kHashIntermediatePageFanout</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      DualPagePointer* target = page-&gt;get_pointer_address(index);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(target-&gt;volatile_pointer_.is_null());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c">extract_snapshot_id_from_snapshot_pointer</a>(target-&gt;snapshot_pointer_)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        != <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac4636fdc3d56e3e7bdeec76376110844">snapshot_id_</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      target-&gt;snapshot_pointer_ = entry.page_id_;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      ++installed_diff;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(input-&gt;next_bin());</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  *installed_count += installed_diff;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_ac4636fdc3d56e3e7bdeec76376110844"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac4636fdc3d56e3e7bdeec76376110844">foedus::storage::hash::ComposedBinsMergedStream::snapshot_id_</a></div><div class="ttdeci">snapshot::SnapshotId snapshot_id_</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00214">hash_composed_bins_impl.hpp:214</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_af14890eca14b624933a31695301cfc54"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af14890eca14b624933a31695301cfc54">foedus::storage::hash::ComposedBinsMergedStream::input_count_</a></div><div class="ttdeci">uint32_t input_count_</div><div class="ttdoc">total number of buffers in inputs_ </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00213">hash_composed_bins_impl.hpp:213</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a624c99f582a4eba687bf61431c2a3434"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">foedus::storage::hash::ComposedBinsMergedStream::cur_path_</a></div><div class="ttdeci">PagePtr cur_path_[kHashMaxLevels]</div><div class="ttdoc">The pages we are now composing. </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00219">hash_composed_bins_impl.hpp:219</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a368530bdff21d82974fe381ff7047894"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a368530bdff21d82974fe381ff7047894">foedus::storage::hash::ComposedBinsMergedStream::inputs_</a></div><div class="ttdeci">ComposedBinsBuffer * inputs_</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00211">hash_composed_bins_impl.hpp:211</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_html_a82df0b3921d7c863275baf4f9c59959c"><div class="ttname"><a href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c">foedus::storage::extract_snapshot_id_from_snapshot_pointer</a></div><div class="ttdeci">uint16_t extract_snapshot_id_from_snapshot_pointer(SnapshotPagePointer pointer)</div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00098">storage_id.hpp:98</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a1f04faaadf8a2eb07c654fbe116c3a11"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a1f04faaadf8a2eb07c654fbe116c3a11">foedus::storage::hash::kInvalidHashBin</a></div><div class="ttdeci">const HashBin kInvalidHashBin</div><div class="ttdoc">This value or larger never appears as a valid HashBin. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00162">hash_id.hpp:162</a></div></div>
<div class="ttc" id="group__HASH_html_ga4398665205e13bd71e8b2c1691ba1ba3"><div class="ttname"><a href="group__HASH.html#ga4398665205e13bd71e8b2c1691ba1ba3">foedus::storage::hash::kHashIntermediatePageFanout</a></div><div class="ttdeci">const uint8_t kHashIntermediatePageFanout</div><div class="ttdoc">Number of pointers in an intermediate page of hash storage. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00049">hash_id.hpp:49</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer_html_a27a70df0aa416ebe9560ab41e19de8fd"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a27a70df0aa416ebe9560ab41e19de8fd">foedus::storage::hash::ComposedBinsBuffer::get_cur_bin</a></div><div class="ttdeci">const ComposedBin &amp; get_cur_bin() const __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00190">hash_composed_bins_impl.hpp:190</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_ac3a65cebf835d18357a69bd523a3bc9d_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_ac3a65cebf835d18357a69bd523a3bc9d_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_ac3a65cebf835d18357a69bd523a3bc9d_cgraph" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_ac3a65cebf835d18357a69bd523a3bc9d_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1187,5,1377,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="256,175,417,231"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a27a70df0aa416ebe9560ab41e19de8fd" title="foedus::storage::hash\l::ComposedBinsBuffer\l::get_cur_bin" alt="" coords="261,255,412,311"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#aece2742172ad6ec69b66046362c2e265" title="foedus::storage::hash\l::ComposedBinsBuffer\l::has_more" alt="" coords="485,316,636,372"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="256,385,417,441"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#aa72388dc98c566a63c723184449a830f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer_address" alt="" coords="256,465,417,521"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="256,545,417,601"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="256,626,417,667"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a87975eab41db6a99b88424bd2d6dbb90" title="Moves on to next bin. " alt="" coords="261,95,412,151"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a1727fc002322da1b15f4e91f914fd35d" title="foedus::storage::hash\l::ComposedBinsBuffer\l::get_cur_page" alt="" coords="485,236,636,292"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="465,397,656,438"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="480,626,641,667"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a5fe3533ff092920e41ddc56ebcd4165c" title="Read pages to buffer_. " alt="" coords="485,124,636,180"/>
<area shape="rect" id="node15" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#aae67209f9aa9d03e45a9934067c8245b" title="Read contiguous pages in one shot. " alt="" coords="704,151,891,193"/>
<area shape="rect" id="node16" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="939,71,1139,127"/>
<area shape="rect" id="node17" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="945,151,1132,193"/>
<area shape="rect" id="node19" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="963,294,1114,335"/>
<area shape="rect" id="node26" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="963,225,1114,266"/>
<area shape="rect" id="node18" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1188,85,1376,141"/>
<area shape="rect" id="node20" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="1211,166,1353,207"/>
<area shape="rect" id="node21" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="1207,362,1357,403"/>
<area shape="rect" id="node22" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1212,231,1352,273"/>
<area shape="rect" id="node23" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="1207,427,1357,469"/>
<area shape="rect" id="node24" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="1215,297,1349,338"/>
<area shape="rect" id="node25" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="1425,297,1560,338"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad9d314f5d6c1a5f698ca623ef7d0188e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::ComposedBinsMergedStream::switch_path </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a>&#160;</td>
          <td class="paramname"><em>lowest_bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *&#160;</td>
          <td class="paramname"><em>fileset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html">snapshot::SnapshotWriter</a> *&#160;</td>
          <td class="paramname"><em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>writer_buffer_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>writer_higher_buffer_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Moves cur_path_ to a page that cotains the specified bin. </p>
<p>It opens higher-level pages if needed. </p>

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00191">191</a> of file <a class="el" href="hash__composed__bins__impl_8cpp_source.html">hash_composed_bins_impl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00219">cur_path_</a>, <a class="el" href="hash__id_8hpp_source.html#l00162">foedus::storage::hash::kInvalidHashBin</a>, <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00215">levels_</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">open_path()</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                      {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(lowest_bin != <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a1f04faaadf8a2eb07c654fbe116c3a11">kInvalidHashBin</a>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// because a path in this sub-tree must be switched, this is at least 3-levels.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">// levels_==1 : single-level hash, separately processed in construct_root</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// levels_==2 : then each sub-tree has only one level-0 page. switch_path is never called.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a> &gt;= 3U);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[0]-&gt;get_bin_range().contains(lowest_bin));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a> - 1U]-&gt;get_bin_range().contains(lowest_bin));  <span class="comment">// root page</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a> - 2U]-&gt;get_bin_range().contains(lowest_bin));  <span class="comment">// root_child page</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// where do we have to switch?</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  uint8_t valid_upto;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">for</span> (valid_upto = 1U; valid_upto + 2U &lt; <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">levels_</a>; ++valid_upto) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[valid_upto]-&gt;get_bin_range().contains(lowest_bin)) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[valid_upto]-&gt;get_bin_range().contains(lowest_bin));</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!<a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">cur_path_</a>[valid_upto - 1U]-&gt;get_bin_range().contains(lowest_bin));</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4">open_path</a>(</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    lowest_bin,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    valid_upto,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    fileset,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    writer,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    writer_buffer_pos,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    writer_higher_buffer_pos);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a624c99f582a4eba687bf61431c2a3434"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a624c99f582a4eba687bf61431c2a3434">foedus::storage::hash::ComposedBinsMergedStream::cur_path_</a></div><div class="ttdeci">PagePtr cur_path_[kHashMaxLevels]</div><div class="ttdoc">The pages we are now composing. </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00219">hash_composed_bins_impl.hpp:219</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a44aee1c88cd9632da951affe0cd029e4"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a44aee1c88cd9632da951affe0cd029e4">foedus::storage::hash::ComposedBinsMergedStream::levels_</a></div><div class="ttdeci">uint8_t levels_</div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8hpp_source.html#l00215">hash_composed_bins_impl.hpp:215</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_html_a230f7dbb47f1b22e7295fe7c00a96fa4"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4">foedus::storage::hash::ComposedBinsMergedStream::open_path</a></div><div class="ttdeci">ErrorCode open_path(HashBin bin, uint8_t fixed_upto_level, cache::SnapshotFileSet *fileset, snapshot::SnapshotWriter *writer, uint32_t *writer_buffer_pos, uint32_t *writer_higher_buffer_pos)</div><div class="ttdoc">Recursively opens pages down from fixed_upto_level. </div><div class="ttdef"><b>Definition:</b> <a href="hash__composed__bins__impl_8cpp_source.html#l00225">hash_composed_bins_impl.cpp:225</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a1f04faaadf8a2eb07c654fbe116c3a11"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a1f04faaadf8a2eb07c654fbe116c3a11">foedus::storage::hash::kInvalidHashBin</a></div><div class="ttdeci">const HashBin kInvalidHashBin</div><div class="ttdoc">This value or larger never appears as a valid HashBin. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00162">hash_id.hpp:162</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_ad9d314f5d6c1a5f698ca623ef7d0188e_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_ad9d314f5d6c1a5f698ca623ef7d0188e_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_ad9d314f5d6c1a5f698ca623ef7d0188e_cgraph" id="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream_ad9d314f5d6c1a5f698ca623ef7d0188e_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="256,605,459,661"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#adbaff9aeb65615f7af84b820fd3bf241" title="Subroutine to flush the writer if needed to make sure it has enough room. " alt="" coords="507,107,709,163"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#adb899ef232610546cd5a017a817fba45" title="foedus::snapshot::Snapshot\lWriter::get_intermediate_size" alt="" coords="1055,139,1247,180"/>
<area shape="rect" id="node11" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09" title="foedus::snapshot::Snapshot\lWriter::get_page_size" alt="" coords="785,239,969,280"/>
<area shape="rect" id="node12" href="unionfoedus_1_1storage_1_1hash_1_1IntermediateRoute.html#a0212c25f878f45d0936d9df0271fd41b" title="Calculates the rout for the given hash bin. " alt="" coords="535,297,681,353"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html#af492eb6df181653434b727ba29e5c833" title="foedus::storage::hash\l::HashBinRange::contains" alt="" coords="521,377,695,419"/>
<area shape="rect" id="node15" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1055,550,1246,606"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="527,641,689,697"/>
<area shape="rect" id="node17" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a340a320860a56dd850c5f8e02a44278b" title="foedus::snapshot::Snapshot\lWriter::get_intermediate_base" alt="" coords="510,721,706,763"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="527,853,689,909"/>
<area shape="rect" id="node21" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#af9bcb8a605aecbbc3eabdc6664f6b163" title="foedus::snapshot::Snapshot\lWriter::get_next_page_id" alt="" coords="516,933,700,975"/>
<area shape="rect" id="node22" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720" title="foedus::snapshot::Snapshot\lWriter::get_page_base" alt="" coords="516,787,700,828"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="527,999,689,1055"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="527,1079,689,1135"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6b20dce9484c09666d6cf1df866d00d3" title="foedus::storage::hash\l::HashIntermediatePage\l::initialize_snapshot_page" alt="" coords="522,443,694,499"/>
<area shape="rect" id="node34" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html#ae2b145559047e486059fec93c35ebfc1" title="foedus::storage::hash\l::HashBinRange::length" alt="" coords="529,1160,687,1201"/>
<area shape="rect" id="node35" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="515,575,701,616"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a55ba9fc4a87f71b3991bba1c39948cc9" title="Write out pages that are contiguous in the main page pool. " alt="" coords="785,5,969,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ad43c975601c7bced5a548c4872c498e4" title="Expands intermediate_memory_ in case it is too small. " alt="" coords="757,71,996,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad79701492d232cb5aec1ad4d8c99eb5d" title="If the current size is smaller than the given size, automatically expands. " alt="" coords="1044,71,1257,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="1305,60,1519,101"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1AlignedMemory.html#afd955f5f991e28943c72ecff1167c16b" title="Releases the memory block. " alt="" coords="1305,125,1519,167"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="1305,209,1519,251"/>
<area shape="rect" id="node13" href="unionfoedus_1_1storage_1_1hash_1_1IntermediateRoute.html#a5c731b0f50eeabc808b77db3e7be71b7" title="foedus::storage::hash\l::IntermediateRoute::\lconvert_back" alt="" coords="803,305,950,361"/>
<area shape="rect" id="node18" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="770,844,983,885"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="781,909,972,951"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1PageHeader.html#a65c4acd213d2f482eb29c6dee0818915" title="foedus::storage::PageHeader\l::init_snapshot" alt="" coords="781,385,972,427"/>
<area shape="rect" id="node33" href="structfoedus_1_1storage_1_1PageHeader.html#a1956943904b68b6472f53b4e9ed6df87" title="foedus::storage::PageHeader\l::set_in_layer_level" alt="" coords="781,451,972,492"/>
<area shape="rect" id="node27" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1057,461,1245,517"/>
<area shape="rect" id="node28" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="1051,325,1250,367"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1PageVersion.html#ae40168c82f16645e85bb66f9019e53cf" title="used only while page initialization " alt="" coords="1055,391,1247,432"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1PageVersionStatus.html#af49ef4f3320148130f46f494f1c845aa" title="foedus::storage::PageVersion\lStatus::reset" alt="" coords="1316,359,1508,400"/>
<area shape="rect" id="node31" href="structfoedus_1_1xct_1_1McsWwLock.html#a4114c2dec151ad650a294dedac4f239d" title="used only while page initialization " alt="" coords="1327,424,1497,465"/>
<area shape="rect" id="node32" href="structfoedus_1_1xct_1_1McsWwBlockData.html#a3161e47c41388e9c1b50929f585e366b" title="foedus::xct::McsWwBlockData\l::clear" alt="" coords="1567,424,1768,465"/>
<area shape="rect" id="node36" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="777,567,977,623"/>
<area shape="rect" id="node37" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="783,648,970,689"/>
<area shape="rect" id="node38" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="801,779,952,820"/>
<area shape="rect" id="node45" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="801,713,952,755"/>
<area shape="rect" id="node39" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="1079,648,1222,689"/>
<area shape="rect" id="node40" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="1075,844,1226,885"/>
<area shape="rect" id="node41" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1081,713,1221,755"/>
<area shape="rect" id="node42" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="1075,909,1226,951"/>
<area shape="rect" id="node43" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="1083,779,1218,820"/>
<area shape="rect" id="node44" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="1345,779,1479,820"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a624c99f582a4eba687bf61431c2a3434"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a76fd54b958c7e6a74a1b600a79211e9d">PagePtr</a> foedus::storage::hash::ComposedBinsMergedStream::cur_path_[<a class="el" href="group__HASH.html#gacb6faca61be6849c9cdb02447cb3edbe">kHashMaxLevels</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The pages we are now composing. </p>
<p>cur_path_[n] is the level-n intermediate page. </p>

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00219">219</a> of file <a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00087">init()</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">open_path()</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00150">process_a_bin()</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00191">switch_path()</a>.</p>

</div>
</div>
<a class="anchor" id="af14890eca14b624933a31695301cfc54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::storage::hash::ComposedBinsMergedStream::input_count_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>total number of buffers in inputs_ </p>

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00213">213</a> of file <a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00087">init()</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00150">process_a_bin()</a>.</p>

</div>
</div>
<a class="anchor" id="a368530bdff21d82974fe381ff7047894"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html">ComposedBinsBuffer</a>* foedus::storage::hash::ComposedBinsMergedStream::inputs_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00211">211</a> of file <a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00087">init()</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00150">process_a_bin()</a>.</p>

</div>
</div>
<a class="anchor" id="a50e596103c2e1b8bb4172dbbd013d87f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html">ComposedBinsBuffer</a>[] &gt; foedus::storage::hash::ComposedBinsMergedStream::inputs_memory_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>just for auto release </p>

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00209">209</a> of file <a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00087">init()</a>.</p>

</div>
</div>
<a class="anchor" id="a44aee1c88cd9632da951affe0cd029e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t foedus::storage::hash::ComposedBinsMergedStream::levels_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00215">215</a> of file <a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00290">assure_writer_buffer()</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00087">init()</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">open_path()</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00191">switch_path()</a>.</p>

</div>
</div>
<a class="anchor" id="aa73307558c0f8b10b72196c1fc6394f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t foedus::storage::hash::ComposedBinsMergedStream::padding_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00216">216</a> of file <a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac4636fdc3d56e3e7bdeec76376110844"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__SNAPSHOT.html#gaec32eb05303ebec1048d120f73295031">snapshot::SnapshotId</a> foedus::storage::hash::ComposedBinsMergedStream::snapshot_id_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__composed__bins__impl_8hpp_source.html#l00214">214</a> of file <a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a>.</p>

<p>Referenced by <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00087">init()</a>, <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00225">open_path()</a>, and <a class="el" href="hash__composed__bins__impl_8cpp_source.html#l00150">process_a_bin()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/storage/hash/<a class="el" href="hash__composed__bins__impl_8hpp_source.html">hash_composed_bins_impl.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/hash/<a class="el" href="hash__composed__bins__impl_8cpp_source.html">hash_composed_bins_impl.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1storage.html">storage</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1storage_1_1hash.html">hash</a></li><li class="navelem"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html">ComposedBinsMergedStream</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

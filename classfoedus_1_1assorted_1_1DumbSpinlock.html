<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::assorted::DumbSpinlock Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1assorted_1_1DumbSpinlock.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classfoedus_1_1assorted_1_1DumbSpinlock-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::assorted::DumbSpinlock Class Reference<div class="ingroups"><a class="el" href="group__IDIOMS.html">FOEDUS Programming Idioms</a> &raquo; <a class="el" href="group__ASSORTED.html">Assorted Methods/Classes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A simple spinlock using a boolean field.  
 <a href="classfoedus_1_1assorted_1_1DumbSpinlock.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A simple spinlock using a boolean field. </p>
<p>As the name suggests, this spinlock implementation is not scalable at all. It's the dumbest implementation of lock, which might cause cacheline invalidation storm when contended. However, in many places it's enough and also the simplicity helps. You just need memory for one bool, that's it. It trivially works for a shared memory, too.</p>
<p>Use this object where you don't expect much contention. </p>

<p>Definition at line <a class="el" href="dumb__spinlock_8hpp_source.html#l00040">40</a> of file <a class="el" href="dumb__spinlock_8hpp_source.html">dumb_spinlock.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="dumb__spinlock_8hpp_source.html">dumb_spinlock.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abd8578381e04d1a4a8cc2fc2337d78bb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#abd8578381e04d1a4a8cc2fc2337d78bb">DumbSpinlock</a> (bool *locked, bool lock_initially=true)</td></tr>
<tr class="separator:abd8578381e04d1a4a8cc2fc2337d78bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c68a0f047a5dc33330e21a1f8e1d9ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a1c68a0f047a5dc33330e21a1f8e1d9ef">~DumbSpinlock</a> ()</td></tr>
<tr class="memdesc:a1c68a0f047a5dc33330e21a1f8e1d9ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">automatically unlocks when out of scope.  <a href="#a1c68a0f047a5dc33330e21a1f8e1d9ef">More...</a><br /></td></tr>
<tr class="separator:a1c68a0f047a5dc33330e21a1f8e1d9ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a212b63b43466650d38a5ea368bf76320"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a212b63b43466650d38a5ea368bf76320">is_locked_by_me</a> () const </td></tr>
<tr class="separator:a212b63b43466650d38a5ea368bf76320"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e9ca033e2f4270494df3d126229e58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a31e9ca033e2f4270494df3d126229e58">lock</a> ()</td></tr>
<tr class="memdesc:a31e9ca033e2f4270494df3d126229e58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locks it if I haven't locked it yet.  <a href="#a31e9ca033e2f4270494df3d126229e58">More...</a><br /></td></tr>
<tr class="separator:a31e9ca033e2f4270494df3d126229e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46ac1cc2643a47526246ff23033a945e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a46ac1cc2643a47526246ff23033a945e">try_lock</a> ()</td></tr>
<tr class="memdesc:a46ac1cc2643a47526246ff23033a945e"><td class="mdescLeft">&#160;</td><td class="mdescRight">try-version of the lock.  <a href="#a46ac1cc2643a47526246ff23033a945e">More...</a><br /></td></tr>
<tr class="separator:a46ac1cc2643a47526246ff23033a945e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0851db74c3d11d83b2e8c82dc01471f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a0851db74c3d11d83b2e8c82dc01471f2">unlock</a> ()</td></tr>
<tr class="memdesc:a0851db74c3d11d83b2e8c82dc01471f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlocks it if I locked it.  <a href="#a0851db74c3d11d83b2e8c82dc01471f2">More...</a><br /></td></tr>
<tr class="separator:a0851db74c3d11d83b2e8c82dc01471f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="abd8578381e04d1a4a8cc2fc2337d78bb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::assorted::DumbSpinlock::DumbSpinlock </td>
          <td>(</td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>locked</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>lock_initially</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="dumb__spinlock_8hpp_source.html#l00042">42</a> of file <a class="el" href="dumb__spinlock_8hpp_source.html">dumb_spinlock.hpp</a>.</p>

<p>References <a class="el" href="dumb__spinlock_8hpp_source.html#l00053">lock()</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                                         : locked_by_me_(<span class="keyword">false</span>), locked_(locked) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (lock_initially) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <a class="code" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a31e9ca033e2f4270494df3d126229e58">lock</a>();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1assorted_1_1DumbSpinlock_html_a31e9ca033e2f4270494df3d126229e58"><div class="ttname"><a href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a31e9ca033e2f4270494df3d126229e58">foedus::assorted::DumbSpinlock::lock</a></div><div class="ttdeci">void lock()</div><div class="ttdoc">Locks it if I haven&#39;t locked it yet. </div><div class="ttdef"><b>Definition:</b> <a href="dumb__spinlock_8hpp_source.html#l00053">dumb_spinlock.hpp:53</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1assorted_1_1DumbSpinlock_abd8578381e04d1a4a8cc2fc2337d78bb_cgraph.png" border="0" usemap="#classfoedus_1_1assorted_1_1DumbSpinlock_abd8578381e04d1a4a8cc2fc2337d78bb_cgraph" alt=""/></div>
<map name="classfoedus_1_1assorted_1_1DumbSpinlock_abd8578381e04d1a4a8cc2fc2337d78bb_cgraph" id="classfoedus_1_1assorted_1_1DumbSpinlock_abd8578381e04d1a4a8cc2fc2337d78bb_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a31e9ca033e2f4270494df3d126229e58" title="Locks it if I haven&#39;t locked it yet. " alt="" coords="264,5,475,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a46ac1cc2643a47526246ff23033a945e" title="try&#45;version of the lock. " alt="" coords="523,5,733,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1c68a0f047a5dc33330e21a1f8e1d9ef"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::assorted::DumbSpinlock::~DumbSpinlock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>automatically unlocks when out of scope. </p>

<p>Definition at line <a class="el" href="dumb__spinlock_8hpp_source.html#l00048">48</a> of file <a class="el" href="dumb__spinlock_8hpp_source.html">dumb_spinlock.hpp</a>.</p>

<p>References <a class="el" href="dumb__spinlock_8hpp_source.html#l00078">unlock()</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{ <a class="code" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a0851db74c3d11d83b2e8c82dc01471f2">unlock</a>(); }</div>
<div class="ttc" id="classfoedus_1_1assorted_1_1DumbSpinlock_html_a0851db74c3d11d83b2e8c82dc01471f2"><div class="ttname"><a href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a0851db74c3d11d83b2e8c82dc01471f2">foedus::assorted::DumbSpinlock::unlock</a></div><div class="ttdeci">void unlock()</div><div class="ttdoc">Unlocks it if I locked it. </div><div class="ttdef"><b>Definition:</b> <a href="dumb__spinlock_8hpp_source.html#l00078">dumb_spinlock.hpp:78</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1assorted_1_1DumbSpinlock_a1c68a0f047a5dc33330e21a1f8e1d9ef_cgraph.png" border="0" usemap="#classfoedus_1_1assorted_1_1DumbSpinlock_a1c68a0f047a5dc33330e21a1f8e1d9ef_cgraph" alt=""/></div>
<map name="classfoedus_1_1assorted_1_1DumbSpinlock_a1c68a0f047a5dc33330e21a1f8e1d9ef_cgraph" id="classfoedus_1_1assorted_1_1DumbSpinlock_a1c68a0f047a5dc33330e21a1f8e1d9ef_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a0851db74c3d11d83b2e8c82dc01471f2" title="Unlocks it if I locked it. " alt="" coords="264,5,475,47"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf" title="Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). " alt="" coords="523,5,696,47"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a212b63b43466650d38a5ea368bf76320"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::assorted::DumbSpinlock::is_locked_by_me </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="dumb__spinlock_8hpp_source.html#l00050">50</a> of file <a class="el" href="dumb__spinlock_8hpp_source.html">dumb_spinlock.hpp</a>.</p>

<p>Referenced by <a class="el" href="masstree__grow__impl_8cpp_source.html#l00119">foedus::storage::masstree::GrowFirstLayerRoot::run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{ <span class="keywordflow">return</span> locked_by_me_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1assorted_1_1DumbSpinlock_a212b63b43466650d38a5ea368bf76320_icgraph.png" border="0" usemap="#classfoedus_1_1assorted_1_1DumbSpinlock_a212b63b43466650d38a5ea368bf76320_icgraph" alt=""/></div>
<map name="classfoedus_1_1assorted_1_1DumbSpinlock_a212b63b43466650d38a5ea368bf76320_icgraph" id="classfoedus_1_1assorted_1_1DumbSpinlock_a212b63b43466650d38a5ea368bf76320_icgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1masstree_1_1GrowFirstLayerRoot.html#a2c3c6cc4a2d74c498cee8f9051d09909" title="Execute the system transaction. " alt="" coords="264,5,437,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a31e9ca033e2f4270494df3d126229e58"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::assorted::DumbSpinlock::lock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Locks it if I haven't locked it yet. </p>
<p>This method is idempotent. </p>

<p>Definition at line <a class="el" href="dumb__spinlock_8hpp_source.html#l00053">53</a> of file <a class="el" href="dumb__spinlock_8hpp_source.html">dumb_spinlock.hpp</a>.</p>

<p>References <a class="el" href="assorted__func_8hpp_source.html#l00256">SPINLOCK_WHILE</a>, and <a class="el" href="dumb__spinlock_8hpp_source.html#l00061">try_lock()</a>.</p>

<p>Referenced by <a class="el" href="dumb__spinlock_8hpp_source.html#l00042">DumbSpinlock()</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;              {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="group__ASSORTED.html#gae932f87b60cbd230347151ccf33eed86">SPINLOCK_WHILE</a>(<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a46ac1cc2643a47526246ff23033a945e">try_lock</a>()) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1assorted_1_1DumbSpinlock_html_a46ac1cc2643a47526246ff23033a945e"><div class="ttname"><a href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a46ac1cc2643a47526246ff23033a945e">foedus::assorted::DumbSpinlock::try_lock</a></div><div class="ttdeci">bool try_lock()</div><div class="ttdoc">try-version of the lock. </div><div class="ttdef"><b>Definition:</b> <a href="dumb__spinlock_8hpp_source.html#l00061">dumb_spinlock.hpp:61</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gae932f87b60cbd230347151ccf33eed86"><div class="ttname"><a href="group__ASSORTED.html#gae932f87b60cbd230347151ccf33eed86">SPINLOCK_WHILE</a></div><div class="ttdeci">#define SPINLOCK_WHILE(x)</div><div class="ttdoc">A macro to busy-wait (spinlock) with occasional pause. </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8hpp_source.html#l00256">assorted_func.hpp:256</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1assorted_1_1DumbSpinlock_a31e9ca033e2f4270494df3d126229e58_cgraph.png" border="0" usemap="#classfoedus_1_1assorted_1_1DumbSpinlock_a31e9ca033e2f4270494df3d126229e58_cgraph" alt=""/></div>
<map name="classfoedus_1_1assorted_1_1DumbSpinlock_a31e9ca033e2f4270494df3d126229e58_cgraph" id="classfoedus_1_1assorted_1_1DumbSpinlock_a31e9ca033e2f4270494df3d126229e58_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a46ac1cc2643a47526246ff23033a945e" title="try&#45;version of the lock. " alt="" coords="264,5,475,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1assorted_1_1DumbSpinlock_a31e9ca033e2f4270494df3d126229e58_icgraph.png" border="0" usemap="#classfoedus_1_1assorted_1_1DumbSpinlock_a31e9ca033e2f4270494df3d126229e58_icgraph" alt=""/></div>
<map name="classfoedus_1_1assorted_1_1DumbSpinlock_a31e9ca033e2f4270494df3d126229e58_icgraph" id="classfoedus_1_1assorted_1_1DumbSpinlock_a31e9ca033e2f4270494df3d126229e58_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#abd8578381e04d1a4a8cc2fc2337d78bb" title="foedus::assorted::DumbSpinlock\l::DumbSpinlock" alt="" coords="264,5,475,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a46ac1cc2643a47526246ff23033a945e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::assorted::DumbSpinlock::try_lock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>try-version of the lock. </p>

<p>Definition at line <a class="el" href="dumb__spinlock_8hpp_source.html#l00061">61</a> of file <a class="el" href="dumb__spinlock_8hpp_source.html">dumb_spinlock.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>.</p>

<p>Referenced by <a class="el" href="dumb__spinlock_8hpp_source.html#l00053">lock()</a>, and <a class="el" href="masstree__grow__impl_8cpp_source.html#l00119">foedus::storage::masstree::GrowFirstLayerRoot::run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                  {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (locked_by_me_) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;  <span class="comment">// already locked</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">bool</span> expected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (raw_atomic_compare_exchange_weak&lt;bool&gt;(locked_, &amp;expected, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(*locked_);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      locked_by_me_ = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(expected);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1assorted_1_1DumbSpinlock_a46ac1cc2643a47526246ff23033a945e_icgraph.png" border="0" usemap="#classfoedus_1_1assorted_1_1DumbSpinlock_a46ac1cc2643a47526246ff23033a945e_icgraph" alt=""/></div>
<map name="classfoedus_1_1assorted_1_1DumbSpinlock_a46ac1cc2643a47526246ff23033a945e_icgraph" id="classfoedus_1_1assorted_1_1DumbSpinlock_a46ac1cc2643a47526246ff23033a945e_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a31e9ca033e2f4270494df3d126229e58" title="Locks it if I haven&#39;t locked it yet. " alt="" coords="264,5,475,47"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1masstree_1_1GrowFirstLayerRoot.html#a2c3c6cc4a2d74c498cee8f9051d09909" title="Execute the system transaction. " alt="" coords="283,71,456,112"/>
<area shape="rect" id="node3" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#abd8578381e04d1a4a8cc2fc2337d78bb" title="foedus::assorted::DumbSpinlock\l::DumbSpinlock" alt="" coords="523,5,733,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0851db74c3d11d83b2e8c82dc01471f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::assorted::DumbSpinlock::unlock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unlocks it if I locked it. </p>
<p>This method is idempotent. You can safely call many times. </p>

<p>Definition at line <a class="el" href="dumb__spinlock_8hpp_source.html#l00078">78</a> of file <a class="el" href="dumb__spinlock_8hpp_source.html">dumb_spinlock.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, and <a class="el" href="atomic__fences_8hpp_source.html#l00069">foedus::assorted::memory_fence_acq_rel()</a>.</p>

<p>Referenced by <a class="el" href="dumb__spinlock_8hpp_source.html#l00048">~DumbSpinlock()</a>.</p>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (locked_by_me_) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(*locked_);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      locked_by_me_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf">assorted::memory_fence_acq_rel</a>();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      *locked_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <a class="code" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf">assorted::memory_fence_acq_rel</a>();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaff9fa4aedd631410da28740f6e1dddbf"><div class="ttname"><a href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf">foedus::assorted::memory_fence_acq_rel</a></div><div class="ttdeci">void memory_fence_acq_rel()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00069">atomic_fences.hpp:69</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1assorted_1_1DumbSpinlock_a0851db74c3d11d83b2e8c82dc01471f2_cgraph.png" border="0" usemap="#classfoedus_1_1assorted_1_1DumbSpinlock_a0851db74c3d11d83b2e8c82dc01471f2_cgraph" alt=""/></div>
<map name="classfoedus_1_1assorted_1_1DumbSpinlock_a0851db74c3d11d83b2e8c82dc01471f2_cgraph" id="classfoedus_1_1assorted_1_1DumbSpinlock_a0851db74c3d11d83b2e8c82dc01471f2_cgraph">
<area shape="rect" id="node2" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf" title="Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). " alt="" coords="264,5,437,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1assorted_1_1DumbSpinlock_a0851db74c3d11d83b2e8c82dc01471f2_icgraph.png" border="0" usemap="#classfoedus_1_1assorted_1_1DumbSpinlock_a0851db74c3d11d83b2e8c82dc01471f2_icgraph" alt=""/></div>
<map name="classfoedus_1_1assorted_1_1DumbSpinlock_a0851db74c3d11d83b2e8c82dc01471f2_icgraph" id="classfoedus_1_1assorted_1_1DumbSpinlock_a0851db74c3d11d83b2e8c82dc01471f2_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1assorted_1_1DumbSpinlock.html#a1c68a0f047a5dc33330e21a1f8e1d9ef" title="automatically unlocks when out of scope. " alt="" coords="264,5,475,47"/>
</map>
</div>
</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/assorted/<a class="el" href="dumb__spinlock_8hpp_source.html">dumb_spinlock.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1assorted.html">assorted</a></li><li class="navelem"><a class="el" href="classfoedus_1_1assorted_1_1DumbSpinlock.html">DumbSpinlock</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

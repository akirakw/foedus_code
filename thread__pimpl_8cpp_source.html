<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: /home/shino/foedus_code/foedus-core/src/foedus/thread/thread_pimpl.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('thread__pimpl_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">thread_pimpl.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="thread__pimpl_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2014-2015, Hewlett-Packard Development Company, LP.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify it</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * under the terms of the GNU General Public License as published by the Free</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Software Foundation; either version 2 of the License, or (at your option)</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * any later version.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * more details. You should have received a copy of the GNU General Public</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * License along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * HP designates this particular file as subject to the &quot;Classpath&quot; exception</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * as provided by HP in the LICENSE.txt file that accompanied this code.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__pimpl_8hpp.html">foedus/thread/thread_pimpl.hpp</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;pthread.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;sched.h&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;glog/logging.h&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;atomic&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;future&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;mutex&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;thread&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="assert__nd_8hpp.html">foedus/assert_nd.hpp</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="engine_8hpp.html">foedus/engine.hpp</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="engine__options_8hpp.html">foedus/engine_options.hpp</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="error__stack__batch_8hpp.html">foedus/error_stack_batch.hpp</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="atomic__fences_8hpp.html">foedus/assorted/atomic_fences.hpp</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cache__hashtable_8hpp.html">foedus/cache/cache_hashtable.hpp</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__log__buffer_8hpp.html">foedus/log/thread_log_buffer.hpp</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="engine__memory_8hpp.html">foedus/memory/engine_memory.hpp</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="numa__core__memory_8hpp.html">foedus/memory/numa_core_memory.hpp</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="numa__node__memory_8hpp.html">foedus/memory/numa_node_memory.hpp</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="proc__id_8hpp.html">foedus/proc/proc_id.hpp</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="proc__manager_8hpp.html">foedus/proc/proc_manager.hpp</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="shared__memory__repo_8hpp.html">foedus/soc/shared_memory_repo.hpp</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="soc__manager_8hpp.html">foedus/soc/soc_manager.hpp</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="numa__thread__scope_8hpp.html">foedus/thread/numa_thread_scope.hpp</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread_8hpp.html">foedus/thread/thread.hpp</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__pool_8hpp.html">foedus/thread/thread_pool.hpp</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__pool__pimpl_8hpp.html">foedus/thread/thread_pool_pimpl.hpp</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sysxct__functor_8hpp.html">foedus/xct/sysxct_functor.hpp</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sysxct__impl_8hpp.html">foedus/xct/sysxct_impl.hpp</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xct__id_8hpp.html">foedus/xct/xct_id.hpp</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xct__manager_8hpp.html">foedus/xct/xct_manager.hpp</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xct__mcs__impl_8hpp.html">foedus/xct/xct_mcs_impl.hpp</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacefoedus.html">foedus</a> {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">namespace </span>thread {</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ace37a6e62cdde3cef1009c59b4dd44c3">   55</a></span>&#160;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a92f7bb785b2f0acc72deaab9f186453c">ThreadPimpl::ThreadPimpl</a>(</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="classfoedus_1_1Engine.html">Engine</a>* engine,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1Thread.html">Thread</a>* holder,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="group__THREAD.html#ga709a79fc1ed05a3543d8309ba391da93">ThreadId</a> <span class="keywordtype">id</span>,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="group__THREAD.html#gad998a8a9811ac9f9bd7c88bea3ce1d9b">ThreadGlobalOrdinal</a> global_ordinal)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  : engine_(engine),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    holder_(holder),</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    id_(id),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    numa_node_(<a class="code" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa">decompose_numa_node</a>(id)),</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    global_ordinal_(global_ordinal),</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    core_memory_(nullptr),</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    node_memory_(nullptr),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    snapshot_cache_hashtable_(nullptr),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    snapshot_page_pool_(nullptr),</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    log_buffer_(engine, id),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    current_xct_(engine, holder, id),</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    snapshot_file_set_(engine),</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    control_block_(nullptr),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    task_input_memory_(nullptr),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    task_output_memory_(nullptr),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    mcs_ww_blocks_(nullptr),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    mcs_rw_simple_blocks_(nullptr),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    mcs_rw_extended_blocks_(nullptr),</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    canonical_address_(nullptr) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a741208e803d0a0bb5f979ebb099d2a8d">   81</a></span>&#160;<a class="code" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a741208e803d0a0bb5f979ebb099d2a8d">ThreadPimpl::initialize_once</a>() {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e">is_initialized</a>());</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html">soc::ThreadMemoryAnchors</a>* anchors</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e">get_soc_manager</a>()-&gt;<a class="code" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c">get_shared_memory_repo</a>()-&gt;<a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ae22e59b0c58a7f6fa519e2c4149afd9c">get_thread_memory_anchors</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a> = anchors-&gt;thread_memory_;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a261b434597087690ad1f65e407a3a221">initialize</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a8b5ec40798ea07cf3dbb4def4c6ad142">task_input_memory_</a> = anchors-&gt;task_input_memory_;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa2dced4e9409f69e3d5327c653807362">task_output_memory_</a> = anchors-&gt;task_output_memory_;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a7964fa7de54357a65cab8f05c1de4696">mcs_ww_blocks_</a> = anchors-&gt;mcs_ww_lock_memories_;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dd7f177602e25a5cd1318723825c861">mcs_rw_simple_blocks_</a> = anchors-&gt;mcs_rw_simple_lock_memories_;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0f8e120dfd26566418bbb9057f8c5b20">mcs_rw_extended_blocks_</a> = anchors-&gt;mcs_rw_extended_lock_memories_;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a052ae65bb017f9f77741db58bcbcf936">mcs_rw_async_mappings_</a> = anchors-&gt;mcs_rw_async_mappings_memories_;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keyword">auto</span> mcs_type = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a1fb740dca84aaaed101bf9f4818c5b4f">xct_</a>.<a class="code" href="structfoedus_1_1xct_1_1XctOptions.html#ad96ba092ce5e33bca1625f40850ead73">mcs_implementation_type_</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(mcs_type == <a class="code" href="structfoedus_1_1xct_1_1XctOptions.html#a1e874be55edde5eec583d9745a90000ea7eec21376c24502222d35f7db5484068">xct::XctOptions::kMcsImplementationTypeSimple</a></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    || mcs_type == <a class="code" href="structfoedus_1_1xct_1_1XctOptions.html#a1e874be55edde5eec583d9745a90000ea10c91c38fa2a5246c11348523f892d7e">xct::XctOptions::kMcsImplementationTypeExtended</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a684b8acdccad684b32c4ea97be009f8e">simple_mcs_rw_</a> = mcs_type == <a class="code" href="structfoedus_1_1xct_1_1XctOptions.html#a1e874be55edde5eec583d9745a90000ea7eec21376c24502222d35f7db5484068">xct::XctOptions::kMcsImplementationTypeSimple</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1e93a62b0a6414f6e30c17969af2340">node_memory_</a> = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a0c5065125240df0f59f2cd04ff5f8808">get_local_memory</a>();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a> = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1e93a62b0a6414f6e30c17969af2340">node_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a58cd4f9c594cdcfd85fb3c3e9d47a983">get_core_memory</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a6e51937e58975e50d0f3eea198b24d3e">cache_</a>.<a class="code" href="structfoedus_1_1cache_1_1CacheOptions.html#a896cdc7cbe05ed0d5f77b863228a7c3a">snapshot_cache_enabled_</a>) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6236b974981b361bfbc25db38c7f9626">snapshot_cache_hashtable_</a> = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1e93a62b0a6414f6e30c17969af2340">node_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaNodeMemory.html#ad8fddde9484a0ceb8d31cd8eca323c77">get_snapshot_cache_table</a>();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6236b974981b361bfbc25db38c7f9626">snapshot_cache_hashtable_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1c0d1b2cce940cc22285a906b1076bd3">snapshot_page_pool_</a> = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1e93a62b0a6414f6e30c17969af2340">node_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a0541f9ed9fc128fc2c246a4a3bd2b740">get_snapshot_pool</a>();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#a9dd027b4a8d21f45a60f82d110c5a529">initialize</a>(</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a>,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    &amp;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a174d00be0d6482995665c5731da35d79">mcs_block_current_</a>,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    &amp;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a39fd5c3a2e0e0175a52ae24c3339e0c8">mcs_rw_async_mapping_current_</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a30fc7377de865406c4174bcd7be6b616">snapshot_file_set_</a>.<a class="code" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff">initialize</a>());</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad101b64b189a656c13f92b7fb7bb62d7">log_buffer_</a>.<a class="code" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff">initialize</a>());</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a44232f657701896a24ec4a238d0ab226">global_volatile_page_resolver_</a></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">get_global_volatile_page_resolver</a>();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0b56e96991f936feba47c29f61c0fbcb">local_volatile_page_resolver_</a> = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1e93a62b0a6414f6e30c17969af2340">node_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a630ab6d899053a9afc067e34877edd48">get_volatile_pool</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e">get_resolver</a>();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad8236666d8fca6674334d0d166218e5c">raw_thread_set_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a12c3db0e7d4015e8eaddbae71c90ab7e">raw_thread_</a> = std::move(std::thread(&amp;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a73a9dfcab4771b1a5c6362406b27faeb">ThreadPimpl::handle_tasks</a>, <span class="keyword">this</span>));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad8236666d8fca6674334d0d166218e5c">raw_thread_set_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aba7104a56eaff1c1f8c87f5bb03f4045">  122</a></span>&#160;<a class="code" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aba7104a56eaff1c1f8c87f5bb03f4045">ThreadPimpl::uninitialize_once</a>() {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="classfoedus_1_1ErrorStackBatch.html">ErrorStackBatch</a> batch;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a21f70ae9d374cc919ab50bb410172415">status_</a> = <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a949e36ce3a330b30392c68f53455ab4d">kWaitingForTerminate</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a0949244710729002906aae535581fa30">wakeup_cond_</a>.<a class="code" href="classfoedus_1_1soc_1_1SharedPolling.html#ae523f3b3bda39c0c81bfb5cb0d5ad626">signal</a>();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; requested to terminate&quot;</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a12c3db0e7d4015e8eaddbae71c90ab7e">raw_thread_</a>.joinable()) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a12c3db0e7d4015e8eaddbae71c90ab7e">raw_thread_</a>.join();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a21f70ae9d374cc919ab50bb410172415">status_</a> = <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12af713804e6a22002bd137b04e90560ca3">kTerminated</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// release retired volatile pages. we do this in thread module rather than in memory module</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// because this has to happen before NumaNodeMemory of any node is uninitialized.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">for</span> (uint16_t node = 0; node &lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#af0ac9dbae9481b295a8492c6d9f6c1d5">get_soc_count</a>(); ++node) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html">memory::PagePoolOffsetAndEpochChunk</a>* chunk</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad0624fe34e52c0904ee449c97f0325c5">get_retired_volatile_pool_chunk</a>(node);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="classfoedus_1_1memory_1_1PagePool.html">memory::PagePool</a>* volatile_pool</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8">get_node_memory</a>(node)-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774">get_volatile_pool</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordflow">if</span> (!chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#af96624c49b6035bc5b9254c111c0d07d">empty</a>()) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        volatile_pool-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#a802171ff0578875748d20b4e9c8c9463">release</a>(chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#ad99e5b875980b442bf5de61fb022f0ac">size</a>(), chunk);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#af96624c49b6035bc5b9254c111c0d07d">empty</a>());</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  batch.<a class="code" href="classfoedus_1_1ErrorStackBatch.html#a1fe18afaafed459feb5c644ba9d7c56e">emprace_back</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a30fc7377de865406c4174bcd7be6b616">snapshot_file_set_</a>.<a class="code" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb">uninitialize</a>());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  batch.<a class="code" href="classfoedus_1_1ErrorStackBatch.html#a1fe18afaafed459feb5c644ba9d7c56e">emprace_back</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad101b64b189a656c13f92b7fb7bb62d7">log_buffer_</a>.<a class="code" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb">uninitialize</a>());</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1e93a62b0a6414f6e30c17969af2340">node_memory_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6236b974981b361bfbc25db38c7f9626">snapshot_cache_hashtable_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#ac5fa11df3b3c0d7815a36e60edb9b93e">uninitialize</a>();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga67390b22b0afbe5a4938df9847eafda9">SUMMARIZE_ERROR_BATCH</a>(batch);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a28f34cbb16ac60050a2e42332058b3eb">  158</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a28f34cbb16ac60050a2e42332058b3eb">ThreadPimpl::is_stop_requested</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a21f70ae9d374cc919ab50bb410172415">status_</a> == <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a949e36ce3a330b30392c68f53455ab4d">kWaitingForTerminate</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a73a9dfcab4771b1a5c6362406b27faeb">  163</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a73a9dfcab4771b1a5c6362406b27faeb">ThreadPimpl::handle_tasks</a>() {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordtype">int</span> numa_node = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa">decompose_numa_node</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a>));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; started running on NUMA node: &quot;</span> &lt;&lt; numa_node</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; control_block address=&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="structfoedus_1_1thread_1_1NumaThreadScope.html">NumaThreadScope</a> scope(numa_node);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad6c2ae1c63499d211f31d3165eeea3cf">set_thread_schedule</a>();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(control_block_-&gt;status_ == <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a3b9c59461ee89a25359ea69563068a9b">kNotInitialized</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  control_block_-&gt;status_ = <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a72aee7fe031aa8f5648f624a68616ecd">kWaitingForTask</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a28f34cbb16ac60050a2e42332058b3eb">is_stop_requested</a>()) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="group__ASSORTED.html#gaa05e01910d3ea9909f1a64afd62729fb">assorted::spinlock_yield</a>();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      uint64_t demand = control_block_-&gt;wakeup_cond_.acquire_ticket();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a28f34cbb16ac60050a2e42332058b3eb">is_stop_requested</a>()) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="comment">// these two status are &quot;not urgent&quot;.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">if</span> (control_block_-&gt;status_ == <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a72aee7fe031aa8f5648f624a68616ecd">kWaitingForTask</a></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        || control_block_-&gt;status_ == <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a348b1e174a3d845ea1c808defd1de2a6">kWaitingForClientRelease</a>) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; sleeping...&quot;</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        control_block_-&gt;wakeup_cond_.timedwait(demand, 100000ULL, 1U &lt;&lt; 16, 1U &lt;&lt; 13);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; woke up. status=&quot;</span> &lt;&lt; control_block_-&gt;status_;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span> (control_block_-&gt;status_ == <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12afa60273eee5d8d1548d0da34187b2a08">kWaitingForExecution</a>) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      control_block_-&gt;output_len_ = 0;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      control_block_-&gt;status_ = <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12ae4da726d3c3a0db2b9e657ddcee9444d">kRunningTask</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">// Reset the default value of enable_rll_for_this_xct etc to system-wide setting</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// for every impersonation.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#a873d7bb9094918e5d61742c456dbeb61">set_default_rll_for_this_xct</a>(</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a1fb740dca84aaaed101bf9f4818c5b4f">xct_</a>.<a class="code" href="structfoedus_1_1xct_1_1XctOptions.html#aca8818f386f22400be2a64de3d9eee6b">enable_retrospective_lock_list_</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#ace9354af4e27109da6affc4d3bd84419">set_default_hot_threshold_for_this_xct</a>(</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a3e40cfe4530b10e87344b42be16927e1">storage_</a>.<a class="code" href="structfoedus_1_1storage_1_1StorageOptions.html#ac27b7919baf2e41da1057dd666442e6f">hot_threshold_</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#a339fdd767efdfed418e32792b560b373">set_default_rll_threshold_for_this_xct</a>(</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a1fb740dca84aaaed101bf9f4818c5b4f">xct_</a>.<a class="code" href="structfoedus_1_1xct_1_1XctOptions.html#a0c631d601027cf678dfd192f74cd348b">hot_threshold_for_retrospective_lock_list_</a>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keyword">const</span> <a class="code" href="classfoedus_1_1assorted_1_1FixedString.html">proc::ProcName</a>&amp; proc_name = control_block_-&gt;proc_name_;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; retrieved a task: &quot;</span> &lt;&lt; proc_name;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="group__PROC.html#ga7aa50117a254b660df879d65d1d9964b">proc::Proc</a> proc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> result = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a213680d8d683ac663b847d09f1c0e9e3">get_proc_manager</a>()-&gt;<a class="code" href="classfoedus_1_1proc_1_1ProcManager.html#a22da584f85fbfd412c0637f737e32740">get_proc</a>(proc_name, &amp;proc);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span> (result.<a class="code" href="classfoedus_1_1ErrorStack.html#a9c7b3a8b3806ff623c7fb4a9db5cbeec">is_error</a>()) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">// control_block_-&gt;proc_result_</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; couldn&#39;t find procedure: &quot;</span> &lt;&lt; proc_name;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        uint32_t output_used = 0;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <a class="code" href="group__PROC.html#structfoedus_1_1proc_1_1ProcArguments">proc::ProcArguments</a> args = {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7cc8b97ee07c0a860f0c5a3247d6ace">holder_</a>,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a8b5ec40798ea07cf3dbb4def4c6ad142">task_input_memory_</a>,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          control_block_-&gt;input_len_,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa2dced4e9409f69e3d5327c653807362">task_output_memory_</a>,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <a class="code" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea9639075ff64fbe04fd9838a70e156ab3">soc::ThreadMemoryAnchors::kTaskOutputMemorySize</a>,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          &amp;output_used,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        };</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        result = proc(args);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; run(task) returned. result =&quot;</span> &lt;&lt; result</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;, output_used=&quot;</span> &lt;&lt; output_used;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        control_block_-&gt;output_len_ = output_used;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">if</span> (result.<a class="code" href="classfoedus_1_1ErrorStack.html#a9c7b3a8b3806ff623c7fb4a9db5cbeec">is_error</a>()) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        control_block_-&gt;proc_result_.from_error_stack(result);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        control_block_-&gt;proc_result_.clear();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      control_block_-&gt;status_ = <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a348b1e174a3d845ea1c808defd1de2a6">kWaitingForClientRelease</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">// Wakeup the client if it&#39;s waiting.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        control_block_-&gt;task_complete_cond_.signal();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; finished a task. result =&quot;</span> &lt;&lt; result;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a28f34cbb16ac60050a2e42332058b3eb">is_stop_requested</a>());</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  control_block_-&gt;status_ = <a class="code" href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12af713804e6a22002bd137b04e90560ca3">kTerminated</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; exits&quot;</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad6c2ae1c63499d211f31d3165eeea3cf">  239</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad6c2ae1c63499d211f31d3165eeea3cf">ThreadPimpl::set_thread_schedule</a>() {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// this code totally assumes pthread. maybe ifdef to handle Windows.. later!</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="group__ASSORTED.html#gae932f87b60cbd230347151ccf33eed86">SPINLOCK_WHILE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad8236666d8fca6674334d0d166218e5c">raw_thread_set_</a> == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// as the copy to raw_thread_ might happen after the launched thread getting here,</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// we check it and spin. This is mainly to make valgrind happy.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  pthread_t handle = <span class="keyword">static_cast&lt;</span>pthread_t<span class="keyword">&gt;</span>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a12c3db0e7d4015e8eaddbae71c90ab7e">raw_thread_</a>.native_handle());</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordtype">int</span> policy;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  sched_param param;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">int</span> ret = ::pthread_getschedparam(handle, &amp;policy, &amp;param);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">if</span> (ret) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;WTF. pthread_getschedparam() failed: error=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keyword">const</span> <a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html">ThreadOptions</a>&amp; opt = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a97a206187b610b15a6edbfc75a384b1a">thread_</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// output the following logs just once.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> == 0) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;The default thread policy=&quot;</span> &lt;&lt; policy &lt;&lt; <span class="stringliteral">&quot;, priority=&quot;</span> &lt;&lt; param.__sched_priority;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (opt.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#a6aa7925ce950791e71dc66c5cf928e3d">overwrite_thread_schedule_</a>) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Overwriting thread policy=&quot;</span> &lt;&lt; opt.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#aad75e714583f8ece41a49e47930d0dcb">thread_policy_</a></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, priority=&quot;</span> &lt;&lt; opt.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#afa7106df08eeeaa4147b295e7e125b8c">thread_priority_</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">if</span> (opt.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#a6aa7925ce950791e71dc66c5cf928e3d">overwrite_thread_schedule_</a>) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    policy = opt.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#aad75e714583f8ece41a49e47930d0dcb">thread_policy_</a>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    param.__sched_priority = opt.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#afa7106df08eeeaa4147b295e7e125b8c">thread_priority_</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">int</span> priority_max = ::sched_get_priority_max(policy);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">int</span> priority_min = ::sched_get_priority_min(policy);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span> (opt.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#afa7106df08eeeaa4147b295e7e125b8c">thread_priority_</a> &gt; priority_max) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Thread priority too large. using max value: &quot;</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        &lt;&lt; opt.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#afa7106df08eeeaa4147b295e7e125b8c">thread_priority_</a> &lt;&lt; <span class="stringliteral">&quot;-&gt;&quot;</span> &lt;&lt; priority_max;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      param.__sched_priority = priority_max;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (opt.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#afa7106df08eeeaa4147b295e7e125b8c">thread_priority_</a> &lt; priority_min) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Thread priority too small. using min value: &quot;</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        &lt;&lt; opt.<a class="code" href="structfoedus_1_1thread_1_1ThreadOptions.html#afa7106df08eeeaa4147b295e7e125b8c">thread_priority_</a> &lt;&lt; <span class="stringliteral">&quot;-&gt;&quot;</span> &lt;&lt; priority_min;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      param.__sched_priority = priority_min;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">int</span> ret2 = ::pthread_setschedparam(handle, policy, &amp;param);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span> (ret2 == EPERM) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="comment">// this is a quite common mis-configuratrion, so let&#39;s output a friendly error message.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">// also, not fatal. keep running, as this only affects performance.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;=========   ATTENTION: Thread-scheduling Permission Error!!!!   ==========\n&quot;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="stringliteral">&quot; pthread_setschedparam() failed due to permission error. This means you have\n&quot;</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="stringliteral">&quot; not set appropriate rtprio to limits.conf. You cannot set priority higher than what\n&quot;</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="stringliteral">&quot; OS allows. Configure limits.conf (eg. &#39;kimurhid - rtprio 99&#39;) or modify ThreadOptions.\n&quot;</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="stringliteral">&quot;=============================               ATTENTION              ======================&quot;</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret2) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;WTF pthread_setschedparam() failed: error=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04">  292</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04">ThreadPimpl::install_a_volatile_page</a>(</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>* pointer,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** installed_page) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#af1b2fd480af916504df50c01faa3e597">snapshot_pointer_</a> != 0);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// copy from snapshot version</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* snapshot_page;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681">find_or_read_a_snapshot_page</a>(pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#af1b2fd480af916504df50c01faa3e597">snapshot_pointer_</a>, &amp;snapshot_page));</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> volatile_pointer = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98">grab_free_volatile_page_pointer</a>();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> offset = volatile_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6">get_offset</a>();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(volatile_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7">is_null</a>())) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a2ddd0cd462e4ae138f0e572106ad098c">kErrorCodeMemoryNoFreePages</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offset &lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0b56e96991f936feba47c29f61c0fbcb">local_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1LocalPageResolver.html#afd53ee3eaa00a58b7b0446456d82f4a9">end_</a>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0b56e96991f936feba47c29f61c0fbcb">local_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f">resolve_offset_newpage</a>(offset);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  std::memcpy(page, snapshot_page, <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">storage::kPageSize</a>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// We copied from a snapshot page, so the snapshot flag is on.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#ac0baf9ee636d13c02d334ce779cc6a8f">snapshot_</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  page-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#ac0baf9ee636d13c02d334ce779cc6a8f">snapshot_</a> = <span class="keyword">false</span>;  <span class="comment">// now it&#39;s volatile</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  page-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#a59128590fdc568e894a8973a319a0154">page_id_</a> = volatile_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a8bb6c37c44056c5f986f6dd164b5b23a">word</a>;  <span class="comment">// and correct page ID</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  *installed_page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343">place_a_new_volatile_page</a>(offset, pointer);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343">  317</a></span>&#160;<a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343">ThreadPimpl::place_a_new_volatile_page</a>(</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> new_offset,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>* pointer) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> cur_pointer = pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> new_pointer;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    new_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69">set</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0dc235d99dfaac00446b613f409de2ab">numa_node_</a>, new_offset);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// atomically install it.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (cur_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7">is_null</a>() &amp;&amp;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      assorted::raw_atomic_compare_exchange_strong&lt;uint64_t&gt;(</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        &amp;(pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a8bb6c37c44056c5f986f6dd164b5b23a">word</a>),</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        &amp;(cur_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a8bb6c37c44056c5f986f6dd164b5b23a">word</a>),</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        new_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a8bb6c37c44056c5f986f6dd164b5b23a">word</a>)) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="comment">// successfully installed</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0b56e96991f936feba47c29f61c0fbcb">local_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f">resolve_offset_newpage</a>(new_offset);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">if</span> (!cur_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7">is_null</a>()) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="comment">// someone else has installed it!</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Interesting. Lost race to install a volatile page. ver-b. Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;, local offset=&quot;</span> &lt;&lt; new_offset &lt;&lt; <span class="stringliteral">&quot; winning=&quot;</span> &lt;&lt; cur_pointer;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a6c9bf7d6b21ac33a61d6f7176023ea3a">release_free_volatile_page</a>(new_offset);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* placed_page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a44232f657701896a24ec4a238d0ab226">global_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f">resolve_offset</a>(cur_pointer);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(placed_page-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#ac0baf9ee636d13c02d334ce779cc6a8f">snapshot_</a> == <span class="keyword">false</span>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">return</span> placed_page;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="comment">// This is probably a bug, but we might only change mod count for some reason.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Very interesting. Lost race but volatile page not installed. Thread-&quot;</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot;, local offset=&quot;</span> &lt;&lt; new_offset;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">// placed here to allow inlining</span></div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6">  353</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6">Thread::follow_page_pointer</a>(</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="code" href="group__STORAGE.html#gab1f01cb8d7e103171a991936c4805486">storage::VolatilePageInit</a> page_initializer,</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">bool</span> tolerate_null_pointer,</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordtype">bool</span> will_modify,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">bool</span> take_ptr_set_snapshot,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>* pointer,</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** page,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keyword">const</span> <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* parent,</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  uint16_t index_in_parent) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904">follow_page_pointer</a>(</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    page_initializer,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    tolerate_null_pointer,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    will_modify,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    take_ptr_set_snapshot,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    pointer,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    page,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    parent,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    index_in_parent);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#abb36cf6186f747e38d98a13c6419e128">  373</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#abb36cf6186f747e38d98a13c6419e128">Thread::follow_page_pointers_for_read_batch</a>(</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  uint16_t batch_size,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="group__STORAGE.html#gab1f01cb8d7e103171a991936c4805486">storage::VolatilePageInit</a> page_initializer,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordtype">bool</span> tolerate_null_pointer,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordtype">bool</span> take_ptr_set_snapshot,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>** pointers,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** parents,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keyword">const</span> uint16_t* index_in_parents,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordtype">bool</span>* followed_snapshots,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** out) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a89fe2af2a31e70a89e143cbc2d687ffb">follow_page_pointers_for_read_batch</a>(</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    batch_size,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    page_initializer,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    tolerate_null_pointer,</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    take_ptr_set_snapshot,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    pointers,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    parents,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    index_in_parents,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    followed_snapshots,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    out);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a2b375e7de4d6c9c7b222c45b271126dc">  395</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a2b375e7de4d6c9c7b222c45b271126dc">Thread::follow_page_pointers_for_write_batch</a>(</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  uint16_t batch_size,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="group__STORAGE.html#gab1f01cb8d7e103171a991936c4805486">storage::VolatilePageInit</a> page_initializer,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>** pointers,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** parents,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keyword">const</span> uint16_t* index_in_parents,</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** out) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aac3821c478965e40c60c819a7e5a83e5">follow_page_pointers_for_write_batch</a>(</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    batch_size,</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    page_initializer,</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    pointers,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    parents,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    index_in_parents,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    out);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;}</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904">  411</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904">ThreadPimpl::follow_page_pointer</a>(</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <a class="code" href="group__STORAGE.html#gab1f01cb8d7e103171a991936c4805486">storage::VolatilePageInit</a> page_initializer,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordtype">bool</span> tolerate_null_pointer,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordtype">bool</span> will_modify,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">bool</span> take_ptr_set_snapshot,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>* pointer,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** page,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keyword">const</span> <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* parent,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  uint16_t index_in_parent) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!tolerate_null_pointer || !will_modify);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> volatile_pointer = pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordtype">bool</span> followed_snapshot = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">if</span> (pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#af1b2fd480af916504df50c01faa3e597">snapshot_pointer_</a> == 0) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span> (volatile_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7">is_null</a>()) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="comment">// both null, so the page is not created yet.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordflow">if</span> (tolerate_null_pointer) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        *page = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">// place an empty new page</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page_initializer);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">// we must not install a new volatile page in snapshot page. We must not hit this case.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!parent-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#ac0baf9ee636d13c02d334ce779cc6a8f">snapshot_</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> offset = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570">grab_free_volatile_page</a>();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(offset == 0)) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a2ddd0cd462e4ae138f0e572106ad098c">kErrorCodeMemoryNoFreePages</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offset &lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0b56e96991f936feba47c29f61c0fbcb">local_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1LocalPageResolver.html#afd53ee3eaa00a58b7b0446456d82f4a9">end_</a>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* new_page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0b56e96991f936feba47c29f61c0fbcb">local_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f">resolve_offset_newpage</a>(offset);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> new_page_id;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        new_page_id.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69">set</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0dc235d99dfaac00446b613f409de2ab">numa_node_</a>, offset);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="group__STORAGE.html#structfoedus_1_1storage_1_1VolatilePageInitArguments">storage::VolatilePageInitArguments</a> args = {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7cc8b97ee07c0a860f0c5a3247d6ace">holder_</a>,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          new_page_id,</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          new_page,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          parent,</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          index_in_parent</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        };</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        page_initializer(args);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <a class="code" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d">storage::assert_valid_volatile_page</a>(new_page, offset);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(new_page-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#ac0baf9ee636d13c02d334ce779cc6a8f">snapshot_</a> == <span class="keyword">false</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        *page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343">place_a_new_volatile_page</a>(offset, pointer);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="comment">// then we have to follow volatile page anyway</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      *page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a44232f657701896a24ec4a238d0ab226">global_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f">resolve_offset</a>(volatile_pointer);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// if there is a snapshot page, we have a few more choices.</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">if</span> (!volatile_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7">is_null</a>()) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="comment">// we have a volatile page, which is guaranteed to be latest</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      *page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a44232f657701896a24ec4a238d0ab226">global_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f">resolve_offset</a>(volatile_pointer);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (will_modify) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="comment">// we need a volatile page. so construct it from snapshot</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04">install_a_volatile_page</a>(pointer, page));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="comment">// otherwise just use snapshot</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681">find_or_read_a_snapshot_page</a>(pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#af1b2fd480af916504df50c01faa3e597">snapshot_pointer_</a>, page));</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      followed_snapshot = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*page) == <span class="keyword">nullptr</span> || (followed_snapshot == (*page)-&gt;get_header().snapshot_));</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">// if we follow a snapshot pointer, remember pointer set</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352">get_isolation_level</a>() == <a class="code" href="group__XCT.html#gga9ac5dae4b91a288e9d887f28a7124c13a5e9c22688eea55cea2bf4380b03a8630">xct::kSerializable</a>) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> ((*page == <span class="keyword">nullptr</span> || followed_snapshot) &amp;&amp; take_ptr_set_snapshot) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3">add_to_pointer_set</a>(&amp;pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>, volatile_pointer);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;}</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a89fe2af2a31e70a89e143cbc2d687ffb">  484</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a89fe2af2a31e70a89e143cbc2d687ffb">ThreadPimpl::follow_page_pointers_for_read_batch</a>(</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  uint16_t batch_size,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="group__STORAGE.html#gab1f01cb8d7e103171a991936c4805486">storage::VolatilePageInit</a> page_initializer,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordtype">bool</span> tolerate_null_pointer,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordtype">bool</span> take_ptr_set_snapshot,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>** pointers,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** parents,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keyword">const</span> uint16_t* index_in_parents,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">bool</span>* followed_snapshots,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** out) {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(tolerate_null_pointer || page_initializer);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">if</span> (batch_size == 0) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(batch_size &gt; <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a7e94630e018900343888e94e36c6b14cabf2c9dc4a44ca83095e56776ae6817da">Thread::kMaxFindPagesBatch</a>)) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a01914ad44c1e130dd69580da3c04a195">kErrorCodeInvalidParameter</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">// this one uses a batched find method for following snapshot pages.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// some of them might follow volatile pages, so we do it only when at least one snapshot ptr.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordtype">bool</span> has_some_snapshot = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> needs_ptr_set</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    = take_ptr_set_snapshot &amp;&amp; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352">get_isolation_level</a>() == <a class="code" href="group__XCT.html#gga9ac5dae4b91a288e9d887f28a7124c13a5e9c22688eea55cea2bf4380b03a8630">xct::kSerializable</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// REMINDER: Remember that it might be parents == out. We thus use tmp_out.</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* tmp_out[<a class="code" href="classfoedus_1_1thread_1_1Thread.html#a7e94630e018900343888e94e36c6b14cabf2c9dc4a44ca83095e56776ae6817da">Thread::kMaxFindPagesBatch</a>];</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">// fill with garbage for easier debugging</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  std::memset(tmp_out, 0xDA, <span class="keyword">sizeof</span>(tmp_out));</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#endif  // NDEBUG</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">// collect snapshot page IDs.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">storage::SnapshotPagePointer</a> snapshot_page_ids[<a class="code" href="classfoedus_1_1thread_1_1Thread.html#a7e94630e018900343888e94e36c6b14cabf2c9dc4a44ca83095e56776ae6817da">Thread::kMaxFindPagesBatch</a>];</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordflow">for</span> (uint16_t b = 0; b &lt; batch_size; ++b) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    snapshot_page_ids[b] = 0;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>* pointer = pointers[b];</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">if</span> (pointer == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// followed_snapshots is both input and output.</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// as input, it should indicate whether the parent is snapshot or not</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(parents[b]-&gt;get_header().snapshot_ == followed_snapshots[b]);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">if</span> (pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#af1b2fd480af916504df50c01faa3e597">snapshot_pointer_</a> != 0 &amp;&amp; pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7">is_null</a>()) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      has_some_snapshot = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      snapshot_page_ids[b] = pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#af1b2fd480af916504df50c01faa3e597">snapshot_pointer_</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// follow them in a batch. output to tmp_out.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">if</span> (has_some_snapshot) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a98de2aa47bebca5add3e0550f2c602bf">find_or_read_snapshot_pages_batch</a>(batch_size, snapshot_page_ids, tmp_out));</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">// handle cases we have to volatile pages. also we might have to create a new page.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">for</span> (uint16_t b = 0; b &lt; batch_size; ++b) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>* pointer = pointers[b];</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">if</span> (has_some_snapshot) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keywordflow">if</span> (pointer == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        out[b] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tmp_out[b]) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="comment">// if we follow a snapshot pointer _from volatile page_, remember pointer set</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">if</span> (needs_ptr_set &amp;&amp; !followed_snapshots[b]) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3">add_to_pointer_set</a>(&amp;pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>, pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        followed_snapshots[b] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        out[b] = tmp_out[b];</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(tmp_out[b] == <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// we didn&#39;t follow snapshot page. we must follow volatile page, or null.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    followed_snapshots[b] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!parents[b]-&gt;get_header().snapshot_);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span> (pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#af1b2fd480af916504df50c01faa3e597">snapshot_pointer_</a> == 0) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">if</span> (pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7">is_null</a>()) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="comment">// both null, so the page is not created yet.</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">if</span> (tolerate_null_pointer) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;          out[b] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;          <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> offset = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570">grab_free_volatile_page</a>();</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(offset == 0)) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a2ddd0cd462e4ae138f0e572106ad098c">kErrorCodeMemoryNoFreePages</a>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;          <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* new_page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0b56e96991f936feba47c29f61c0fbcb">local_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f">resolve_offset_newpage</a>(offset);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;          <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> new_page_id;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;          new_page_id.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69">set</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0dc235d99dfaac00446b613f409de2ab">numa_node_</a>, offset);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;          <a class="code" href="group__STORAGE.html#structfoedus_1_1storage_1_1VolatilePageInitArguments">storage::VolatilePageInitArguments</a> args = {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7cc8b97ee07c0a860f0c5a3247d6ace">holder_</a>,</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            new_page_id,</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            new_page,</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            parents[b],</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            index_in_parents[b]</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          };</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          page_initializer(args);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;          <a class="code" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d">storage::assert_valid_volatile_page</a>(new_page, offset);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(new_page-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#ac0baf9ee636d13c02d334ce779cc6a8f">snapshot_</a> == <span class="keyword">false</span>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;          out[b] = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343">place_a_new_volatile_page</a>(offset, pointer);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        out[b] = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a44232f657701896a24ec4a238d0ab226">global_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f">resolve_offset</a>(pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7">is_null</a>());</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      out[b] = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a44232f657701896a24ec4a238d0ab226">global_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f">resolve_offset</a>(pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aac3821c478965e40c60c819a7e5a83e5">  595</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aac3821c478965e40c60c819a7e5a83e5">ThreadPimpl::follow_page_pointers_for_write_batch</a>(</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  uint16_t batch_size,</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <a class="code" href="group__STORAGE.html#gab1f01cb8d7e103171a991936c4805486">storage::VolatilePageInit</a> page_initializer,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>** pointers,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** parents,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keyword">const</span> uint16_t* index_in_parents,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** out) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">// REMINDER: Remember that it might be parents == out. It&#39;s not an issue in this function, tho.</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">// this method is not quite batched as it doesn&#39;t need to be.</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">// still, less branches because we can assume all of them need a writable volatile page.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordflow">for</span> (uint16_t b = 0; b &lt; batch_size; ++b) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a>* pointer = pointers[b];</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">if</span> (pointer == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      out[b] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!parents[b]-&gt;get_header().snapshot_);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** page = out + b;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> volatile_pointer = pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">if</span> (!volatile_pointer.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7">is_null</a>()) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      *page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a44232f657701896a24ec4a238d0ab226">global_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f">resolve_offset</a>(volatile_pointer);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pointer-&gt;<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#af1b2fd480af916504df50c01faa3e597">snapshot_pointer_</a> == 0) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="comment">// we need a volatile page. so construct it from snapshot</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04">install_a_volatile_page</a>(pointer, page));</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page_initializer);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="comment">// we must not install a new volatile page in snapshot page. We must not hit this case.</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> offset = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570">grab_free_volatile_page</a>();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(offset == 0)) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a2ddd0cd462e4ae138f0e572106ad098c">kErrorCodeMemoryNoFreePages</a>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* new_page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0b56e96991f936feba47c29f61c0fbcb">local_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f">resolve_offset_newpage</a>(offset);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> new_page_id;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      new_page_id.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69">set</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0dc235d99dfaac00446b613f409de2ab">numa_node_</a>, offset);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <a class="code" href="group__STORAGE.html#structfoedus_1_1storage_1_1VolatilePageInitArguments">storage::VolatilePageInitArguments</a> args = {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7cc8b97ee07c0a860f0c5a3247d6ace">holder_</a>,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        new_page_id,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        new_page,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        parents[b],</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        index_in_parents[b]</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      };</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      page_initializer(args);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <a class="code" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d">storage::assert_valid_volatile_page</a>(new_page, offset);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(new_page-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#ac0baf9ee636d13c02d334ce779cc6a8f">snapshot_</a> == <span class="keyword">false</span>);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      *page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343">place_a_new_volatile_page</a>(offset, pointer);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(out[b] != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;}</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681">  647</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681">ThreadPimpl::find_or_read_a_snapshot_page</a>(</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">storage::SnapshotPagePointer</a> page_id,</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** out) {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6236b974981b361bfbc25db38c7f9626">snapshot_cache_hashtable_</a>) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a6e51937e58975e50d0f3eea198b24d3e">cache_</a>.<a class="code" href="structfoedus_1_1cache_1_1CacheOptions.html#a896cdc7cbe05ed0d5f77b863228a7c3a">snapshot_cache_enabled_</a>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> offset = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6236b974981b361bfbc25db38c7f9626">snapshot_cache_hashtable_</a>-&gt;<a class="code" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74">find</a>(page_id);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">// the &quot;find&quot; is very efficient and wait-free, but instead it might have false positive/nagative</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// in which case we should just install a new page. No worry about duplicate thanks to the</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// immutability of snapshot pages. it just wastes a bit of CPU and memory.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">if</span> (offset == 0 || <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1c0d1b2cce940cc22285a906b1076bd3">snapshot_page_pool_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8">get_base</a>()[offset].<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#a59128590fdc568e894a8973a319a0154">page_id_</a> != page_id) {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keywordflow">if</span> (offset != 0) {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        DVLOG(0) &lt;&lt; <span class="stringliteral">&quot;Interesting, this race is rare, but possible. offset=&quot;</span> &lt;&lt; offset;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963">on_snapshot_cache_miss</a>(page_id, &amp;offset));</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offset != 0);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6236b974981b361bfbc25db38c7f9626">snapshot_cache_hashtable_</a>-&gt;<a class="code" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a">install</a>(page_id, offset));</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      ++<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#ada5ae07c10b92acbab636eb0d221557b">stat_snapshot_cache_misses_</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      ++<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#aea90422952de0f11fcb10568cc6ada62">stat_snapshot_cache_hits_</a>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offset != 0);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    *out = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1c0d1b2cce940cc22285a906b1076bd3">snapshot_page_pool_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8">get_base</a>() + offset;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a6e51937e58975e50d0f3eea198b24d3e">cache_</a>.<a class="code" href="structfoedus_1_1cache_1_1CacheOptions.html#a896cdc7cbe05ed0d5f77b863228a7c3a">snapshot_cache_enabled_</a>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">// Snapshot is disabled. So far this happens only in performance experiments.</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">// We use local work memory in this case.</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8">acquire_local_work_memory</a>(</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">storage::kPageSize</a>,</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      reinterpret_cast&lt;void**&gt;(out),</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">storage::kPageSize</a>));</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca">read_a_snapshot_page</a>(page_id, *out);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;}</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;static_assert(</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  static_cast&lt;int&gt;(<a class="code" href="classfoedus_1_1thread_1_1Thread.html#a7e94630e018900343888e94e36c6b14cabf2c9dc4a44ca83095e56776ae6817da">Thread::kMaxFindPagesBatch</a>)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    &lt;= static_cast&lt;int&gt;(<a class="code" href="classfoedus_1_1cache_1_1CacheHashtable.html#a9eb2a178b8368240d82ccc787841f200a524de05ad7502c6d46ae15540d1e6334">cache::CacheHashtable::kMaxFindBatchSize</a>),</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="stringliteral">&quot;Booo&quot;</span>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a98de2aa47bebca5add3e0550f2c602bf">  687</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a98de2aa47bebca5add3e0550f2c602bf">ThreadPimpl::find_or_read_snapshot_pages_batch</a>(</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  uint16_t batch_size,</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keyword">const</span> <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">storage::SnapshotPagePointer</a>* page_ids,</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** out) {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(batch_size &lt;= <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a7e94630e018900343888e94e36c6b14cabf2c9dc4a44ca83095e56776ae6817da">Thread::kMaxFindPagesBatch</a>);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">if</span> (batch_size == 0) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(batch_size &gt; <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a7e94630e018900343888e94e36c6b14cabf2c9dc4a44ca83095e56776ae6817da">Thread::kMaxFindPagesBatch</a>)) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a01914ad44c1e130dd69580da3c04a195">kErrorCodeInvalidParameter</a>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6236b974981b361bfbc25db38c7f9626">snapshot_cache_hashtable_</a>) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a6e51937e58975e50d0f3eea198b24d3e">cache_</a>.<a class="code" href="structfoedus_1_1cache_1_1CacheOptions.html#a896cdc7cbe05ed0d5f77b863228a7c3a">snapshot_cache_enabled_</a>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> offsets[<a class="code" href="classfoedus_1_1thread_1_1Thread.html#a7e94630e018900343888e94e36c6b14cabf2c9dc4a44ca83095e56776ae6817da">Thread::kMaxFindPagesBatch</a>];</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6236b974981b361bfbc25db38c7f9626">snapshot_cache_hashtable_</a>-&gt;<a class="code" href="classfoedus_1_1cache_1_1CacheHashtable.html#a8e48716623ca44e83cc5ef871c10b131">find_batch</a>(batch_size, page_ids, offsets));</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">for</span> (uint16_t b = 0; b &lt; batch_size; ++b) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> offset = offsets[b];</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">storage::SnapshotPagePointer</a> page_id = page_ids[b];</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="keywordflow">if</span> (page_id == 0) {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        out[b] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b &gt; 0 &amp;&amp; page_ids[b - 1] == page_id) {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offsets[b - 1] == offset);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        out[b] = out[b - 1];</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">if</span> (offset == 0 || <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1c0d1b2cce940cc22285a906b1076bd3">snapshot_page_pool_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8">get_base</a>()[offset].<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#a59128590fdc568e894a8973a319a0154">page_id_</a> != page_id) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordflow">if</span> (offset != 0) {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;          DVLOG(0) &lt;&lt; <span class="stringliteral">&quot;Interesting, this race is rare, but possible. offset=&quot;</span> &lt;&lt; offset;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963">on_snapshot_cache_miss</a>(page_id, &amp;offset));</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offset != 0);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6236b974981b361bfbc25db38c7f9626">snapshot_cache_hashtable_</a>-&gt;<a class="code" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a">install</a>(page_id, offset));</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        ++<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#ada5ae07c10b92acbab636eb0d221557b">stat_snapshot_cache_misses_</a>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        ++<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">control_block_</a>-&gt;<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html#aea90422952de0f11fcb10568cc6ada62">stat_snapshot_cache_hits_</a>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(offset != 0);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      out[b] = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1c0d1b2cce940cc22285a906b1076bd3">snapshot_page_pool_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8">get_base</a>() + offset;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a6e51937e58975e50d0f3eea198b24d3e">cache_</a>.<a class="code" href="structfoedus_1_1cache_1_1CacheOptions.html#a896cdc7cbe05ed0d5f77b863228a7c3a">snapshot_cache_enabled_</a>);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">for</span> (uint16_t b = 0; b &lt; batch_size; ++b) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8">acquire_local_work_memory</a>(</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">storage::kPageSize</a>,</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        reinterpret_cast&lt;void**&gt;(out + b),</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">storage::kPageSize</a>));</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca">read_a_snapshot_page</a>(page_ids[b], out[b]));</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;}</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div>
<div class="line"><a name="l00741"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963">  741</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963">ThreadPimpl::on_snapshot_cache_miss</a>(</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">storage::SnapshotPagePointer</a> page_id,</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a>* pool_offset) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">// grab a buffer page to read into.</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> offset = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ac3e2f6d24f2b0f5c04d2cde48db11f6a">grab_free_snapshot_page</a>();</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordflow">if</span> (offset == 0) {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="comment">// TASK(Hideaki) First, we have to make sure this doesn&#39;t happen often (cleaner&#39;s work).</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">// Second, when this happens, we have to do eviction now, but probably after aborting the xct.</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;Could not grab free snapshot page while cache miss. thread=&quot;</span> &lt;&lt; *<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7cc8b97ee07c0a860f0c5a3247d6ace">holder_</a></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;, page_id=&quot;</span> &lt;&lt; <a class="code" href="structfoedus_1_1assorted_1_1Hex.html">assorted::Hex</a>(page_id);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ab6e70410f19ae9632262f6394f3354ff">kErrorCodeCacheNoFreePages</a>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* new_page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1c0d1b2cce940cc22285a906b1076bd3">snapshot_page_pool_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8">get_base</a>() + offset;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> read_result = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca">read_a_snapshot_page</a>(page_id, new_page);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">if</span> (read_result != <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;Failed to read a snapshot page. thread=&quot;</span> &lt;&lt; *<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7cc8b97ee07c0a860f0c5a3247d6ace">holder_</a></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;, page_id=&quot;</span> &lt;&lt; <a class="code" href="structfoedus_1_1assorted_1_1Hex.html">assorted::Hex</a>(page_id);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a7ea5067e450fa872240cb010ddb65464">release_free_snapshot_page</a>(offset);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">return</span> read_result;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  *pool_offset = offset;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#af52661009b044c7a6553234720d71923">  767</a></span>&#160;<a class="code" href="classfoedus_1_1thread_1_1ThreadRef.html">ThreadRef</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#af52661009b044c7a6553234720d71923">ThreadPimpl::get_thread_ref</a>(<a class="code" href="group__THREAD.html#ga709a79fc1ed05a3543d8309ba391da93">ThreadId</a> <span class="keywordtype">id</span>) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keyword">auto</span>* pool_pimpl = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a4243a3e399186727d6bbdda5bc98f8cd">get_thread_pool</a>()-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPool.html#a4af4c3d3fd7a9353d892e5270a900f1c">get_pimpl</a>();</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">return</span> pool_pimpl-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPoolPimpl.html#a61040189c343e97c3f0ee961df7a9f31">get_thread_ref</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;}</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a674a8a8e613dc4e19a626da490c883fc">  777</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a674a8a8e613dc4e19a626da490c883fc">ThreadPimpl::collect_retired_volatile_page</a>(<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> ptr) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a28d4f2f16808e20d2d174f12ff1c7317">is_volatile_page_retired</a>(ptr));</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  uint16_t node = ptr.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077">get_numa_node</a>();</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <a class="code" href="classfoedus_1_1Epoch.html">Epoch</a> current_epoch = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a48d5e1f7ce2f70161c253f650c75ed95">get_xct_manager</a>()-&gt;<a class="code" href="classfoedus_1_1xct_1_1XctManager.html#a4578dd6dab7925b95d7810335ae5cec0">get_current_global_epoch_weak</a>();</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <a class="code" href="classfoedus_1_1Epoch.html">Epoch</a> safe_epoch = current_epoch.<a class="code" href="classfoedus_1_1Epoch.html#a786afd92afdc87b54dfa11ef093f06f3">one_more</a>().<a class="code" href="classfoedus_1_1Epoch.html#a786afd92afdc87b54dfa11ef093f06f3">one_more</a>();</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html">memory::PagePoolOffsetAndEpochChunk</a>* chunk = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">core_memory_</a>-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad0624fe34e52c0904ee449c97f0325c5">get_retired_volatile_pool_chunk</a>(node);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">if</span> (chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#acac2755ecb22d4539c3d6bb44538240d">full</a>()) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a694a2aaa7515ab45a8c9fa12b709defb">flush_retired_volatile_page</a>(node, current_epoch, chunk);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#aae530fb2917cf0f6329ac323f1da7c8c">push_back</a>(ptr.<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6">get_offset</a>(), safe_epoch);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;}</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00789"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a694a2aaa7515ab45a8c9fa12b709defb">  789</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a694a2aaa7515ab45a8c9fa12b709defb">ThreadPimpl::flush_retired_volatile_page</a>(</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  uint16_t node,</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <a class="code" href="classfoedus_1_1Epoch.html">Epoch</a> current_epoch,</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html">memory::PagePoolOffsetAndEpochChunk</a>* chunk) {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">if</span> (chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#ad99e5b875980b442bf5de61fb022f0ac">size</a>() == 0) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  uint32_t safe_count = chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#a7d9aa924c48bd26b4dd208d4a9333127">get_safe_offset_count</a>(current_epoch);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordflow">while</span> (safe_count &lt; chunk-&gt;size() / 10U) {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; can return only &quot;</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      &lt;&lt; safe_count &lt;&lt; <span class="stringliteral">&quot; out of &quot;</span> &lt;&lt; chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#ad99e5b875980b442bf5de61fb022f0ac">size</a>()</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; retired pages to node-&quot;</span> &lt;&lt; node  &lt;&lt; <span class="stringliteral">&quot; in epoch=&quot;</span> &lt;&lt; current_epoch</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;. This means the thread received so many retired pages in a short time period.&quot;</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Will adavance an epoch to safely return the retired pages.&quot;</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; This should be a rare event.&quot;</span>;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a48d5e1f7ce2f70161c253f650c75ed95">get_xct_manager</a>()-&gt;<a class="code" href="classfoedus_1_1xct_1_1XctManager.html#aa75089821b48c98a00cd7e4ddc0615da">advance_current_global_epoch</a>();</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    current_epoch = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a48d5e1f7ce2f70161c253f650c75ed95">get_xct_manager</a>()-&gt;<a class="code" href="classfoedus_1_1xct_1_1XctManager.html#a419a270d62522ede9bd871dd4adc0e2a">get_current_global_epoch</a>();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;okay, advanced epoch. now we should be able to return more pages&quot;</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    safe_count = chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#a7d9aa924c48bd26b4dd208d4a9333127">get_safe_offset_count</a>(current_epoch);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">id_</a> &lt;&lt; <span class="stringliteral">&quot; batch-returning retired volatile pages to node-&quot;</span> &lt;&lt; node</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; safe_count/count=&quot;</span> &lt;&lt; safe_count &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#ad99e5b875980b442bf5de61fb022f0ac">size</a>() &lt;&lt; <span class="stringliteral">&quot;. epoch=&quot;</span> &lt;&lt; current_epoch;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <a class="code" href="classfoedus_1_1memory_1_1PagePool.html">memory::PagePool</a>* volatile_pool</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8">get_node_memory</a>(node)-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774">get_volatile_pool</a>();</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  volatile_pool-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#a802171ff0578875748d20b4e9c8c9463">release</a>(safe_count, chunk);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!chunk-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#acac2755ecb22d4539c3d6bb44538240d">full</a>());</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;}</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div>
<div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a28d4f2f16808e20d2d174f12ff1c7317">  818</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a28d4f2f16808e20d2d174f12ff1c7317">ThreadPimpl::is_volatile_page_retired</a>(<a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> ptr) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* page = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a44232f657701896a24ec4a238d0ab226">global_volatile_page_resolver_</a>.<a class="code" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f">resolve_offset</a>(ptr);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="keywordflow">return</span> page-&gt;<a class="code" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">get_header</a>().<a class="code" href="structfoedus_1_1storage_1_1PageHeader.html#a44c12d47d4b478bac2076df4760fc990">page_version_</a>.<a class="code" href="structfoedus_1_1storage_1_1PageVersion.html#a61318d7aab5c4ca7334ec05f8de168ca">is_retired</a>();</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;}</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a1b1ea3713f779b1c3f6215533145ef26">  833</a></span>&#160;<a class="code" href="structfoedus_1_1xct_1_1McsRwSimpleBlock.html">xct::McsRwSimpleBlock</a>* <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a1b1ea3713f779b1c3f6215533145ef26">Thread::get_mcs_rw_simple_blocks</a>() {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dd7f177602e25a5cd1318723825c861">mcs_rw_simple_blocks_</a>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;}</div>
<div class="line"><a name="l00836"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a533a93844ae692e32571524f656870b3">  836</a></span>&#160;<a class="code" href="structfoedus_1_1xct_1_1McsRwExtendedBlock.html">xct::McsRwExtendedBlock</a>* <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a533a93844ae692e32571524f656870b3">Thread::get_mcs_rw_extended_blocks</a>() {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0f8e120dfd26566418bbb9057f8c5b20">mcs_rw_extended_blocks_</a>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;}</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">// Put Thread methods here to allow inlining.</span></div>
<div class="line"><a name="l00841"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a21bff0861e0c12573bc0a6b776857b76">  841</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a21bff0861e0c12573bc0a6b776857b76">Thread::cll_release_all_locks</a>() {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6367855f3aa3549b2d7b74adf383c87a">cll_release_all_locks</a>();</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;}</div>
<div class="line"><a name="l00844"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a4ff4d49ae69ae490afb0cc09c4c19507">  844</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a4ff4d49ae69ae490afb0cc09c4c19507">Thread::cll_release_all_locks_after</a>(<a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">xct::UniversalLockId</a> address) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#af1783a8b90bfcd0fa87c4947fc406b0b">cll_release_all_locks_after</a>(address);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;}</div>
<div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a94b9b35db175ad18d7e889b3bd57ea85">  847</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a94b9b35db175ad18d7e889b3bd57ea85">Thread::cll_giveup_all_locks_after</a>(<a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">xct::UniversalLockId</a> address) {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4197d522317d6177fd0d9a0ee811cdf5">cll_giveup_all_locks_after</a>(address);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;}</div>
<div class="line"><a name="l00850"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#ab52244fbb6c13b0c0774431af72d482e">  850</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#ab52244fbb6c13b0c0774431af72d482e">Thread::cll_try_or_acquire_single_lock</a>(<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">xct::LockListPosition</a> pos) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#afd87e3c9d855306d2c8115571eb79fa6">cll_try_or_acquire_single_lock</a>(pos);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;}</div>
<div class="line"><a name="l00853"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a476c43885a66c28ac33e624d071a7a7d">  853</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a476c43885a66c28ac33e624d071a7a7d">Thread::cll_try_or_acquire_multiple_locks</a>(<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">xct::LockListPosition</a> upto_pos) {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae594169d3ecc7b0d4d356d1ed6dfa8b2">cll_try_or_acquire_multiple_locks</a>(upto_pos);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;}</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno"><a class="line" href="namespacefoedus_1_1thread.html#ab0a71e2e54e7ef6805b7f1d1d626f9b5">  859</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacefoedus_1_1thread.html#ab0a71e2e54e7ef6805b7f1d1d626f9b5">assert_mcs_aligned</a>(<span class="keyword">const</span> <span class="keywordtype">void</span>* address) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(address);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(reinterpret_cast&lt;uintptr_t&gt;(address) % 4 == 0);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;}</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> RW_BLOCK&gt;</div>
<div class="line"><a name="l00865"></a><span class="lineno"><a class="line" href="namespacefoedus_1_1thread.html#a4a3d94e8a7c24f07eb69239505fb5b21">  865</a></span>&#160;<a class="code" href="classfoedus_1_1xct_1_1McsImpl.html">xct::McsImpl&lt; ThreadPimplMcsAdaptor&lt; RW_BLOCK &gt;</a>, RW_BLOCK &gt; <a class="code" href="namespacefoedus_1_1thread.html#a4a3d94e8a7c24f07eb69239505fb5b21">get_mcs_impl</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html">ThreadPimpl</a>* pimpl) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; RW_BLOCK &gt;</a> adaptor(pimpl);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1McsImpl.html">xct::McsImpl&lt; ThreadPimplMcsAdaptor&lt; RW_BLOCK &gt;</a> , RW_BLOCK&gt; impl(adaptor);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="keywordflow">return</span> impl;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;}</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div>
<div class="line"><a name="l00876"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#af1783a8b90bfcd0fa87c4947fc406b0b">  876</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#af1783a8b90bfcd0fa87c4947fc406b0b">ThreadPimpl::cll_release_all_locks_after</a>(<a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">xct::UniversalLockId</a> address) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html">xct::CurrentLockList</a>* cll = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8">get_current_lock_list</a>();</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">is_simple_mcs_rw</a>()) {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keyword">auto</span> impl(get_mcs_impl&lt;xct::McsRwSimpleBlock&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#ace2e6a593d7b975f1756ce9eec0fd1f2">release_all_after</a>(address, &amp;impl);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keyword">auto</span> impl(get_mcs_impl&lt;xct::McsRwExtendedBlock&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#ace2e6a593d7b975f1756ce9eec0fd1f2">release_all_after</a>(address, &amp;impl);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;}</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4197d522317d6177fd0d9a0ee811cdf5">  887</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4197d522317d6177fd0d9a0ee811cdf5">ThreadPimpl::cll_giveup_all_locks_after</a>(<a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">xct::UniversalLockId</a> address) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html">xct::CurrentLockList</a>* cll = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8">get_current_lock_list</a>();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">is_simple_mcs_rw</a>()) {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keyword">auto</span> impl(get_mcs_impl&lt;xct::McsRwSimpleBlock&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a3ac4e854509ec8a1cf9a70fcba501a68">giveup_all_after</a>(address, &amp;impl);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keyword">auto</span> impl(get_mcs_impl&lt;xct::McsRwExtendedBlock&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a3ac4e854509ec8a1cf9a70fcba501a68">giveup_all_after</a>(address, &amp;impl);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;}</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#afd87e3c9d855306d2c8115571eb79fa6">  898</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#afd87e3c9d855306d2c8115571eb79fa6">ThreadPimpl::cll_try_or_acquire_single_lock</a>(<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">xct::LockListPosition</a> pos) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html">xct::CurrentLockList</a>* cll = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8">get_current_lock_list</a>();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">is_simple_mcs_rw</a>()) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keyword">auto</span> impl(get_mcs_impl&lt;xct::McsRwSimpleBlock&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">return</span> cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#aa8023ecc3dc58816a010a3415ebfc1dd">try_or_acquire_single_lock</a>(pos, &amp;impl);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keyword">auto</span> impl(get_mcs_impl&lt;xct::McsRwExtendedBlock&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">return</span> cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#aa8023ecc3dc58816a010a3415ebfc1dd">try_or_acquire_single_lock</a>(pos, &amp;impl);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;}</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae594169d3ecc7b0d4d356d1ed6dfa8b2">  909</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae594169d3ecc7b0d4d356d1ed6dfa8b2">ThreadPimpl::cll_try_or_acquire_multiple_locks</a>(<a class="code" href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">xct::LockListPosition</a> upto_pos) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html">xct::CurrentLockList</a>* cll = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8">get_current_lock_list</a>();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">is_simple_mcs_rw</a>()) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keyword">auto</span> impl(get_mcs_impl&lt;xct::McsRwSimpleBlock&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">return</span> cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#ad7029aa2b4a2d3ec394aa0a0b378b088">try_or_acquire_multiple_locks</a>(upto_pos, &amp;impl);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keyword">auto</span> impl(get_mcs_impl&lt;xct::McsRwExtendedBlock&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">return</span> cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#ad7029aa2b4a2d3ec394aa0a0b378b088">try_or_acquire_multiple_locks</a>(upto_pos, &amp;impl);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;}</div>
<div class="line"><a name="l00919"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6367855f3aa3549b2d7b74adf383c87a">  919</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6367855f3aa3549b2d7b74adf383c87a">ThreadPimpl::cll_release_all_locks</a>() {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html">xct::CurrentLockList</a>* cll = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8">get_current_lock_list</a>();</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">is_simple_mcs_rw</a>()) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keyword">auto</span> impl(get_mcs_impl&lt;xct::McsRwSimpleBlock&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">return</span> cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a069941b140019c23d86092e68cd9b331">release_all_locks</a>(&amp;impl);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keyword">auto</span> impl(get_mcs_impl&lt;xct::McsRwExtendedBlock&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">return</span> cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a069941b140019c23d86092e68cd9b331">release_all_locks</a>(&amp;impl);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;}</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00930"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761">  930</a></span>&#160;<a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">xct::UniversalLockId</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761">ThreadPimpl::cll_get_max_locked_id</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keyword">const</span> <a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html">xct::CurrentLockList</a>* cll = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8">get_current_lock_list</a>();</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="keywordflow">return</span> cll-&gt;<a class="code" href="classfoedus_1_1xct_1_1CurrentLockList.html#a398ec264786992d102b8edd74d5767b3">get_max_locked_id</a>();</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;}</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div>
<div class="line"><a name="l00936"></a><span class="lineno"><a class="line" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html">  936</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html">ThreadPimplCllReleaseAllFunctor</a> {</div>
<div class="line"><a name="l00937"></a><span class="lineno"><a class="line" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a2723c5bae3f50df9b36b672f2ceb6564">  937</a></span>&#160;  <span class="keyword">explicit</span> <a class="code" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a2723c5bae3f50df9b36b672f2ceb6564">ThreadPimplCllReleaseAllFunctor</a>(<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html">ThreadPimpl</a>* pimpl) : <a class="code" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a8e6063415cae4400e2460bea361ab593">pimpl_</a>(pimpl) {}</div>
<div class="line"><a name="l00938"></a><span class="lineno"><a class="line" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a3c10a09a949ac94c2134e14e30d70e1e">  938</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a3c10a09a949ac94c2134e14e30d70e1e">operator()</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <a class="code" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a8e6063415cae4400e2460bea361ab593">pimpl_</a>-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6367855f3aa3549b2d7b74adf383c87a">cll_release_all_locks</a>();</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  }</div>
<div class="line"><a name="l00941"></a><span class="lineno"><a class="line" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a8e6063415cae4400e2460bea361ab593">  941</a></span>&#160;  <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html">ThreadPimpl</a>* <span class="keyword">const</span> <a class="code" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a8e6063415cae4400e2460bea361ab593">pimpl_</a>;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;};</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div>
<div class="line"><a name="l00952"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c">  952</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c">Thread::run_nested_sysxct</a>(<a class="code" href="structfoedus_1_1xct_1_1SysxctFunctor.html">xct::SysxctFunctor</a>* functor, uint32_t max_retries) {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221">run_nested_sysxct</a>(functor, max_retries);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;}</div>
<div class="line"><a name="l00955"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a383dee9d2971403e9bc3bef4a2d33d44">  955</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a383dee9d2971403e9bc3bef4a2d33d44">Thread::sysxct_record_lock</a>(</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html">xct::SysxctWorkspace</a>* sysxct_workspace,</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> page_id,</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1RwLockableXctId.html">xct::RwLockableXctId</a>* lock) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a056563bc302fb45ad684a7fa28d00161">sysxct_record_lock</a>(sysxct_workspace, page_id, lock);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;}</div>
<div class="line"><a name="l00961"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a664a76eb577003d4d4c0d417ecb014cc">  961</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a664a76eb577003d4d4c0d417ecb014cc">Thread::sysxct_batch_record_locks</a>(</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html">xct::SysxctWorkspace</a>* sysxct_workspace,</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> page_id,</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  uint32_t lock_count,</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1RwLockableXctId.html">xct::RwLockableXctId</a>** locks) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7234ffc46e46d480cedc556f0800da6">sysxct_batch_record_locks</a>(sysxct_workspace, page_id, lock_count, locks);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;}</div>
<div class="line"><a name="l00968"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a7ac249b3b032751e9bf0903ad7e45255">  968</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a7ac249b3b032751e9bf0903ad7e45255">Thread::sysxct_page_lock</a>(<a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html">xct::SysxctWorkspace</a>* sysxct_workspace, <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* page) {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a2cd3cb727c6e211c8e6a72ccb00f3854">sysxct_page_lock</a>(sysxct_workspace, page);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;}</div>
<div class="line"><a name="l00971"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1Thread.html#a2573902a53ca92a0cf7e19113d5b5979">  971</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1Thread.html#a2573902a53ca92a0cf7e19113d5b5979">Thread::sysxct_batch_page_locks</a>(</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html">xct::SysxctWorkspace</a>* sysxct_workspace,</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  uint32_t lock_count,</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** pages) {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordflow">return</span> pimpl_-&gt;<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac779ce5587967f00b09325337578dd24">sysxct_batch_page_locks</a>(sysxct_workspace, lock_count, pages);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;}</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221">  980</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221">ThreadPimpl::run_nested_sysxct</a>(</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1SysxctFunctor.html">xct::SysxctFunctor</a>* functor,</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  uint32_t max_retries) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html">xct::SysxctWorkspace</a>* workspace = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">current_xct_</a>.<a class="code" href="classfoedus_1_1xct_1_1Xct.html#aca66ae9959651b7c6fa86a75db287f54">get_sysxct_workspace</a>();</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <a class="code" href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">xct::UniversalLockId</a> enclosing_max_lock_id = <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761">cll_get_max_locked_id</a>();</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <a class="code" href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html">ThreadPimplCllReleaseAllFunctor</a> release_functor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">is_simple_mcs_rw</a>()) {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; xct::McsRwSimpleBlock &gt;</a> adaptor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__SYSXCT.html#gaf49955c6d4efe3d92e6e09b4ff890618">xct::run_nested_sysxct_impl</a>(</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        functor,</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        adaptor,</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        max_retries,</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        workspace,</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        enclosing_max_lock_id,</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        release_functor);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; xct::McsRwExtendedBlock &gt;</a> adaptor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__SYSXCT.html#gaf49955c6d4efe3d92e6e09b4ff890618">xct::run_nested_sysxct_impl</a>(</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        functor,</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        adaptor,</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        max_retries,</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        workspace,</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        enclosing_max_lock_id,</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        release_functor);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;}</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a056563bc302fb45ad684a7fa28d00161"> 1007</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a056563bc302fb45ad684a7fa28d00161">ThreadPimpl::sysxct_record_lock</a>(</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html">xct::SysxctWorkspace</a>* sysxct_workspace,</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> page_id,</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1RwLockableXctId.html">xct::RwLockableXctId</a>* lock) {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(sysxct_workspace-&gt;<a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html#a116372be4f325425adbf43b1f9bc93f7">running_sysxct_</a>);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="keyword">auto</span>&amp; sysxct_lock_list = sysxct_workspace-&gt;<a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html#a9defe6eec5baa9d85b3fd675dd64e211">lock_list_</a>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">is_simple_mcs_rw</a>()) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; xct::McsRwSimpleBlock &gt;</a> adaptor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">return</span> sysxct_lock_list.request_record_lock(adaptor, page_id, lock);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; xct::McsRwExtendedBlock &gt;</a> adaptor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">return</span> sysxct_lock_list.request_record_lock(adaptor, page_id, lock);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;}</div>
<div class="line"><a name="l01021"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7234ffc46e46d480cedc556f0800da6"> 1021</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7234ffc46e46d480cedc556f0800da6">ThreadPimpl::sysxct_batch_record_locks</a>(</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html">xct::SysxctWorkspace</a>* sysxct_workspace,</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">storage::VolatilePagePointer</a> page_id,</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  uint32_t lock_count,</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1RwLockableXctId.html">xct::RwLockableXctId</a>** locks) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(sysxct_workspace-&gt;<a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html#a116372be4f325425adbf43b1f9bc93f7">running_sysxct_</a>);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keyword">auto</span>&amp; sysxct_lock_list = sysxct_workspace-&gt;<a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html#a9defe6eec5baa9d85b3fd675dd64e211">lock_list_</a>;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">is_simple_mcs_rw</a>()) {</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; xct::McsRwSimpleBlock &gt;</a> adaptor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">return</span> sysxct_lock_list.batch_request_record_locks(adaptor, page_id, lock_count, locks);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; xct::McsRwExtendedBlock &gt;</a> adaptor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">return</span> sysxct_lock_list.batch_request_record_locks(adaptor, page_id, lock_count, locks);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;}</div>
<div class="line"><a name="l01036"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a2cd3cb727c6e211c8e6a72ccb00f3854"> 1036</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a2cd3cb727c6e211c8e6a72ccb00f3854">ThreadPimpl::sysxct_page_lock</a>(</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html">xct::SysxctWorkspace</a>* sysxct_workspace,</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>* page) {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(sysxct_workspace-&gt;<a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html#a116372be4f325425adbf43b1f9bc93f7">running_sysxct_</a>);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keyword">auto</span>&amp; sysxct_lock_list = sysxct_workspace-&gt;<a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html#a9defe6eec5baa9d85b3fd675dd64e211">lock_list_</a>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">is_simple_mcs_rw</a>()) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; xct::McsRwSimpleBlock &gt;</a> adaptor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">return</span> sysxct_lock_list.request_page_lock(adaptor, page);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; xct::McsRwExtendedBlock &gt;</a> adaptor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">return</span> sysxct_lock_list.request_page_lock(adaptor, page);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;}</div>
<div class="line"><a name="l01049"></a><span class="lineno"><a class="line" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac779ce5587967f00b09325337578dd24"> 1049</a></span>&#160;<a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> <a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac779ce5587967f00b09325337578dd24">ThreadPimpl::sysxct_batch_page_locks</a>(</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html">xct::SysxctWorkspace</a>* sysxct_workspace,</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  uint32_t lock_count,</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1Page.html">storage::Page</a>** pages) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(sysxct_workspace-&gt;<a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html#a116372be4f325425adbf43b1f9bc93f7">running_sysxct_</a>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keyword">auto</span>&amp; sysxct_lock_list = sysxct_workspace-&gt;<a class="code" href="structfoedus_1_1xct_1_1SysxctWorkspace.html#a9defe6eec5baa9d85b3fd675dd64e211">lock_list_</a>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">is_simple_mcs_rw</a>()) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; xct::McsRwSimpleBlock &gt;</a> adaptor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">return</span> sysxct_lock_list.batch_request_page_locks(adaptor, lock_count, pages);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <a class="code" href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">ThreadPimplMcsAdaptor&lt; xct::McsRwExtendedBlock &gt;</a> adaptor(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordflow">return</span> sysxct_lock_list.batch_request_page_locks(adaptor, lock_count, pages);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;}</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;static_assert(</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keyword">sizeof</span>(<a class="code" href="structfoedus_1_1thread_1_1ThreadControlBlock.html">ThreadControlBlock</a>) &lt;= <a class="code" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea3bd0825749dc6071f3f1299afc25fbc4">soc::ThreadMemoryAnchors::kThreadMemorySize</a>,</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="stringliteral">&quot;ThreadControlBlock is too large.&quot;</span>);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;}  <span class="comment">// namespace thread</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;}  <span class="comment">// namespace foedus</span></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_a873d7bb9094918e5d61742c456dbeb61"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#a873d7bb9094918e5d61742c456dbeb61">foedus::xct::Xct::set_default_rll_for_this_xct</a></div><div class="ttdeci">void set_default_rll_for_this_xct(bool value)</div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00126">xct.hpp:126</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadOptions_html"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadOptions.html">foedus::thread::ThreadOptions</a></div><div class="ttdoc">Set of options about threads and thread-groups. </div><div class="ttdef"><b>Definition:</b> <a href="thread__options_8hpp_source.html#l00031">thread_options.hpp:31</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadControlBlock_html_a261b434597087690ad1f65e407a3a221"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a261b434597087690ad1f65e407a3a221">foedus::thread::ThreadControlBlock::initialize</a></div><div class="ttdeci">void initialize(ThreadId my_thread_id)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00053">thread_pimpl.hpp:53</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ThreadMemoryAnchors_html_a5c5d096932618c5ffb765a9ae839758ea3bd0825749dc6071f3f1299afc25fbc4"><div class="ttname"><a href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea3bd0825749dc6071f3f1299afc25fbc4">foedus::soc::ThreadMemoryAnchors::kThreadMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00411">shared_memory_repo.hpp:411</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPool_html_a4af4c3d3fd7a9353d892e5270a900f1c"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPool.html#a4af4c3d3fd7a9353d892e5270a900f1c">foedus::thread::ThreadPool::get_pimpl</a></div><div class="ttdeci">ThreadPoolPimpl * get_pimpl() const </div><div class="ttdoc">Returns the pimpl of this object. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pool_8hpp_source.html#l00237">thread_pool.hpp:237</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a674a8a8e613dc4e19a626da490c883fc"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a674a8a8e613dc4e19a626da490c883fc">foedus::thread::ThreadPimpl::collect_retired_volatile_page</a></div><div class="ttdeci">void collect_retired_volatile_page(storage::VolatilePagePointer ptr)</div><div class="ttdoc">Keeps the specified volatile page as retired as of the current epoch. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00777">thread_pimpl.cpp:777</a></div></div>
<div class="ttc" id="namespacefoedus_1_1thread_html_ab0a71e2e54e7ef6805b7f1d1d626f9b5"><div class="ttname"><a href="namespacefoedus_1_1thread.html#ab0a71e2e54e7ef6805b7f1d1d626f9b5">foedus::thread::assert_mcs_aligned</a></div><div class="ttdeci">void assert_mcs_aligned(const void *address)</div><div class="ttdoc">ThreadPimpl MCS implementations. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00859">thread_pimpl.cpp:859</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a2cd3cb727c6e211c8e6a72ccb00f3854"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a2cd3cb727c6e211c8e6a72ccb00f3854">foedus::thread::ThreadPimpl::sysxct_page_lock</a></div><div class="ttdeci">ErrorCode sysxct_page_lock(xct::SysxctWorkspace *sysxct_workspace, storage::Page *page)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l01036">thread_pimpl.cpp:1036</a></div></div>
<div class="ttc" id="structfoedus_1_1memory_1_1GlobalVolatilePageResolver_html_a56250946b7719a7bd15532d211eac88f"><div class="ttname"><a href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f">foedus::memory::GlobalVolatilePageResolver::resolve_offset</a></div><div class="ttdeci">storage::Page * resolve_offset(uint8_t numa_node, PagePoolOffset offset) const __attribute__((always_inline))</div><div class="ttdoc">Resolves offset plus NUMA node ID to storage::Page*. </div><div class="ttdef"><b>Definition:</b> <a href="page__resolver_8hpp_source.html#l00120">page_resolver.hpp:120</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a8b5ec40798ea07cf3dbb4def4c6ad142"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a8b5ec40798ea07cf3dbb4def4c6ad142">foedus::thread::ThreadPimpl::task_input_memory_</a></div><div class="ttdeci">void * task_input_memory_</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00383">thread_pimpl.hpp:383</a></div></div>
<div class="ttc" id="group__SYSXCT_html_gaf49955c6d4efe3d92e6e09b4ff890618"><div class="ttname"><a href="group__SYSXCT.html#gaf49955c6d4efe3d92e6e09b4ff890618">foedus::xct::run_nested_sysxct_impl</a></div><div class="ttdeci">ErrorCode run_nested_sysxct_impl(SysxctFunctor *functor, MCS_ADAPTOR mcs_adaptor, uint32_t max_retries, SysxctWorkspace *workspace, UniversalLockId enclosing_max_lock_id, ENCLOSURE_RELEASE_ALL_LOCKS_FUNCTOR enclosure_release_all_locks_functor)</div><div class="ttdoc">Runs a system transaction nested in a user transaction. </div><div class="ttdef"><b>Definition:</b> <a href="sysxct__impl_8hpp_source.html#l00496">sysxct_impl.hpp:496</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a4a95ef1bd710a66e0c24df998f881d04"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04">foedus::thread::ThreadPimpl::install_a_volatile_page</a></div><div class="ttdeci">ErrorCode install_a_volatile_page(storage::DualPagePointer *pointer, storage::Page **installed_page)</div><div class="ttdoc">Installs a volatile page to the given dual pointer as a copy of the snapshot page. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00292">thread_pimpl.cpp:292</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a01914ad44c1e130dd69580da3c04a195"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a01914ad44c1e130dd69580da3c04a195">foedus::kErrorCodeInvalidParameter</a></div><div class="ttdoc">0x0002 : "GENERAL: Invalid parameter given" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00106">error_code.hpp:106</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor_html"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimplMcsAdaptor.html">foedus::thread::ThreadPimplMcsAdaptor</a></div><div class="ttdoc">Implements McsAdaptorConcept over ThreadPimpl. </div><div class="ttdef"><b>Definition:</b> <a href="thread_2fwd_8hpp_source.html#l00038">fwd.hpp:38</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaCoreMemory_html_a6c9bf7d6b21ac33a61d6f7176023ea3a"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a6c9bf7d6b21ac33a61d6f7176023ea3a">foedus::memory::NumaCoreMemory::release_free_volatile_page</a></div><div class="ttdeci">void release_free_volatile_page(PagePoolOffset offset)</div><div class="ttdoc">Returns one free volatile page to local page pool. </div><div class="ttdef"><b>Definition:</b> <a href="numa__core__memory_8cpp_source.html#l00213">numa_core_memory.cpp:213</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1DualPagePointer_html"><div class="ttname"><a href="structfoedus_1_1storage_1_1DualPagePointer.html">foedus::storage::DualPagePointer</a></div><div class="ttdoc">Represents a pointer to another page (usually a child page). </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00271">storage_id.hpp:271</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a30fc7377de865406c4174bcd7be6b616"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a30fc7377de865406c4174bcd7be6b616">foedus::thread::ThreadPimpl::snapshot_file_set_</a></div><div class="ttdeci">cache::SnapshotFileSet snapshot_file_set_</div><div class="ttdoc">Each threads maintains a private set of snapshot file descriptors. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00380">thread_pimpl.hpp:380</a></div></div>
<div class="ttc" id="sysxct__functor_8hpp_html"><div class="ttname"><a href="sysxct__functor_8hpp.html">sysxct_functor.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a6367855f3aa3549b2d7b74adf383c87a"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6367855f3aa3549b2d7b74adf383c87a">foedus::thread::ThreadPimpl::cll_release_all_locks</a></div><div class="ttdeci">void cll_release_all_locks()</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00919">thread_pimpl.cpp:919</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk_html_af96624c49b6035bc5b9254c111c0d07d"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#af96624c49b6035bc5b9254c111c0d07d">foedus::memory::PagePoolOffsetAndEpochChunk::empty</a></div><div class="ttdeci">bool empty() const </div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8hpp_source.html#l00131">page_pool.hpp:131</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaNodeMemory_html_a58cd4f9c594cdcfd85fb3c3e9d47a983"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a58cd4f9c594cdcfd85fb3c3e9d47a983">foedus::memory::NumaNodeMemory::get_core_memory</a></div><div class="ttdeci">NumaCoreMemory * get_core_memory(foedus::thread::ThreadId id) const </div><div class="ttdef"><b>Definition:</b> <a href="numa__node__memory_8hpp_source.html#l00067">numa_node_memory.hpp:67</a></div></div>
<div class="ttc" id="shared__memory__repo_8hpp_html"><div class="ttname"><a href="shared__memory__repo_8hpp.html">shared_memory_repo.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_afc0b909c82e905105f4f9701082a16b8"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8">foedus::xct::Xct::get_current_lock_list</a></div><div class="ttdeci">xct::CurrentLockList * get_current_lock_list()</div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00413">xct.hpp:413</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1XctManager_html_a4578dd6dab7925b95d7810335ae5cec0"><div class="ttname"><a href="classfoedus_1_1xct_1_1XctManager.html#a4578dd6dab7925b95d7810335ae5cec0">foedus::xct::XctManager::get_current_global_epoch_weak</a></div><div class="ttdeci">Epoch get_current_global_epoch_weak() const </div><div class="ttdef"><b>Definition:</b> <a href="xct__manager__pimpl_8cpp_source.html#l00060">xct_manager_pimpl.cpp:60</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaCoreMemory_html_ad09e335bbca636246cf2c3d60ec22570"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570">foedus::memory::NumaCoreMemory::grab_free_volatile_page</a></div><div class="ttdeci">PagePoolOffset grab_free_volatile_page()</div><div class="ttdoc">Acquires one free volatile page from local page pool. </div><div class="ttdef"><b>Definition:</b> <a href="numa__core__memory_8cpp_source.html#l00199">numa_core_memory.cpp:199</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_aba7104a56eaff1c1f8c87f5bb03f4045"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#aba7104a56eaff1c1f8c87f5bb03f4045">foedus::thread::ThreadPimpl::uninitialize_once</a></div><div class="ttdeci">ErrorStack uninitialize_once() override final</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00122">thread_pimpl.cpp:122</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a2b375e7de4d6c9c7b222c45b271126dc"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a2b375e7de4d6c9c7b222c45b271126dc">foedus::thread::Thread::follow_page_pointers_for_write_batch</a></div><div class="ttdeci">ErrorCode follow_page_pointers_for_write_batch(uint16_t batch_size, storage::VolatilePageInit page_initializer, storage::DualPagePointer **pointers, storage::Page **parents, const uint16_t *index_in_parents, storage::Page **out)</div><div class="ttdoc">Batched version of follow_page_pointer with will_modify==true and tolerate_null_pointer==true. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00395">thread_pimpl.cpp:395</a></div></div>
<div class="ttc" id="classfoedus_1_1ErrorStackBatch_html_a1fe18afaafed459feb5c644ba9d7c56e"><div class="ttname"><a href="classfoedus_1_1ErrorStackBatch.html#a1fe18afaafed459feb5c644ba9d7c56e">foedus::ErrorStackBatch::emprace_back</a></div><div class="ttdeci">void emprace_back(ErrorStack &amp;&amp;error_stack)</div><div class="ttdoc">If the given ErrorStack is an error, this method adds it to the end of this batch. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack__batch_8hpp_source.html#l00083">error_stack_batch.hpp:83</a></div></div>
<div class="ttc" id="group__THREAD_html_gga8c4e8dcff52aa5328fe569fa44853d12a72aee7fe031aa8f5648f624a68616ecd"><div class="ttname"><a href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a72aee7fe031aa8f5648f624a68616ecd">foedus::thread::kWaitingForTask</a></div><div class="ttdoc">Idle state, receiving a new task. </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00207">thread_id.hpp:207</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_ace9354af4e27109da6affc4d3bd84419"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#ace9354af4e27109da6affc4d3bd84419">foedus::xct::Xct::set_default_hot_threshold_for_this_xct</a></div><div class="ttdeci">void set_default_hot_threshold_for_this_xct(uint16_t value)</div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00132">xct.hpp:132</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadControlBlock_html_a174d00be0d6482995665c5731da35d79"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a174d00be0d6482995665c5731da35d79">foedus::thread::ThreadControlBlock::mcs_block_current_</a></div><div class="ttdeci">uint32_t mcs_block_current_</div><div class="ttdoc">How many MCS blocks we allocated in this thread&#39;s current xct. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00084">thread_pimpl.hpp:84</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_ad6c2ae1c63499d211f31d3165eeea3cf"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad6c2ae1c63499d211f31d3165eeea3cf">foedus::thread::ThreadPimpl::set_thread_schedule</a></div><div class="ttdeci">void set_thread_schedule()</div><div class="ttdoc">initializes the thread&#39;s policy/priority </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00239">thread_pimpl.cpp:239</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_ae594169d3ecc7b0d4d356d1ed6dfa8b2"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae594169d3ecc7b0d4d356d1ed6dfa8b2">foedus::thread::ThreadPimpl::cll_try_or_acquire_multiple_locks</a></div><div class="ttdeci">ErrorCode cll_try_or_acquire_multiple_locks(xct::LockListPosition upto_pos)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00909">thread_pimpl.cpp:909</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadControlBlock_html_aea90422952de0f11fcb10568cc6ada62"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadControlBlock.html#aea90422952de0f11fcb10568cc6ada62">foedus::thread::ThreadControlBlock::stat_snapshot_cache_hits_</a></div><div class="ttdeci">uint64_t stat_snapshot_cache_hits_</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00145">thread_pimpl.hpp:145</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a92f7bb785b2f0acc72deaab9f186453c"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a92f7bb785b2f0acc72deaab9f186453c">foedus::thread::ThreadPimpl::ThreadPimpl</a></div><div class="ttdeci">ThreadPimpl()=delete</div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a2573902a53ca92a0cf7e19113d5b5979"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a2573902a53ca92a0cf7e19113d5b5979">foedus::thread::Thread::sysxct_batch_page_locks</a></div><div class="ttdeci">ErrorCode sysxct_batch_page_locks(xct::SysxctWorkspace *sysxct_workspace, uint32_t lock_count, storage::Page **pages)</div><div class="ttdoc">Takes a bunch of page locks for a sysxct running under this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00971">thread_pimpl.cpp:971</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a33a1b8b428cd84029b8b377867197ea4"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4">foedus::thread::ThreadPimpl::is_simple_mcs_rw</a></div><div class="ttdeci">bool is_simple_mcs_rw() const </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00282">thread_pimpl.hpp:282</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePool_html"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePool.html">foedus::memory::PagePool</a></div><div class="ttdoc">Page pool for volatile read/write store (VolatilePage) and the read-only bufferpool (SnapshotPage)...</div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8hpp_source.html#l00173">page_pool.hpp:173</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_ab52244fbb6c13b0c0774431af72d482e"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#ab52244fbb6c13b0c0774431af72d482e">foedus::thread::Thread::cll_try_or_acquire_single_lock</a></div><div class="ttdeci">ErrorCode cll_try_or_acquire_single_lock(xct::LockListPosition pos)</div><div class="ttdoc">Methods related to Current Lock List (CLL) These are the only interface in Thread to lock records...</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00850">thread_pimpl.cpp:850</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1XctManager_html_a419a270d62522ede9bd871dd4adc0e2a"><div class="ttname"><a href="classfoedus_1_1xct_1_1XctManager.html#a419a270d62522ede9bd871dd4adc0e2a">foedus::xct::XctManager::get_current_global_epoch</a></div><div class="ttdeci">Epoch get_current_global_epoch() const </div><div class="ttdoc">Returns the current global epoch, the epoch a newly started transaction will be in. </div><div class="ttdef"><b>Definition:</b> <a href="xct__manager__pimpl_8cpp_source.html#l00057">xct_manager_pimpl.cpp:57</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1SysxctWorkspace_html_a9defe6eec5baa9d85b3fd675dd64e211"><div class="ttname"><a href="structfoedus_1_1xct_1_1SysxctWorkspace.html#a9defe6eec5baa9d85b3fd675dd64e211">foedus::xct::SysxctWorkspace::lock_list_</a></div><div class="ttdeci">SysxctLockList lock_list_</div><div class="ttdoc">Lock list for the system transaction. </div><div class="ttdef"><b>Definition:</b> <a href="sysxct__impl_8hpp_source.html#l00460">sysxct_impl.hpp:460</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PageVersion_html_a61318d7aab5c4ca7334ec05f8de168ca"><div class="ttname"><a href="structfoedus_1_1storage_1_1PageVersion.html#a61318d7aab5c4ca7334ec05f8de168ca">foedus::storage::PageVersion::is_retired</a></div><div class="ttdeci">bool is_retired() const __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00140">page.hpp:140</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheHashtable_html_af7762689517cd7a18dd64d8591a3272a"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a">foedus::cache::CacheHashtable::install</a></div><div class="ttdeci">ErrorCode install(storage::SnapshotPagePointer page_id, ContentId content)</div><div class="ttdoc">Called when a cached page is not found. </div><div class="ttdef"><b>Definition:</b> <a href="cache__hashtable_8cpp_source.html#l00114">cache_hashtable.cpp:114</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1XctOptions_html_aca8818f386f22400be2a64de3d9eee6b"><div class="ttname"><a href="structfoedus_1_1xct_1_1XctOptions.html#aca8818f386f22400be2a64de3d9eee6b">foedus::xct::XctOptions::enable_retrospective_lock_list_</a></div><div class="ttdeci">bool enable_retrospective_lock_list_</div><div class="ttdoc">Whether to use Retrospective Lock List (RLL) after aborts. </div><div class="ttdef"><b>Definition:</b> <a href="xct__options_8hpp_source.html#l00123">xct_options.hpp:123</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPoolPimpl_html_a61040189c343e97c3f0ee961df7a9f31"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPoolPimpl.html#a61040189c343e97c3f0ee961df7a9f31">foedus::thread::ThreadPoolPimpl::get_thread_ref</a></div><div class="ttdeci">ThreadRef get_thread_ref(ThreadId id) __attribute__((always_inline))</div><div class="ttdoc">For better performance, but for some reason this method causes an issue in MCS lock. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pool__pimpl_8hpp_source.html#l00092">thread_pool_pimpl.hpp:92</a></div></div>
<div class="ttc" id="namespacefoedus_html"><div class="ttname"><a href="namespacefoedus.html">foedus</a></div><div class="ttdoc">Root package of FOEDUS (Fast Optimistic Engine for Data Unification Services). </div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00044">assert_nd.hpp:44</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaNodeMemory_html_a0541f9ed9fc128fc2c246a4a3bd2b740"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a0541f9ed9fc128fc2c246a4a3bd2b740">foedus::memory::NumaNodeMemory::get_snapshot_pool</a></div><div class="ttdeci">PagePool * get_snapshot_pool()</div><div class="ttdef"><b>Definition:</b> <a href="numa__node__memory_8hpp_source.html#l00058">numa_node_memory.hpp:58</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk_html_acac2755ecb22d4539c3d6bb44538240d"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#acac2755ecb22d4539c3d6bb44538240d">foedus::memory::PagePoolOffsetAndEpochChunk::full</a></div><div class="ttdeci">bool full() const </div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8hpp_source.html#l00132">page_pool.hpp:132</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1VolatilePagePointer_html_a8bb6c37c44056c5f986f6dd164b5b23a"><div class="ttname"><a href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a8bb6c37c44056c5f986f6dd164b5b23a">foedus::storage::VolatilePagePointer::word</a></div><div class="ttdeci">uint64_t word</div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00195">storage_id.hpp:195</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a664a76eb577003d4d4c0d417ecb014cc"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a664a76eb577003d4d4c0d417ecb014cc">foedus::thread::Thread::sysxct_batch_record_locks</a></div><div class="ttdeci">ErrorCode sysxct_batch_record_locks(xct::SysxctWorkspace *sysxct_workspace, storage::VolatilePagePointer page_id, uint32_t lock_count, xct::RwLockableXctId **locks)</div><div class="ttdoc">Takes a bunch of locks in the same page for a sysxct running under this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00961">thread_pimpl.cpp:961</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a383dee9d2971403e9bc3bef4a2d33d44"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a383dee9d2971403e9bc3bef4a2d33d44">foedus::thread::Thread::sysxct_record_lock</a></div><div class="ttdeci">ErrorCode sysxct_record_lock(xct::SysxctWorkspace *sysxct_workspace, storage::VolatilePagePointer page_id, xct::RwLockableXctId *lock)</div><div class="ttdoc">Takes a lock for a sysxct running under this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00955">thread_pimpl.cpp:955</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_ace2e6a593d7b975f1756ce9eec0fd1f2"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#ace2e6a593d7b975f1756ce9eec0fd1f2">foedus::xct::CurrentLockList::release_all_after</a></div><div class="ttdeci">void release_all_after(UniversalLockId address, MCS_RW_IMPL *mcs_rw_impl)</div><div class="ttdoc">Release all locks in CLL whose addresses are canonically ordered before the parameter. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00753">retrospective_lock_list.hpp:753</a></div></div>
<div class="ttc" id="thread__pimpl_8hpp_html"><div class="ttname"><a href="thread__pimpl_8hpp.html">thread_pimpl.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_ab1e93a62b0a6414f6e30c17969af2340"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1e93a62b0a6414f6e30c17969af2340">foedus::thread::ThreadPimpl::node_memory_</a></div><div class="ttdeci">memory::NumaNodeMemory * node_memory_</div><div class="ttdoc">same above </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00347">thread_pimpl.hpp:347</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html">foedus::thread::Thread</a></div><div class="ttdoc">Represents one thread running on one NUMA core. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8hpp_source.html#l00048">thread.hpp:48</a></div></div>
<div class="ttc" id="group__MEMORY_html_gaf7ed7c23d184b14ce978b1775a86dfae"><div class="ttname"><a href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">foedus::memory::PagePoolOffset</a></div><div class="ttdeci">uint32_t PagePoolOffset</div><div class="ttdoc">Offset in PagePool that compactly represents the page address (unlike 8 bytes pointer). </div><div class="ttdef"><b>Definition:</b> <a href="memory__id_8hpp_source.html#l00044">memory_id.hpp:44</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a44232f657701896a24ec4a238d0ab226"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a44232f657701896a24ec4a238d0ab226">foedus::thread::ThreadPimpl::global_volatile_page_resolver_</a></div><div class="ttdeci">memory::GlobalVolatilePageResolver global_volatile_page_resolver_</div><div class="ttdoc">Page resolver to convert all page ID to page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00354">thread_pimpl.hpp:354</a></div></div>
<div class="ttc" id="namespacefoedus_1_1thread_html_a4a3d94e8a7c24f07eb69239505fb5b21"><div class="ttname"><a href="namespacefoedus_1_1thread.html#a4a3d94e8a7c24f07eb69239505fb5b21">foedus::thread::get_mcs_impl</a></div><div class="ttdeci">xct::McsImpl&lt; ThreadPimplMcsAdaptor&lt; RW_BLOCK &gt;, RW_BLOCK &gt; get_mcs_impl(ThreadPimpl *pimpl)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00865">thread_pimpl.cpp:865</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a12c3db0e7d4015e8eaddbae71c90ab7e"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a12c3db0e7d4015e8eaddbae71c90ab7e">foedus::thread::ThreadPimpl::raw_thread_</a></div><div class="ttdeci">std::thread raw_thread_</div><div class="ttdoc">Encapsulates raw thread object. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00366">thread_pimpl.hpp:366</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a533a93844ae692e32571524f656870b3"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a533a93844ae692e32571524f656870b3">foedus::thread::Thread::get_mcs_rw_extended_blocks</a></div><div class="ttdeci">xct::McsRwExtendedBlock * get_mcs_rw_extended_blocks()</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00836">thread_pimpl.cpp:836</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1XctOptions_html_a1e874be55edde5eec583d9745a90000ea7eec21376c24502222d35f7db5484068"><div class="ttname"><a href="structfoedus_1_1xct_1_1XctOptions.html#a1e874be55edde5eec583d9745a90000ea7eec21376c24502222d35f7db5484068">foedus::xct::XctOptions::kMcsImplementationTypeSimple</a></div><div class="ttdef"><b>Definition:</b> <a href="xct__options_8hpp_source.html#l00050">xct_options.hpp:50</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadControlBlock_html"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadControlBlock.html">foedus::thread::ThreadControlBlock</a></div><div class="ttdoc">Shared data of ThreadPimpl. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00048">thread_pimpl.hpp:48</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a62b2d4de6a72644e9e31d35a7f9beae0"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">foedus::memory::EngineMemory::get_global_volatile_page_resolver</a></div><div class="ttdeci">const GlobalVolatilePageResolver &amp; get_global_volatile_page_resolver() const </div><div class="ttdoc">Returns the page resolver to convert volatile page ID to page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00090">engine_memory.hpp:90</a></div></div>
<div class="ttc" id="group__THREAD_html_gga8c4e8dcff52aa5328fe569fa44853d12afa60273eee5d8d1548d0da34187b2a08"><div class="ttname"><a href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12afa60273eee5d8d1548d0da34187b2a08">foedus::thread::kWaitingForExecution</a></div><div class="ttdoc">A client has set a next task. </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00209">thread_id.hpp:209</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1VolatilePagePointer_html"><div class="ttname"><a href="structfoedus_1_1storage_1_1VolatilePagePointer.html">foedus::storage::VolatilePagePointer</a></div><div class="ttdoc">Represents a pointer to a volatile page with modification count for preventing ABA. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00194">storage_id.hpp:194</a></div></div>
<div class="ttc" id="structfoedus_1_1memory_1_1LocalPageResolver_html_aa9d2266686c3a66678b37241a3ac434f"><div class="ttname"><a href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f">foedus::memory::LocalPageResolver::resolve_offset_newpage</a></div><div class="ttdeci">storage::Page * resolve_offset_newpage(PagePoolOffset offset) const __attribute__((always_inline))</div><div class="ttdoc">As the name suggests, this version is for new pages, which don&#39;t have sanity checks. </div><div class="ttdef"><b>Definition:</b> <a href="page__resolver_8hpp_source.html#l00064">page_resolver.hpp:64</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a398ec264786992d102b8edd74d5767b3"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a398ec264786992d102b8edd74d5767b3">foedus::xct::CurrentLockList::get_max_locked_id</a></div><div class="ttdeci">UniversalLockId get_max_locked_id() const </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00385">retrospective_lock_list.hpp:385</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a3d583a33e85e1a33568fa04b409ae2ca"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca">foedus::thread::ThreadPimpl::read_a_snapshot_page</a></div><div class="ttdeci">ErrorCode read_a_snapshot_page(storage::SnapshotPagePointer page_id, storage::Page *buffer) __attribute__((always_inline))</div><div class="ttdoc">Read a snapshot page using the thread-local file descriptor set. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00512">thread_pimpl.hpp:512</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_a1fb740dca84aaaed101bf9f4818c5b4f"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#a1fb740dca84aaaed101bf9f4818c5b4f">foedus::EngineOptions::xct_</a></div><div class="ttdeci">xct::XctOptions xct_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00147">engine_options.hpp:147</a></div></div>
<div class="ttc" id="engine_8hpp_html"><div class="ttname"><a href="engine_8hpp.html">engine.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a1c0d1b2cce940cc22285a906b1076bd3"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1c0d1b2cce940cc22285a906b1076bd3">foedus::thread::ThreadPimpl::snapshot_page_pool_</a></div><div class="ttdeci">memory::PagePool * snapshot_page_pool_</div><div class="ttdoc">shorthand for node_memory_->get_snapshot_pool() </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00351">thread_pimpl.hpp:351</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a4197d522317d6177fd0d9a0ee811cdf5"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4197d522317d6177fd0d9a0ee811cdf5">foedus::thread::ThreadPimpl::cll_giveup_all_locks_after</a></div><div class="ttdeci">void cll_giveup_all_locks_after(xct::UniversalLockId address)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00887">thread_pimpl.cpp:887</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a3ac4e854509ec8a1cf9a70fcba501a68"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a3ac4e854509ec8a1cf9a70fcba501a68">foedus::xct::CurrentLockList::giveup_all_after</a></div><div class="ttdeci">void giveup_all_after(UniversalLockId address, MCS_RW_IMPL *mcs_rw_impl)</div><div class="ttdoc">This gives-up locks in CLL that are not yet taken. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00826">retrospective_lock_list.hpp:826</a></div></div>
<div class="ttc" id="classfoedus_1_1DefaultInitializable_html_ab14b136a7d26f9f499ab9dc15a45a8cb"><div class="ttname"><a href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb">foedus::DefaultInitializable::uninitialize</a></div><div class="ttdeci">ErrorStack uninitialize() override final</div><div class="ttdoc">Typical implementation of Initializable::uninitialize() that provides uninitialize-once semantics...</div><div class="ttdef"><b>Definition:</b> <a href="initializable_8hpp_source.html#l00187">initializable.hpp:187</a></div></div>
<div class="ttc" id="classfoedus_1_1ErrorStack_html"><div class="ttname"><a href="classfoedus_1_1ErrorStack.html">foedus::ErrorStack</a></div><div class="ttdoc">Brings error stacktrace information as return value of functions. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00081">error_stack.hpp:81</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1McsRwSimpleBlock_html"><div class="ttname"><a href="structfoedus_1_1xct_1_1McsRwSimpleBlock.html">foedus::xct::McsRwSimpleBlock</a></div><div class="ttdoc">Reader-writer (RW) MCS lock classes. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00387">xct_id.hpp:387</a></div></div>
<div class="ttc" id="classfoedus_1_1Epoch_html"><div class="ttname"><a href="classfoedus_1_1Epoch.html">foedus::Epoch</a></div><div class="ttdoc">Represents a time epoch. </div><div class="ttdef"><b>Definition:</b> <a href="epoch_8hpp_source.html#l00061">epoch.hpp:61</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk_html_ad99e5b875980b442bf5de61fb022f0ac"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#ad99e5b875980b442bf5de61fb022f0ac">foedus::memory::PagePoolOffsetAndEpochChunk::size</a></div><div class="ttdeci">uint32_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8hpp_source.html#l00130">page_pool.hpp:130</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ThreadMemoryAnchors_html"><div class="ttname"><a href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html">foedus::soc::ThreadMemoryAnchors</a></div><div class="ttdoc">Part of NodeMemoryAnchors for each thread. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00409">shared_memory_repo.hpp:409</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1NumaThreadScope_html"><div class="ttname"><a href="structfoedus_1_1thread_1_1NumaThreadScope.html">foedus::thread::NumaThreadScope</a></div><div class="ttdoc">Pin the current thread to the given NUMA node in this object&#39;s scope. </div><div class="ttdef"><b>Definition:</b> <a href="numa__thread__scope_8hpp_source.html#l00033">numa_thread_scope.hpp:33</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a81e03c29d8931350b4df1fd1f8b9e4b6"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6">foedus::thread::Thread::follow_page_pointer</a></div><div class="ttdeci">ErrorCode follow_page_pointer(storage::VolatilePageInit page_initializer, bool tolerate_null_pointer, bool will_modify, bool take_ptr_set_snapshot, storage::DualPagePointer *pointer, storage::Page **page, const storage::Page *parent, uint16_t index_in_parent)</div><div class="ttdoc">A general method to follow (read) a page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00353">thread_pimpl.cpp:353</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a7e94630e018900343888e94e36c6b14cabf2c9dc4a44ca83095e56776ae6817da"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a7e94630e018900343888e94e36c6b14cabf2c9dc4a44ca83095e56776ae6817da">foedus::thread::Thread::kMaxFindPagesBatch</a></div><div class="ttdoc">Max size for find_or_read_snapshot_pages_batch() etc. </div><div class="ttdef"><b>Definition:</b> <a href="thread_8hpp_source.html#l00055">thread.hpp:55</a></div></div>
<div class="ttc" id="cache__hashtable_8hpp_html"><div class="ttname"><a href="cache__hashtable_8hpp.html">cache_hashtable.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaCoreMemory_html_afb436d68c982228d9e4bc66104b2aa98"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98">foedus::memory::NumaCoreMemory::grab_free_volatile_page_pointer</a></div><div class="ttdeci">storage::VolatilePagePointer grab_free_volatile_page_pointer()</div><div class="ttdoc">Wrapper for grab_free_volatile_page(). </div><div class="ttdef"><b>Definition:</b> <a href="numa__core__memory_8cpp_source.html#l00208">numa_core_memory.cpp:208</a></div></div>
<div class="ttc" id="structfoedus_1_1cache_1_1CacheOptions_html_a896cdc7cbe05ed0d5f77b863228a7c3a"><div class="ttname"><a href="structfoedus_1_1cache_1_1CacheOptions.html#a896cdc7cbe05ed0d5f77b863228a7c3a">foedus::cache::CacheOptions::snapshot_cache_enabled_</a></div><div class="ttdeci">bool snapshot_cache_enabled_</div><div class="ttdoc">Whether to cache the read accesses on snapshot files. </div><div class="ttdef"><b>Definition:</b> <a href="cache__options_8hpp_source.html#l00050">cache_options.hpp:50</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_ac779ce5587967f00b09325337578dd24"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac779ce5587967f00b09325337578dd24">foedus::thread::ThreadPimpl::sysxct_batch_page_locks</a></div><div class="ttdeci">ErrorCode sysxct_batch_page_locks(xct::SysxctWorkspace *sysxct_workspace, uint32_t lock_count, storage::Page **pages)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l01049">thread_pimpl.cpp:1049</a></div></div>
<div class="ttc" id="numa__node__memory_8hpp_html"><div class="ttname"><a href="numa__node__memory_8hpp.html">numa_node_memory.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_ad8236666d8fca6674334d0d166218e5c"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad8236666d8fca6674334d0d166218e5c">foedus::thread::ThreadPimpl::raw_thread_set_</a></div><div class="ttdeci">std::atomic&lt; bool &gt; raw_thread_set_</div><div class="ttdoc">Just to make sure raw_thread_ is set. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00368">thread_pimpl.hpp:368</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadOptions_html_a6aa7925ce950791e71dc66c5cf928e3d"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadOptions.html#a6aa7925ce950791e71dc66c5cf928e3d">foedus::thread::ThreadOptions::overwrite_thread_schedule_</a></div><div class="ttdeci">bool overwrite_thread_schedule_</div><div class="ttdoc">Whether to overwrite policy/priority of worker threads. </div><div class="ttdef"><b>Definition:</b> <a href="thread__options_8hpp_source.html#l00053">thread_options.hpp:53</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html">foedus::thread::ThreadPimpl</a></div><div class="ttdoc">Pimpl object of Thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00159">thread_pimpl.hpp:159</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a7964fa7de54357a65cab8f05c1de4696"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a7964fa7de54357a65cab8f05c1de4696">foedus::thread::ThreadPimpl::mcs_ww_blocks_</a></div><div class="ttdeci">xct::McsWwBlock * mcs_ww_blocks_</div><div class="ttdoc">Pre-allocated MCS blocks. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00387">thread_pimpl.hpp:387</a></div></div>
<div class="ttc" id="group__XCT_html_ga21ce32adf787156f3dd820273426026a"><div class="ttname"><a href="group__XCT.html#ga21ce32adf787156f3dd820273426026a">foedus::xct::UniversalLockId</a></div><div class="ttdeci">uintptr_t UniversalLockId</div><div class="ttdoc">Universally ordered identifier of each lock. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00134">xct_id.hpp:134</a></div></div>
<div class="ttc" id="proc__manager_8hpp_html"><div class="ttname"><a href="proc__manager_8hpp.html">proc_manager.hpp</a></div></div>
<div class="ttc" id="structfoedus_1_1memory_1_1LocalPageResolver_html_afd53ee3eaa00a58b7b0446456d82f4a9"><div class="ttname"><a href="structfoedus_1_1memory_1_1LocalPageResolver.html#afd53ee3eaa00a58b7b0446456d82f4a9">foedus::memory::LocalPageResolver::end_</a></div><div class="ttdeci">PagePoolOffset end_</div><div class="ttdoc">where a valid page entry ends. </div><div class="ttdef"><b>Definition:</b> <a href="page__resolver_8hpp_source.html#l00073">page_resolver.hpp:73</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadControlBlock_html_a0949244710729002906aae535581fa30"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a0949244710729002906aae535581fa30">foedus::thread::ThreadControlBlock::wakeup_cond_</a></div><div class="ttdeci">soc::SharedPolling wakeup_cond_</div><div class="ttdoc">The thread sleeps on this conditional when it has no task. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00104">thread_pimpl.hpp:104</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1RwLockableXctId_html"><div class="ttname"><a href="structfoedus_1_1xct_1_1RwLockableXctId.html">foedus::xct::RwLockableXctId</a></div><div class="ttdoc">The MCS reader-writer lock variant of LockableXctId. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l01132">xct_id.hpp:1132</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_af0ac9dbae9481b295a8492c6d9f6c1d5"><div class="ttname"><a href="classfoedus_1_1Engine.html#af0ac9dbae9481b295a8492c6d9f6c1d5">foedus::Engine::get_soc_count</a></div><div class="ttdeci">soc::SocId get_soc_count() const </div><div class="ttdoc">Shorthand for get_options().thread_.group_count_. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00074">engine.cpp:74</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1StorageOptions_html_ac27b7919baf2e41da1057dd666442e6f"><div class="ttname"><a href="structfoedus_1_1storage_1_1StorageOptions.html#ac27b7919baf2e41da1057dd666442e6f">foedus::storage::StorageOptions::hot_threshold_</a></div><div class="ttdeci">uint64_t hot_threshold_</div><div class="ttdoc">Page hotness >= this value will be considered hot (hybrid CC only). </div><div class="ttdef"><b>Definition:</b> <a href="storage__options_8hpp_source.html#l00056">storage_options.hpp:56</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadControlBlock_html_ac5fa11df3b3c0d7815a36e60edb9b93e"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadControlBlock.html#ac5fa11df3b3c0d7815a36e60edb9b93e">foedus::thread::ThreadControlBlock::uninitialize</a></div><div class="ttdeci">void uninitialize()</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00071">thread_pimpl.hpp:71</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor_html"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html">foedus::thread::ThreadPimplCllReleaseAllFunctor</a></div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00936">thread_pimpl.cpp:936</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a28d4f2f16808e20d2d174f12ff1c7317"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a28d4f2f16808e20d2d174f12ff1c7317">foedus::thread::ThreadPimpl::is_volatile_page_retired</a></div><div class="ttdeci">bool is_volatile_page_retired(storage::VolatilePagePointer ptr)</div><div class="ttdoc">Subroutine of collect_retired_volatile_page() just for assertion. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00818">thread_pimpl.cpp:818</a></div></div>
<div class="ttc" id="classfoedus_1_1ErrorStackBatch_html"><div class="ttname"><a href="classfoedus_1_1ErrorStackBatch.html">foedus::ErrorStackBatch</a></div><div class="ttdoc">Batches zero or more ErrorStack objects to represent in one ErrorStack. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack__batch_8hpp_source.html#l00034">error_stack_batch.hpp:34</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePool_html_af9db36a92eb5116e01545d73cc7e1ab8"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8">foedus::memory::PagePool::get_base</a></div><div class="ttdeci">storage::Page * get_base() const </div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8cpp_source.html#l00119">page_pool.cpp:119</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1DualPagePointer_html_a99e67179a5576a52a4710c700ac309f4"><div class="ttname"><a href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">foedus::storage::DualPagePointer::volatile_pointer_</a></div><div class="ttdeci">VolatilePagePointer volatile_pointer_</div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00308">storage_id.hpp:308</a></div></div>
<div class="ttc" id="engine__options_8hpp_html"><div class="ttname"><a href="engine__options_8hpp.html">engine_options.hpp</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_html_a9220f4aff16817a668990bd85f2f527d"><div class="ttname"><a href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d">foedus::storage::assert_valid_volatile_page</a></div><div class="ttdeci">void assert_valid_volatile_page(const Page *page, uint32_t offset)</div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00407">page.hpp:407</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor_html_a8e6063415cae4400e2460bea361ab593"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a8e6063415cae4400e2460bea361ab593">foedus::thread::ThreadPimplCllReleaseAllFunctor::pimpl_</a></div><div class="ttdeci">ThreadPimpl *const pimpl_</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00941">thread_pimpl.cpp:941</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1SysxctFunctor_html"><div class="ttname"><a href="structfoedus_1_1xct_1_1SysxctFunctor.html">foedus::xct::SysxctFunctor</a></div><div class="ttdoc">A functor representing the logic in a system transaction via virtual-function. </div><div class="ttdef"><b>Definition:</b> <a href="sysxct__functor_8hpp_source.html#l00042">sysxct_functor.hpp:42</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_a069941b140019c23d86092e68cd9b331"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#a069941b140019c23d86092e68cd9b331">foedus::xct::CurrentLockList::release_all_locks</a></div><div class="ttdeci">void release_all_locks(MCS_RW_IMPL *mcs_rw_impl)</div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00473">retrospective_lock_list.hpp:473</a></div></div>
<div class="ttc" id="group__THREAD_html_gga8c4e8dcff52aa5328fe569fa44853d12a949e36ce3a330b30392c68f53455ab4d"><div class="ttname"><a href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a949e36ce3a330b30392c68f53455ab4d">foedus::thread::kWaitingForTerminate</a></div><div class="ttdoc">The thread is requested to terminate. </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00215">thread_id.hpp:215</a></div></div>
<div class="ttc" id="group__THREAD_html_gga8c4e8dcff52aa5328fe569fa44853d12a3b9c59461ee89a25359ea69563068a9b"><div class="ttname"><a href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a3b9c59461ee89a25359ea69563068a9b">foedus::thread::kNotInitialized</a></div><div class="ttdoc">Initial state. </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00205">thread_id.hpp:205</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheHashtable_html_a8e48716623ca44e83cc5ef871c10b131"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheHashtable.html#a8e48716623ca44e83cc5ef871c10b131">foedus::cache::CacheHashtable::find_batch</a></div><div class="ttdeci">ErrorCode find_batch(uint16_t batch_size, const storage::SnapshotPagePointer *page_ids, ContentId *out) const </div><div class="ttdoc">Batched version of find(). </div><div class="ttdef"><b>Definition:</b> <a href="cache__hashtable_8cpp_source.html#l00376">cache_hashtable.cpp:376</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk_html_aae530fb2917cf0f6329ac323f1da7c8c"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#aae530fb2917cf0f6329ac323f1da7c8c">foedus::memory::PagePoolOffsetAndEpochChunk::push_back</a></div><div class="ttdeci">void push_back(PagePoolOffset offset, const Epoch &amp;safe_epoch)</div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8hpp_source.html#l00140">page_pool.hpp:140</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_aa8023ecc3dc58816a010a3415ebfc1dd"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#aa8023ecc3dc58816a010a3415ebfc1dd">foedus::xct::CurrentLockList::try_or_acquire_single_lock</a></div><div class="ttdeci">ErrorCode try_or_acquire_single_lock(LockListPosition pos, MCS_RW_IMPL *mcs_rw_impl)</div><div class="ttdoc">Methods below take or release locks, so they receive MCS_RW_IMPL, a template param. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00569">retrospective_lock_list.hpp:569</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1VolatilePagePointer_html_ac3d7cb1649528efa8b9aa22b63bf52e6"><div class="ttname"><a href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6">foedus::storage::VolatilePagePointer::get_offset</a></div><div class="ttdeci">memory::PagePoolOffset get_offset() const </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00202">storage_id.hpp:202</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a98de2aa47bebca5add3e0550f2c602bf"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a98de2aa47bebca5add3e0550f2c602bf">foedus::thread::ThreadPimpl::find_or_read_snapshot_pages_batch</a></div><div class="ttdeci">ErrorCode find_or_read_snapshot_pages_batch(uint16_t batch_size, const storage::SnapshotPagePointer *page_ids, storage::Page **out)</div><div class="ttdoc">Batched version of find_or_read_a_snapshot_page(). </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00687">thread_pimpl.cpp:687</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheHashtable_html_a9eb2a178b8368240d82ccc787841f200a524de05ad7502c6d46ae15540d1e6334"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheHashtable.html#a9eb2a178b8368240d82ccc787841f200a524de05ad7502c6d46ae15540d1e6334">foedus::cache::CacheHashtable::kMaxFindBatchSize</a></div><div class="ttdoc">Max size for find_batch() </div><div class="ttdef"><b>Definition:</b> <a href="cache__hashtable_8hpp_source.html#l00237">cache_hashtable.hpp:237</a></div></div>
<div class="ttc" id="xct__id_8hpp_html"><div class="ttname"><a href="xct__id_8hpp.html">xct_id.hpp</a></div><div class="ttdoc">Definitions of IDs in this package and a few related constant values. </div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a0dc235d99dfaac00446b613f409de2ab"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0dc235d99dfaac00446b613f409de2ab">foedus::thread::ThreadPimpl::numa_node_</a></div><div class="ttdeci">const ThreadGroupId numa_node_</div><div class="ttdoc">Node this thread belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00333">thread_pimpl.hpp:333</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_a3e40cfe4530b10e87344b42be16927e1"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#a3e40cfe4530b10e87344b42be16927e1">foedus::EngineOptions::storage_</a></div><div class="ttdeci">storage::StorageOptions storage_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00145">engine_options.hpp:145</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_afd87e3c9d855306d2c8115571eb79fa6"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#afd87e3c9d855306d2c8115571eb79fa6">foedus::thread::ThreadPimpl::cll_try_or_acquire_single_lock</a></div><div class="ttdeci">ErrorCode cll_try_or_acquire_single_lock(xct::LockListPosition pos)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00898">thread_pimpl.cpp:898</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a7ac249b3b032751e9bf0903ad7e45255"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a7ac249b3b032751e9bf0903ad7e45255">foedus::thread::Thread::sysxct_page_lock</a></div><div class="ttdeci">ErrorCode sysxct_page_lock(xct::SysxctWorkspace *sysxct_workspace, storage::Page *page)</div><div class="ttdoc">Takes a page lock in the same page for a sysxct running under this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00968">thread_pimpl.cpp:968</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a694a2aaa7515ab45a8c9fa12b709defb"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a694a2aaa7515ab45a8c9fa12b709defb">foedus::thread::ThreadPimpl::flush_retired_volatile_page</a></div><div class="ttdeci">void flush_retired_volatile_page(uint16_t node, Epoch current_epoch, memory::PagePoolOffsetAndEpochChunk *chunk)</div><div class="ttdoc">Subroutine of collect_retired_volatile_page() in case the chunk becomes full. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00789">thread_pimpl.cpp:789</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_ae1bfd239ac92cface8460b6e1ffa1813"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#ae1bfd239ac92cface8460b6e1ffa1813">foedus::thread::ThreadPimpl::engine_</a></div><div class="ttdeci">Engine *const engine_</div><div class="ttdoc">MCS locks methods. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00320">thread_pimpl.hpp:320</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a056563bc302fb45ad684a7fa28d00161"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a056563bc302fb45ad684a7fa28d00161">foedus::thread::ThreadPimpl::sysxct_record_lock</a></div><div class="ttdeci">ErrorCode sysxct_record_lock(xct::SysxctWorkspace *sysxct_workspace, storage::VolatilePagePointer page_id, xct::RwLockableXctId *lock)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l01007">thread_pimpl.cpp:1007</a></div></div>
<div class="ttc" id="error__stack__batch_8hpp_html"><div class="ttname"><a href="error__stack__batch_8hpp.html">error_stack_batch.hpp</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ab6e70410f19ae9632262f6394f3354ff"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ab6e70410f19ae9632262f6394f3354ff">foedus::kErrorCodeCacheNoFreePages</a></div><div class="ttdoc">0x0901 : "SPCACHE: Not enough free snapshot pages. Cleaner is not catching up" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00192">error_code.hpp:192</a></div></div>
<div class="ttc" id="numa__core__memory_8hpp_html"><div class="ttname"><a href="numa__core__memory_8hpp.html">numa_core_memory.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1McsImpl_html"><div class="ttname"><a href="classfoedus_1_1xct_1_1McsImpl.html">foedus::xct::McsImpl</a></div><div class="ttdoc">Implements an MCS-locking Algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="xct__mcs__impl_8hpp_source.html#l00087">xct_mcs_impl.hpp:87</a></div></div>
<div class="ttc" id="group__XCT_html_gaf1e1817b6663c210b329ce1ea57e63fb"><div class="ttname"><a href="group__XCT.html#gaf1e1817b6663c210b329ce1ea57e63fb">foedus::xct::LockListPosition</a></div><div class="ttdeci">uint32_t LockListPosition</div><div class="ttdoc">Index in a lock-list, either RLL or CLL. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00148">xct_id.hpp:148</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_af1783a8b90bfcd0fa87c4947fc406b0b"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#af1783a8b90bfcd0fa87c4947fc406b0b">foedus::thread::ThreadPimpl::cll_release_all_locks_after</a></div><div class="ttdeci">void cll_release_all_locks_after(xct::UniversalLockId address)</div><div class="ttdoc">RW-locks. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00876">thread_pimpl.cpp:876</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga629d4b8103bfb83ef9c11b842a4fd398"><div class="ttname"><a href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">foedus::storage::SnapshotPagePointer</a></div><div class="ttdeci">uint64_t SnapshotPagePointer</div><div class="ttdoc">Page ID of a snapshot page. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00079">storage_id.hpp:79</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a21bff0861e0c12573bc0a6b776857b76"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a21bff0861e0c12573bc0a6b776857b76">foedus::thread::Thread::cll_release_all_locks</a></div><div class="ttdeci">void cll_release_all_locks()</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00841">thread_pimpl.cpp:841</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1McsRwExtendedBlock_html"><div class="ttname"><a href="structfoedus_1_1xct_1_1McsRwExtendedBlock.html">foedus::xct::McsRwExtendedBlock</a></div><div class="ttdoc">Pre-allocated MCS block for extended version of RW-locks. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00513">xct_id.hpp:513</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_aa7cc8b97ee07c0a860f0c5a3247d6ace"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7cc8b97ee07c0a860f0c5a3247d6ace">foedus::thread::ThreadPimpl::holder_</a></div><div class="ttdeci">Thread *const holder_</div><div class="ttdoc">The public object that holds this pimpl object. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00325">thread_pimpl.hpp:325</a></div></div>
<div class="ttc" id="classfoedus_1_1DefaultInitializable_html_a22a0dc3bbbca682c3bc41eace9b6d1ff"><div class="ttname"><a href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff">foedus::DefaultInitializable::initialize</a></div><div class="ttdeci">ErrorStack initialize() override final</div><div class="ttdoc">Typical implementation of Initializable::initialize() that provides initialize-once semantics...</div><div class="ttdef"><b>Definition:</b> <a href="initializable_8hpp_source.html#l00169">initializable.hpp:169</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaCoreMemory_html_a7ea5067e450fa872240cb010ddb65464"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a7ea5067e450fa872240cb010ddb65464">foedus::memory::NumaCoreMemory::release_free_snapshot_page</a></div><div class="ttdeci">void release_free_snapshot_page(PagePoolOffset offset)</div><div class="ttdoc">Same, except it&#39;s for snapshot page. </div><div class="ttdef"><b>Definition:</b> <a href="numa__core__memory_8cpp_source.html#l00230">numa_core_memory.cpp:230</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gae932f87b60cbd230347151ccf33eed86"><div class="ttname"><a href="group__ASSORTED.html#gae932f87b60cbd230347151ccf33eed86">SPINLOCK_WHILE</a></div><div class="ttdeci">#define SPINLOCK_WHILE(x)</div><div class="ttdoc">A macro to busy-wait (spinlock) with occasional pause. </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8hpp_source.html#l00256">assorted_func.hpp:256</a></div></div>
<div class="ttc" id="group__THREAD_html_gga8c4e8dcff52aa5328fe569fa44853d12ae4da726d3c3a0db2b9e657ddcee9444d"><div class="ttname"><a href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12ae4da726d3c3a0db2b9e657ddcee9444d">foedus::thread::kRunningTask</a></div><div class="ttdoc">The thread has picked the task up and is now running. </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00211">thread_id.hpp:211</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_abb36cf6186f747e38d98a13c6419e128"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#abb36cf6186f747e38d98a13c6419e128">foedus::thread::Thread::follow_page_pointers_for_read_batch</a></div><div class="ttdeci">ErrorCode follow_page_pointers_for_read_batch(uint16_t batch_size, storage::VolatilePageInit page_initializer, bool tolerate_null_pointer, bool take_ptr_set_snapshot, storage::DualPagePointer **pointers, storage::Page **parents, const uint16_t *index_in_parents, bool *followed_snapshots, storage::Page **out)</div><div class="ttdoc">Batched version of follow_page_pointer with will_modify==false. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00373">thread_pimpl.cpp:373</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html"><div class="ttname"><a href="classfoedus_1_1Engine.html">foedus::Engine</a></div><div class="ttdoc">Database engine object that holds all resources and provides APIs. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8hpp_source.html#l00109">engine.hpp:109</a></div></div>
<div class="ttc" id="assert__nd_8hpp_html"><div class="ttname"><a href="assert__nd_8hpp.html">assert_nd.hpp</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadOptions_html_afa7106df08eeeaa4147b295e7e125b8c"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadOptions.html#afa7106df08eeeaa4147b295e7e125b8c">foedus::thread::ThreadOptions::thread_priority_</a></div><div class="ttdeci">ThreadPriority thread_priority_</div><div class="ttdoc">Thread priority for worker threads. </div><div class="ttdef"><b>Definition:</b> <a href="thread__options_8hpp_source.html#l00058">thread_options.hpp:58</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadControlBlock_html_a39fd5c3a2e0e0175a52ae24c3339e0c8"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a39fd5c3a2e0e0175a52ae24c3339e0c8">foedus::thread::ThreadControlBlock::mcs_rw_async_mapping_current_</a></div><div class="ttdeci">uint32_t mcs_rw_async_mapping_current_</div><div class="ttdoc">How many async mappings for extended RW lock we have so far. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00087">thread_pimpl.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a8bf8832e627cd97fe92c60d38ed96ac8"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8">foedus::memory::EngineMemory::get_node_memory</a></div><div class="ttdeci">NumaNodeMemoryRef * get_node_memory(foedus::thread::ThreadGroupId group) const </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00076">engine_memory.hpp:76</a></div></div>
<div class="ttc" id="thread__pool_8hpp_html"><div class="ttname"><a href="thread__pool_8hpp.html">thread_pool.hpp</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1DualPagePointer_html_af1b2fd480af916504df50c01faa3e597"><div class="ttname"><a href="structfoedus_1_1storage_1_1DualPagePointer.html#af1b2fd480af916504df50c01faa3e597">foedus::storage::DualPagePointer::snapshot_pointer_</a></div><div class="ttdeci">SnapshotPagePointer snapshot_pointer_</div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00307">storage_id.hpp:307</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_aa7234ffc46e46d480cedc556f0800da6"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa7234ffc46e46d480cedc556f0800da6">foedus::thread::ThreadPimpl::sysxct_batch_record_locks</a></div><div class="ttdeci">ErrorCode sysxct_batch_record_locks(xct::SysxctWorkspace *sysxct_workspace, storage::VolatilePagePointer page_id, uint32_t lock_count, xct::RwLockableXctId **locks)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l01021">thread_pimpl.cpp:1021</a></div></div>
<div class="ttc" id="proc__id_8hpp_html"><div class="ttname"><a href="proc__id_8hpp.html">proc_id.hpp</a></div><div class="ttdoc">Typedefs of ID types used in procedure package. </div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadRef_html"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadRef.html">foedus::thread::ThreadRef</a></div><div class="ttdoc">A view of Thread object for other SOCs and master engine. </div><div class="ttdef"><b>Definition:</b> <a href="thread__ref_8hpp_source.html#l00039">thread_ref.hpp:39</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_ad101b64b189a656c13f92b7fb7bb62d7"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#ad101b64b189a656c13f92b7fb7bb62d7">foedus::thread::ThreadPimpl::log_buffer_</a></div><div class="ttdeci">log::ThreadLogBuffer log_buffer_</div><div class="ttdoc">Thread-private log buffer. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00361">thread_pimpl.hpp:361</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html_ad7029aa2b4a2d3ec394aa0a0b378b088"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html#ad7029aa2b4a2d3ec394aa0a0b378b088">foedus::xct::CurrentLockList::try_or_acquire_multiple_locks</a></div><div class="ttdeci">ErrorCode try_or_acquire_multiple_locks(LockListPosition upto_pos, MCS_RW_IMPL *mcs_rw_impl)</div><div class="ttdoc">Acquire multiple locks up to the given position in canonical order. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00636">retrospective_lock_list.hpp:636</a></div></div>
<div class="ttc" id="xct__mcs__impl_8hpp_html"><div class="ttname"><a href="xct__mcs__impl_8hpp.html">xct_mcs_impl.hpp</a></div></div>
<div class="ttc" id="group__STORAGE_html_structfoedus_1_1storage_1_1VolatilePageInitArguments"><div class="ttname"><a href="group__STORAGE.html#structfoedus_1_1storage_1_1VolatilePageInitArguments">foedus::storage::VolatilePageInitArguments</a></div><div class="ttdoc">Set of arguments, both inputs and outputs, given to each volatile page initializer. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00365">page.hpp:365</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1Page_html"><div class="ttname"><a href="structfoedus_1_1storage_1_1Page.html">foedus::storage::Page</a></div><div class="ttdoc">Just a marker to denote that the memory region represents a data page. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00334">page.hpp:334</a></div></div>
<div class="ttc" id="classfoedus_1_1Epoch_html_a786afd92afdc87b54dfa11ef093f06f3"><div class="ttname"><a href="classfoedus_1_1Epoch.html#a786afd92afdc87b54dfa11ef093f06f3">foedus::Epoch::one_more</a></div><div class="ttdeci">Epoch one_more() const </div><div class="ttdef"><b>Definition:</b> <a href="epoch_8hpp_source.html#l00127">epoch.hpp:127</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a4ff4d49ae69ae490afb0cc09c4c19507"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a4ff4d49ae69ae490afb0cc09c4c19507">foedus::thread::Thread::cll_release_all_locks_after</a></div><div class="ttdeci">void cll_release_all_locks_after(xct::UniversalLockId address)</div><div class="ttdoc">Release all locks in CLL of this thread whose addresses are canonically ordered before the parameter...</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00844">thread_pimpl.cpp:844</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a94b9b35db175ad18d7e889b3bd57ea85"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a94b9b35db175ad18d7e889b3bd57ea85">foedus::thread::Thread::cll_giveup_all_locks_after</a></div><div class="ttdeci">void cll_giveup_all_locks_after(xct::UniversalLockId address)</div><div class="ttdoc">This gives-up locks in CLL that are not yet taken. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00847">thread_pimpl.cpp:847</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PageHeader_html_a44c12d47d4b478bac2076df4760fc990"><div class="ttname"><a href="structfoedus_1_1storage_1_1PageHeader.html#a44c12d47d4b478bac2076df4760fc990">foedus::storage::PageHeader::page_version_</a></div><div class="ttdeci">PageVersion page_version_</div><div class="ttdoc">Used in several storage types as concurrency control mechanism for the page. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00272">page.hpp:272</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1XctOptions_html_a0c631d601027cf678dfd192f74cd348b"><div class="ttname"><a href="structfoedus_1_1xct_1_1XctOptions.html#a0c631d601027cf678dfd192f74cd348b">foedus::xct::XctOptions::hot_threshold_for_retrospective_lock_list_</a></div><div class="ttdeci">uint16_t hot_threshold_for_retrospective_lock_list_</div><div class="ttdoc">When we construct Retrospective Lock List (RLL) after aborts, we add read-locks on records whose hotn...</div><div class="ttdef"><b>Definition:</b> <a href="xct__options_8hpp_source.html#l00135">xct_options.hpp:135</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1VolatilePagePointer_html_a273a4c4f51c06ebc91663329742e1c69"><div class="ttname"><a href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69">foedus::storage::VolatilePagePointer::set</a></div><div class="ttdeci">void set(uint8_t numa_node, memory::PagePoolOffset offset)</div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00212">storage_id.hpp:212</a></div></div>
<div class="ttc" id="thread_8hpp_html"><div class="ttname"><a href="thread_8hpp.html">thread.hpp</a></div></div>
<div class="ttc" id="group__THREAD_html_ga1622c6d8c64ca80f51c1bef5190ec4fa"><div class="ttname"><a href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa">foedus::thread::decompose_numa_node</a></div><div class="ttdeci">ThreadGroupId decompose_numa_node(ThreadId global_id)</div><div class="ttdoc">Extracts NUMA node ID from the given globally unique ID of Thread (core). </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00131">thread_id.hpp:131</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_aca66ae9959651b7c6fa86a75db287f54"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#aca66ae9959651b7c6fa86a75db287f54">foedus::xct::Xct::get_sysxct_workspace</a></div><div class="ttdeci">SysxctWorkspace * get_sysxct_workspace() const </div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00142">xct.hpp:142</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a9b77133f66157bca81a49caeca9a9904"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904">foedus::thread::ThreadPimpl::follow_page_pointer</a></div><div class="ttdeci">ErrorCode follow_page_pointer(storage::VolatilePageInit page_initializer, bool tolerate_null_pointer, bool will_modify, bool take_ptr_set_snapshot, storage::DualPagePointer *pointer, storage::Page **page, const storage::Page *parent, uint16_t index_in_parent)</div><div class="ttdoc">A general method to follow (read) a page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00411">thread_pimpl.cpp:411</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a498a6a07313bf9fbb2c0e3d02f075221"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221">foedus::thread::ThreadPimpl::run_nested_sysxct</a></div><div class="ttdeci">ErrorCode run_nested_sysxct(xct::SysxctFunctor *functor, uint32_t max_retries)</div><div class="ttdoc">Sysxct-related. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00980">thread_pimpl.cpp:980</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a0b56e96991f936feba47c29f61c0fbcb"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0b56e96991f936feba47c29f61c0fbcb">foedus::thread::ThreadPimpl::local_volatile_page_resolver_</a></div><div class="ttdeci">memory::LocalPageResolver local_volatile_page_resolver_</div><div class="ttdoc">Page resolver to convert only local page ID to page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00356">thread_pimpl.hpp:356</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a73a9dfcab4771b1a5c6362406b27faeb"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a73a9dfcab4771b1a5c6362406b27faeb">foedus::thread::ThreadPimpl::handle_tasks</a></div><div class="ttdeci">void handle_tasks()</div><div class="ttdoc">Main routine of the worker thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00163">thread_pimpl.cpp:163</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a213680d8d683ac663b847d09f1c0e9e3"><div class="ttname"><a href="classfoedus_1_1Engine.html#a213680d8d683ac663b847d09f1c0e9e3">foedus::Engine::get_proc_manager</a></div><div class="ttdeci">proc::ProcManager * get_proc_manager() const </div><div class="ttdoc">See System and User Procedures. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00051">engine.cpp:51</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a2ddd0cd462e4ae138f0e572106ad098c"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a2ddd0cd462e4ae138f0e572106ad098c">foedus::kErrorCodeMemoryNoFreePages</a></div><div class="ttdoc">0x0301 : "MEMORY : Not enough free volatile pages. Check the config of MemoryOptions" ...</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00142">error_code.hpp:142</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePool_html_a802171ff0578875748d20b4e9c8c9463"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePool.html#a802171ff0578875748d20b4e9c8c9463">foedus::memory::PagePool::release</a></div><div class="ttdeci">void release(uint32_t desired_release_count, PagePoolOffsetChunk *chunk)</div><div class="ttdoc">Returns the specified number of free pages from the chunk. </div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8cpp_source.html#l00134">page_pool.cpp:134</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaa05e01910d3ea9909f1a64afd62729fb"><div class="ttname"><a href="group__ASSORTED.html#gaa05e01910d3ea9909f1a64afd62729fb">foedus::assorted::spinlock_yield</a></div><div class="ttdeci">void spinlock_yield()</div><div class="ttdoc">Invoke _mm_pause(), x86 PAUSE instruction, or something equivalent in the env. </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8cpp_source.html#l00193">assorted_func.cpp:193</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga67390b22b0afbe5a4938df9847eafda9"><div class="ttname"><a href="group__ERRORCODES.html#ga67390b22b0afbe5a4938df9847eafda9">SUMMARIZE_ERROR_BATCH</a></div><div class="ttdeci">#define SUMMARIZE_ERROR_BATCH(x)</div><div class="ttdoc">This macro calls ErrorStackBatch::summarize() with automatically provided parameters. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack__batch_8hpp_source.html#l00136">error_stack_batch.hpp:136</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaCoreMemory_html_ad0624fe34e52c0904ee449c97f0325c5"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad0624fe34e52c0904ee449c97f0325c5">foedus::memory::NumaCoreMemory::get_retired_volatile_pool_chunk</a></div><div class="ttdeci">PagePoolOffsetAndEpochChunk * get_retired_volatile_pool_chunk(uint16_t node)</div><div class="ttdef"><b>Definition:</b> <a href="numa__core__memory_8cpp_source.html#l00253">numa_core_memory.cpp:253</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a1dd7f177602e25a5cd1318723825c861"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dd7f177602e25a5cd1318723825c861">foedus::thread::ThreadPimpl::mcs_rw_simple_blocks_</a></div><div class="ttdeci">xct::McsRwSimpleBlock * mcs_rw_simple_blocks_</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00388">thread_pimpl.hpp:388</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a48d5e1f7ce2f70161c253f650c75ed95"><div class="ttname"><a href="classfoedus_1_1Engine.html#a48d5e1f7ce2f70161c253f650c75ed95">foedus::Engine::get_xct_manager</a></div><div class="ttdeci">xct::XctManager * get_xct_manager() const </div><div class="ttdoc">See Transaction Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00061">engine.cpp:61</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ThreadMemoryAnchors_html_a5c5d096932618c5ffb765a9ae839758ea9639075ff64fbe04fd9838a70e156ab3"><div class="ttname"><a href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea9639075ff64fbe04fd9838a70e156ab3">foedus::soc::ThreadMemoryAnchors::kTaskOutputMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00413">shared_memory_repo.hpp:413</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaNodeMemory_html_ad8fddde9484a0ceb8d31cd8eca323c77"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaNodeMemory.html#ad8fddde9484a0ceb8d31cd8eca323c77">foedus::memory::NumaNodeMemory::get_snapshot_cache_table</a></div><div class="ttdeci">cache::CacheHashtable * get_snapshot_cache_table()</div><div class="ttdef"><b>Definition:</b> <a href="numa__node__memory_8hpp_source.html#l00059">numa_node_memory.hpp:59</a></div></div>
<div class="ttc" id="xct__manager_8hpp_html"><div class="ttname"><a href="xct__manager_8hpp.html">xct_manager.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a741208e803d0a0bb5f979ebb099d2a8d"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a741208e803d0a0bb5f979ebb099d2a8d">foedus::thread::ThreadPimpl::initialize_once</a></div><div class="ttdeci">ErrorStack initialize_once() override final</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00081">thread_pimpl.cpp:81</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_ac881d08d38d5332ddababbef597e67a9"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#ac881d08d38d5332ddababbef597e67a9">foedus::thread::ThreadPimpl::id_</a></div><div class="ttdeci">const ThreadId id_</div><div class="ttdoc">Unique ID of this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00330">thread_pimpl.hpp:330</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a26c718d661316827c8efd219b743e227"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a26c718d661316827c8efd219b743e227">foedus::thread::ThreadPimpl::current_xct_</a></div><div class="ttdeci">xct::Xct current_xct_</div><div class="ttdoc">Current transaction this thread is conveying. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00375">thread_pimpl.hpp:375</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaCoreMemory_html_ac3e2f6d24f2b0f5c04d2cde48db11f6a"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ac3e2f6d24f2b0f5c04d2cde48db11f6a">foedus::memory::NumaCoreMemory::grab_free_snapshot_page</a></div><div class="ttdeci">PagePoolOffset grab_free_snapshot_page()</div><div class="ttdoc">Same, except it&#39;s for snapshot page. </div><div class="ttdef"><b>Definition:</b> <a href="numa__core__memory_8cpp_source.html#l00221">numa_core_memory.cpp:221</a></div></div>
<div class="ttc" id="group__THREAD_html_gad998a8a9811ac9f9bd7c88bea3ce1d9b"><div class="ttname"><a href="group__THREAD.html#gad998a8a9811ac9f9bd7c88bea3ce1d9b">foedus::thread::ThreadGlobalOrdinal</a></div><div class="ttdeci">uint16_t ThreadGlobalOrdinal</div><div class="ttdoc">Typedef for a globally and contiguously numbered ID of thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00098">thread_id.hpp:98</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a16c6375f66e9f177c908dc1fbc132681"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681">foedus::thread::ThreadPimpl::find_or_read_a_snapshot_page</a></div><div class="ttdeci">ErrorCode find_or_read_a_snapshot_page(storage::SnapshotPagePointer page_id, storage::Page **out)</div><div class="ttdoc">Find the given page in snapshot cache, reading it if not found. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00647">thread_pimpl.cpp:647</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaaa260096daf8620266c2799d1f5a0270"><div class="ttname"><a href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">foedus::assorted::os_error</a></div><div class="ttdeci">std::string os_error()</div><div class="ttdoc">Thread-safe strerror(errno). </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8cpp_source.html#l00067">assorted_func.cpp:67</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="classfoedus_1_1proc_1_1ProcManager_html_a22da584f85fbfd412c0637f737e32740"><div class="ttname"><a href="classfoedus_1_1proc_1_1ProcManager.html#a22da584f85fbfd412c0637f737e32740">foedus::proc::ProcManager::get_proc</a></div><div class="ttdeci">ErrorStack get_proc(const ProcName &amp;name, Proc *out)</div><div class="ttdoc">Returns the function pointer of the specified procedure. </div><div class="ttdef"><b>Definition:</b> <a href="proc__manager_8cpp_source.html#l00040">proc_manager.cpp:40</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_a97a206187b610b15a6edbfc75a384b1a"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#a97a206187b610b15a6edbfc75a384b1a">foedus::EngineOptions::thread_</a></div><div class="ttdeci">thread::ThreadOptions thread_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00146">engine_options.hpp:146</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_abae2ae5210db8eda39a1507940bf7352"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352">foedus::xct::Xct::get_isolation_level</a></div><div class="ttdeci">IsolationLevel get_isolation_level() const </div><div class="ttdoc">Returns the level of isolation for this transaction. </div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00149">xct.hpp:149</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1VolatilePagePointer_html_ad9d25c0d8211f93db82d8cefe9d6ead7"><div class="ttname"><a href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7">foedus::storage::VolatilePagePointer::is_null</a></div><div class="ttdeci">bool is_null() const </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00210">storage_id.hpp:210</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a0c5065125240df0f59f2cd04ff5f8808"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a0c5065125240df0f59f2cd04ff5f8808">foedus::memory::EngineMemory::get_local_memory</a></div><div class="ttdeci">NumaNodeMemory * get_local_memory() const </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00073">engine_memory.hpp:73</a></div></div>
<div class="ttc" id="group__THREAD_html_ga709a79fc1ed05a3543d8309ba391da93"><div class="ttname"><a href="group__THREAD.html#ga709a79fc1ed05a3543d8309ba391da93">foedus::thread::ThreadId</a></div><div class="ttdeci">uint16_t ThreadId</div><div class="ttdoc">Typedef for a global ID of Thread (core), which is unique across NUMA nodes. </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00080">thread_id.hpp:80</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadControlBlock_html_ada5ae07c10b92acbab636eb0d221557b"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadControlBlock.html#ada5ae07c10b92acbab636eb0d221557b">foedus::thread::ThreadControlBlock::stat_snapshot_cache_misses_</a></div><div class="ttdeci">uint64_t stat_snapshot_cache_misses_</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00146">thread_pimpl.hpp:146</a></div></div>
<div class="ttc" id="sysxct__impl_8hpp_html"><div class="ttname"><a href="sysxct__impl_8hpp.html">sysxct_impl.hpp</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadControlBlock_html_a21f70ae9d374cc919ab50bb410172415"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadControlBlock.html#a21f70ae9d374cc919ab50bb410172415">foedus::thread::ThreadControlBlock::status_</a></div><div class="ttdeci">ThreadStatus status_</div><div class="ttdoc">Impersonation status of this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00110">thread_pimpl.hpp:110</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1XctManager_html_aa75089821b48c98a00cd7e4ddc0615da"><div class="ttname"><a href="classfoedus_1_1xct_1_1XctManager.html#aa75089821b48c98a00cd7e4ddc0615da">foedus::xct::XctManager::advance_current_global_epoch</a></div><div class="ttdeci">void advance_current_global_epoch()</div><div class="ttdoc">Requests to advance the current global epoch as soon as possible and blocks until it actually does...</div><div class="ttdef"><b>Definition:</b> <a href="xct__manager__pimpl_8cpp_source.html#l00070">xct_manager_pimpl.cpp:70</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1XctOptions_html_ad96ba092ce5e33bca1625f40850ead73"><div class="ttname"><a href="structfoedus_1_1xct_1_1XctOptions.html#ad96ba092ce5e33bca1625f40850ead73">foedus::xct::XctOptions::mcs_implementation_type_</a></div><div class="ttdeci">uint16_t mcs_implementation_type_</div><div class="ttdoc">Defines which implementation of MCS locks to use for RW locks. </div><div class="ttdef"><b>Definition:</b> <a href="xct__options_8hpp_source.html#l00164">xct_options.hpp:164</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a1b1ea3713f779b1c3f6215533145ef26"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a1b1ea3713f779b1c3f6215533145ef26">foedus::thread::Thread::get_mcs_rw_simple_blocks</a></div><div class="ttdeci">xct::McsRwSimpleBlock * get_mcs_rw_simple_blocks()</div><div class="ttdoc">Unconditionally takes MCS lock on the given mcs_lock. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00833">thread_pimpl.cpp:833</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_ae9ad7ab6a3df52b0e9f0e50ede6faa2e"><div class="ttname"><a href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e">foedus::Engine::get_soc_manager</a></div><div class="ttdeci">soc::SocManager * get_soc_manager() const </div><div class="ttdoc">See SOC and IPC. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00059">engine.cpp:59</a></div></div>
<div class="ttc" id="thread__pool__pimpl_8hpp_html"><div class="ttname"><a href="thread__pool__pimpl_8hpp.html">thread_pool_pimpl.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_a339fdd767efdfed418e32792b560b373"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#a339fdd767efdfed418e32792b560b373">foedus::xct::Xct::set_default_rll_threshold_for_this_xct</a></div><div class="ttdeci">void set_default_rll_threshold_for_this_xct(uint16_t value)</div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00139">xct.hpp:139</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaNodeMemoryRef_html_a70b68580143ce771f5b5b1f9a209f774"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774">foedus::memory::NumaNodeMemoryRef::get_volatile_pool</a></div><div class="ttdeci">PagePool * get_volatile_pool()</div><div class="ttdef"><b>Definition:</b> <a href="numa__node__memory_8hpp_source.html#l00175">numa_node_memory.hpp:175</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1Hex_html"><div class="ttname"><a href="structfoedus_1_1assorted_1_1Hex.html">foedus::assorted::Hex</a></div><div class="ttdoc">Convenient way of writing hex integers to stream. </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8hpp_source.html#l00124">assorted_func.hpp:124</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a0f8e120dfd26566418bbb9057f8c5b20"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a0f8e120dfd26566418bbb9057f8c5b20">foedus::thread::ThreadPimpl::mcs_rw_extended_blocks_</a></div><div class="ttdeci">xct::McsRwExtendedBlock * mcs_rw_extended_blocks_</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00389">thread_pimpl.hpp:389</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_ab1611b1e29b58ee7aaf3b88cc57f9343"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343">foedus::thread::ThreadPimpl::place_a_new_volatile_page</a></div><div class="ttdeci">storage::Page * place_a_new_volatile_page(memory::PagePoolOffset new_offset, storage::DualPagePointer *pointer)</div><div class="ttdoc">Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v...</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00317">thread_pimpl.cpp:317</a></div></div>
<div class="ttc" id="atomic__fences_8hpp_html"><div class="ttname"><a href="atomic__fences_8hpp.html">atomic_fences.hpp</a></div><div class="ttdoc">Atomic fence methods and load/store with fences that work for both C++11/non-C++11 code...</div></div>
<div class="ttc" id="group__STORAGE_html_gab1f01cb8d7e103171a991936c4805486"><div class="ttname"><a href="group__STORAGE.html#gab1f01cb8d7e103171a991936c4805486">foedus::storage::VolatilePageInit</a></div><div class="ttdeci">void(* VolatilePageInit)(const VolatilePageInitArguments &amp;args)</div><div class="ttdoc">A function pointer to initialize a volatile page. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00387">page.hpp:387</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadOptions_html_aad75e714583f8ece41a49e47930d0dcb"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadOptions.html#aad75e714583f8ece41a49e47930d0dcb">foedus::thread::ThreadOptions::thread_policy_</a></div><div class="ttdeci">ThreadPolicy thread_policy_</div><div class="ttdoc">Thread policy for worker threads. </div><div class="ttdef"><b>Definition:</b> <a href="thread__options_8hpp_source.html#l00056">thread_options.hpp:56</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a89fe2af2a31e70a89e143cbc2d687ffb"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a89fe2af2a31e70a89e143cbc2d687ffb">foedus::thread::ThreadPimpl::follow_page_pointers_for_read_batch</a></div><div class="ttdeci">ErrorCode follow_page_pointers_for_read_batch(uint16_t batch_size, storage::VolatilePageInit page_initializer, bool tolerate_null_pointer, bool take_ptr_set_snapshot, storage::DualPagePointer **pointers, storage::Page **parents, const uint16_t *index_in_parents, bool *followed_snapshots, storage::Page **out)</div><div class="ttdoc">Batched version of follow_page_pointer with will_modify==false. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00484">thread_pimpl.cpp:484</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaf84f9944a16c5848f69beacdfeedf939"><div class="ttname"><a href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">foedus::assorted::memory_fence_acquire</a></div><div class="ttdeci">void memory_fence_acquire()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acquire). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00046">atomic_fences.hpp:46</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a052ae65bb017f9f77741db58bcbcf936"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a052ae65bb017f9f77741db58bcbcf936">foedus::thread::ThreadPimpl::mcs_rw_async_mappings_</a></div><div class="ttdeci">xct::McsRwAsyncMapping * mcs_rw_async_mappings_</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00390">thread_pimpl.hpp:390</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1Page_html_abee44ea141b30e613f3de40831d6ff8e"><div class="ttname"><a href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e">foedus::storage::Page::get_header</a></div><div class="ttdeci">PageHeader &amp; get_header()</div><div class="ttdoc">At least the basic header exists in all pages. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00336">page.hpp:336</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_aa2dced4e9409f69e3d5327c653807362"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#aa2dced4e9409f69e3d5327c653807362">foedus::thread::ThreadPimpl::task_output_memory_</a></div><div class="ttdeci">void * task_output_memory_</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00384">thread_pimpl.hpp:384</a></div></div>
<div class="ttc" id="numa__thread__scope_8hpp_html"><div class="ttname"><a href="numa__thread__scope_8hpp.html">numa_thread_scope.hpp</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1SysxctWorkspace_html_a116372be4f325425adbf43b1f9bc93f7"><div class="ttname"><a href="structfoedus_1_1xct_1_1SysxctWorkspace.html#a116372be4f325425adbf43b1f9bc93f7">foedus::xct::SysxctWorkspace::running_sysxct_</a></div><div class="ttdeci">bool running_sysxct_</div><div class="ttdoc">Whether we are already running a sysxct using this workspace. </div><div class="ttdef"><b>Definition:</b> <a href="sysxct__impl_8hpp_source.html#l00452">sysxct_impl.hpp:452</a></div></div>
<div class="ttc" id="group__THREAD_html_gga8c4e8dcff52aa5328fe569fa44853d12a348b1e174a3d845ea1c808defd1de2a6"><div class="ttname"><a href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12a348b1e174a3d845ea1c808defd1de2a6">foedus::thread::kWaitingForClientRelease</a></div><div class="ttdoc">The thread has completed the task and set the result. </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00213">thread_id.hpp:213</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1CurrentLockList_html"><div class="ttname"><a href="classfoedus_1_1xct_1_1CurrentLockList.html">foedus::xct::CurrentLockList</a></div><div class="ttdoc">Sorted list of all locks, either read-lock or write-lock, taken in the current run. </div><div class="ttdef"><b>Definition:</b> <a href="retrospective__lock__list_8hpp_source.html#l00309">retrospective_lock_list.hpp:309</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor_html_a2723c5bae3f50df9b36b672f2ceb6564"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a2723c5bae3f50df9b36b672f2ceb6564">foedus::thread::ThreadPimplCllReleaseAllFunctor::ThreadPimplCllReleaseAllFunctor</a></div><div class="ttdeci">ThreadPimplCllReleaseAllFunctor(ThreadPimpl *pimpl)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00937">thread_pimpl.cpp:937</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1XctOptions_html_a1e874be55edde5eec583d9745a90000ea10c91c38fa2a5246c11348523f892d7e"><div class="ttname"><a href="structfoedus_1_1xct_1_1XctOptions.html#a1e874be55edde5eec583d9745a90000ea10c91c38fa2a5246c11348523f892d7e">foedus::xct::XctOptions::kMcsImplementationTypeExtended</a></div><div class="ttdef"><b>Definition:</b> <a href="xct__options_8hpp_source.html#l00051">xct_options.hpp:51</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_af52661009b044c7a6553234720d71923"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#af52661009b044c7a6553234720d71923">foedus::thread::ThreadPimpl::get_thread_ref</a></div><div class="ttdeci">ThreadRef get_thread_ref(ThreadId id)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00767">thread_pimpl.cpp:767</a></div></div>
<div class="ttc" id="classfoedus_1_1assorted_1_1FixedString_html"><div class="ttname"><a href="classfoedus_1_1assorted_1_1FixedString.html">foedus::assorted::FixedString&lt; 60 &gt;</a></div></div>
<div class="ttc" id="group__PROC_html_ga7aa50117a254b660df879d65d1d9964b"><div class="ttname"><a href="group__PROC.html#ga7aa50117a254b660df879d65d1d9964b">foedus::proc::Proc</a></div><div class="ttdeci">ErrorStack(* Proc)(const ProcArguments &amp;args)</div><div class="ttdoc">A function pointer of a user/system stored procedure. </div><div class="ttdef"><b>Definition:</b> <a href="proc__id_8hpp_source.html#l00113">proc_id.hpp:113</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk_html"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html">foedus::memory::PagePoolOffsetAndEpochChunk</a></div><div class="ttdoc">Used to store an epoch value with each entry in PagePoolOffsetChunk. </div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8hpp_source.html#l00108">page_pool.hpp:108</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePool_html_a18916c76eea7aa49572e69e48e75717e"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e">foedus::memory::PagePool::get_resolver</a></div><div class="ttdeci">const LocalPageResolver &amp; get_resolver() const </div><div class="ttdoc">Gives an object to resolve an offset in this page pool (thus local) to an actual pointer and vice ver...</div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8cpp_source.html#l00146">page_pool.cpp:146</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_a7f299489d8dd719eb055ce2ef29309b8"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8">foedus::xct::Xct::acquire_local_work_memory</a></div><div class="ttdeci">ErrorCode acquire_local_work_memory(uint32_t size, void **out, uint32_t alignment=8)</div><div class="ttdoc">Get a tentative work memory of the specified size from pre-allocated thread-private memory...</div><div class="ttdef"><b>Definition:</b> <a href="xct_8hpp_source.html#l00397">xct.hpp:397</a></div></div>
<div class="ttc" id="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor_html_a3c10a09a949ac94c2134e14e30d70e1e"><div class="ttname"><a href="structfoedus_1_1thread_1_1ThreadPimplCllReleaseAllFunctor.html#a3c10a09a949ac94c2134e14e30d70e1e">foedus::thread::ThreadPimplCllReleaseAllFunctor::operator()</a></div><div class="ttdeci">void operator()() const </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00938">thread_pimpl.cpp:938</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a28f34cbb16ac60050a2e42332058b3eb"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a28f34cbb16ac60050a2e42332058b3eb">foedus::thread::ThreadPimpl::is_stop_requested</a></div><div class="ttdeci">bool is_stop_requested() const </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00158">thread_pimpl.cpp:158</a></div></div>
<div class="ttc" id="thread__log__buffer_8hpp_html"><div class="ttname"><a href="thread__log__buffer_8hpp.html">thread_log_buffer.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a6ff575610172c3b1ed337665a277f761"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761">foedus::thread::ThreadPimpl::cll_get_max_locked_id</a></div><div class="ttdeci">xct::UniversalLockId cll_get_max_locked_id() const </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00930">thread_pimpl.cpp:930</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PageHeader_html_ac0baf9ee636d13c02d334ce779cc6a8f"><div class="ttname"><a href="structfoedus_1_1storage_1_1PageHeader.html#ac0baf9ee636d13c02d334ce779cc6a8f">foedus::storage::PageHeader::snapshot_</a></div><div class="ttdeci">bool snapshot_</div><div class="ttdoc">Whether this page image is of a snapshot page. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00211">page.hpp:211</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1VolatilePagePointer_html_adb76c33cd20ea764c7a8e554e8201077"><div class="ttname"><a href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077">foedus::storage::VolatilePagePointer::get_numa_node</a></div><div class="ttdeci">uint8_t get_numa_node() const </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00201">storage_id.hpp:201</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a3c43ac83a4cdcc3e48d8b125dfcff963"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963">foedus::thread::ThreadPimpl::on_snapshot_cache_miss</a></div><div class="ttdeci">ErrorCode on_snapshot_cache_miss(storage::SnapshotPagePointer page_id, memory::PagePoolOffset *pool_offset)</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00741">thread_pimpl.cpp:741</a></div></div>
<div class="ttc" id="group__PROC_html_structfoedus_1_1proc_1_1ProcArguments"><div class="ttname"><a href="group__PROC.html#structfoedus_1_1proc_1_1ProcArguments">foedus::proc::ProcArguments</a></div><div class="ttdoc">Set of arguments, both inputs and outputs, given to each procedure. </div><div class="ttdef"><b>Definition:</b> <a href="proc__id_8hpp_source.html#l00081">proc_id.hpp:81</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a2a5e6b008138d755e7e401f25927400c"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c">foedus::thread::Thread::run_nested_sysxct</a></div><div class="ttdeci">ErrorCode run_nested_sysxct(xct::SysxctFunctor *functor, uint32_t max_retries=0)</div><div class="ttdoc">Methods related to System transactions (sysxct) nested under this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00952">thread_pimpl.cpp:952</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_ae22e59b0c58a7f6fa519e2c4149afd9c"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ae22e59b0c58a7f6fa519e2c4149afd9c">foedus::soc::SharedMemoryRepo::get_thread_memory_anchors</a></div><div class="ttdeci">ThreadMemoryAnchors * get_thread_memory_anchors(thread::ThreadId thread_id)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00526">shared_memory_repo.hpp:526</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a4ef6a79e56890341d855cfca877bf934"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4ef6a79e56890341d855cfca877bf934">foedus::thread::ThreadPimpl::core_memory_</a></div><div class="ttdeci">memory::NumaCoreMemory * core_memory_</div><div class="ttdoc">Private memory repository of this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00345">thread_pimpl.hpp:345</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a684b8acdccad684b32c4ea97be009f8e"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a684b8acdccad684b32c4ea97be009f8e">foedus::thread::ThreadPimpl::simple_mcs_rw_</a></div><div class="ttdeci">bool simple_mcs_rw_</div><div class="ttdoc">shortcut for engine_->get_options().xct_.mcs_implementation_type_ == simple </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00338">thread_pimpl.hpp:338</a></div></div>
<div class="ttc" id="engine__memory_8hpp_html"><div class="ttname"><a href="engine__memory_8hpp.html">engine_memory.hpp</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_adfd2125c9cc252494693f65719ed53b3"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3">foedus::xct::Xct::add_to_pointer_set</a></div><div class="ttdeci">ErrorCode add_to_pointer_set(const storage::VolatilePagePointer *pointer_address, storage::VolatilePagePointer observed)</div><div class="ttdoc">Add the given page pointer to the pointer set of this transaction. </div><div class="ttdef"><b>Definition:</b> <a href="xct_8cpp_source.html#l00198">xct.cpp:198</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk_html_a7d9aa924c48bd26b4dd208d4a9333127"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePoolOffsetAndEpochChunk.html#a7d9aa924c48bd26b4dd208d4a9333127">foedus::memory::PagePoolOffsetAndEpochChunk::get_safe_offset_count</a></div><div class="ttdeci">uint32_t get_safe_offset_count(const Epoch &amp;threshold) const </div><div class="ttdoc">Returns the number of offsets (always from index-0) whose safe_epoch_ is strictly-before the given ep...</div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8cpp_source.html#l00057">page_pool.cpp:57</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga1a3c05fe1d44455fc3e761947c6e21e6"><div class="ttname"><a href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">foedus::storage::kPageSize</a></div><div class="ttdeci">const uint16_t kPageSize</div><div class="ttdoc">A constant defining the page size (in bytes) of both snapshot pages and volatile pages. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00045">storage_id.hpp:45</a></div></div>
<div class="ttc" id="soc__manager_8hpp_html"><div class="ttname"><a href="soc__manager_8hpp.html">soc_manager.hpp</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaae5f98d1b4caace7febc49e59ae5ac56"><div class="ttname"><a href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">foedus::ErrorCode</a></div><div class="ttdeci">ErrorCode</div><div class="ttdoc">Enum of error codes defined in error_code.xmacro. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00085">error_code.hpp:85</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a4243a3e399186727d6bbdda5bc98f8cd"><div class="ttname"><a href="classfoedus_1_1Engine.html#a4243a3e399186727d6bbdda5bc98f8cd">foedus::Engine::get_thread_pool</a></div><div class="ttdeci">thread::ThreadPool * get_thread_pool() const </div><div class="ttdoc">See Thread and Thread-Group. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00052">engine.cpp:52</a></div></div>
<div class="ttc" id="classfoedus_1_1DefaultInitializable_html_a1abda1e84b8af8bd6916e52fd0a09f3e"><div class="ttname"><a href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e">foedus::DefaultInitializable::is_initialized</a></div><div class="ttdeci">bool is_initialized() const  override final</div><div class="ttdoc">Returns whether the object has been already initialized or not. </div><div class="ttdef"><b>Definition:</b> <a href="initializable_8hpp_source.html#l00196">initializable.hpp:196</a></div></div>
<div class="ttc" id="structfoedus_1_1xct_1_1SysxctWorkspace_html"><div class="ttname"><a href="structfoedus_1_1xct_1_1SysxctWorkspace.html">foedus::xct::SysxctWorkspace</a></div><div class="ttdoc">Per-thread reused work memory for system transactions. </div><div class="ttdef"><b>Definition:</b> <a href="sysxct__impl_8hpp_source.html#l00447">sysxct_impl.hpp:447</a></div></div>
<div class="ttc" id="group__THREAD_html_gga8c4e8dcff52aa5328fe569fa44853d12af713804e6a22002bd137b04e90560ca3"><div class="ttname"><a href="group__THREAD.html#gga8c4e8dcff52aa5328fe569fa44853d12af713804e6a22002bd137b04e90560ca3">foedus::thread::kTerminated</a></div><div class="ttdoc">The thread has terminated (either error or normal, check the result to differentiate them)...</div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00217">thread_id.hpp:217</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a6236b974981b361bfbc25db38c7f9626"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6236b974981b361bfbc25db38c7f9626">foedus::thread::ThreadPimpl::snapshot_cache_hashtable_</a></div><div class="ttdeci">cache::CacheHashtable * snapshot_cache_hashtable_</div><div class="ttdoc">same above </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00349">thread_pimpl.hpp:349</a></div></div>
<div class="ttc" id="group__XCT_html_gga9ac5dae4b91a288e9d887f28a7124c13a5e9c22688eea55cea2bf4380b03a8630"><div class="ttname"><a href="group__XCT.html#gga9ac5dae4b91a288e9d887f28a7124c13a5e9c22688eea55cea2bf4380b03a8630">foedus::xct::kSerializable</a></div><div class="ttdoc">Protects against all anomalies in all situations. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00086">xct_id.hpp:86</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1Thread_html_a476c43885a66c28ac33e624d071a7a7d"><div class="ttname"><a href="classfoedus_1_1thread_1_1Thread.html#a476c43885a66c28ac33e624d071a7a7d">foedus::thread::Thread::cll_try_or_acquire_multiple_locks</a></div><div class="ttdeci">ErrorCode cll_try_or_acquire_multiple_locks(xct::LockListPosition upto_pos)</div><div class="ttdoc">Acquire multiple locks up to the given position in canonical order. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00853">thread_pimpl.cpp:853</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedPolling_html_ae523f3b3bda39c0c81bfb5cb0d5ad626"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedPolling.html#ae523f3b3bda39c0c81bfb5cb0d5ad626">foedus::soc::SharedPolling::signal</a></div><div class="ttdeci">void signal()</div><div class="ttdoc">Signal it to let waiters exit. </div><div class="ttdef"><b>Definition:</b> <a href="shared__polling_8cpp_source.html#l00100">shared_polling.cpp:100</a></div></div>
<div class="ttc" id="classfoedus_1_1ErrorStack_html_a9c7b3a8b3806ff623c7fb4a9db5cbeec"><div class="ttname"><a href="classfoedus_1_1ErrorStack.html#a9c7b3a8b3806ff623c7fb4a9db5cbeec">foedus::ErrorStack::is_error</a></div><div class="ttdeci">bool is_error() const </div><div class="ttdoc">Returns if this return code is not kErrorCodeOk. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00385">error_stack.hpp:385</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_a6e51937e58975e50d0f3eea198b24d3e"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#a6e51937e58975e50d0f3eea198b24d3e">foedus::EngineOptions::cache_</a></div><div class="ttdeci">cache::CacheOptions cache_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00136">engine_options.hpp:136</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_aac3821c478965e40c60c819a7e5a83e5"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#aac3821c478965e40c60c819a7e5a83e5">foedus::thread::ThreadPimpl::follow_page_pointers_for_write_batch</a></div><div class="ttdeci">ErrorCode follow_page_pointers_for_write_batch(uint16_t batch_size, storage::VolatilePageInit page_initializer, storage::DualPagePointer **pointers, storage::Page **parents, const uint16_t *index_in_parents, storage::Page **out)</div><div class="ttdoc">Batched version of follow_page_pointer with will_modify==true and tolerate_null_pointer==true. </div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8cpp_source.html#l00595">thread_pimpl.cpp:595</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PageHeader_html_a59128590fdc568e894a8973a319a0154"><div class="ttname"><a href="structfoedus_1_1storage_1_1PageHeader.html#a59128590fdc568e894a8973a319a0154">foedus::storage::PageHeader::page_id_</a></div><div class="ttdeci">uint64_t page_id_</div><div class="ttdoc">Page ID of this page. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00191">page.hpp:191</a></div></div>
<div class="ttc" id="classfoedus_1_1cache_1_1CacheHashtable_html_ac92d7a0c69e61cfdcacd72b9e8c7bd74"><div class="ttname"><a href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74">foedus::cache::CacheHashtable::find</a></div><div class="ttdeci">ContentId find(storage::SnapshotPagePointer page_id) const __attribute__((always_inline))</div><div class="ttdoc">Returns an offset for the given page ID opportunistically. </div><div class="ttdef"><b>Definition:</b> <a href="cache__hashtable_8hpp_source.html#l00415">cache_hashtable.hpp:415</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaNodeMemory_html_a630ab6d899053a9afc067e34877edd48"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a630ab6d899053a9afc067e34877edd48">foedus::memory::NumaNodeMemory::get_volatile_pool</a></div><div class="ttdeci">PagePool * get_volatile_pool()</div><div class="ttdef"><b>Definition:</b> <a href="numa__node__memory_8hpp_source.html#l00057">numa_node_memory.hpp:57</a></div></div>
<div class="ttc" id="classfoedus_1_1xct_1_1Xct_html_a9dd027b4a8d21f45a60f82d110c5a529"><div class="ttname"><a href="classfoedus_1_1xct_1_1Xct.html#a9dd027b4a8d21f45a60f82d110c5a529">foedus::xct::Xct::initialize</a></div><div class="ttdeci">void initialize(memory::NumaCoreMemory *core_memory, uint32_t *mcs_block_current, uint32_t *mcs_rw_async_mapping_current)</div><div class="ttdef"><b>Definition:</b> <a href="xct_8cpp_source.html#l00077">xct.cpp:77</a></div></div>
<div class="ttc" id="classfoedus_1_1thread_1_1ThreadPimpl_html_a1dafa88a0e8db9faa2deffb4d893b69f"><div class="ttname"><a href="classfoedus_1_1thread_1_1ThreadPimpl.html#a1dafa88a0e8db9faa2deffb4d893b69f">foedus::thread::ThreadPimpl::control_block_</a></div><div class="ttdeci">ThreadControlBlock * control_block_</div><div class="ttdef"><b>Definition:</b> <a href="thread__pimpl_8hpp_source.html#l00382">thread_pimpl.hpp:382</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SocManager_html_a627cf434892c441c90c2de7c20637e9c"><div class="ttname"><a href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c">foedus::soc::SocManager::get_shared_memory_repo</a></div><div class="ttdeci">SharedMemoryRepo * get_shared_memory_repo()</div><div class="ttdoc">Returns the shared memories maintained across SOCs. </div><div class="ttdef"><b>Definition:</b> <a href="soc__manager_8cpp_source.html#l00038">soc_manager.cpp:38</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_8937f9425540f92243ad585d5de884fc.html">foedus-core</a></li><li class="navelem"><a class="el" href="dir_d7a805ee636aca3e828841913b8fee6f.html">src</a></li><li class="navelem"><a class="el" href="dir_69f399cb2d64e6ca2c29e4a5a8e5672b.html">foedus</a></li><li class="navelem"><a class="el" href="dir_a4b6e39f85f11aa3f3f5ba5de0669d75.html">thread</a></li><li class="navelem"><a class="el" href="thread__pimpl_8cpp.html">thread_pimpl.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

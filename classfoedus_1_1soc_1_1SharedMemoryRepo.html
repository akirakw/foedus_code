<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::soc::SharedMemoryRepo Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1soc_1_1SharedMemoryRepo.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classfoedus_1_1soc_1_1SharedMemoryRepo-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::soc::SharedMemoryRepo Class Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__SOC.html">SOC and IPC</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Repository of all shared memory in one FOEDUS instance.  
 <a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Repository of all shared memory in one FOEDUS instance. </p>
<p>These are the memories shared across SOCs, which are allocated at initialization. Be super careful on objects placed in these shared memories. You can't put objects with heap-allocated contents, such as std::string. </p>

<p>Definition at line <a class="el" href="shared__memory__repo_8hpp_source.html#l00463">463</a> of file <a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1450226d1c1d5c3f05338de8bb5c8c54"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1450226d1c1d5c3f05338de8bb5c8c54">SharedMemoryRepo</a> ()</td></tr>
<tr class="separator:a1450226d1c1d5c3f05338de8bb5c8c54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae93958bcd01826cc39e3b84333d1c3d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ae93958bcd01826cc39e3b84333d1c3d9">~SharedMemoryRepo</a> ()</td></tr>
<tr class="separator:ae93958bcd01826cc39e3b84333d1c3d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7f912e70f99e870cee687d1faa6d6f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ac7f912e70f99e870cee687d1faa6d6f3">SharedMemoryRepo</a> (const <a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html">SharedMemoryRepo</a> &amp;other)=delete</td></tr>
<tr class="separator:ac7f912e70f99e870cee687d1faa6d6f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a239fa2f5b199909a9cce1574b307e6fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html">SharedMemoryRepo</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a239fa2f5b199909a9cce1574b307e6fb">operator=</a> (const <a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html">SharedMemoryRepo</a> &amp;other)=delete</td></tr>
<tr class="separator:a239fa2f5b199909a9cce1574b307e6fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa42d7f6cd529569e79e4cfc298adb39b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa42d7f6cd529569e79e4cfc298adb39b">allocate_shared_memories</a> (uint64_t upid, <a class="el" href="namespacefoedus.html#a561c91cb2051b60a396a5c99bd72490a">Eid</a> eid, const <a class="el" href="structfoedus_1_1EngineOptions.html">EngineOptions</a> &amp;options)</td></tr>
<tr class="memdesc:aa42d7f6cd529569e79e4cfc298adb39b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Master process creates shared memories by calling this method.  <a href="#aa42d7f6cd529569e79e4cfc298adb39b">More...</a><br /></td></tr>
<tr class="separator:aa42d7f6cd529569e79e4cfc298adb39b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b6032d62764c145607306973945bb8c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a4b6032d62764c145607306973945bb8c">attach_shared_memories</a> (uint64_t master_upid, <a class="el" href="namespacefoedus.html#a561c91cb2051b60a396a5c99bd72490a">Eid</a> master_eid, <a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a> my_soc_id, <a class="el" href="structfoedus_1_1EngineOptions.html">EngineOptions</a> *options)</td></tr>
<tr class="memdesc:a4b6032d62764c145607306973945bb8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Child processes (emulated or not) set a reference to shared memory and receive the EngnieOption value by calling this method.  <a href="#a4b6032d62764c145607306973945bb8c">More...</a><br /></td></tr>
<tr class="separator:a4b6032d62764c145607306973945bb8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78e80ef586cc59284a2c9af365e1f0b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a78e80ef586cc59284a2c9af365e1f0b6">mark_for_release</a> ()</td></tr>
<tr class="memdesc:a78e80ef586cc59284a2c9af365e1f0b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks shared memories as being removed so that it will be reclaimed when all processes detach it.  <a href="#a78e80ef586cc59284a2c9af365e1f0b6">More...</a><br /></td></tr>
<tr class="separator:a78e80ef586cc59284a2c9af365e1f0b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa961c615ceddd0dd0d3943629fd1a147"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147">deallocate_shared_memories</a> ()</td></tr>
<tr class="memdesc:aa961c615ceddd0dd0d3943629fd1a147"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detaches and releases the shared memories.  <a href="#aa961c615ceddd0dd0d3943629fd1a147">More...</a><br /></td></tr>
<tr class="separator:aa961c615ceddd0dd0d3943629fd1a147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e083b61b71eaf53a3a291d16f7a81ee"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a8e083b61b71eaf53a3a291d16f7a81ee">get_global_memory</a> ()</td></tr>
<tr class="separator:a8e083b61b71eaf53a3a291d16f7a81ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c21cc6a27cabaf4a8c9dc26985aacfb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html">GlobalMemoryAnchors</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb">get_global_memory_anchors</a> ()</td></tr>
<tr class="separator:a1c21cc6a27cabaf4a8c9dc26985aacfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6dda26e594cbef6ceeb6287a1a3092b"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ab6dda26e594cbef6ceeb6287a1a3092b">get_global_user_memory</a> ()</td></tr>
<tr class="separator:ab6dda26e594cbef6ceeb6287a1a3092b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45aa9998863c0d0f8548806d06503972"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a45aa9998863c0d0f8548806d06503972">change_master_status</a> (<a class="el" href="structfoedus_1_1soc_1_1MasterEngineStatus.html#aa27f54bcc29ab6a9bb7c4dbd21914afd">MasterEngineStatus::StatusCode</a> new_status)</td></tr>
<tr class="separator:a45aa9998863c0d0f8548806d06503972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91712157cc54f8072a0c1664a902f388"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1soc_1_1MasterEngineStatus.html#aa27f54bcc29ab6a9bb7c4dbd21914afd">MasterEngineStatus::StatusCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a91712157cc54f8072a0c1664a902f388">get_master_status</a> () const </td></tr>
<tr class="separator:a91712157cc54f8072a0c1664a902f388"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac6d8360313375e55bddacf6fde461e6"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aac6d8360313375e55bddacf6fde461e6">get_node_memory</a> (<a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a> node)</td></tr>
<tr class="separator:aac6d8360313375e55bddacf6fde461e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e5d1a0a78c66ac6e1c8ef166d2965c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html">NodeMemoryAnchors</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e5d1a0a78c66ac6e1c8ef166d2965c3">get_node_memory_anchors</a> (<a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a> node)</td></tr>
<tr class="separator:a2e5d1a0a78c66ac6e1c8ef166d2965c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e39207d5c93495c392a8c41ffae38e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ad6e39207d5c93495c392a8c41ffae38e">change_child_status</a> (<a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a> node, <a class="el" href="structfoedus_1_1soc_1_1ChildEngineStatus.html#a7578e96cb975278b2b2434d568e39ce7">ChildEngineStatus::StatusCode</a> new_status)</td></tr>
<tr class="separator:ad6e39207d5c93495c392a8c41ffae38e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858b2e2cceeb9f8c71722ed5f8c3c069"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1soc_1_1ChildEngineStatus.html#a7578e96cb975278b2b2434d568e39ce7">ChildEngineStatus::StatusCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a858b2e2cceeb9f8c71722ed5f8c3c069">get_child_status</a> (<a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a> node) const </td></tr>
<tr class="separator:a858b2e2cceeb9f8c71722ed5f8c3c069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae22e59b0c58a7f6fa519e2c4149afd9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html">ThreadMemoryAnchors</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ae22e59b0c58a7f6fa519e2c4149afd9c">get_thread_memory_anchors</a> (<a class="el" href="group__THREAD.html#ga709a79fc1ed05a3543d8309ba391da93">thread::ThreadId</a> thread_id)</td></tr>
<tr class="separator:ae22e59b0c58a7f6fa519e2c4149afd9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e03c4b7d87150fb9175a239ca657f71"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a7e03c4b7d87150fb9175a239ca657f71">get_volatile_pool</a> (<a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a> node)</td></tr>
<tr class="separator:a7e03c4b7d87150fb9175a239ca657f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a9cea4a83fb68a8f86ad43c04165c06e3"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a9cea4a83fb68a8f86ad43c04165c06e3">calculate_global_memory_size</a> (uint64_t xml_size, const <a class="el" href="structfoedus_1_1EngineOptions.html">EngineOptions</a> &amp;options)</td></tr>
<tr class="separator:a9cea4a83fb68a8f86ad43c04165c06e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e2c4c30186c25585226aabc09e942cf"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e2c4c30186c25585226aabc09e942cf">calculate_node_memory_size</a> (const <a class="el" href="structfoedus_1_1EngineOptions.html">EngineOptions</a> &amp;options)</td></tr>
<tr class="separator:a2e2c4c30186c25585226aabc09e942cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1450226d1c1d5c3f05338de8bb5c8c54"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::soc::SharedMemoryRepo::SharedMemoryRepo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8hpp_source.html#l00465">465</a> of file <a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                     :</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    soc_count_(0),</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    my_soc_id_(0),</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    node_memories_(<a class="code" href="group__CXX11.html#ga213f92e16813051c59cdccf6d28baa78">CXX11_NULLPTR</a>),</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    node_memory_anchors_(<a class="code" href="group__CXX11.html#ga213f92e16813051c59cdccf6d28baa78">CXX11_NULLPTR</a>) {}</div>
<div class="ttc" id="group__CXX11_html_ga213f92e16813051c59cdccf6d28baa78"><div class="ttname"><a href="group__CXX11.html#ga213f92e16813051c59cdccf6d28baa78">CXX11_NULLPTR</a></div><div class="ttdeci">#define CXX11_NULLPTR</div><div class="ttdoc">Used in public headers in place of "nullptr" of C++11. </div><div class="ttdef"><b>Definition:</b> <a href="cxx11_8hpp_source.html#l00132">cxx11.hpp:132</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae93958bcd01826cc39e3b84333d1c3d9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::soc::SharedMemoryRepo::~SharedMemoryRepo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8hpp_source.html#l00470">470</a> of file <a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8cpp_source.html#l00223">deallocate_shared_memories()</a>.</p>
<div class="fragment"><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;{ <a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147">deallocate_shared_memories</a>(); }</div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_aa961c615ceddd0dd0d3943629fd1a147"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147">foedus::soc::SharedMemoryRepo::deallocate_shared_memories</a></div><div class="ttdeci">void deallocate_shared_memories()</div><div class="ttdoc">Detaches and releases the shared memories. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00223">shared_memory_repo.cpp:223</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_ae93958bcd01826cc39e3b84333d1c3d9_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_ae93958bcd01826cc39e3b84333d1c3d9_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_ae93958bcd01826cc39e3b84333d1c3d9_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_ae93958bcd01826cc39e3b84333d1c3d9_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147" title="Detaches and releases the shared memories. " alt="" coords="240,162,425,218"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a78e80ef586cc59284a2c9af365e1f0b6" title="Marks shared memories as being removed so that it will be reclaimed when all processes detach it..." alt="" coords="486,5,671,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1SharedMemory.html#acbdca7a06f5b1fe14cba7c718c822ac4" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="473,71,684,112"/>
<area shape="rect" id="node6" href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a10383a5371b4bac033184c7441719fee" title="Removes all access restrictions via mprotect(). " alt="" coords="487,136,670,177"/>
<area shape="rect" id="node7" href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a2242e8ed93e24a8cba2097c3433e0216" title="Called at shutdown to check whether these boundaries were not accessed. " alt="" coords="487,201,670,243"/>
<area shape="rect" id="node8" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#a46e22c8cac15e20ccea8ac8e77311b23" title="foedus::soc::GlobalMemory\lAnchors::clear" alt="" coords="488,267,669,308"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1SharedMemory.html#a20f2fb7b7f86ab5c4134452f1267eeb5" title="Releases the memory block IF this process has an ownership. " alt="" coords="473,332,684,373"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1SharedMemory.html#a06fa097c286b762b8ae484076592bf0d" title="Marks the shared memory as being removed so that it will be reclaimed when all processes detach it..." alt="" coords="732,104,943,145"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1SharedMemory.html#a83f0c9b29ecfc29550923dd33bc031e7" title="Returns if this process owns this memory and is responsible to delete it. " alt="" coords="732,267,943,308"/>
<area shape="rect" id="node11" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="767,332,907,373"/>
<area shape="rect" id="node12" href="group__FILESYSTEM.html#gad1f62b080fa246b5f8c166f44c72134f" title="Deletes a regular file or an empty directory. " alt="" coords="774,398,901,425"/>
<area shape="rect" id="node13" href="structfoedus_1_1fs_1_1FileStatus.html#ac4ab24d4308aab673c8d1606a84367e5" title="foedus::fs::FileStatus\l::exists" alt="" coords="991,325,1136,367"/>
<area shape="rect" id="node14" href="structfoedus_1_1fs_1_1FileStatus.html#a76000c37b9fc4c1d9596240409972809" title="foedus::fs::FileStatus\l::is_regular_file" alt="" coords="991,391,1136,432"/>
<area shape="rect" id="node15" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="1002,457,1125,483"/>
<area shape="rect" id="node16" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="1184,457,1335,483"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac7f912e70f99e870cee687d1faa6d6f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::soc::SharedMemoryRepo::SharedMemoryRepo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html">SharedMemoryRepo</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa42d7f6cd529569e79e4cfc298adb39b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::soc::SharedMemoryRepo::allocate_shared_memories </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>upid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefoedus.html#a561c91cb2051b60a396a5c99bd72490a">Eid</a>&#160;</td>
          <td class="paramname"><em>eid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1EngineOptions.html">EngineOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Master process creates shared memories by calling this method. </p>

<p>Definition at line <a class="el" href="shared__memory__repo_8cpp_source.html#l00096">96</a> of file <a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8cpp_source.html#l00066">foedus::soc::align_2mb()</a>, <a class="el" href="shared__memory_8cpp_source.html#l00067">foedus::memory::SharedMemory::alloc()</a>, <a class="el" href="shared__memory__repo_8cpp_source.html#l00365">calculate_global_memory_size()</a>, <a class="el" href="shared__memory__repo_8cpp_source.html#l00505">calculate_node_memory_size()</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="shared__memory__repo_8cpp_source.html#l00223">deallocate_shared_memories()</a>, <a class="el" href="shared__memory_8hpp_source.html#l00144">foedus::memory::SharedMemory::get_block()</a>, <a class="el" href="shared__memory__repo_8cpp_source.html#l00037">foedus::soc::get_self_path()</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00069">foedus::soc::MasterEngineStatus::kInitial</a>, <a class="el" href="soc__id_8hpp_source.html#l00035">foedus::soc::kMaxSocs</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00250">foedus::soc::GlobalMemoryAnchors::master_status_memory_</a>, <a class="el" href="engine__options_8hpp_source.html#l00139">foedus::EngineOptions::memory_</a>, <a class="el" href="memory__options_8hpp_source.html#l00094">foedus::memory::MemoryOptions::rigorous_memory_boundary_check_</a>, <a class="el" href="memory__options_8hpp_source.html#l00114">foedus::memory::MemoryOptions::rigorous_page_boundary_check_</a>, <a class="el" href="externalizable_8cpp_source.html#l00055">foedus::externalize::Externalizable::save_to_stream()</a>, and <a class="el" href="shared__memory__repo_8hpp_source.html#l00128">foedus::soc::MasterEngineStatus::status_code_</a>.</p>

<p>Referenced by <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00086">foedus::soc::SocManagerPimpl::initialize_master()</a>.</p>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147">deallocate_shared_memories</a>();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  init_empty(options);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// We place a serialized EngineOptions in the beginning of shared memory.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  std::stringstream options_stream;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  options.save_to_stream(&amp;options_stream);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  std::string xml(options_stream.str());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  uint64_t xml_size = xml.size();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">// construct unique meta files using PID.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  uint64_t global_memory_size = <a class="code" href="namespacefoedus_1_1soc.html#a82eb2c1c7892da72ccb633c3fddead78">align_2mb</a>(<a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a9cea4a83fb68a8f86ad43c04165c06e3">calculate_global_memory_size</a>(xml_size, options));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  std::string global_memory_path = <a class="code" href="namespacefoedus_1_1soc.html#a42d9cec7b9ff69287c57c9590ea7ac86">get_self_path</a>(upid, eid) + std::string(<span class="stringliteral">&quot;_global&quot;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> global_hugepages = !options.memory_.rigorous_memory_boundary_check_;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#ae4b91eee2dce03e4b3aac612c71b88a0">alloc</a>(global_memory_path, global_memory_size, 0, global_hugepages));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// from now on, be very careful to not exit without releasing this shared memory.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  set_global_memory_anchors(xml_size, options, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  global_memory_anchors_.<a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ae21c8452d4ace76cd9c71813742964aa">master_status_memory_</a>-&gt;<a class="code" href="structfoedus_1_1soc_1_1MasterEngineStatus.html#a6de44a65bd1dc5823d7b08a50636aa58">status_code_</a> = <a class="code" href="structfoedus_1_1soc_1_1MasterEngineStatus.html#aa27f54bcc29ab6a9bb7c4dbd21914afdacc4266feb1226e6341b9888f391e3521">MasterEngineStatus::kInitial</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">// copy the EngineOptions string into the beginning of the global memory</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  std::memcpy(global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113">get_block</a>(), &amp;xml_size, <span class="keyword">sizeof</span>(xml_size));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  std::memcpy(global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113">get_block</a>() + <span class="keyword">sizeof</span>(xml_size), xml.data(), xml_size);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">// the following is parallelized</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  uint64_t node_memory_size = <a class="code" href="namespacefoedus_1_1soc.html#a82eb2c1c7892da72ccb633c3fddead78">align_2mb</a>(<a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e2c4c30186c25585226aabc09e942cf">calculate_node_memory_size</a>(options));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  ErrorStack alloc_results[<a class="code" href="group__SOC.html#gac7adcfe2665ed43d242389b3866acc19">kMaxSocs</a>];</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  std::vector&lt; std::thread &gt; alloc_threads;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">for</span> (uint16_t node = 0; node &lt; soc_count_; ++node) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    alloc_threads.emplace_back(std::thread(</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      SharedMemoryRepo::allocate_one_node,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      upid,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      eid,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      node,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      node_memory_size,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      options.memory_.rigorous_memory_boundary_check_,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      options.memory_.rigorous_page_boundary_check_,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      alloc_results + node,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keyword">this</span>));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  ErrorStack last_error;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordtype">bool</span> failed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">for</span> (uint16_t node = 0; node &lt; soc_count_; ++node) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    alloc_threads[node].join();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (alloc_results[node].is_error()) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;[FOEDUS] Failed to allocate node shared memory for node-&quot;</span> &lt;&lt; node</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;. &quot;</span> &lt;&lt; alloc_results[node] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      last_error = alloc_results[node];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      failed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">if</span> (failed) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147">deallocate_shared_memories</a>();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">return</span> last_error;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">for</span> (uint16_t node = 0; node &lt; soc_count_; ++node) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    set_node_memory_anchors(node, options, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_aa961c615ceddd0dd0d3943629fd1a147"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147">foedus::soc::SharedMemoryRepo::deallocate_shared_memories</a></div><div class="ttdeci">void deallocate_shared_memories()</div><div class="ttdoc">Detaches and releases the shared memories. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00223">shared_memory_repo.cpp:223</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1SharedMemory_html_a085dfb81511ba8e4c0563b5a72967113"><div class="ttname"><a href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113">foedus::memory::SharedMemory::get_block</a></div><div class="ttdeci">char * get_block() const </div><div class="ttdoc">Returns the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory_8hpp_source.html#l00144">shared_memory.hpp:144</a></div></div>
<div class="ttc" id="namespacefoedus_1_1soc_html_a42d9cec7b9ff69287c57c9590ea7ac86"><div class="ttname"><a href="namespacefoedus_1_1soc.html#a42d9cec7b9ff69287c57c9590ea7ac86">foedus::soc::get_self_path</a></div><div class="ttdeci">std::string get_self_path(uint64_t upid, Eid eid)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00037">shared_memory_repo.cpp:37</a></div></div>
<div class="ttc" id="namespacefoedus_1_1soc_html_a82eb2c1c7892da72ccb633c3fddead78"><div class="ttname"><a href="namespacefoedus_1_1soc.html#a82eb2c1c7892da72ccb633c3fddead78">foedus::soc::align_2mb</a></div><div class="ttdeci">uint64_t align_2mb(uint64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00066">shared_memory_repo.cpp:66</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_a9cea4a83fb68a8f86ad43c04165c06e3"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a9cea4a83fb68a8f86ad43c04165c06e3">foedus::soc::SharedMemoryRepo::calculate_global_memory_size</a></div><div class="ttdeci">static uint64_t calculate_global_memory_size(uint64_t xml_size, const EngineOptions &amp;options)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00365">shared_memory_repo.cpp:365</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_a2e2c4c30186c25585226aabc09e942cf"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e2c4c30186c25585226aabc09e942cf">foedus::soc::SharedMemoryRepo::calculate_node_memory_size</a></div><div class="ttdeci">static uint64_t calculate_node_memory_size(const EngineOptions &amp;options)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00505">shared_memory_repo.cpp:505</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ae21c8452d4ace76cd9c71813742964aa"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ae21c8452d4ace76cd9c71813742964aa">foedus::soc::GlobalMemoryAnchors::master_status_memory_</a></div><div class="ttdeci">MasterEngineStatus * master_status_memory_</div><div class="ttdoc">This tiny piece of memory contains the current status of the master engine and its synchronization me...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00250">shared_memory_repo.hpp:250</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1MasterEngineStatus_html_a6de44a65bd1dc5823d7b08a50636aa58"><div class="ttname"><a href="structfoedus_1_1soc_1_1MasterEngineStatus.html#a6de44a65bd1dc5823d7b08a50636aa58">foedus::soc::MasterEngineStatus::status_code_</a></div><div class="ttdeci">StatusCode status_code_</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00128">shared_memory_repo.hpp:128</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1SharedMemory_html_ae4b91eee2dce03e4b3aac612c71b88a0"><div class="ttname"><a href="classfoedus_1_1memory_1_1SharedMemory.html#ae4b91eee2dce03e4b3aac612c71b88a0">foedus::memory::SharedMemory::alloc</a></div><div class="ttdeci">ErrorStack alloc(const std::string &amp;meta_path, uint64_t size, int numa_node, bool use_hugepages)</div><div class="ttdoc">Newly allocate a shared memory of given size on given NUMA node. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory_8cpp_source.html#l00067">shared_memory.cpp:67</a></div></div>
<div class="ttc" id="group__SOC_html_gac7adcfe2665ed43d242389b3866acc19"><div class="ttname"><a href="group__SOC.html#gac7adcfe2665ed43d242389b3866acc19">foedus::soc::kMaxSocs</a></div><div class="ttdeci">const uint16_t kMaxSocs</div><div class="ttdoc">Maximum number of SOCs. </div><div class="ttdef"><b>Definition:</b> <a href="soc__id_8hpp_source.html#l00035">soc_id.hpp:35</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1MasterEngineStatus_html_aa27f54bcc29ab6a9bb7c4dbd21914afdacc4266feb1226e6341b9888f391e3521"><div class="ttname"><a href="structfoedus_1_1soc_1_1MasterEngineStatus.html#aa27f54bcc29ab6a9bb7c4dbd21914afdacc4266feb1226e6341b9888f391e3521">foedus::soc::MasterEngineStatus::kInitial</a></div><div class="ttdoc">Master engine has just started. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00069">shared_memory_repo.hpp:69</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_aa42d7f6cd529569e79e4cfc298adb39b_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_aa42d7f6cd529569e79e4cfc298adb39b_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_aa42d7f6cd529569e79e4cfc298adb39b_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_aa42d7f6cd529569e79e4cfc298adb39b_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1soc.html#a82eb2c1c7892da72ccb633c3fddead78" title="foedus::soc::align_2mb" alt="" coords="306,89,462,116"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1SharedMemory.html#ae4b91eee2dce03e4b3aac612c71b88a0" title="Newly allocate a shared memory of given size on given NUMA node. " alt="" coords="279,141,489,182"/>
<area shape="rect" id="node15" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a9cea4a83fb68a8f86ad43c04165c06e3" title="foedus::soc::SharedMemory\lRepo::calculate_global\l_memory_size" alt="" coords="291,433,477,489"/>
<area shape="rect" id="node17" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a2e2c4c30186c25585226aabc09e942cf" title="foedus::soc::SharedMemory\lRepo::calculate_node_memory_size" alt="" coords="268,514,500,555"/>
<area shape="rect" id="node18" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147" title="Detaches and releases the shared memories. " alt="" coords="291,353,477,409"/>
<area shape="rect" id="node24" href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113" title="Returns the memory block. " alt="" coords="279,579,489,621"/>
<area shape="rect" id="node25" href="namespacefoedus_1_1soc.html#a42d9cec7b9ff69287c57c9590ea7ac86" title="foedus::soc::get_self_path" alt="" coords="297,645,471,672"/>
<area shape="rect" id="node26" href="structfoedus_1_1externalize_1_1Externalizable.html#af4afef8baea2ce7e2363f1af99244c17" title="Invokes save() and directs the resulting XML text to the given stream. " alt="" coords="311,696,457,752"/>
<area shape="rect" id="node4" href="group__FILESYSTEM.html#ga4f8f53901e9c98fce72b6b3c52cf83a4" title="Returns if the file exists. " alt="" coords="851,5,973,32"/>
<area shape="rect" id="node8" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="586,107,721,149"/>
<area shape="rect" id="node9" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="842,57,982,98"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1SharedMemory.html#a20f2fb7b7f86ab5c4134452f1267eeb5" title="Releases the memory block IF this process has an ownership. " alt="" coords="548,173,759,214"/>
<area shape="rect" id="node5" href="structfoedus_1_1fs_1_1FileStatus.html#ac4ab24d4308aab673c8d1606a84367e5" title="foedus::fs::FileStatus\l::exists" alt="" coords="1065,86,1211,127"/>
<area shape="rect" id="node6" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="1077,20,1199,47"/>
<area shape="rect" id="node7" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="1259,20,1409,47"/>
<area shape="rect" id="node11" href="classfoedus_1_1memory_1_1SharedMemory.html#a83f0c9b29ecfc29550923dd33bc031e7" title="Returns if this process owns this memory and is responsible to delete it. " alt="" coords="807,122,1017,163"/>
<area shape="rect" id="node12" href="classfoedus_1_1memory_1_1SharedMemory.html#a06fa097c286b762b8ae484076592bf0d" title="Marks the shared memory as being removed so that it will be reclaimed when all processes detach it..." alt="" coords="807,369,1017,410"/>
<area shape="rect" id="node13" href="group__FILESYSTEM.html#gad1f62b080fa246b5f8c166f44c72134f" title="Deletes a regular file or an empty directory. " alt="" coords="849,188,975,215"/>
<area shape="rect" id="node14" href="structfoedus_1_1fs_1_1FileStatus.html#a76000c37b9fc4c1d9596240409972809" title="foedus::fs::FileStatus\l::is_regular_file" alt="" coords="1065,181,1211,222"/>
<area shape="rect" id="node16" href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643" title="foedus::soc::align_4kb" alt="" coords="577,565,729,592"/>
<area shape="rect" id="node19" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a78e80ef586cc59284a2c9af365e1f0b6" title="Marks shared memories as being removed so that it will be reclaimed when all processes detach it..." alt="" coords="561,499,746,541"/>
<area shape="rect" id="node20" href="classfoedus_1_1memory_1_1SharedMemory.html#acbdca7a06f5b1fe14cba7c718c822ac4" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="548,238,759,279"/>
<area shape="rect" id="node21" href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a10383a5371b4bac033184c7441719fee" title="Removes all access restrictions via mprotect(). " alt="" coords="562,303,745,345"/>
<area shape="rect" id="node22" href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a2242e8ed93e24a8cba2097c3433e0216" title="Called at shutdown to check whether these boundaries were not accessed. " alt="" coords="562,369,745,410"/>
<area shape="rect" id="node23" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#a46e22c8cac15e20ccea8ac8e77311b23" title="foedus::soc::GlobalMemory\lAnchors::clear" alt="" coords="563,434,744,475"/>
<area shape="rect" id="node27" href="structfoedus_1_1externalize_1_1Externalizable.html#ad6b9ab6485d761a9d2d5402da7c97700" title="Returns an XML tag name for this object as a root element. " alt="" coords="584,623,723,679"/>
<area shape="rect" id="node28" href="classfoedus_1_1ErrorStack.html#a9c7b3a8b3806ff623c7fb4a9db5cbeec" title="Returns if this return code is not kErrorCodeOk. " alt="" coords="588,703,719,745"/>
<area shape="rect" id="node29" href="structfoedus_1_1externalize_1_1Externalizable.html#a19c407586854a4765981cf165b653ef5" title="Writes the content of this object to the given XML element. " alt="" coords="580,769,727,810"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_aa42d7f6cd529569e79e4cfc298adb39b_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_aa42d7f6cd529569e79e4cfc298adb39b_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_aa42d7f6cd529569e79e4cfc298adb39b_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_aa42d7f6cd529569e79e4cfc298adb39b_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="268,5,471,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="519,5,721,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4b6032d62764c145607306973945bb8c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::soc::SharedMemoryRepo::attach_shared_memories </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>master_upid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefoedus.html#a561c91cb2051b60a396a5c99bd72490a">Eid</a>&#160;</td>
          <td class="paramname"><em>master_eid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a>&#160;</td>
          <td class="paramname"><em>my_soc_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1EngineOptions.html">EngineOptions</a> *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Child processes (emulated or not) set a reference to shared memory and receive the EngnieOption value by calling this method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">master_upid</td><td>Universal (or Unique) ID of the master process. This is the parameter that has to be passed from the master process to child processes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">master_eid</td><td><a class="el" href="classfoedus_1_1Engine.html" title="Database engine object that holds all resources and provides APIs. ">Engine</a> ID of the master process. This is another parameter that has to be passed from the master process to child processes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">my_soc_id</td><td>SOC ID of this node. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">options</td><td>One of the shared memory contains the EngineOption values. This method also retrieves them from the shared memory. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="shared__memory__repo_8cpp_source.html#l00165">165</a> of file <a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="shared__memory_8cpp_source.html#l00157">foedus::memory::SharedMemory::attach()</a>, <a class="el" href="shared__memory__repo_8cpp_source.html#l00547">change_child_status()</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="shared__memory__repo_8cpp_source.html#l00223">deallocate_shared_memories()</a>, <a class="el" href="error__stack_8hpp_source.html#l00480">ERROR_STACK</a>, <a class="el" href="shared__memory_8hpp_source.html#l00144">foedus::memory::SharedMemory::get_block()</a>, <a class="el" href="shared__memory__repo_8cpp_source.html#l00042">foedus::soc::get_master_path()</a>, <a class="el" href="shared__memory_8hpp_source.html#l00152">foedus::memory::SharedMemory::is_null()</a>, <a class="el" href="error__code_8hpp_source.html#l00221">foedus::kErrorCodeSocShmAttachFailed</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00169">foedus::soc::ChildEngineStatus::kFatalError</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="externalizable_8cpp_source.html#l00038">foedus::externalize::Externalizable::load_from_string()</a>, <a class="el" href="engine__options_8hpp_source.html#l00139">foedus::EngineOptions::memory_</a>, and <a class="el" href="memory__options_8hpp_source.html#l00094">foedus::memory::MemoryOptions::rigorous_memory_boundary_check_</a>.</p>

<p>Referenced by <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00128">foedus::soc::SocManagerPimpl::initialize_child()</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                          {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147">deallocate_shared_memories</a>();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  std::string base = <a class="code" href="namespacefoedus_1_1soc.html#aaead1a827fc8440e524a03434e832219">get_master_path</a>(master_upid, master_eid);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  std::string global_memory_path = base + std::string(<span class="stringliteral">&quot;_global&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> global_hugepages = !options-&gt;memory_.rigorous_memory_boundary_check_;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a690fd766729121b64adf28994a8a6660">attach</a>(global_memory_path, global_hugepages);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">if</span> (global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#acbdca7a06f5b1fe14cba7c718c822ac4">is_null</a>()) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147">deallocate_shared_memories</a>();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#gaa598b0ca7f0de626ecfa17f2cd58d5b4">ERROR_STACK</a>(<a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a4ee2359b408f2af808ec6e1674471b71">kErrorCodeSocShmAttachFailed</a>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// read the options from global_memory</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  uint64_t xml_size = 0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  std::memcpy(&amp;xml_size, global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113">get_block</a>(), <span class="keyword">sizeof</span>(xml_size));</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(xml_size &gt; 0);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  std::string xml(global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113">get_block</a>() + <span class="keyword">sizeof</span>(xml_size), xml_size);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(options-&gt;load_from_string(xml));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  my_soc_id_ = my_soc_id;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  init_empty(*options);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  set_global_memory_anchors(xml_size, *options, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">bool</span> failed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">for</span> (uint16_t node = 0; node &lt; soc_count_; ++node) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    std::string node_memory_str = base + std::string(<span class="stringliteral">&quot;_node_&quot;</span>) + std::to_string(node);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    node_memories_[node].<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a690fd766729121b64adf28994a8a6660">attach</a>(node_memory_str, !options-&gt;memory_.rigorous_memory_boundary_check_);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span> (node_memories_[node].is_null()) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      failed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      set_node_memory_anchors(node, *options, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">if</span> (failed) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span> (!node_memories_[my_soc_id].is_null()) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="comment">// then we can at least notify the error via the shared memory</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ad6e39207d5c93495c392a8c41ffae38e">change_child_status</a>(my_soc_id, <a class="code" href="structfoedus_1_1soc_1_1ChildEngineStatus.html#a7578e96cb975278b2b2434d568e39ce7af60c000bff1974c68b01df8d7a11d9fb">ChildEngineStatus::kFatalError</a>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147">deallocate_shared_memories</a>();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#gaa598b0ca7f0de626ecfa17f2cd58d5b4">ERROR_STACK</a>(<a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a4ee2359b408f2af808ec6e1674471b71">kErrorCodeSocShmAttachFailed</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a4ee2359b408f2af808ec6e1674471b71"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a4ee2359b408f2af808ec6e1674471b71">foedus::kErrorCodeSocShmAttachFailed</a></div><div class="ttdoc">0x0C02 : "SOC    : Failed to attach a shared memory." . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00221">error_code.hpp:221</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa598b0ca7f0de626ecfa17f2cd58d5b4"><div class="ttname"><a href="group__ERRORCODES.html#gaa598b0ca7f0de626ecfa17f2cd58d5b4">ERROR_STACK</a></div><div class="ttdeci">#define ERROR_STACK(e)        </div><div class="ttdoc">Instantiates ErrorStack with the given foedus::error_code, creating an error stack with the current f...</div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00480">error_stack.hpp:480</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_aa961c615ceddd0dd0d3943629fd1a147"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147">foedus::soc::SharedMemoryRepo::deallocate_shared_memories</a></div><div class="ttdeci">void deallocate_shared_memories()</div><div class="ttdoc">Detaches and releases the shared memories. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00223">shared_memory_repo.cpp:223</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1SharedMemory_html_a085dfb81511ba8e4c0563b5a72967113"><div class="ttname"><a href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113">foedus::memory::SharedMemory::get_block</a></div><div class="ttdeci">char * get_block() const </div><div class="ttdoc">Returns the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory_8hpp_source.html#l00144">shared_memory.hpp:144</a></div></div>
<div class="ttc" id="namespacefoedus_1_1soc_html_aaead1a827fc8440e524a03434e832219"><div class="ttname"><a href="namespacefoedus_1_1soc.html#aaead1a827fc8440e524a03434e832219">foedus::soc::get_master_path</a></div><div class="ttdeci">std::string get_master_path(uint64_t master_upid, Eid master_eid)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00042">shared_memory_repo.cpp:42</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1SharedMemory_html_a690fd766729121b64adf28994a8a6660"><div class="ttname"><a href="classfoedus_1_1memory_1_1SharedMemory.html#a690fd766729121b64adf28994a8a6660">foedus::memory::SharedMemory::attach</a></div><div class="ttdeci">void attach(const std::string &amp;meta_path, bool use_hugepages)</div><div class="ttdoc">Attach an already-allocated shared memory so that this object points to the memory. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory_8cpp_source.html#l00157">shared_memory.cpp:157</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_ad6e39207d5c93495c392a8c41ffae38e"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ad6e39207d5c93495c392a8c41ffae38e">foedus::soc::SharedMemoryRepo::change_child_status</a></div><div class="ttdeci">void change_child_status(SocId node, ChildEngineStatus::StatusCode new_status)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00547">shared_memory_repo.cpp:547</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1SharedMemory_html_acbdca7a06f5b1fe14cba7c718c822ac4"><div class="ttname"><a href="classfoedus_1_1memory_1_1SharedMemory.html#acbdca7a06f5b1fe14cba7c718c822ac4">foedus::memory::SharedMemory::is_null</a></div><div class="ttdeci">bool is_null() const </div><div class="ttdoc">Returns if this object doesn&#39;t hold a valid memory block. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory_8hpp_source.html#l00152">shared_memory.hpp:152</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ChildEngineStatus_html_a7578e96cb975278b2b2434d568e39ce7af60c000bff1974c68b01df8d7a11d9fb"><div class="ttname"><a href="structfoedus_1_1soc_1_1ChildEngineStatus.html#a7578e96cb975278b2b2434d568e39ce7af60c000bff1974c68b01df8d7a11d9fb">foedus::soc::ChildEngineStatus::kFatalError</a></div><div class="ttdoc">The child engine observed some unrecoverable error and has exit. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00169">shared_memory_repo.hpp:169</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a4b6032d62764c145607306973945bb8c_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a4b6032d62764c145607306973945bb8c_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a4b6032d62764c145607306973945bb8c_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a4b6032d62764c145607306973945bb8c_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1SharedMemory.html#a690fd766729121b64adf28994a8a6660" title="Attach an already&#45;allocated shared memory so that this object points to the memory. " alt="" coords="260,86,471,127"/>
<area shape="rect" id="node13" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ad6e39207d5c93495c392a8c41ffae38e" title="foedus::soc::SharedMemory\lRepo::change_child_status" alt="" coords="273,369,458,410"/>
<area shape="rect" id="node16" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147" title="Detaches and releases the shared memories. " alt="" coords="273,288,458,344"/>
<area shape="rect" id="node18" href="classfoedus_1_1memory_1_1SharedMemory.html#acbdca7a06f5b1fe14cba7c718c822ac4" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="519,181,729,222"/>
<area shape="rect" id="node22" href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113" title="Returns the memory block. " alt="" coords="260,434,471,475"/>
<area shape="rect" id="node23" href="namespacefoedus_1_1soc.html#aaead1a827fc8440e524a03434e832219" title="foedus::soc::get_master_path" alt="" coords="268,500,463,527"/>
<area shape="rect" id="node24" href="structfoedus_1_1externalize_1_1Externalizable.html#a70d1aa96eadd30de0497a290ea656ed0" title="Load the content of this object from the given XML string. " alt="" coords="293,557,437,613"/>
<area shape="rect" id="node3" href="group__FILESYSTEM.html#ga4f8f53901e9c98fce72b6b3c52cf83a4" title="Returns if the file exists. " alt="" coords="822,5,943,32"/>
<area shape="rect" id="node7" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="813,57,953,98"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1SharedMemory.html#a20f2fb7b7f86ab5c4134452f1267eeb5" title="Releases the memory block IF this process has an ownership. " alt="" coords="519,115,729,157"/>
<area shape="rect" id="node4" href="structfoedus_1_1fs_1_1FileStatus.html#ac4ab24d4308aab673c8d1606a84367e5" title="foedus::fs::FileStatus\l::exists" alt="" coords="1036,57,1181,98"/>
<area shape="rect" id="node5" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="1047,5,1170,32"/>
<area shape="rect" id="node6" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="1229,5,1380,32"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1SharedMemory.html#a83f0c9b29ecfc29550923dd33bc031e7" title="Returns if this process owns this memory and is responsible to delete it. " alt="" coords="777,174,988,215"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1SharedMemory.html#a06fa097c286b762b8ae484076592bf0d" title="Marks the shared memory as being removed so that it will be reclaimed when all processes detach it..." alt="" coords="777,309,988,350"/>
<area shape="rect" id="node11" href="group__FILESYSTEM.html#gad1f62b080fa246b5f8c166f44c72134f" title="Deletes a regular file or an empty directory. " alt="" coords="819,123,946,149"/>
<area shape="rect" id="node12" href="structfoedus_1_1fs_1_1FileStatus.html#a76000c37b9fc4c1d9596240409972809" title="foedus::fs::FileStatus\l::is_regular_file" alt="" coords="1036,122,1181,163"/>
<area shape="rect" id="node14" href="structfoedus_1_1soc_1_1ChildEngineStatus.html#aa4e9303cf9cd2299bd7e9f44f6e837e0" title="Update the value of status_code_ with fence. " alt="" coords="541,508,707,564"/>
<area shape="rect" id="node15" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf" title="Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). " alt="" coords="796,515,969,557"/>
<area shape="rect" id="node17" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a78e80ef586cc59284a2c9af365e1f0b6" title="Marks shared memories as being removed so that it will be reclaimed when all processes detach it..." alt="" coords="531,377,717,418"/>
<area shape="rect" id="node19" href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a10383a5371b4bac033184c7441719fee" title="Removes all access restrictions via mprotect(). " alt="" coords="533,442,715,483"/>
<area shape="rect" id="node20" href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a2242e8ed93e24a8cba2097c3433e0216" title="Called at shutdown to check whether these boundaries were not accessed. " alt="" coords="533,246,715,287"/>
<area shape="rect" id="node21" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#a46e22c8cac15e20ccea8ac8e77311b23" title="foedus::soc::GlobalMemory\lAnchors::clear" alt="" coords="533,311,715,353"/>
<area shape="rect" id="node25" href="structfoedus_1_1externalize_1_1Externalizable.html#a546988f0869a3899e671f702ecbc5b17" title="Reads the content of this object from the given XML element. " alt="" coords="552,589,696,630"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a4b6032d62764c145607306973945bb8c_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a4b6032d62764c145607306973945bb8c_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a4b6032d62764c145607306973945bb8c_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a4b6032d62764c145607306973945bb8c_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1d09b3bd25667fccd9bb831303788401" title="Called as part of initialize_once() if this is a child SOC engine. " alt="" coords="260,5,463,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="511,5,713,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9cea4a83fb68a8f86ad43c04165c06e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::soc::SharedMemoryRepo::calculate_global_memory_size </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>xml_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1EngineOptions.html">EngineOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8cpp_source.html#l00365">365</a> of file <a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8cpp_source.html#l00065">foedus::soc::align_4kb()</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00221">foedus::soc::GlobalMemoryAnchors::kLogManagerMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00220">foedus::soc::GlobalMemoryAnchors::kMasterStatusMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00222">foedus::soc::GlobalMemoryAnchors::kMetaLoggerSize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00223">foedus::soc::GlobalMemoryAnchors::kRestartManagerMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00225">foedus::soc::GlobalMemoryAnchors::kSavepointManagerMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00226">foedus::soc::GlobalMemoryAnchors::kSnapshotManagerMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00227">foedus::soc::GlobalMemoryAnchors::kStorageManagerMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00229">foedus::soc::GlobalMemoryAnchors::kStorageMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00228">foedus::soc::GlobalMemoryAnchors::kXctManagerMemorySize</a>, <a class="el" href="storage__options_8hpp_source.html#l00043">foedus::storage::StorageOptions::max_storages_</a>, <a class="el" href="storage__options_8hpp_source.html#l00051">foedus::storage::StorageOptions::partitioner_data_memory_mb_</a>, <a class="el" href="soc__options_8hpp_source.html#l00060">foedus::soc::SocOptions::shared_user_memory_size_kb_</a>, <a class="el" href="engine__options_8hpp_source.html#l00144">foedus::EngineOptions::soc_</a>, and <a class="el" href="engine__options_8hpp_source.html#l00145">foedus::EngineOptions::storage_</a>.</p>

<p>Referenced by <a class="el" href="shared__memory__repo_8cpp_source.html#l00096">allocate_shared_memories()</a>, and <a class="el" href="engine__options_8cpp_source.html#l00341">foedus::EngineOptions::calculate_required_memory()</a>.</p>
<div class="fragment"><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keyword">const</span> uint64_t kBoundarySize = <span class="keyword">sizeof</span>(assorted::ProtectedBoundary);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  uint64_t total = 0;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  total += <a class="code" href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643">align_4kb</a>(<span class="keyword">sizeof</span>(xml_size) + xml_size) + kBoundarySize;  <span class="comment">// options_xml_</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545a483c66f4b0cada84a76ec7da062b026d">GlobalMemoryAnchors::kMasterStatusMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545a5a53b8bf839cf2cd6e406fc1923224c1">GlobalMemoryAnchors::kLogManagerMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545a9eeaa3a529263c0a5c788c7f1fa88811">GlobalMemoryAnchors::kMetaLoggerSize</a> + kBoundarySize;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545a19c7d2bb903886200b85236576f8d713">GlobalMemoryAnchors::kRestartManagerMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545aa7a2df985ae74439922cac045b8dab2b">GlobalMemoryAnchors::kSavepointManagerMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545ae43384354b9366870fbd9840bdca2c59">GlobalMemoryAnchors::kSnapshotManagerMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545aec17b128faf411c04630ee5a7cf26e1d">GlobalMemoryAnchors::kStorageManagerMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545a98864eba79f3bca83fc06661bb0344be">GlobalMemoryAnchors::kXctManagerMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  total +=</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643">align_4kb</a>(<span class="keyword">sizeof</span>(storage::PartitionerMetadata) * options.storage_.max_storages_)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    + kBoundarySize;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  total +=</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    (<span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(options.storage_.partitioner_data_memory_mb_) &lt;&lt; 20)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;     + kBoundarySize;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  total +=</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643">align_4kb</a>(<span class="keyword">sizeof</span>(<a class="code" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">storage::StorageId</a>) * options.storage_.max_storages_)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    + kBoundarySize;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  total +=</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(<a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545ae94b1957ca95c7c2d9ce3dfd302dec2b">GlobalMemoryAnchors::kStorageMemorySize</a>) * options.storage_.max_storages_</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    + kBoundarySize;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  total += <a class="code" href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643">align_4kb</a>(1024ULL * options.soc_.shared_user_memory_size_kb_) + kBoundarySize;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordflow">return</span> total;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ad087cfa2750075baaf8443032fcde545ae94b1957ca95c7c2d9ce3dfd302dec2b"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545ae94b1957ca95c7c2d9ce3dfd302dec2b">foedus::soc::GlobalMemoryAnchors::kStorageMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00229">shared_memory_repo.hpp:229</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga595ca7fc4a3011a9704a883a25141e5f"><div class="ttname"><a href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">foedus::storage::StorageId</a></div><div class="ttdeci">uint32_t StorageId</div><div class="ttdoc">Unique ID for storage. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00055">storage_id.hpp:55</a></div></div>
<div class="ttc" id="namespacefoedus_1_1soc_html_a91ebb7be5e6cf6cadff3c7b7c2260643"><div class="ttname"><a href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643">foedus::soc::align_4kb</a></div><div class="ttdeci">uint64_t align_4kb(uint64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00065">shared_memory_repo.cpp:65</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ad087cfa2750075baaf8443032fcde545aa7a2df985ae74439922cac045b8dab2b"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545aa7a2df985ae74439922cac045b8dab2b">foedus::soc::GlobalMemoryAnchors::kSavepointManagerMemorySize</a></div><div class="ttdoc">3 << 19 is for FixedSavepoint. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00225">shared_memory_repo.hpp:225</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ad087cfa2750075baaf8443032fcde545a19c7d2bb903886200b85236576f8d713"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545a19c7d2bb903886200b85236576f8d713">foedus::soc::GlobalMemoryAnchors::kRestartManagerMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00223">shared_memory_repo.hpp:223</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ad087cfa2750075baaf8443032fcde545a5a53b8bf839cf2cd6e406fc1923224c1"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545a5a53b8bf839cf2cd6e406fc1923224c1">foedus::soc::GlobalMemoryAnchors::kLogManagerMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00221">shared_memory_repo.hpp:221</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ad087cfa2750075baaf8443032fcde545a9eeaa3a529263c0a5c788c7f1fa88811"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545a9eeaa3a529263c0a5c788c7f1fa88811">foedus::soc::GlobalMemoryAnchors::kMetaLoggerSize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00222">shared_memory_repo.hpp:222</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ad087cfa2750075baaf8443032fcde545a483c66f4b0cada84a76ec7da062b026d"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545a483c66f4b0cada84a76ec7da062b026d">foedus::soc::GlobalMemoryAnchors::kMasterStatusMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00220">shared_memory_repo.hpp:220</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ad087cfa2750075baaf8443032fcde545aec17b128faf411c04630ee5a7cf26e1d"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545aec17b128faf411c04630ee5a7cf26e1d">foedus::soc::GlobalMemoryAnchors::kStorageManagerMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00227">shared_memory_repo.hpp:227</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ad087cfa2750075baaf8443032fcde545ae43384354b9366870fbd9840bdca2c59"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545ae43384354b9366870fbd9840bdca2c59">foedus::soc::GlobalMemoryAnchors::kSnapshotManagerMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00226">shared_memory_repo.hpp:226</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ad087cfa2750075baaf8443032fcde545a98864eba79f3bca83fc06661bb0344be"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ad087cfa2750075baaf8443032fcde545a98864eba79f3bca83fc06661bb0344be">foedus::soc::GlobalMemoryAnchors::kXctManagerMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00228">shared_memory_repo.hpp:228</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a9cea4a83fb68a8f86ad43c04165c06e3_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a9cea4a83fb68a8f86ad43c04165c06e3_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a9cea4a83fb68a8f86ad43c04165c06e3_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a9cea4a83fb68a8f86ad43c04165c06e3_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643" title="foedus::soc::align_4kb" alt="" coords="239,20,391,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a9cea4a83fb68a8f86ad43c04165c06e3_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a9cea4a83fb68a8f86ad43c04165c06e3_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a9cea4a83fb68a8f86ad43c04165c06e3_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a9cea4a83fb68a8f86ad43c04165c06e3_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa42d7f6cd529569e79e4cfc298adb39b" title="Master process creates shared memories by calling this method. " alt="" coords="239,5,453,47"/>
<area shape="rect" id="node5" href="structfoedus_1_1EngineOptions.html#ace695b3d0e069ed255df9572f71ecfa4" title="foedus::EngineOptions\l::calculate_required\l_memory" alt="" coords="269,71,423,127"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="501,5,704,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="752,5,955,47"/>
<area shape="rect" id="node6" href="structfoedus_1_1EngineOptions.html#ae11d1267946c562743cea44470525a69" title="Checks the machine environment and raises as many errors as possible before the engine starts up..." alt="" coords="526,79,679,120"/>
<area shape="rect" id="node7" href="classfoedus_1_1EnginePimpl.html#ad48323b2f8311ecee663647aeeecdea6" title="foedus::EnginePimpl\l::check_valid_options" alt="" coords="780,79,927,120"/>
<area shape="rect" id="node8" href="classfoedus_1_1EnginePimpl.html#a15c27fd38d4219abdf0b2deb5e5f365c" title="foedus::EnginePimpl\l::initialize_once" alt="" coords="1003,79,1144,120"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2e2c4c30186c25585226aabc09e942cf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::soc::SharedMemoryRepo::calculate_node_memory_size </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1EngineOptions.html">EngineOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8cpp_source.html#l00505">505</a> of file <a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8cpp_source.html#l00065">foedus::soc::align_4kb()</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00315">foedus::soc::NodeMemoryAnchors::kChildStatusMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00318">foedus::soc::NodeMemoryAnchors::kLoggerMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00317">foedus::soc::NodeMemoryAnchors::kLogReducerMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00416">foedus::soc::ThreadMemoryAnchors::kMcsRwAsyncMappingMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00415">foedus::soc::ThreadMemoryAnchors::kMcsRwLockMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00414">foedus::soc::ThreadMemoryAnchors::kMcsWwLockMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00316">foedus::soc::NodeMemoryAnchors::kPagePoolMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00319">foedus::soc::NodeMemoryAnchors::kProcManagerMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00412">foedus::soc::ThreadMemoryAnchors::kTaskInputMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00413">foedus::soc::ThreadMemoryAnchors::kTaskOutputMemorySize</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00411">foedus::soc::ThreadMemoryAnchors::kThreadMemorySize</a>, <a class="el" href="engine__options_8hpp_source.html#l00138">foedus::EngineOptions::log_</a>, <a class="el" href="snapshot__options_8hpp_source.html#l00115">foedus::snapshot::SnapshotOptions::log_reducer_buffer_mb_</a>, <a class="el" href="log__options_8hpp_source.html#l00080">foedus::log::LogOptions::loggers_per_node_</a>, <a class="el" href="proc__options_8hpp_source.html#l00049">foedus::proc::ProcOptions::max_proc_count_</a>, <a class="el" href="storage__options_8hpp_source.html#l00043">foedus::storage::StorageOptions::max_storages_</a>, <a class="el" href="engine__options_8hpp_source.html#l00139">foedus::EngineOptions::memory_</a>, <a class="el" href="memory__options_8hpp_source.html#l00122">foedus::memory::MemoryOptions::page_pool_size_mb_per_node_</a>, <a class="el" href="engine__options_8hpp_source.html#l00140">foedus::EngineOptions::proc_</a>, <a class="el" href="engine__options_8hpp_source.html#l00143">foedus::EngineOptions::snapshot_</a>, <a class="el" href="engine__options_8hpp_source.html#l00145">foedus::EngineOptions::storage_</a>, <a class="el" href="engine__options_8hpp_source.html#l00146">foedus::EngineOptions::thread_</a>, and <a class="el" href="thread__options_8hpp_source.html#l00050">foedus::thread::ThreadOptions::thread_count_per_group_</a>.</p>

<p>Referenced by <a class="el" href="shared__memory__repo_8cpp_source.html#l00096">allocate_shared_memories()</a>, and <a class="el" href="engine__options_8cpp_source.html#l00341">foedus::EngineOptions::calculate_required_memory()</a>.</p>
<div class="fragment"><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                                                                  {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keyword">const</span> uint64_t kBoundarySize = <span class="keyword">sizeof</span>(assorted::ProtectedBoundary);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  uint64_t total = 0;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a8d6fc8477c8fa29fc8bef20b629d7de0a8b381ed757336bde142360cbe5aae198">NodeMemoryAnchors::kChildStatusMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a8d6fc8477c8fa29fc8bef20b629d7de0a1fcbcb39e37c7b46fff43094220c80ff">NodeMemoryAnchors::kPagePoolMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a8d6fc8477c8fa29fc8bef20b629d7de0ae96d747de0c8117e1a6d6b565f4b8582">NodeMemoryAnchors::kProcManagerMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  total += <a class="code" href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643">align_4kb</a>(<span class="keyword">sizeof</span>(<a class="code" href="group__PROC.html#ga66e05b529dbdf230d526ac66c01149ca">proc::ProcAndName</a>) * options.proc_.max_proc_count_) + kBoundarySize;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  total += <a class="code" href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643">align_4kb</a>(<span class="keyword">sizeof</span>(<a class="code" href="group__PROC.html#ga1442a7320d091c72ccabfbc7f9f0ff64">proc::LocalProcId</a>) * options.proc_.max_proc_count_) + kBoundarySize;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  total += <a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a8d6fc8477c8fa29fc8bef20b629d7de0a007c4bb27406657ed3002c5d26d87ed0">NodeMemoryAnchors::kLogReducerMemorySize</a> + kBoundarySize;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  total += options.storage_.max_storages_ * 4096ULL + kBoundarySize;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  uint64_t loggers_per_node = options.log_.loggers_per_node_;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  total += loggers_per_node * (<a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a8d6fc8477c8fa29fc8bef20b629d7de0a2d8d233cee6da3bf78b2d82f5ad52b1b">NodeMemoryAnchors::kLoggerMemorySize</a> + kBoundarySize);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  uint64_t threads_per_node = options.thread_.thread_count_per_group_;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  total += threads_per_node * (<a class="code" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea3bd0825749dc6071f3f1299afc25fbc4">ThreadMemoryAnchors::kThreadMemorySize</a> + kBoundarySize);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  total += threads_per_node * (<a class="code" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758eafb58d91e89c10ffec6305cae80b1defc">ThreadMemoryAnchors::kTaskInputMemorySize</a> + kBoundarySize);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  total += threads_per_node * (<a class="code" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea9639075ff64fbe04fd9838a70e156ab3">ThreadMemoryAnchors::kTaskOutputMemorySize</a> + kBoundarySize);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  total += threads_per_node * (<a class="code" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea0c3060a13d1f14ec943c6aa4ed7629fe">ThreadMemoryAnchors::kMcsWwLockMemorySize</a> + kBoundarySize);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  total += threads_per_node * (<a class="code" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758eab1fda735d16fd78358414927033f886c">ThreadMemoryAnchors::kMcsRwLockMemorySize</a> + kBoundarySize);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  total += threads_per_node * (<a class="code" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758eab1fda735d16fd78358414927033f886c">ThreadMemoryAnchors::kMcsRwLockMemorySize</a> + kBoundarySize);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  total += threads_per_node * (<a class="code" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea6068d2010f42886bf990d907d89aecf9">ThreadMemoryAnchors::kMcsRwAsyncMappingMemorySize</a> + kBoundarySize);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  total +=</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    (<span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(options.snapshot_.log_reducer_buffer_mb_) &lt;&lt; 20)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    + kBoundarySize;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">// Then volatile pool at the end.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  total +=</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    (<span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(options.memory_.page_pool_size_mb_per_node_) &lt;&lt; 20)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    + kBoundarySize;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">return</span> total;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_a8d6fc8477c8fa29fc8bef20b629d7de0a1fcbcb39e37c7b46fff43094220c80ff"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a8d6fc8477c8fa29fc8bef20b629d7de0a1fcbcb39e37c7b46fff43094220c80ff">foedus::soc::NodeMemoryAnchors::kPagePoolMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00316">shared_memory_repo.hpp:316</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ThreadMemoryAnchors_html_a5c5d096932618c5ffb765a9ae839758ea3bd0825749dc6071f3f1299afc25fbc4"><div class="ttname"><a href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea3bd0825749dc6071f3f1299afc25fbc4">foedus::soc::ThreadMemoryAnchors::kThreadMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00411">shared_memory_repo.hpp:411</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ThreadMemoryAnchors_html_a5c5d096932618c5ffb765a9ae839758eafb58d91e89c10ffec6305cae80b1defc"><div class="ttname"><a href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758eafb58d91e89c10ffec6305cae80b1defc">foedus::soc::ThreadMemoryAnchors::kTaskInputMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00412">shared_memory_repo.hpp:412</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_a8d6fc8477c8fa29fc8bef20b629d7de0a8b381ed757336bde142360cbe5aae198"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a8d6fc8477c8fa29fc8bef20b629d7de0a8b381ed757336bde142360cbe5aae198">foedus::soc::NodeMemoryAnchors::kChildStatusMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00315">shared_memory_repo.hpp:315</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ThreadMemoryAnchors_html_a5c5d096932618c5ffb765a9ae839758ea0c3060a13d1f14ec943c6aa4ed7629fe"><div class="ttname"><a href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea0c3060a13d1f14ec943c6aa4ed7629fe">foedus::soc::ThreadMemoryAnchors::kMcsWwLockMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00414">shared_memory_repo.hpp:414</a></div></div>
<div class="ttc" id="namespacefoedus_1_1soc_html_a91ebb7be5e6cf6cadff3c7b7c2260643"><div class="ttname"><a href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643">foedus::soc::align_4kb</a></div><div class="ttdeci">uint64_t align_4kb(uint64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00065">shared_memory_repo.cpp:65</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_a8d6fc8477c8fa29fc8bef20b629d7de0ae96d747de0c8117e1a6d6b565f4b8582"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a8d6fc8477c8fa29fc8bef20b629d7de0ae96d747de0c8117e1a6d6b565f4b8582">foedus::soc::NodeMemoryAnchors::kProcManagerMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00319">shared_memory_repo.hpp:319</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ThreadMemoryAnchors_html_a5c5d096932618c5ffb765a9ae839758eab1fda735d16fd78358414927033f886c"><div class="ttname"><a href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758eab1fda735d16fd78358414927033f886c">foedus::soc::ThreadMemoryAnchors::kMcsRwLockMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00415">shared_memory_repo.hpp:415</a></div></div>
<div class="ttc" id="group__PROC_html_ga66e05b529dbdf230d526ac66c01149ca"><div class="ttname"><a href="group__PROC.html#ga66e05b529dbdf230d526ac66c01149ca">foedus::proc::ProcAndName</a></div><div class="ttdeci">std::pair&lt; ProcName, Proc &gt; ProcAndName</div><div class="ttdoc">Just a std::pair<ProcName, Proc>. </div><div class="ttdef"><b>Definition:</b> <a href="proc__id_8hpp_source.html#l00119">proc_id.hpp:119</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ThreadMemoryAnchors_html_a5c5d096932618c5ffb765a9ae839758ea9639075ff64fbe04fd9838a70e156ab3"><div class="ttname"><a href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea9639075ff64fbe04fd9838a70e156ab3">foedus::soc::ThreadMemoryAnchors::kTaskOutputMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00413">shared_memory_repo.hpp:413</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_a8d6fc8477c8fa29fc8bef20b629d7de0a007c4bb27406657ed3002c5d26d87ed0"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a8d6fc8477c8fa29fc8bef20b629d7de0a007c4bb27406657ed3002c5d26d87ed0">foedus::soc::NodeMemoryAnchors::kLogReducerMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00317">shared_memory_repo.hpp:317</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_a8d6fc8477c8fa29fc8bef20b629d7de0a2d8d233cee6da3bf78b2d82f5ad52b1b"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a8d6fc8477c8fa29fc8bef20b629d7de0a2d8d233cee6da3bf78b2d82f5ad52b1b">foedus::soc::NodeMemoryAnchors::kLoggerMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00318">shared_memory_repo.hpp:318</a></div></div>
<div class="ttc" id="group__PROC_html_ga1442a7320d091c72ccabfbc7f9f0ff64"><div class="ttname"><a href="group__PROC.html#ga1442a7320d091c72ccabfbc7f9f0ff64">foedus::proc::LocalProcId</a></div><div class="ttdeci">uint32_t LocalProcId</div><div class="ttdoc">Represents a locally-unique ID of a procedure in one SOC. </div><div class="ttdef"><b>Definition:</b> <a href="proc__id_8hpp_source.html#l00056">proc_id.hpp:56</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ThreadMemoryAnchors_html_a5c5d096932618c5ffb765a9ae839758ea6068d2010f42886bf990d907d89aecf9"><div class="ttname"><a href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html#a5c5d096932618c5ffb765a9ae839758ea6068d2010f42886bf990d907d89aecf9">foedus::soc::ThreadMemoryAnchors::kMcsRwAsyncMappingMemorySize</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00416">shared_memory_repo.hpp:416</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a2e2c4c30186c25585226aabc09e942cf_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a2e2c4c30186c25585226aabc09e942cf_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a2e2c4c30186c25585226aabc09e942cf_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a2e2c4c30186c25585226aabc09e942cf_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1soc.html#a91ebb7be5e6cf6cadff3c7b7c2260643" title="foedus::soc::align_4kb" alt="" coords="285,13,437,39"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a2e2c4c30186c25585226aabc09e942cf_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a2e2c4c30186c25585226aabc09e942cf_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a2e2c4c30186c25585226aabc09e942cf_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a2e2c4c30186c25585226aabc09e942cf_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa42d7f6cd529569e79e4cfc298adb39b" title="Master process creates shared memories by calling this method. " alt="" coords="285,5,500,47"/>
<area shape="rect" id="node5" href="structfoedus_1_1EngineOptions.html#ace695b3d0e069ed255df9572f71ecfa4" title="foedus::EngineOptions\l::calculate_required\l_memory" alt="" coords="316,71,469,127"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="548,5,751,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="799,5,1001,47"/>
<area shape="rect" id="node6" href="structfoedus_1_1EngineOptions.html#ae11d1267946c562743cea44470525a69" title="Checks the machine environment and raises as many errors as possible before the engine starts up..." alt="" coords="573,79,726,120"/>
<area shape="rect" id="node7" href="classfoedus_1_1EnginePimpl.html#ad48323b2f8311ecee663647aeeecdea6" title="foedus::EnginePimpl\l::check_valid_options" alt="" coords="827,79,973,120"/>
<area shape="rect" id="node8" href="classfoedus_1_1EnginePimpl.html#a15c27fd38d4219abdf0b2deb5e5f365c" title="foedus::EnginePimpl\l::initialize_once" alt="" coords="1049,79,1191,120"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad6e39207d5c93495c392a8c41ffae38e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::soc::SharedMemoryRepo::change_child_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a>&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1soc_1_1ChildEngineStatus.html#a7578e96cb975278b2b2434d568e39ce7">ChildEngineStatus::StatusCode</a>&#160;</td>
          <td class="paramname"><em>new_status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8cpp_source.html#l00547">547</a> of file <a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8hpp_source.html#l00179">foedus::soc::ChildEngineStatus::change_status_atomic()</a>, and <a class="el" href="shared__memory__repo_8hpp_source.html#l00338">foedus::soc::NodeMemoryAnchors::child_status_memory_</a>.</p>

<p>Referenced by <a class="el" href="shared__memory__repo_8cpp_source.html#l00165">attach_shared_memories()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00594">foedus::soc::SocManagerPimpl::child_main_common()</a>, and <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00128">foedus::soc::SocManagerPimpl::initialize_child()</a>.</p>
<div class="fragment"><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                                                                             {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  node_memory_anchors_[node].<a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a9561bc9630f921a8bc174e300fbe212d">child_status_memory_</a>-&gt;<a class="code" href="structfoedus_1_1soc_1_1ChildEngineStatus.html#aa4e9303cf9cd2299bd7e9f44f6e837e0">change_status_atomic</a>(new_status);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1soc_1_1ChildEngineStatus_html_aa4e9303cf9cd2299bd7e9f44f6e837e0"><div class="ttname"><a href="structfoedus_1_1soc_1_1ChildEngineStatus.html#aa4e9303cf9cd2299bd7e9f44f6e837e0">foedus::soc::ChildEngineStatus::change_status_atomic</a></div><div class="ttdeci">void change_status_atomic(StatusCode new_status)</div><div class="ttdoc">Update the value of status_code_ with fence. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00179">shared_memory_repo.hpp:179</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_a9561bc9630f921a8bc174e300fbe212d"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a9561bc9630f921a8bc174e300fbe212d">foedus::soc::NodeMemoryAnchors::child_status_memory_</a></div><div class="ttdeci">ChildEngineStatus * child_status_memory_</div><div class="ttdoc">This tiny piece of memory contains the current status of the child engine on this node...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00338">shared_memory_repo.hpp:338</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_ad6e39207d5c93495c392a8c41ffae38e_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_ad6e39207d5c93495c392a8c41ffae38e_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_ad6e39207d5c93495c392a8c41ffae38e_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_ad6e39207d5c93495c392a8c41ffae38e_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1soc_1_1ChildEngineStatus.html#aa4e9303cf9cd2299bd7e9f44f6e837e0" title="Update the value of status_code_ with fence. " alt="" coords="239,5,405,61"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf" title="Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). " alt="" coords="453,13,627,54"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_ad6e39207d5c93495c392a8c41ffae38e_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_ad6e39207d5c93495c392a8c41ffae38e_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_ad6e39207d5c93495c392a8c41ffae38e_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_ad6e39207d5c93495c392a8c41ffae38e_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a4b6032d62764c145607306973945bb8c" title="Child processes (emulated or not) set a reference to shared memory and receive the EngnieOption value..." alt="" coords="239,5,445,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1d09b3bd25667fccd9bb831303788401" title="Called as part of initialize_once() if this is a child SOC engine. " alt="" coords="493,5,696,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#adfd1a1b588c61f7b8efaf8e0e9fd5f8f" title="foedus::soc::SocManagerPimpl\l::child_main_common" alt="" coords="241,129,443,171"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="1245,40,1448,81"/>
<area shape="rect" id="node6" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a2b7bbec9fe5f7713ae184361dcd658f8" title="Main routine of emulated SOCs. " alt="" coords="493,71,696,112"/>
<area shape="rect" id="node9" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a15ec97d18049b472d172cb50c25e489b" title="Main routine of forked SOCs. " alt="" coords="493,136,696,177"/>
<area shape="rect" id="node11" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a328e5ee7367152a0033bcc5843867eb1" title="Main routine of spawned SOCs. " alt="" coords="493,201,696,243"/>
<area shape="rect" id="node7" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a77d275f92471e6ac9e0c4bb4c609665f" title="Launch emulated children as threads. " alt="" coords="744,71,947,112"/>
<area shape="rect" id="node8" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="995,71,1197,112"/>
<area shape="rect" id="node10" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#ad9ef70c0b175a6535731e2cf0c2370f1" title="Launch children via fork. " alt="" coords="744,136,947,177"/>
<area shape="rect" id="node12" href="classfoedus_1_1soc_1_1SocManager.html#a8b8ea1146fa76120be0fcb5ace838d0f" title="This version also receives user&#45;defined procedures to be registered in this SOC. " alt="" coords="759,201,932,243"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a45aa9998863c0d0f8548806d06503972"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::soc::SharedMemoryRepo::change_master_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1soc_1_1MasterEngineStatus.html#aa27f54bcc29ab6a9bb7c4dbd21914afd">MasterEngineStatus::StatusCode</a>&#160;</td>
          <td class="paramname"><em>new_status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8cpp_source.html#l00539">539</a> of file <a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8hpp_source.html#l00102">foedus::soc::MasterEngineStatus::change_status_atomic()</a>, and <a class="el" href="shared__memory__repo_8hpp_source.html#l00250">foedus::soc::GlobalMemoryAnchors::master_status_memory_</a>.</p>

<p>Referenced by <a class="el" href="engine__pimpl_8cpp_source.html#l00096">foedus::EnginePimpl::initialize_once()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00479">foedus::soc::SocManagerPimpl::launch_forked_children()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00523">foedus::soc::SocManagerPimpl::launch_spawned_children()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00057">foedus::soc::SocManagerPimpl::uninitialize_once()</a>, <a class="el" href="engine__pimpl_8cpp_source.html#l00178">foedus::EnginePimpl::uninitialize_once()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00152">foedus::soc::SocManagerPimpl::wait_for_child_attach()</a>, and <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00228">foedus::soc::SocManagerPimpl::wait_for_child_terminate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                                                                   {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  global_memory_anchors_.<a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ae21c8452d4ace76cd9c71813742964aa">master_status_memory_</a>-&gt;<a class="code" href="structfoedus_1_1soc_1_1MasterEngineStatus.html#aa3f2eb00974e1e60ce9a03e8f8f64954">change_status_atomic</a>(new_status);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1soc_1_1MasterEngineStatus_html_aa3f2eb00974e1e60ce9a03e8f8f64954"><div class="ttname"><a href="structfoedus_1_1soc_1_1MasterEngineStatus.html#aa3f2eb00974e1e60ce9a03e8f8f64954">foedus::soc::MasterEngineStatus::change_status_atomic</a></div><div class="ttdeci">void change_status_atomic(StatusCode new_status)</div><div class="ttdoc">Update the value of status_code_ with fence. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00102">shared_memory_repo.hpp:102</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ae21c8452d4ace76cd9c71813742964aa"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ae21c8452d4ace76cd9c71813742964aa">foedus::soc::GlobalMemoryAnchors::master_status_memory_</a></div><div class="ttdeci">MasterEngineStatus * master_status_memory_</div><div class="ttdoc">This tiny piece of memory contains the current status of the master engine and its synchronization me...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00250">shared_memory_repo.hpp:250</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a45aa9998863c0d0f8548806d06503972_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a45aa9998863c0d0f8548806d06503972_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a45aa9998863c0d0f8548806d06503972_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a45aa9998863c0d0f8548806d06503972_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1soc_1_1MasterEngineStatus.html#aa3f2eb00974e1e60ce9a03e8f8f64954" title="Update the value of status_code_ with fence. " alt="" coords="245,5,444,47"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf" title="Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). " alt="" coords="492,5,665,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a45aa9998863c0d0f8548806d06503972_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a45aa9998863c0d0f8548806d06503972_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a45aa9998863c0d0f8548806d06503972_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a45aa9998863c0d0f8548806d06503972_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1EnginePimpl.html#a15c27fd38d4219abdf0b2deb5e5f365c" title="foedus::EnginePimpl\l::initialize_once" alt="" coords="276,5,417,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#ad9ef70c0b175a6535731e2cf0c2370f1" title="Launch children via fork. " alt="" coords="496,57,699,99"/>
<area shape="rect" id="node6" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a4a9091baae2ba21b2cb888da8d391818" title="Launch children via spawn. " alt="" coords="496,188,699,229"/>
<area shape="rect" id="node7" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1d435277bd229b7988c3f249c0a0730f" title="foedus::soc::SocManagerPimpl\l::uninitialize_once" alt="" coords="496,328,699,369"/>
<area shape="rect" id="node8" href="classfoedus_1_1EnginePimpl.html#a483875a16cf2f469b8b751c9f6e2d673" title="foedus::EnginePimpl\l::uninitialize_once" alt="" coords="276,240,417,281"/>
<area shape="rect" id="node9" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a998409bf9e2aff10ec8dfb02f17bb956" title="Wait for child SOCs to start up and at least finish attaching shared memory. " alt="" coords="245,123,448,164"/>
<area shape="rect" id="node11" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#afa01a52797a06b55092eeb900a7f62ef" title="Wait for child SOCs to terminate. " alt="" coords="245,357,448,399"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="747,123,949,164"/>
<area shape="rect" id="node5" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="997,123,1200,164"/>
<area shape="rect" id="node10" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a77d275f92471e6ac9e0c4bb4c609665f" title="Launch emulated children as threads. " alt="" coords="496,123,699,164"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa961c615ceddd0dd0d3943629fd1a147"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::soc::SharedMemoryRepo::deallocate_shared_memories </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detaches and releases the shared memories. </p>
<p>In child processes, this just detaches. </p>

<p>Definition at line <a class="el" href="shared__memory__repo_8cpp_source.html#l00223">223</a> of file <a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a>.</p>

<p>References <a class="el" href="protected__boundary_8hpp_source.html#l00103">foedus::assorted::ProtectedBoundary::assert_boundary()</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00235">foedus::soc::GlobalMemoryAnchors::clear()</a>, <a class="el" href="shared__memory_8hpp_source.html#l00152">foedus::memory::SharedMemory::is_null()</a>, <a class="el" href="shared__memory__repo_8cpp_source.html#l00214">mark_for_release()</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00302">foedus::soc::GlobalMemoryAnchors::protected_boundaries_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00398">foedus::soc::NodeMemoryAnchors::protected_boundaries_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00304">foedus::soc::GlobalMemoryAnchors::protected_boundaries_count_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00400">foedus::soc::NodeMemoryAnchors::protected_boundaries_count_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00306">foedus::soc::GlobalMemoryAnchors::protected_boundaries_needs_release_</a>, <a class="el" href="shared__memory_8cpp_source.html#l00222">foedus::memory::SharedMemory::release_block()</a>, and <a class="el" href="protected__boundary_8cpp_source.html#l00033">foedus::assorted::ProtectedBoundary::release_protect()</a>.</p>

<p>Referenced by <a class="el" href="shared__memory__repo_8cpp_source.html#l00096">allocate_shared_memories()</a>, <a class="el" href="shared__memory__repo_8cpp_source.html#l00165">attach_shared_memories()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00086">foedus::soc::SocManagerPimpl::initialize_master()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00479">foedus::soc::SocManagerPimpl::launch_forked_children()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00523">foedus::soc::SocManagerPimpl::launch_spawned_children()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00057">foedus::soc::SocManagerPimpl::uninitialize_once()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00152">foedus::soc::SocManagerPimpl::wait_for_child_attach()</a>, and <a class="el" href="shared__memory__repo_8hpp_source.html#l00470">~SharedMemoryRepo()</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                                  {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a78e80ef586cc59284a2c9af365e1f0b6">mark_for_release</a>();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">if</span> (!global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#acbdca7a06f5b1fe14cba7c718c822ac4">is_null</a>()) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (global_memory_anchors_.<a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#acd017f6f29b5a120b1fab19d173d8c19">protected_boundaries_needs_release_</a>) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; global_memory_anchors_.<a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#af8a9ab6db1d945d4b3ad0b44410b0560">protected_boundaries_count_</a>; ++i) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        assorted::ProtectedBoundary* boundary = global_memory_anchors_.<a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#a5281c012a4e79a5de31434b7939c1fb2">protected_boundaries_</a>[i];</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        boundary-&gt;<a class="code" href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a10383a5371b4bac033184c7441719fee">release_protect</a>();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        boundary-&gt;assert_boundary();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  global_memory_anchors_.<a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#a46e22c8cac15e20ccea8ac8e77311b23">clear</a>();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// release_block() is idempotent, so just do it on all of them</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a20f2fb7b7f86ab5c4134452f1267eeb5">release_block</a>();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">for</span> (uint16_t i = 0; i &lt; soc_count_; ++i) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (node_memories_) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">if</span> (node_memory_anchors_[i].protected_boundaries_needs_release_) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">for</span> (uint32_t j = 0; j &lt; node_memory_anchors_[i].<a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#aa95114b613d6e0f4dbc622fa8ec05bd0">protected_boundaries_count_</a>; ++j) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          assorted::ProtectedBoundary* boundary = node_memory_anchors_[i].<a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a2acbd6fef01e6f8eb04e0b6637b5d601">protected_boundaries_</a>[j];</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          boundary-&gt;<a class="code" href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a10383a5371b4bac033184c7441719fee">release_protect</a>();</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          boundary-&gt;assert_boundary();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      node_memories_[i].<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a20f2fb7b7f86ab5c4134452f1267eeb5">release_block</a>();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">if</span> (node_memories_) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">delete</span>[] node_memories_;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    node_memories_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (node_memory_anchors_) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keyword">delete</span>[] node_memory_anchors_;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    node_memory_anchors_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  soc_count_ = 0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_aa95114b613d6e0f4dbc622fa8ec05bd0"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#aa95114b613d6e0f4dbc622fa8ec05bd0">foedus::soc::NodeMemoryAnchors::protected_boundaries_count_</a></div><div class="ttdeci">uint32_t protected_boundaries_count_</div><div class="ttdoc">To be a POD, we avoid vector and instead uses a fix-sized array. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00400">shared_memory_repo.hpp:400</a></div></div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMemoryRepo_html_a78e80ef586cc59284a2c9af365e1f0b6"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a78e80ef586cc59284a2c9af365e1f0b6">foedus::soc::SharedMemoryRepo::mark_for_release</a></div><div class="ttdeci">void mark_for_release()</div><div class="ttdoc">Marks shared memories as being removed so that it will be reclaimed when all processes detach it...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8cpp_source.html#l00214">shared_memory_repo.cpp:214</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_a46e22c8cac15e20ccea8ac8e77311b23"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#a46e22c8cac15e20ccea8ac8e77311b23">foedus::soc::GlobalMemoryAnchors::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00235">shared_memory_repo.hpp:235</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_af8a9ab6db1d945d4b3ad0b44410b0560"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#af8a9ab6db1d945d4b3ad0b44410b0560">foedus::soc::GlobalMemoryAnchors::protected_boundaries_count_</a></div><div class="ttdeci">uint32_t protected_boundaries_count_</div><div class="ttdoc">To be a POD, we avoid vector and instead uses a fix-sized array. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00304">shared_memory_repo.hpp:304</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_a2acbd6fef01e6f8eb04e0b6637b5d601"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a2acbd6fef01e6f8eb04e0b6637b5d601">foedus::soc::NodeMemoryAnchors::protected_boundaries_</a></div><div class="ttdeci">assorted::ProtectedBoundary * protected_boundaries_[kMaxBoundaries]</div><div class="ttdoc">sanity check boundaries to detect bogus memory accesses that overrun a memory region ...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00398">shared_memory_repo.hpp:398</a></div></div>
<div class="ttc" id="structfoedus_1_1assorted_1_1ProtectedBoundary_html_a10383a5371b4bac033184c7441719fee"><div class="ttname"><a href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a10383a5371b4bac033184c7441719fee">foedus::assorted::ProtectedBoundary::release_protect</a></div><div class="ttdeci">ErrorCode release_protect()</div><div class="ttdoc">Removes all access restrictions via mprotect(). </div><div class="ttdef"><b>Definition:</b> <a href="protected__boundary_8cpp_source.html#l00033">protected_boundary.cpp:33</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1SharedMemory_html_acbdca7a06f5b1fe14cba7c718c822ac4"><div class="ttname"><a href="classfoedus_1_1memory_1_1SharedMemory.html#acbdca7a06f5b1fe14cba7c718c822ac4">foedus::memory::SharedMemory::is_null</a></div><div class="ttdeci">bool is_null() const </div><div class="ttdoc">Returns if this object doesn&#39;t hold a valid memory block. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory_8hpp_source.html#l00152">shared_memory.hpp:152</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_acd017f6f29b5a120b1fab19d173d8c19"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#acd017f6f29b5a120b1fab19d173d8c19">foedus::soc::GlobalMemoryAnchors::protected_boundaries_needs_release_</a></div><div class="ttdeci">bool protected_boundaries_needs_release_</div><div class="ttdoc">whether we have invoked mprotect on them </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00306">shared_memory_repo.hpp:306</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_a5281c012a4e79a5de31434b7939c1fb2"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#a5281c012a4e79a5de31434b7939c1fb2">foedus::soc::GlobalMemoryAnchors::protected_boundaries_</a></div><div class="ttdeci">assorted::ProtectedBoundary * protected_boundaries_[kMaxBoundaries]</div><div class="ttdoc">sanity check boundaries to detect bogus memory accesses that overrun a memory region ...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00302">shared_memory_repo.hpp:302</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1SharedMemory_html_a20f2fb7b7f86ab5c4134452f1267eeb5"><div class="ttname"><a href="classfoedus_1_1memory_1_1SharedMemory.html#a20f2fb7b7f86ab5c4134452f1267eeb5">foedus::memory::SharedMemory::release_block</a></div><div class="ttdeci">void release_block()</div><div class="ttdoc">Releases the memory block IF this process has an ownership. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory_8cpp_source.html#l00222">shared_memory.cpp:222</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_aa961c615ceddd0dd0d3943629fd1a147_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_aa961c615ceddd0dd0d3943629fd1a147_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_aa961c615ceddd0dd0d3943629fd1a147_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_aa961c615ceddd0dd0d3943629fd1a147_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a2242e8ed93e24a8cba2097c3433e0216" title="Called at shutdown to check whether these boundaries were not accessed. " alt="" coords="253,5,435,47"/>
<area shape="rect" id="node3" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#a46e22c8cac15e20ccea8ac8e77311b23" title="foedus::soc::GlobalMemory\lAnchors::clear" alt="" coords="253,71,435,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1SharedMemory.html#acbdca7a06f5b1fe14cba7c718c822ac4" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="239,136,449,177"/>
<area shape="rect" id="node5" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a78e80ef586cc59284a2c9af365e1f0b6" title="Marks shared memories as being removed so that it will be reclaimed when all processes detach it..." alt="" coords="251,201,437,243"/>
<area shape="rect" id="node7" href="classfoedus_1_1memory_1_1SharedMemory.html#a20f2fb7b7f86ab5c4134452f1267eeb5" title="Releases the memory block IF this process has an ownership. " alt="" coords="239,267,449,308"/>
<area shape="rect" id="node15" href="structfoedus_1_1assorted_1_1ProtectedBoundary.html#a10383a5371b4bac033184c7441719fee" title="Removes all access restrictions via mprotect(). " alt="" coords="253,332,435,373"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1SharedMemory.html#a06fa097c286b762b8ae484076592bf0d" title="Marks the shared memory as being removed so that it will be reclaimed when all processes detach it..." alt="" coords="497,201,708,243"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1SharedMemory.html#a83f0c9b29ecfc29550923dd33bc031e7" title="Returns if this process owns this memory and is responsible to delete it. " alt="" coords="497,267,708,308"/>
<area shape="rect" id="node9" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="533,332,673,373"/>
<area shape="rect" id="node10" href="group__FILESYSTEM.html#gad1f62b080fa246b5f8c166f44c72134f" title="Deletes a regular file or an empty directory. " alt="" coords="539,398,666,425"/>
<area shape="rect" id="node11" href="structfoedus_1_1fs_1_1FileStatus.html#ac4ab24d4308aab673c8d1606a84367e5" title="foedus::fs::FileStatus\l::exists" alt="" coords="756,325,901,367"/>
<area shape="rect" id="node12" href="structfoedus_1_1fs_1_1FileStatus.html#a76000c37b9fc4c1d9596240409972809" title="foedus::fs::FileStatus\l::is_regular_file" alt="" coords="756,391,901,432"/>
<area shape="rect" id="node13" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="767,457,890,483"/>
<area shape="rect" id="node14" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="949,457,1100,483"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_aa961c615ceddd0dd0d3943629fd1a147_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_aa961c615ceddd0dd0d3943629fd1a147_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_aa961c615ceddd0dd0d3943629fd1a147_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_aa961c615ceddd0dd0d3943629fd1a147_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa42d7f6cd529569e79e4cfc298adb39b" title="Master process creates shared memories by calling this method. " alt="" coords="493,61,708,103"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="756,151,959,192"/>
<area shape="rect" id="node5" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a4b6032d62764c145607306973945bb8c" title="Child processes (emulated or not) set a reference to shared memory and receive the EngnieOption value..." alt="" coords="239,5,445,47"/>
<area shape="rect" id="node7" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#ad9ef70c0b175a6535731e2cf0c2370f1" title="Launch children via fork. " alt="" coords="499,179,702,220"/>
<area shape="rect" id="node8" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a4a9091baae2ba21b2cb888da8d391818" title="Launch children via spawn. " alt="" coords="499,309,702,351"/>
<area shape="rect" id="node9" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1d435277bd229b7988c3f249c0a0730f" title="foedus::soc::SocManagerPimpl\l::uninitialize_once" alt="" coords="241,295,443,336"/>
<area shape="rect" id="node10" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a998409bf9e2aff10ec8dfb02f17bb956" title="Wait for child SOCs to start up and at least finish attaching shared memory. " alt="" coords="241,229,443,271"/>
<area shape="rect" id="node12" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ae93958bcd01826cc39e3b84333d1c3d9" title="foedus::soc::SharedMemory\lRepo::~SharedMemoryRepo" alt="" coords="249,412,435,453"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="1007,91,1209,132"/>
<area shape="rect" id="node6" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1d09b3bd25667fccd9bb831303788401" title="Called as part of initialize_once() if this is a child SOC engine. " alt="" coords="756,31,959,72"/>
<area shape="rect" id="node11" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a77d275f92471e6ac9e0c4bb4c609665f" title="Launch emulated children as threads. " alt="" coords="499,244,702,285"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a858b2e2cceeb9f8c71722ed5f8c3c069"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1soc_1_1ChildEngineStatus.html#a7578e96cb975278b2b2434d568e39ce7">ChildEngineStatus::StatusCode</a> foedus::soc::SharedMemoryRepo::get_child_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a>&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8cpp_source.html#l00551">551</a> of file <a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8hpp_source.html#l00338">foedus::soc::NodeMemoryAnchors::child_status_memory_</a>, and <a class="el" href="shared__memory__repo_8hpp_source.html#l00187">foedus::soc::ChildEngineStatus::read_status_atomic()</a>.</p>

<p>Referenced by <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00152">foedus::soc::SocManagerPimpl::wait_for_child_attach()</a>, and <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00228">foedus::soc::SocManagerPimpl::wait_for_child_terminate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                                                               {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">return</span> node_memory_anchors_[node].<a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a9561bc9630f921a8bc174e300fbe212d">child_status_memory_</a>-&gt;<a class="code" href="structfoedus_1_1soc_1_1ChildEngineStatus.html#ac8acd97b1b354cda68779ade6a963d04">read_status_atomic</a>();</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_a9561bc9630f921a8bc174e300fbe212d"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a9561bc9630f921a8bc174e300fbe212d">foedus::soc::NodeMemoryAnchors::child_status_memory_</a></div><div class="ttdeci">ChildEngineStatus * child_status_memory_</div><div class="ttdoc">This tiny piece of memory contains the current status of the child engine on this node...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00338">shared_memory_repo.hpp:338</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1ChildEngineStatus_html_ac8acd97b1b354cda68779ade6a963d04"><div class="ttname"><a href="structfoedus_1_1soc_1_1ChildEngineStatus.html#ac8acd97b1b354cda68779ade6a963d04">foedus::soc::ChildEngineStatus::read_status_atomic</a></div><div class="ttdeci">StatusCode read_status_atomic() const </div><div class="ttdoc">Read status_code_ with fence. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00187">shared_memory_repo.hpp:187</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a858b2e2cceeb9f8c71722ed5f8c3c069_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a858b2e2cceeb9f8c71722ed5f8c3c069_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a858b2e2cceeb9f8c71722ed5f8c3c069_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a858b2e2cceeb9f8c71722ed5f8c3c069_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1soc_1_1ChildEngineStatus.html#ac8acd97b1b354cda68779ade6a963d04" title="Read status_code_ with fence. " alt="" coords="239,5,421,47"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf" title="Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). " alt="" coords="469,5,643,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a858b2e2cceeb9f8c71722ed5f8c3c069_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a858b2e2cceeb9f8c71722ed5f8c3c069_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a858b2e2cceeb9f8c71722ed5f8c3c069_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a858b2e2cceeb9f8c71722ed5f8c3c069_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a998409bf9e2aff10ec8dfb02f17bb956" title="Wait for child SOCs to start up and at least finish attaching shared memory. " alt="" coords="239,88,441,129"/>
<area shape="rect" id="node8" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#afa01a52797a06b55092eeb900a7f62ef" title="Wait for child SOCs to terminate. " alt="" coords="239,169,441,211"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a77d275f92471e6ac9e0c4bb4c609665f" title="Launch emulated children as threads. " alt="" coords="489,5,692,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#ad9ef70c0b175a6535731e2cf0c2370f1" title="Launch children via fork. " alt="" coords="489,71,692,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a4a9091baae2ba21b2cb888da8d391818" title="Launch children via spawn. " alt="" coords="489,136,692,177"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="740,71,943,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="991,71,1193,112"/>
<area shape="rect" id="node9" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1d435277bd229b7988c3f249c0a0730f" title="foedus::soc::SocManagerPimpl\l::uninitialize_once" alt="" coords="489,201,692,243"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8e083b61b71eaf53a3a291d16f7a81ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* foedus::soc::SharedMemoryRepo::get_global_memory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8hpp_source.html#l00513">513</a> of file <a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>.</p>

<p>References <a class="el" href="shared__memory_8hpp_source.html#l00144">foedus::memory::SharedMemory::get_block()</a>.</p>

<p>Referenced by <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00057">foedus::soc::SocManagerPimpl::uninitialize_once()</a>.</p>
<div class="fragment"><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{ <span class="keywordflow">return</span> global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113">get_block</a>(); }</div>
<div class="ttc" id="classfoedus_1_1memory_1_1SharedMemory_html_a085dfb81511ba8e4c0563b5a72967113"><div class="ttname"><a href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113">foedus::memory::SharedMemory::get_block</a></div><div class="ttdeci">char * get_block() const </div><div class="ttdoc">Returns the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory_8hpp_source.html#l00144">shared_memory.hpp:144</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a8e083b61b71eaf53a3a291d16f7a81ee_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a8e083b61b71eaf53a3a291d16f7a81ee_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a8e083b61b71eaf53a3a291d16f7a81ee_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a8e083b61b71eaf53a3a291d16f7a81ee_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113" title="Returns the memory block. " alt="" coords="239,5,449,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a8e083b61b71eaf53a3a291d16f7a81ee_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a8e083b61b71eaf53a3a291d16f7a81ee_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a8e083b61b71eaf53a3a291d16f7a81ee_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a8e083b61b71eaf53a3a291d16f7a81ee_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1d435277bd229b7988c3f249c0a0730f" title="foedus::soc::SocManagerPimpl\l::uninitialize_once" alt="" coords="239,5,441,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1c21cc6a27cabaf4a8c9dc26985aacfb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html">GlobalMemoryAnchors</a>* foedus::soc::SharedMemoryRepo::get_global_memory_anchors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8hpp_source.html#l00514">514</a> of file <a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>.</p>

<p>Referenced by <a class="el" href="log__gleaner__impl_8cpp_source.html#l00148">foedus::snapshot::LogGleaner::execute()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00077">foedus::snapshot::LogReducerRef::get_cur_snapshot()</a>, <a class="el" href="partitioner_8cpp_source.html#l00045">foedus::storage::PartitionerMetadata::get_index0_metadata()</a>, <a class="el" href="partitioner_8cpp_source.html#l00038">foedus::storage::PartitionerMetadata::get_metadata()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00086">foedus::soc::SocManagerPimpl::initialize_master()</a>, <a class="el" href="meta__logger__impl_8cpp_source.html#l00036">foedus::log::MetaLogger::initialize_once()</a>, <a class="el" href="storage__manager__pimpl_8cpp_source.html#l00069">foedus::storage::StorageManagerPimpl::initialize_once()</a>, <a class="el" href="log__manager__pimpl_8cpp_source.html#l00049">foedus::log::LogManagerPimpl::initialize_once()</a>, <a class="el" href="xct__manager__pimpl_8cpp_source.html#l00084">foedus::xct::XctManagerPimpl::initialize_once()</a>, <a class="el" href="snapshot__manager__pimpl_8cpp_source.html#l00061">foedus::snapshot::SnapshotManagerPimpl::initialize_once()</a>, <a class="el" href="partitioner_8cpp_source.html#l00051">foedus::storage::PartitionerMetadata::locate_data()</a>, <a class="el" href="log__gleaner__ref_8cpp_source.html#l00030">foedus::snapshot::LogGleanerRef::LogGleanerRef()</a>, <a class="el" href="engine__pimpl_8cpp_source.html#l00261">foedus::EnginePimpl::on_module_initialized()</a>, <a class="el" href="engine__pimpl_8cpp_source.html#l00270">foedus::EnginePimpl::on_module_uninitialized()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00067">foedus::soc::SocManagerPimpl::report_engine_fatal_error()</a>, <a class="el" href="savepoint__manager__pimpl_8cpp_source.html#l00158">foedus::savepoint::SavepointManagerPimpl::savepoint_main()</a>, <a class="el" href="snapshot__manager__pimpl_8cpp_source.html#l00125">foedus::snapshot::SnapshotManagerPimpl::uninitialize_once()</a>, and <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00327">foedus::soc::SocManagerPimpl::wait_for_master_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;{ <span class="keywordflow">return</span> &amp;global_memory_anchors_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a1c21cc6a27cabaf4a8c9dc26985aacfb_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a1c21cc6a27cabaf4a8c9dc26985aacfb_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a1c21cc6a27cabaf4a8c9dc26985aacfb_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a1c21cc6a27cabaf4a8c9dc26985aacfb_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogGleaner.html#a617c3de45c34c6533c7f3e82216557f4" title="Main routine of log gleaner. " alt="" coords="246,92,441,133"/>
<area shape="rect" id="node6" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a632a4da7b3c67dd687f7eba4f6ec1d76" title="foedus::snapshot::Snapshot\lManagerPimpl::initialize_once" alt="" coords="2033,27,2228,68"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#aa4a57d52ef10b270b50d0e00511b24e5" title="foedus::snapshot::LogReducer\lRef::get_cur_snapshot" alt="" coords="244,472,443,513"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a889951c15caacc4d60b446f6c6c56cde" title="Returns the special index&#45;0 entry that manages data block allocation for partitioners. " alt="" coords="239,407,447,448"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aa6e48ddb92bb1c1b572cc3b90e19daf9" title="Returns the shared memory for the given storage ID. " alt="" coords="254,193,433,235"/>
<area shape="rect" id="node24" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="242,537,445,579"/>
<area shape="rect" id="node26" href="classfoedus_1_1log_1_1MetaLogger.html#a5a3484d094947ced0a08a5e162f08a88" title="foedus::log::MetaLogger\l::initialize_once" alt="" coords="263,603,424,644"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1StorageManagerPimpl.html#ad89ca2bb2619e01c3b13d65302a3d7c9" title="foedus::storage::Storage\lManagerPimpl::initialize_once" alt="" coords="246,668,441,709"/>
<area shape="rect" id="node28" href="classfoedus_1_1log_1_1LogManagerPimpl.html#a8b2cfe458668cc3f8cf4ccbfeab179dc" title="foedus::log::LogManagerPimpl\l::initialize_once" alt="" coords="245,733,442,775"/>
<area shape="rect" id="node29" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#aefb36bf03b0bd29c160f5aa36b219d45" title="foedus::xct::XctManagerPimpl\l::initialize_once" alt="" coords="246,799,441,840"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a0534520d3f4fb059afdf7b9db375907e" title="Returns the partitioner data pointed from this metadata. " alt="" coords="254,341,433,383"/>
<area shape="rect" id="node34" href="classfoedus_1_1snapshot_1_1LogGleanerRef.html#a41909aaaf2f05485a26998af4e291fbf" title="foedus::snapshot::LogGleaner\lRef::LogGleanerRef" alt="" coords="246,864,441,905"/>
<area shape="rect" id="node35" href="classfoedus_1_1EnginePimpl.html#a13acd726f8d0ab03b7976d00006a0e6b" title="Called whenever each module has completed its initialization. " alt="" coords="528,967,683,1008"/>
<area shape="rect" id="node38" href="classfoedus_1_1EnginePimpl.html#a5a2c657e4fcf77d3166da849a6af8ffd" title="Called whenever each module has completed its uninitialization. " alt="" coords="521,1097,689,1139"/>
<area shape="rect" id="node40" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a36ec21a4c2b374ce071755a8b2696e3a" title="foedus::soc::SocManagerPimpl\l::report_engine_fatal_error" alt="" coords="504,901,707,943"/>
<area shape="rect" id="node42" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#ae5e8a2671c819fc0ada038b3fa47105a" title="foedus::savepoint::\lSavepointManagerPimpl\l::savepoint_main" alt="" coords="263,1149,424,1205"/>
<area shape="rect" id="node44" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a4fd4f82797b7ce89da73feca6570f581" title="foedus::snapshot::Snapshot\lManagerPimpl::uninitialize_once" alt="" coords="239,1229,448,1271"/>
<area shape="rect" id="node45" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1e8d5c98af1d33d7a77a05503eedc7be" title="foedus::soc::SocManagerPimpl\l::wait_for_master_module" alt="" coords="242,1032,445,1073"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a75c5d41290ab6f960725a004622dc3be" title="Sub&#45;routine of handle_snapshot_triggered(). " alt="" coords="1263,88,1447,129"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a905ccf76fe0e076980dc1965f038fe10" title="handle_snapshot() calls this when it should start snapshotting. " alt="" coords="1516,98,1727,154"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a64e3c7594b7d7d0d5f8a144bd802d910" title="Main routine for snapshot_thread_ in master engine. " alt="" coords="1775,56,1985,97"/>
<area shape="rect" id="node7" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="1803,121,1957,163"/>
<area shape="rect" id="node8" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a868dca9015af77e04202ead68fd7a136" title="foedus::restart::Restart\lManagerPimpl::initialize_once" alt="" coords="2033,121,2228,163"/>
<area shape="rect" id="node10" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a493bf984062f2615c6788b4c4f6b36df" title="used only in debug mode " alt="" coords="506,696,705,737"/>
<area shape="rect" id="node11" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a4ea0f6f073f92ff447cc34429adafbda" title="Append the log entries of one storage in the given buffer to this reducer&#39;s buffer. " alt="" coords="763,696,961,737"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a3b5c729829a30ca3848d8254d616459a" title="Allocates a patitioner data in shared memory of the given size. " alt="" coords="516,579,695,620"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1array_1_1ArrayPartitioner.html#a7002637fe43ab0917bead1d4636805ad" title="foedus::storage::array\l::ArrayPartitioner::design\l_partition" alt="" coords="779,514,945,570"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashPartitioner.html#a9def1e9584cd2af4bae4d2b0c0ca10e4" title="foedus::storage::hash\l::HashPartitioner::design\l_partition" alt="" coords="779,434,945,490"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePartitioner.html#a1aedc45cc5621bd3889f1bf2d47ab79c" title="foedus::storage::masstree\l::MasstreePartitioner::\ldesign_partition" alt="" coords="775,594,949,650"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1Partitioner.html#a31a7e393bf1f87a9a039c60b291ac9d1" title="Determines partitioning scheme for this storage. " alt="" coords="1012,521,1191,563"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1array_1_1ArrayComposeContext.html#ae70f8ca9a8540b78619ac770e2bbbec9" title="ArrayComposeContext methods. " alt="" coords="525,106,686,162"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#ad25781d742feeced13ed8b047b485a3e" title="drop_volatiles and related methods " alt="" coords="517,186,693,242"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1Composer.html#a0995635b97031b208127004382947acd" title="Drops volatile pages that have not been modified since the snapshotted epoch. " alt="" coords="773,188,951,229"/>
<area shape="rect" id="node22" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a26c51902174b692c91aedd15218f01b7" title="subroutine invoked by one thread for one node. " alt="" coords="1009,175,1193,231"/>
<area shape="rect" id="node23" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a5d474e7a6b4de127153103f2295cb0fa" title="Sub&#45;routine of handle_snapshot_triggered(). " alt="" coords="1241,173,1468,215"/>
<area shape="rect" id="node25" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="504,761,707,803"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1array_1_1ArrayPartitioner.html#ac0e40ecaf673b0ba0c5ffa38ff093532" title="foedus::storage::array\l::ArrayPartitioner::ArrayPartitioner" alt="" coords="496,448,715,489"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashPartitioner.html#afe8984187e16a5366b95bef1bc824b6e" title="foedus::storage::hash\l::HashPartitioner::HashPartitioner" alt="" coords="497,513,713,555"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePartitioner.html#a9cbd3bf85a0f48ca30e2e2228361de90" title="MasstreePartitioner methods. " alt="" coords="519,367,692,423"/>
<area shape="rect" id="node36" href="classfoedus_1_1EnginePimpl.html#a1e2a6a45cbf165080b584269b2bbc5aa" title="foedus::EnginePimpl\l::initialize_modules" alt="" coords="791,1023,933,1064"/>
<area shape="rect" id="node37" href="classfoedus_1_1EnginePimpl.html#a15c27fd38d4219abdf0b2deb5e5f365c" title="foedus::EnginePimpl\l::initialize_once" alt="" coords="1031,964,1172,1005"/>
<area shape="rect" id="node39" href="classfoedus_1_1EnginePimpl.html#a483875a16cf2f469b8b751c9f6e2d673" title="foedus::EnginePimpl\l::uninitialize_once" alt="" coords="791,1093,933,1135"/>
<area shape="rect" id="node41" href="classfoedus_1_1soc_1_1SocManager.html#abffe61e3c3cd7959937bf3f81b4579d7" title="Announce fatal error state of this (either master or child) engine if possible. " alt="" coords="776,903,948,944"/>
<area shape="rect" id="node43" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#ad75cdea74e547a1f66d62b85a938a2cd" title="foedus::savepoint::\lSavepointManagerPimpl\l::initialize_once" alt="" coords="525,1163,686,1219"/>
<area shape="rect" id="node46" href="classfoedus_1_1soc_1_1SocManager.html#a73369a529df5147ddacd8d749ae2e002" title="Wait for master engine to finish init/uninit the module. " alt="" coords="520,1032,691,1073"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab6dda26e594cbef6ceeb6287a1a3092b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* foedus::soc::SharedMemoryRepo::get_global_user_memory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8hpp_source.html#l00515">515</a> of file <a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8hpp_source.html#l00299">foedus::soc::GlobalMemoryAnchors::user_memory_</a>.</p>

<p>Referenced by <a class="el" href="soc__manager_8cpp_source.html#l00040">foedus::soc::SocManager::get_shared_user_memory()</a>.</p>
<div class="fragment"><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;{ <span class="keywordflow">return</span> global_memory_anchors_.<a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#acb8ce6c2d8fed5d6e8a248da0ad3eaf4">user_memory_</a>; }</div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_acb8ce6c2d8fed5d6e8a248da0ad3eaf4"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#acb8ce6c2d8fed5d6e8a248da0ad3eaf4">foedus::soc::GlobalMemoryAnchors::user_memory_</a></div><div class="ttdeci">void * user_memory_</div><div class="ttdoc">This &#39;user memory&#39; can be used for arbitrary purporses by the user to communicate between SOCs...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00299">shared_memory_repo.hpp:299</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_ab6dda26e594cbef6ceeb6287a1a3092b_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_ab6dda26e594cbef6ceeb6287a1a3092b_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_ab6dda26e594cbef6ceeb6287a1a3092b_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_ab6dda26e594cbef6ceeb6287a1a3092b_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SocManager.html#a4f4a98141cedc11e909878cfae62d5df" title="Shortcut for get_shared_memory_repo()&#45;&gt;get_global_user_memory() " alt="" coords="259,5,439,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1EngineMemory.html#a678ed893d9fb18f180043e28bb8405e4" title="As part of the global shared memory, we reserve this size of &#39;user memory&#39; that can be used for arbit..." alt="" coords="487,5,697,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a91712157cc54f8072a0c1664a902f388"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1soc_1_1MasterEngineStatus.html#aa27f54bcc29ab6a9bb7c4dbd21914afd">MasterEngineStatus::StatusCode</a> foedus::soc::SharedMemoryRepo::get_master_status </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8cpp_source.html#l00543">543</a> of file <a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8hpp_source.html#l00250">foedus::soc::GlobalMemoryAnchors::master_status_memory_</a>, and <a class="el" href="shared__memory__repo_8hpp_source.html#l00110">foedus::soc::MasterEngineStatus::read_status_atomic()</a>.</p>

<p>Referenced by <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00286">foedus::soc::SocManagerPimpl::wait_for_master_status()</a>.</p>
<div class="fragment"><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                                                       {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">return</span> global_memory_anchors_.<a class="code" href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ae21c8452d4ace76cd9c71813742964aa">master_status_memory_</a>-&gt;<a class="code" href="structfoedus_1_1soc_1_1MasterEngineStatus.html#ac6c964bf07458b5adc1f034705daca34">read_status_atomic</a>();</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1soc_1_1MasterEngineStatus_html_ac6c964bf07458b5adc1f034705daca34"><div class="ttname"><a href="structfoedus_1_1soc_1_1MasterEngineStatus.html#ac6c964bf07458b5adc1f034705daca34">foedus::soc::MasterEngineStatus::read_status_atomic</a></div><div class="ttdeci">StatusCode read_status_atomic() const </div><div class="ttdoc">Read status_code_ with fence. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00110">shared_memory_repo.hpp:110</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1GlobalMemoryAnchors_html_ae21c8452d4ace76cd9c71813742964aa"><div class="ttname"><a href="structfoedus_1_1soc_1_1GlobalMemoryAnchors.html#ae21c8452d4ace76cd9c71813742964aa">foedus::soc::GlobalMemoryAnchors::master_status_memory_</a></div><div class="ttdeci">MasterEngineStatus * master_status_memory_</div><div class="ttdoc">This tiny piece of memory contains the current status of the master engine and its synchronization me...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00250">shared_memory_repo.hpp:250</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a91712157cc54f8072a0c1664a902f388_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a91712157cc54f8072a0c1664a902f388_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a91712157cc54f8072a0c1664a902f388_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a91712157cc54f8072a0c1664a902f388_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1soc_1_1MasterEngineStatus.html#ac6c964bf07458b5adc1f034705daca34" title="Read status_code_ with fence. " alt="" coords="239,5,421,47"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf" title="Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). " alt="" coords="469,5,643,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a91712157cc54f8072a0c1664a902f388_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a91712157cc54f8072a0c1664a902f388_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a91712157cc54f8072a0c1664a902f388_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a91712157cc54f8072a0c1664a902f388_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a8ce63382de1e198ee20353505efef67a" title="Wait for master engine to finish upto the specified status. " alt="" coords="239,37,441,79"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1d09b3bd25667fccd9bb831303788401" title="Called as part of initialize_once() if this is a child SOC engine. " alt="" coords="1241,5,1444,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#adfd1a1b588c61f7b8efaf8e0e9fd5f8f" title="foedus::soc::SocManagerPimpl\l::child_main_common" alt="" coords="489,99,692,140"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="1492,39,1695,80"/>
<area shape="rect" id="node6" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a2b7bbec9fe5f7713ae184361dcd658f8" title="Main routine of emulated SOCs. " alt="" coords="740,64,943,105"/>
<area shape="rect" id="node9" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a15ec97d18049b472d172cb50c25e489b" title="Main routine of forked SOCs. " alt="" coords="740,129,943,171"/>
<area shape="rect" id="node11" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a328e5ee7367152a0033bcc5843867eb1" title="Main routine of spawned SOCs. " alt="" coords="740,195,943,236"/>
<area shape="rect" id="node7" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a77d275f92471e6ac9e0c4bb4c609665f" title="Launch emulated children as threads. " alt="" coords="991,64,1193,105"/>
<area shape="rect" id="node8" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="1241,71,1444,112"/>
<area shape="rect" id="node10" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#ad9ef70c0b175a6535731e2cf0c2370f1" title="Launch children via fork. " alt="" coords="991,129,1193,171"/>
<area shape="rect" id="node12" href="classfoedus_1_1soc_1_1SocManager.html#a8b8ea1146fa76120be0fcb5ace838d0f" title="This version also receives user&#45;defined procedures to be registered in this SOC. " alt="" coords="1005,195,1179,236"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aac6d8360313375e55bddacf6fde461e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* foedus::soc::SharedMemoryRepo::get_node_memory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a>&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8hpp_source.html#l00520">520</a> of file <a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>.</p>

<p>References <a class="el" href="shared__memory_8hpp_source.html#l00144">foedus::memory::SharedMemory::get_block()</a>.</p>
<div class="fragment"><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;{ <span class="keywordflow">return</span> node_memories_[node].<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113">get_block</a>(); }</div>
<div class="ttc" id="classfoedus_1_1memory_1_1SharedMemory_html_a085dfb81511ba8e4c0563b5a72967113"><div class="ttname"><a href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113">foedus::memory::SharedMemory::get_block</a></div><div class="ttdeci">char * get_block() const </div><div class="ttdoc">Returns the memory block. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory_8hpp_source.html#l00144">shared_memory.hpp:144</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_aac6d8360313375e55bddacf6fde461e6_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_aac6d8360313375e55bddacf6fde461e6_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_aac6d8360313375e55bddacf6fde461e6_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_aac6d8360313375e55bddacf6fde461e6_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1SharedMemory.html#a085dfb81511ba8e4c0563b5a72967113" title="Returns the memory block. " alt="" coords="239,5,449,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2e5d1a0a78c66ac6e1c8ef166d2965c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html">NodeMemoryAnchors</a>* foedus::soc::SharedMemoryRepo::get_node_memory_anchors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a>&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8hpp_source.html#l00521">521</a> of file <a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>.</p>

<p>Referenced by <a class="el" href="log__reducer__ref_8cpp_source.html#l00071">foedus::snapshot::LogReducerRef::get_buffer()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00086">foedus::soc::SocManagerPimpl::initialize_master()</a>, <a class="el" href="numa__node__memory_8cpp_source.html#l00057">foedus::memory::NumaNodeMemory::initialize_once()</a>, <a class="el" href="engine__pimpl_8cpp_source.html#l00096">foedus::EnginePimpl::initialize_once()</a>, <a class="el" href="proc__manager__pimpl_8cpp_source.html#l00035">foedus::proc::ProcManagerPimpl::initialize_once()</a>, <a class="el" href="log__manager__pimpl_8cpp_source.html#l00049">foedus::log::LogManagerPimpl::initialize_once()</a>, <a class="el" href="log__reducer__ref_8cpp_source.html#l00036">foedus::snapshot::LogReducerRef::LogReducerRef()</a>, <a class="el" href="numa__node__memory_8cpp_source.html#l00235">foedus::memory::NumaNodeMemoryRef::NumaNodeMemoryRef()</a>, <a class="el" href="engine__pimpl_8cpp_source.html#l00261">foedus::EnginePimpl::on_module_initialized()</a>, <a class="el" href="engine__pimpl_8cpp_source.html#l00270">foedus::EnginePimpl::on_module_uninitialized()</a>, <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00067">foedus::soc::SocManagerPimpl::report_engine_fatal_error()</a>, and <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00360">foedus::soc::SocManagerPimpl::wait_for_children_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;{ <span class="keywordflow">return</span> &amp;node_memory_anchors_[node]; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a2e5d1a0a78c66ac6e1c8ef166d2965c3_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a2e5d1a0a78c66ac6e1c8ef166d2965c3_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a2e5d1a0a78c66ac6e1c8ef166d2965c3_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a2e5d1a0a78c66ac6e1c8ef166d2965c3_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a01c6454d8099e0d74a325af05718dc12" title="foedus::snapshot::LogReducer\lRef::get_buffer" alt="" coords="287,5,486,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="285,71,488,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a70fdc4e831999f941d4105de0c3ce3fd" title="foedus::memory::NumaNode\lMemory::initialize_once" alt="" coords="293,136,480,177"/>
<area shape="rect" id="node7" href="classfoedus_1_1EnginePimpl.html#a15c27fd38d4219abdf0b2deb5e5f365c" title="foedus::EnginePimpl\l::initialize_once" alt="" coords="1019,531,1160,572"/>
<area shape="rect" id="node8" href="classfoedus_1_1proc_1_1ProcManagerPimpl.html#a37d27ce95acbf5eb397f277c83034a15" title="foedus::proc::ProcManager\lPimpl::initialize_once" alt="" coords="297,253,476,295"/>
<area shape="rect" id="node9" href="classfoedus_1_1log_1_1LogManagerPimpl.html#a8b2cfe458668cc3f8cf4ccbfeab179dc" title="foedus::log::LogManagerPimpl\l::initialize_once" alt="" coords="288,319,485,360"/>
<area shape="rect" id="node10" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a48fa59b1bcce029bc8a7e5fd3f688068" title="foedus::snapshot::LogReducer\lRef::LogReducerRef" alt="" coords="287,384,486,425"/>
<area shape="rect" id="node11" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a8e735f7411d3a28d4ddf0c25f3eced4e" title="foedus::memory::NumaNode\lMemoryRef::NumaNodeMemoryRef" alt="" coords="273,449,500,491"/>
<area shape="rect" id="node12" href="classfoedus_1_1EnginePimpl.html#a13acd726f8d0ab03b7976d00006a0e6b" title="Called whenever each module has completed its initialization. " alt="" coords="572,564,727,605"/>
<area shape="rect" id="node14" href="classfoedus_1_1EnginePimpl.html#a5a2c657e4fcf77d3166da849a6af8ffd" title="Called whenever each module has completed its uninitialization. " alt="" coords="565,695,733,736"/>
<area shape="rect" id="node16" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a36ec21a4c2b374ce071755a8b2696e3a" title="foedus::soc::SocManagerPimpl\l::report_engine_fatal_error" alt="" coords="548,263,751,304"/>
<area shape="rect" id="node18" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#ab34e312e55cd449909c9096b45c200fe" title="foedus::soc::SocManagerPimpl\l::wait_for_children_module" alt="" coords="285,625,488,667"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1LogReducerRef.html#a4ea0f6f073f92ff447cc34429adafbda" title="Append the log entries of one storage in the given buffer to this reducer&#39;s buffer. " alt="" coords="550,5,749,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="548,71,751,112"/>
<area shape="rect" id="node13" href="classfoedus_1_1EnginePimpl.html#a1e2a6a45cbf165080b584269b2bbc5aa" title="foedus::EnginePimpl\l::initialize_modules" alt="" coords="814,615,955,656"/>
<area shape="rect" id="node15" href="classfoedus_1_1EnginePimpl.html#a483875a16cf2f469b8b751c9f6e2d673" title="foedus::EnginePimpl\l::uninitialize_once" alt="" coords="814,687,955,728"/>
<area shape="rect" id="node17" href="classfoedus_1_1soc_1_1SocManager.html#abffe61e3c3cd7959937bf3f81b4579d7" title="Announce fatal error state of this (either master or child) engine if possible. " alt="" coords="799,324,971,365"/>
<area shape="rect" id="node19" href="classfoedus_1_1soc_1_1SocManager.html#a7a9cd36f9f5daf08d2424026f611dc11" title="Wait for other engines to finish init/uninit the module. " alt="" coords="562,629,737,671"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae22e59b0c58a7f6fa519e2c4149afd9c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1soc_1_1ThreadMemoryAnchors.html">ThreadMemoryAnchors</a>* foedus::soc::SharedMemoryRepo::get_thread_memory_anchors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__THREAD.html#ga709a79fc1ed05a3543d8309ba391da93">thread::ThreadId</a>&#160;</td>
          <td class="paramname"><em>thread_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8hpp_source.html#l00526">526</a> of file <a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>.</p>

<p>References <a class="el" href="thread__id_8hpp_source.html#l00139">foedus::thread::decompose_numa_local_ordinal()</a>, <a class="el" href="thread__id_8hpp_source.html#l00131">foedus::thread::decompose_numa_node()</a>, and <a class="el" href="shared__memory__repo_8hpp_source.html#l00392">foedus::soc::NodeMemoryAnchors::thread_anchors_</a>.</p>

<p>Referenced by <a class="el" href="thread__pimpl_8cpp_source.html#l00081">foedus::thread::ThreadPimpl::initialize_once()</a>, and <a class="el" href="thread__ref_8cpp_source.html#l00047">foedus::thread::ThreadRef::ThreadRef()</a>.</p>
<div class="fragment"><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                                                           {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <a class="code" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a> node = <a class="code" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa">thread::decompose_numa_node</a>(thread_id);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    uint16_t thread_ordinal = <a class="code" href="group__THREAD.html#ga93083d6b052db01851cb61c120522c1d">thread::decompose_numa_local_ordinal</a>(thread_id);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">return</span> &amp;node_memory_anchors_[node].<a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a47f40b9d2760b6bdb8c8481cc0850bda">thread_anchors_</a>[thread_ordinal];</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div>
<div class="ttc" id="group__THREAD_html_ga93083d6b052db01851cb61c120522c1d"><div class="ttname"><a href="group__THREAD.html#ga93083d6b052db01851cb61c120522c1d">foedus::thread::decompose_numa_local_ordinal</a></div><div class="ttdeci">ThreadLocalOrdinal decompose_numa_local_ordinal(ThreadId global_id)</div><div class="ttdoc">Extracts local ordinal from the given globally unique ID of Thread (core). </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00139">thread_id.hpp:139</a></div></div>
<div class="ttc" id="group__THREAD_html_ga1622c6d8c64ca80f51c1bef5190ec4fa"><div class="ttname"><a href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa">foedus::thread::decompose_numa_node</a></div><div class="ttdeci">ThreadGroupId decompose_numa_node(ThreadId global_id)</div><div class="ttdoc">Extracts NUMA node ID from the given globally unique ID of Thread (core). </div><div class="ttdef"><b>Definition:</b> <a href="thread__id_8hpp_source.html#l00131">thread_id.hpp:131</a></div></div>
<div class="ttc" id="group__SOC_html_ga8fc28ea9a2a4280f6b7c0e59084faab2"><div class="ttname"><a href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">foedus::soc::SocId</a></div><div class="ttdeci">uint16_t SocId</div><div class="ttdoc">Represents an ID of an SOC, or NUMA node. </div><div class="ttdef"><b>Definition:</b> <a href="soc__id_8hpp_source.html#l00041">soc_id.hpp:41</a></div></div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_a47f40b9d2760b6bdb8c8481cc0850bda"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#a47f40b9d2760b6bdb8c8481cc0850bda">foedus::soc::NodeMemoryAnchors::thread_anchors_</a></div><div class="ttdeci">ThreadMemoryAnchors * thread_anchors_</div><div class="ttdoc">Anchors for each thread. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00392">shared_memory_repo.hpp:392</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_ae22e59b0c58a7f6fa519e2c4149afd9c_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_ae22e59b0c58a7f6fa519e2c4149afd9c_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_ae22e59b0c58a7f6fa519e2c4149afd9c_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_ae22e59b0c58a7f6fa519e2c4149afd9c_cgraph">
<area shape="rect" id="node2" href="group__THREAD.html#ga93083d6b052db01851cb61c120522c1d" title="Extracts local ordinal from the given globally unique ID of Thread (core). " alt="" coords="239,5,417,47"/>
<area shape="rect" id="node3" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="239,71,417,112"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_ae22e59b0c58a7f6fa519e2c4149afd9c_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_ae22e59b0c58a7f6fa519e2c4149afd9c_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_ae22e59b0c58a7f6fa519e2c4149afd9c_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_ae22e59b0c58a7f6fa519e2c4149afd9c_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a741208e803d0a0bb5f979ebb099d2a8d" title="foedus::thread::ThreadPimpl\l::initialize_once" alt="" coords="239,5,423,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1thread_1_1ThreadRef.html#a3f798a317603d0d463863c75805d30d6" title="foedus::thread::ThreadRef\l::ThreadRef" alt="" coords="245,71,416,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7e03c4b7d87150fb9175a239ca657f71"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* foedus::soc::SharedMemoryRepo::get_volatile_pool </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SOC.html#ga8fc28ea9a2a4280f6b7c0e59084faab2">SocId</a>&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="shared__memory__repo_8hpp_source.html#l00532">532</a> of file <a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8hpp_source.html#l00395">foedus::soc::NodeMemoryAnchors::volatile_page_pool_</a>.</p>

<p>Referenced by <a class="el" href="numa__node__memory_8cpp_source.html#l00057">foedus::memory::NumaNodeMemory::initialize_once()</a>, and <a class="el" href="numa__node__memory_8cpp_source.html#l00235">foedus::memory::NumaNodeMemoryRef::NumaNodeMemoryRef()</a>.</p>
<div class="fragment"><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;{ <span class="keywordflow">return</span> node_memory_anchors_[node].<a class="code" href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#aaa2a42046a923d7e68f1bb95995902c8">volatile_page_pool_</a>; }</div>
<div class="ttc" id="structfoedus_1_1soc_1_1NodeMemoryAnchors_html_aaa2a42046a923d7e68f1bb95995902c8"><div class="ttname"><a href="structfoedus_1_1soc_1_1NodeMemoryAnchors.html#aaa2a42046a923d7e68f1bb95995902c8">foedus::soc::NodeMemoryAnchors::volatile_page_pool_</a></div><div class="ttdeci">void * volatile_page_pool_</div><div class="ttdoc">By far the largest memory for volatile page pool on this node. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__repo_8hpp_source.html#l00395">shared_memory_repo.hpp:395</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a7e03c4b7d87150fb9175a239ca657f71_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a7e03c4b7d87150fb9175a239ca657f71_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a7e03c4b7d87150fb9175a239ca657f71_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a7e03c4b7d87150fb9175a239ca657f71_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a70fdc4e831999f941d4105de0c3ce3fd" title="foedus::memory::NumaNode\lMemory::initialize_once" alt="" coords="259,5,445,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a8e735f7411d3a28d4ddf0c25f3eced4e" title="foedus::memory::NumaNode\lMemoryRef::NumaNodeMemoryRef" alt="" coords="239,71,465,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a78e80ef586cc59284a2c9af365e1f0b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::soc::SharedMemoryRepo::mark_for_release </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Marks shared memories as being removed so that it will be reclaimed when all processes detach it. </p>
<p>This is part of deallocation of shared memory in master process. After calling this method, no process can attach this shared memory. So, do not call this too early. However, on the other hand, do not call this too late. If the master process dies for an unexpected reason, the shared memory remains until next reboot. Call it as soon as child processes ack-ed that they have attached the memory or that there are some issues the master process should exit. This method is idempotent, meaning you can safely call this many times. </p>

<p>Definition at line <a class="el" href="shared__memory__repo_8cpp_source.html#l00214">214</a> of file <a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a>.</p>

<p>References <a class="el" href="shared__memory_8cpp_source.html#l00213">foedus::memory::SharedMemory::mark_for_release()</a>.</p>

<p>Referenced by <a class="el" href="shared__memory__repo_8cpp_source.html#l00223">deallocate_shared_memories()</a>, and <a class="el" href="soc__manager__pimpl_8cpp_source.html#l00152">foedus::soc::SocManagerPimpl::wait_for_child_attach()</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                        {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// mark_for_release() is idempotent, so just do it on all of them</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  global_memory_.<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a06fa097c286b762b8ae484076592bf0d">mark_for_release</a>();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">for</span> (uint16_t i = 0; i &lt; soc_count_; ++i) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span> (node_memories_) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      node_memories_[i].<a class="code" href="classfoedus_1_1memory_1_1SharedMemory.html#a06fa097c286b762b8ae484076592bf0d">mark_for_release</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1SharedMemory_html_a06fa097c286b762b8ae484076592bf0d"><div class="ttname"><a href="classfoedus_1_1memory_1_1SharedMemory.html#a06fa097c286b762b8ae484076592bf0d">foedus::memory::SharedMemory::mark_for_release</a></div><div class="ttdeci">void mark_for_release()</div><div class="ttdoc">Marks the shared memory as being removed so that it will be reclaimed when all processes detach it...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory_8cpp_source.html#l00213">shared_memory.cpp:213</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a78e80ef586cc59284a2c9af365e1f0b6_cgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a78e80ef586cc59284a2c9af365e1f0b6_cgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a78e80ef586cc59284a2c9af365e1f0b6_cgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a78e80ef586cc59284a2c9af365e1f0b6_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1SharedMemory.html#a06fa097c286b762b8ae484076592bf0d" title="Marks the shared memory as being removed so that it will be reclaimed when all processes detach it..." alt="" coords="239,5,449,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1soc_1_1SharedMemoryRepo_a78e80ef586cc59284a2c9af365e1f0b6_icgraph.png" border="0" usemap="#classfoedus_1_1soc_1_1SharedMemoryRepo_a78e80ef586cc59284a2c9af365e1f0b6_icgraph" alt=""/></div>
<map name="classfoedus_1_1soc_1_1SharedMemoryRepo_a78e80ef586cc59284a2c9af365e1f0b6_icgraph" id="classfoedus_1_1soc_1_1SharedMemoryRepo_a78e80ef586cc59284a2c9af365e1f0b6_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa961c615ceddd0dd0d3943629fd1a147" title="Detaches and releases the shared memories. " alt="" coords="239,173,424,229"/>
<area shape="rect" id="node11" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a998409bf9e2aff10ec8dfb02f17bb956" title="Wait for child SOCs to start up and at least finish attaching shared memory. " alt="" coords="474,5,677,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#aa42d7f6cd529569e79e4cfc298adb39b" title="Master process creates shared memories by calling this method. " alt="" coords="727,319,941,360"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a3dd3a524e5fbb0b8f9cb52dd21689d0a" title="Called as part of initialize_once() if this is a master engine. " alt="" coords="989,201,1192,243"/>
<area shape="rect" id="node6" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a4b6032d62764c145607306973945bb8c" title="Child processes (emulated or not) set a reference to shared memory and receive the EngnieOption value..." alt="" coords="472,407,679,448"/>
<area shape="rect" id="node8" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#ad9ef70c0b175a6535731e2cf0c2370f1" title="Launch children via fork. " alt="" coords="733,172,935,213"/>
<area shape="rect" id="node9" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a4a9091baae2ba21b2cb888da8d391818" title="Launch children via spawn. " alt="" coords="733,107,935,148"/>
<area shape="rect" id="node10" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1d435277bd229b7988c3f249c0a0730f" title="foedus::soc::SocManagerPimpl\l::uninitialize_once" alt="" coords="474,71,677,112"/>
<area shape="rect" id="node13" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#ae93958bcd01826cc39e3b84333d1c3d9" title="foedus::soc::SharedMemory\lRepo::~SharedMemoryRepo" alt="" coords="482,289,669,331"/>
<area shape="rect" id="node5" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#aa14e68e8b8e3902f2b139b6388e712d8" title="foedus::soc::SocManagerPimpl\l::initialize_once" alt="" coords="1240,259,1443,300"/>
<area shape="rect" id="node7" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a1d09b3bd25667fccd9bb831303788401" title="Called as part of initialize_once() if this is a child SOC engine. " alt="" coords="989,315,1192,356"/>
<area shape="rect" id="node12" href="classfoedus_1_1soc_1_1SocManagerPimpl.html#a77d275f92471e6ac9e0c4bb4c609665f" title="Launch emulated children as threads. " alt="" coords="733,24,935,65"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a239fa2f5b199909a9cce1574b307e6fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html">SharedMemoryRepo</a>&amp; foedus::soc::SharedMemoryRepo::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html">SharedMemoryRepo</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/soc/<a class="el" href="shared__memory__repo_8hpp_source.html">shared_memory_repo.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/soc/<a class="el" href="shared__memory__repo_8cpp_source.html">shared_memory_repo.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1soc.html">soc</a></li><li class="navelem"><a class="el" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html">SharedMemoryRepo</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

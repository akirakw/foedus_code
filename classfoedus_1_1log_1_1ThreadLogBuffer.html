<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::log::ThreadLogBuffer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1log_1_1ThreadLogBuffer.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfoedus_1_1log_1_1ThreadLogBuffer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::log::ThreadLogBuffer Class Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__LOG.html">Log Manager</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A thread-local log buffer.  
 <a href="classfoedus_1_1log_1_1ThreadLogBuffer.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A thread-local log buffer. </p>
<p>This is a private implementation-details of <a class="el" href="group__LOG.html">Log Manager</a>, thus file name ends with _impl. Do not include this header from a client program unless you know what you are doing.</p>
<dl class="section user"><dt>Circular buffers</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html" title="Metadata part of ThreadLogBuffer, without the actual buffer which is way way larger. ">foedus::log::ThreadLogBufferMeta</a> </dd></dl>
<dl class="section user"><dt>Epoch marks</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structfoedus_1_1log_1_1ThreadEpockMark.html" title="A thread-buffer&#39;s epoch marker, which indicates where a thread switched an epoch. ...">foedus::log::ThreadEpockMark</a> </dd></dl>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00266">266</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for foedus::log::ThreadLogBuffer:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer__inherit__graph.png" border="0" usemap="#foedus_1_1log_1_1ThreadLogBuffer_inherit__map" alt="Inheritance graph"/></div>
<map name="foedus_1_1log_1_1ThreadLogBuffer_inherit__map" id="foedus_1_1log_1_1ThreadLogBuffer_inherit__map">
<area shape="rect" id="node2" href="classfoedus_1_1DefaultInitializable.html" title="Typical implementation of Initializable as a skeleton base class. " alt="" coords="13,80,185,107"/>
<area shape="rect" id="node3" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="33,5,165,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for foedus::log::ThreadLogBuffer:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer__coll__graph.png" border="0" usemap="#foedus_1_1log_1_1ThreadLogBuffer_coll__map" alt="Collaboration graph"/></div>
<map name="foedus_1_1log_1_1ThreadLogBuffer_coll__map" id="foedus_1_1log_1_1ThreadLogBuffer_coll__map">
<area shape="rect" id="node2" href="classfoedus_1_1DefaultInitializable.html" title="Typical implementation of Initializable as a skeleton base class. " alt="" coords="13,80,185,107"/>
<area shape="rect" id="node3" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="33,5,165,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1log_1_1ThreadLogBuffer_1_1OffsetRange.html">OffsetRange</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a60018f20182c95150f0a674421cb9f4e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a60018f20182c95150f0a674421cb9f4e">ThreadLogBuffer</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, <a class="el" href="group__THREAD.html#ga709a79fc1ed05a3543d8309ba391da93">thread::ThreadId</a> thread_id)</td></tr>
<tr class="separator:a60018f20182c95150f0a674421cb9f4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8303f5db549570913eefd0e123dbfc2e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8303f5db549570913eefd0e123dbfc2e">initialize_once</a> () override</td></tr>
<tr class="separator:a8303f5db549570913eefd0e123dbfc2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5eadb53d972505cb49cfa6d900ae9b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#ae5eadb53d972505cb49cfa6d900ae9b1">uninitialize_once</a> () override</td></tr>
<tr class="separator:ae5eadb53d972505cb49cfa6d900ae9b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba491438e73c39f4bdaffb6c86cef02"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a5ba491438e73c39f4bdaffb6c86cef02">ThreadLogBuffer</a> ()=delete</td></tr>
<tr class="separator:a5ba491438e73c39f4bdaffb6c86cef02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a999fc03d1249b86a2e4aa8e037063629"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a999fc03d1249b86a2e4aa8e037063629">ThreadLogBuffer</a> (const <a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html">ThreadLogBuffer</a> &amp;other)=delete</td></tr>
<tr class="separator:a999fc03d1249b86a2e4aa8e037063629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a817769f418cfa81df9ffde2973b7110f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html">ThreadLogBuffer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a817769f418cfa81df9ffde2973b7110f">operator=</a> (const <a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html">ThreadLogBuffer</a> &amp;other)=delete</td></tr>
<tr class="separator:a817769f418cfa81df9ffde2973b7110f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aa20c59a7d75cf94742beb43b777de6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6">assert_consistent</a> () const </td></tr>
<tr class="memdesc:a9aa20c59a7d75cf94742beb43b777de6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Only for Debug-assertion.  <a href="#a9aa20c59a7d75cf94742beb43b777de6">More...</a><br /></td></tr>
<tr class="separator:a9aa20c59a7d75cf94742beb43b777de6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bc325fbd47d760565ede70fa6be6aa5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__THREAD.html#ga709a79fc1ed05a3543d8309ba391da93">thread::ThreadId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a7bc325fbd47d760565ede70fa6be6aa5">get_thread_id</a> () const </td></tr>
<tr class="separator:a7bc325fbd47d760565ede70fa6be6aa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a8c4e8f3a994272f52ddddb312f15b9"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9">reserve_new_log</a> (uint16_t log_length) __attribute__((always_inline))</td></tr>
<tr class="memdesc:a9a8c4e8f3a994272f52ddddb312f15b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reserves a space for a new (uncommitted) log entry at the tail.  <a href="#a9a8c4e8f3a994272f52ddddb312f15b9">More...</a><br /></td></tr>
<tr class="separator:a9a8c4e8f3a994272f52ddddb312f15b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9fcb5a5ae968d079ee20e51e7418967"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967">head_to_tail_distance</a> () const __attribute__((always_inline))</td></tr>
<tr class="separator:af9fcb5a5ae968d079ee20e51e7418967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58d7c07a52d42d459002bc590421de8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a58d7c07a52d42d459002bc590421de8a">publish_committed_log</a> (<a class="el" href="classfoedus_1_1Epoch.html">Epoch</a> commit_epoch) __attribute__((always_inline))</td></tr>
<tr class="memdesc:a58d7c07a52d42d459002bc590421de8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when the current transaction is successfully committed.  <a href="#a58d7c07a52d42d459002bc590421de8a">More...</a><br /></td></tr>
<tr class="separator:a58d7c07a52d42d459002bc590421de8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fecc418442394a926c49930cb95cc47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9fecc418442394a926c49930cb95cc47">discard_current_xct_log</a> ()</td></tr>
<tr class="memdesc:a9fecc418442394a926c49930cb95cc47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when the current transaction aborts.  <a href="#a9fecc418442394a926c49930cb95cc47">More...</a><br /></td></tr>
<tr class="separator:a9fecc418442394a926c49930cb95cc47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa525c8fe95d9de46dcf22c9911959d86"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Epoch.html">Epoch</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#aa525c8fe95d9de46dcf22c9911959d86">get_last_epoch</a> () const </td></tr>
<tr class="separator:aa525c8fe95d9de46dcf22c9911959d86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de2c4c08a42a349476956be1b853469"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469">wait_for_space</a> (uint16_t required_space)</td></tr>
<tr class="memdesc:a8de2c4c08a42a349476956be1b853469"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when we have to wait till offset_head_ advances so that we can put new logs.  <a href="#a8de2c4c08a42a349476956be1b853469">More...</a><br /></td></tr>
<tr class="separator:a8de2c4c08a42a349476956be1b853469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f5ce389d863a80f857b780295c71339"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a5f5ce389d863a80f857b780295c71339">get_offset_head</a> () const </td></tr>
<tr class="memdesc:a5f5ce389d863a80f857b780295c71339"><td class="mdescLeft">&#160;</td><td class="mdescRight">This marks the position where log entries start.  <a href="#a5f5ce389d863a80f857b780295c71339">More...</a><br /></td></tr>
<tr class="separator:a5f5ce389d863a80f857b780295c71339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacfa81d1219856c2561f71dd14d10ddf"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#aacfa81d1219856c2561f71dd14d10ddf">get_offset_durable</a> () const </td></tr>
<tr class="memdesc:aacfa81d1219856c2561f71dd14d10ddf"><td class="mdescLeft">&#160;</td><td class="mdescRight">This marks the position upto which the log writer durably wrote out to log files.  <a href="#aacfa81d1219856c2561f71dd14d10ddf">More...</a><br /></td></tr>
<tr class="separator:aacfa81d1219856c2561f71dd14d10ddf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad75e847585775d7c506815269a176941"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#ad75e847585775d7c506815269a176941">get_offset_committed</a> () const </td></tr>
<tr class="memdesc:ad75e847585775d7c506815269a176941"><td class="mdescLeft">&#160;</td><td class="mdescRight">This marks the position upto which transaction logs are committed by the thread.  <a href="#ad75e847585775d7c506815269a176941">More...</a><br /></td></tr>
<tr class="separator:ad75e847585775d7c506815269a176941"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3077294533a21c3aa0a115cfd4c90224"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a3077294533a21c3aa0a115cfd4c90224">get_offset_tail</a> () const </td></tr>
<tr class="memdesc:a3077294533a21c3aa0a115cfd4c90224"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current cursor to which next log will be written.  <a href="#a3077294533a21c3aa0a115cfd4c90224">More...</a><br /></td></tr>
<tr class="separator:a3077294533a21c3aa0a115cfd4c90224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a238fd8c6c360ba499a51ef89e664be24"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html">ThreadLogBufferMeta</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a238fd8c6c360ba499a51ef89e664be24">get_meta</a> () const </td></tr>
<tr class="memdesc:a238fd8c6c360ba499a51ef89e664be24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the state of this buffer.  <a href="#a238fd8c6c360ba499a51ef89e664be24">More...</a><br /></td></tr>
<tr class="separator:a238fd8c6c360ba499a51ef89e664be24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2627f1192a077729257b27815a79ab"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a3e2627f1192a077729257b27815a79ab">get_buffer</a> () const </td></tr>
<tr class="separator:a3e2627f1192a077729257b27815a79ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73cb4c21df0113f6c1dcad3029589225"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1log_1_1ThreadLogBuffer_1_1OffsetRange.html">OffsetRange</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a73cb4c21df0113f6c1dcad3029589225">get_logs_to_write</a> (<a class="el" href="classfoedus_1_1Epoch.html">Epoch</a> written_epoch)</td></tr>
<tr class="memdesc:a73cb4c21df0113f6c1dcad3029589225"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns begin/end offsets of logs in the given epoch.  <a href="#a73cb4c21df0113f6c1dcad3029589225">More...</a><br /></td></tr>
<tr class="separator:a73cb4c21df0113f6c1dcad3029589225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5955e8a6092c7486eda02ae3f18a051"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af5955e8a6092c7486eda02ae3f18a051">on_log_written</a> (<a class="el" href="classfoedus_1_1Epoch.html">Epoch</a> written_epoch)</td></tr>
<tr class="memdesc:af5955e8a6092c7486eda02ae3f18a051"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when the logger wrote out all logs in the given epoch, advancing oldest_mark_index_.  <a href="#af5955e8a6092c7486eda02ae3f18a051">More...</a><br /></td></tr>
<tr class="separator:af5955e8a6092c7486eda02ae3f18a051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1DefaultInitializable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1DefaultInitializable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1DefaultInitializable.html">foedus::DefaultInitializable</a></td></tr>
<tr class="memitem:a5e0a2679baa030e297c1a51847352945 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a5e0a2679baa030e297c1a51847352945">DefaultInitializable</a> ()</td></tr>
<tr class="separator:a5e0a2679baa030e297c1a51847352945 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe7a18ec3e5edd143eb7d6a75d65ef9b inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#afe7a18ec3e5edd143eb7d6a75d65ef9b">~DefaultInitializable</a> ()</td></tr>
<tr class="separator:afe7a18ec3e5edd143eb7d6a75d65ef9b inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd6a8f8296ab570b545430593287d454 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#afd6a8f8296ab570b545430593287d454">DefaultInitializable</a> (const <a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;)=delete</td></tr>
<tr class="separator:afd6a8f8296ab570b545430593287d454 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31eb5acadf0544b97414efd33aed08c7 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a31eb5acadf0544b97414efd33aed08c7">operator=</a> (const <a class="el" href="classfoedus_1_1DefaultInitializable.html">DefaultInitializable</a> &amp;)=delete</td></tr>
<tr class="separator:a31eb5acadf0544b97414efd33aed08c7 inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff">initialize</a> () override final</td></tr>
<tr class="memdesc:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typical implementation of <a class="el" href="classfoedus_1_1Initializable.html#aa087b096d1edaeb0304c250eadb0d7e1" title="Acquires resources in this object, usually called right after constructor. ">Initializable::initialize()</a> that provides initialize-once semantics.  <a href="#a22a0dc3bbbca682c3bc41eace9b6d1ff">More...</a><br /></td></tr>
<tr class="separator:a22a0dc3bbbca682c3bc41eace9b6d1ff inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb">uninitialize</a> () override final</td></tr>
<tr class="memdesc:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typical implementation of <a class="el" href="classfoedus_1_1Initializable.html#afbe5738b0bc85362fba80bdf788fd3c3" title="An idempotent method to release all resources of this object, if any. ">Initializable::uninitialize()</a> that provides uninitialize-once semantics.  <a href="#ab14b136a7d26f9f499ab9dc15a45a8cb">More...</a><br /></td></tr>
<tr class="separator:ab14b136a7d26f9f499ab9dc15a45a8cb inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e">is_initialized</a> () const  override final</td></tr>
<tr class="memdesc:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the object has been already initialized or not.  <a href="#a1abda1e84b8af8bd6916e52fd0a09f3e">More...</a><br /></td></tr>
<tr class="separator:a1abda1e84b8af8bd6916e52fd0a09f3e inherit pub_methods_classfoedus_1_1DefaultInitializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1Initializable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1Initializable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1Initializable.html">foedus::Initializable</a></td></tr>
<tr class="memitem:aff308260543d18b3fd1367fd9017b176 inherit pub_methods_classfoedus_1_1Initializable"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Initializable.html#aff308260543d18b3fd1367fd9017b176">~Initializable</a> ()</td></tr>
<tr class="separator:aff308260543d18b3fd1367fd9017b176 inherit pub_methods_classfoedus_1_1Initializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a824cf26a13eb7f42d5ae68f5725098c5"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5">distance</a> (uint64_t buffer_size, uint64_t from, uint64_t to) __attribute__((always_inline))</td></tr>
<tr class="memdesc:a824cf26a13eb7f42d5ae68f5725098c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subtract operator, considering wrapping around.  <a href="#a824cf26a13eb7f42d5ae68f5725098c5">More...</a><br /></td></tr>
<tr class="separator:a824cf26a13eb7f42d5ae68f5725098c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e105bf908004fd08f79432b326067bc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc">advance</a> (uint64_t buffer_size, uint64_t *target, uint64_t amount) __attribute__((always_inline))</td></tr>
<tr class="memdesc:a6e105bf908004fd08f79432b326067bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Addition operator, considering wrapping around.  <a href="#a6e105bf908004fd08f79432b326067bc">More...</a><br /></td></tr>
<tr class="separator:a6e105bf908004fd08f79432b326067bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:aff02b76416d2846736b7ecd798921a0a"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#aff02b76416d2846736b7ecd798921a0a">Logger</a></td></tr>
<tr class="separator:aff02b76416d2846736b7ecd798921a0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad026f1f955a2f9ae5ef826a4821b58ee"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#ad026f1f955a2f9ae5ef826a4821b58ee">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html">ThreadLogBuffer</a> &amp;v)</td></tr>
<tr class="separator:ad026f1f955a2f9ae5ef826a4821b58ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a60018f20182c95150f0a674421cb9f4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">foedus::log::ThreadLogBuffer::ThreadLogBuffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__THREAD.html#ga709a79fc1ed05a3543d8309ba391da93">thread::ThreadId</a>&#160;</td>
          <td class="paramname"><em>thread_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="thread__log__buffer_8cpp_source.html#l00104">104</a> of file <a class="el" href="thread__log__buffer_8cpp_source.html">thread_log_buffer.cpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00174">foedus::log::ThreadLogBufferMeta::thread_id_</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  : engine_(engine), meta_() {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#aa015fde211c913255fbed3a3bee54884">thread_id_</a> = thread_id;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  buffer_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_aa015fde211c913255fbed3a3bee54884"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#aa015fde211c913255fbed3a3bee54884">foedus::log::ThreadLogBufferMeta::thread_id_</a></div><div class="ttdeci">thread::ThreadId thread_id_</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00174">thread_log_buffer.hpp:174</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5ba491438e73c39f4bdaffb6c86cef02"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::log::ThreadLogBuffer::ThreadLogBuffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a999fc03d1249b86a2e4aa8e037063629"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::log::ThreadLogBuffer::ThreadLogBuffer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html">ThreadLogBuffer</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a6e105bf908004fd08f79432b326067bc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void foedus::log::ThreadLogBuffer::advance </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>buffer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>amount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Addition operator, considering wrapping around. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00284">284</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>.</p>

<p>Referenced by <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">reserve_new_log()</a>.</p>
<div class="fragment"><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                                                                             {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(*target &lt; buffer_size);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(amount &lt; buffer_size);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    *target += amount;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (*target &gt;= buffer_size) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      *target -= buffer_size;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a6e105bf908004fd08f79432b326067bc_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a6e105bf908004fd08f79432b326067bc_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a6e105bf908004fd08f79432b326067bc_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a6e105bf908004fd08f79432b326067bc_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="240,573,427,614"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7dde5581eee977242b5373e30365183f" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record" alt="" coords="491,5,688,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7d324da4dcd35490820cb97e7124001b" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record_primitive" alt="" coords="491,85,688,141"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a435ff8b148161ca7296b12eea744a344" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record" alt="" coords="487,165,691,221"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af77ff710cf2f8ef3800e97861ea94e8f" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record_oneshot" alt="" coords="487,245,691,301"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="500,325,679,381"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="499,405,680,461"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="498,485,681,541"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="491,565,687,621"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="488,645,691,701"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#af0b96482a874777c4871a152ad733da3" title="implementation of insert_record family. " alt="" coords="503,725,676,781"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a45396b70b246f330355397b447af55f3" title="implementation of delete_record family. " alt="" coords="503,895,676,951"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aeeccc272d2f9a4d895f4d117f6b96b27" title="implementation of upsert_record family. " alt="" coords="503,1063,676,1119"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ab9cc59cbbef3fd23a62cbd25cbd00abb" title="implementation of overwrite_record family. " alt="" coords="503,1348,676,1404"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa71566d3a4d56ded35df567784b13525" title="implementation of increment_record family. " alt="" coords="503,1647,676,1703"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1sequential_1_1SequentialStorage.html#ab8696b7ccf07c7b8e1efb038d8cd83c2" title="Append one record to this sequential storage. " alt="" coords="475,1727,704,1769"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a3cfbd23c4239f8a63ac5719007a8305b" title="This one further optimizes overwrite_record_primitive() for the frequent use case of incrementing som..." alt="" coords="785,85,956,141"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a5093ba18b241e5179a363476bdd20066" title="This is a faster increment that does not return the value after increment. " alt="" coords="785,165,956,221"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="797,245,944,301"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="797,325,945,381"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="796,405,945,461"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="773,485,969,541"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="789,565,952,621"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="1071,485,1234,541"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="785,645,956,701"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="765,726,977,767"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="784,792,957,848"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#af263fb1494c7ac6a5dbfd28b926ede3b" title="foedus::storage::masstree\l::MasstreeCursor::delete_record" alt="" coords="767,873,975,914"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="1045,965,1260,1006"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="784,989,957,1045"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="763,1070,979,1111"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="784,1136,957,1192"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#ab8b1919cb195dd063be409f772b36630" title="foedus::storage::masstree\l::MasstreeCursor::overwrite_record" alt="" coords="759,1217,982,1258"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a496370a645284f8578875529c6eacb0f" title="foedus::storage::masstree\l::MasstreeCursor::overwrite\l_record_primitive" alt="" coords="781,1283,961,1339"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="1037,1427,1268,1469"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="777,1413,964,1469"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="777,1493,964,1549"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="776,1573,965,1629"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a81ce493961aa7dedc518ca4230d01868" title="foedus::storage::masstree\l::MasstreeCursor::increment_record" alt="" coords="755,1654,986,1695"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="752,1719,989,1761"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="773,1785,968,1841"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9aa20c59a7d75cf94742beb43b777de6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::log::ThreadLogBuffer::assert_consistent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Only for Debug-assertion. </p>
<p>This method must be called by the worker thread itself. When logger calls it, it must make sure the worker is not modifying anything concurrently. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00306">306</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8cpp_source.html#l00059">foedus::log::ThreadLogBufferMeta::assert_consistent()</a>.</p>

<p>Referenced by <a class="el" href="thread__log__buffer_8cpp_source.html#l00136">wait_for_space()</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                        {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a05db4e7c61f07d2320aa7b2c3c76d520">assert_consistent</a>();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">#endif  // NDEBUG</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a05db4e7c61f07d2320aa7b2c3c76d520"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a05db4e7c61f07d2320aa7b2c3c76d520">foedus::log::ThreadLogBufferMeta::assert_consistent</a></div><div class="ttdeci">void assert_consistent() const </div><div class="ttdoc">Only for Debug-assertion. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8cpp_source.html#l00059">thread_log_buffer.cpp:59</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a9aa20c59a7d75cf94742beb43b777de6_cgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a9aa20c59a7d75cf94742beb43b777de6_cgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a9aa20c59a7d75cf94742beb43b777de6_cgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a9aa20c59a7d75cf94742beb43b777de6_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a05db4e7c61f07d2320aa7b2c3c76d520" title="Only for Debug&#45;assertion. " alt="" coords="240,35,427,76"/>
<area shape="rect" id="node3" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a5dd02cf36ffdb642d41badfc61381621" title="foedus::log::ThreadLogBuffer\lMeta::increment_mark_index" alt="" coords="475,5,665,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="493,71,647,98"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a9aa20c59a7d75cf94742beb43b777de6_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a9aa20c59a7d75cf94742beb43b777de6_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a9aa20c59a7d75cf94742beb43b777de6_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a9aa20c59a7d75cf94742beb43b777de6_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="240,573,427,614"/>
<area shape="rect" id="node3" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="475,573,661,614"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7dde5581eee977242b5373e30365183f" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record" alt="" coords="725,5,923,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7d324da4dcd35490820cb97e7124001b" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record_primitive" alt="" coords="725,85,923,141"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a435ff8b148161ca7296b12eea744a344" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record" alt="" coords="722,165,926,221"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af77ff710cf2f8ef3800e97861ea94e8f" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record_oneshot" alt="" coords="722,245,926,301"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="735,325,913,381"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="733,405,915,461"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="733,485,915,541"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="726,565,922,621"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="723,645,925,701"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#af0b96482a874777c4871a152ad733da3" title="implementation of insert_record family. " alt="" coords="737,725,911,781"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a45396b70b246f330355397b447af55f3" title="implementation of delete_record family. " alt="" coords="737,895,911,951"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aeeccc272d2f9a4d895f4d117f6b96b27" title="implementation of upsert_record family. " alt="" coords="737,1063,911,1119"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ab9cc59cbbef3fd23a62cbd25cbd00abb" title="implementation of overwrite_record family. " alt="" coords="737,1348,911,1404"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa71566d3a4d56ded35df567784b13525" title="implementation of increment_record family. " alt="" coords="737,1647,911,1703"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1sequential_1_1SequentialStorage.html#ab8696b7ccf07c7b8e1efb038d8cd83c2" title="Append one record to this sequential storage. " alt="" coords="709,1727,939,1769"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a3cfbd23c4239f8a63ac5719007a8305b" title="This one further optimizes overwrite_record_primitive() for the frequent use case of incrementing som..." alt="" coords="1020,85,1191,141"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a5093ba18b241e5179a363476bdd20066" title="This is a faster increment that does not return the value after increment. " alt="" coords="1020,165,1191,221"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="1032,245,1179,301"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="1031,325,1179,381"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="1031,405,1180,461"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="1007,485,1203,541"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="1024,565,1187,621"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="1306,485,1469,541"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="1020,645,1191,701"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="999,726,1211,767"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="1019,792,1192,848"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#af263fb1494c7ac6a5dbfd28b926ede3b" title="foedus::storage::masstree\l::MasstreeCursor::delete_record" alt="" coords="1001,873,1209,914"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="1280,965,1495,1006"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="1019,989,1192,1045"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="997,1070,1213,1111"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="1019,1136,1192,1192"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#ab8b1919cb195dd063be409f772b36630" title="foedus::storage::masstree\l::MasstreeCursor::overwrite_record" alt="" coords="994,1217,1217,1258"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a496370a645284f8578875529c6eacb0f" title="foedus::storage::masstree\l::MasstreeCursor::overwrite\l_record_primitive" alt="" coords="1015,1283,1195,1339"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="1272,1427,1503,1469"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="1012,1413,1199,1469"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="1012,1493,1199,1549"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="1011,1573,1200,1629"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a81ce493961aa7dedc518ca4230d01868" title="foedus::storage::masstree\l::MasstreeCursor::increment_record" alt="" coords="990,1654,1221,1695"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="987,1719,1224,1761"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="1008,1785,1203,1841"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9fecc418442394a926c49930cb95cc47"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::log::ThreadLogBuffer::discard_current_xct_log </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called when the current transaction aborts. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00358">358</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00221">foedus::log::ThreadLogBufferMeta::offset_committed_</a>, and <a class="el" href="thread__log__buffer_8hpp_source.html#l00231">foedus::log::ThreadLogBufferMeta::offset_tail_</a>.</p>

<p>Referenced by <a class="el" href="xct__manager__pimpl_8cpp_source.html#l00954">foedus::xct::XctManagerPimpl::abort_xct()</a>, and <a class="el" href="xct__manager__pimpl_8cpp_source.html#l00384">foedus::xct::XctManagerPimpl::precommit_xct_readwrite()</a>.</p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                        {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">offset_tail_</a> = meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">offset_committed_</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a657d9371aa5deec7dfbbad85f4352f37"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">foedus::log::ThreadLogBufferMeta::offset_committed_</a></div><div class="ttdeci">uint64_t offset_committed_</div><div class="ttdoc">This marks the position upto which transaction logs are committed by the thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00221">thread_log_buffer.hpp:221</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_abed758916ac4cc7780cd57c4f5912a7b"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">foedus::log::ThreadLogBufferMeta::offset_tail_</a></div><div class="ttdeci">uint64_t offset_tail_</div><div class="ttdoc">The current cursor to which next log will be written. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00231">thread_log_buffer.hpp:231</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a9fecc418442394a926c49930cb95cc47_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a9fecc418442394a926c49930cb95cc47_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a9fecc418442394a926c49930cb95cc47_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a9fecc418442394a926c49930cb95cc47_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a71f565f69929d90febd7beb6b1dca696" title="foedus::xct::XctManagerPimpl\l::abort_xct" alt="" coords="240,5,435,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a777caaecec0e7bb19b1cd2841771f755" title="precommit_xct() if the transaction is read&#45;write " alt="" coords="240,71,435,112"/>
<area shape="rect" id="node3" href="classfoedus_1_1xct_1_1XctManager.html#aa176159e8ab007d35ea467226f5d2475" title="Aborts the currently running transaction on the thread. " alt="" coords="499,5,661,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a014506b605e14b3df1b1b7522e8a23b2" title="This is the gut of commit protocol. " alt="" coords="483,71,677,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1xct_1_1XctManager.html#a486c653445cb64cc9514af3f1031bdf0" title="Prepares the currently running transaction on the thread for commit. " alt="" coords="725,71,888,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a824cf26a13eb7f42d5ae68f5725098c5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint64_t foedus::log::ThreadLogBuffer::distance </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>buffer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Subtract operator, considering wrapping around. </p>
<dl class="section attention"><dt>Attention</dt><dd>Be careful. As this is a circular buffer, from and to are <b>NOT</b> commutative. actually, distance(from, to) = buffer_size - distance(to, from). </dd></dl>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00274">274</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>.</p>

<p>Referenced by <a class="el" href="thread__log__buffer_8hpp_source.html#l00338">head_to_tail_distance()</a>.</p>
<div class="fragment"><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                                                                                           {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(from &lt; buffer_size);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(to &lt; buffer_size);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">if</span> (to &gt;= from) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">return</span> to - from;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">return</span> to + buffer_size - from;  <span class="comment">// wrap around</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  }</div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a824cf26a13eb7f42d5ae68f5725098c5_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a824cf26a13eb7f42d5ae68f5725098c5_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a824cf26a13eb7f42d5ae68f5725098c5_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a824cf26a13eb7f42d5ae68f5725098c5_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="240,573,427,614"/>
<area shape="rect" id="node3" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="709,573,896,614"/>
<area shape="rect" id="node44" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="475,602,661,643"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7dde5581eee977242b5373e30365183f" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record" alt="" coords="960,5,1157,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7d324da4dcd35490820cb97e7124001b" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record_primitive" alt="" coords="960,85,1157,141"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a435ff8b148161ca7296b12eea744a344" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record" alt="" coords="957,165,1161,221"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af77ff710cf2f8ef3800e97861ea94e8f" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record_oneshot" alt="" coords="957,245,1161,301"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="969,325,1148,381"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="968,405,1149,461"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="967,485,1150,541"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="961,565,1157,621"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="957,645,1160,701"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#af0b96482a874777c4871a152ad733da3" title="implementation of insert_record family. " alt="" coords="972,725,1145,781"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a45396b70b246f330355397b447af55f3" title="implementation of delete_record family. " alt="" coords="972,895,1145,951"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aeeccc272d2f9a4d895f4d117f6b96b27" title="implementation of upsert_record family. " alt="" coords="972,1063,1145,1119"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ab9cc59cbbef3fd23a62cbd25cbd00abb" title="implementation of overwrite_record family. " alt="" coords="972,1348,1145,1404"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa71566d3a4d56ded35df567784b13525" title="implementation of increment_record family. " alt="" coords="972,1647,1145,1703"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1sequential_1_1SequentialStorage.html#ab8696b7ccf07c7b8e1efb038d8cd83c2" title="Append one record to this sequential storage. " alt="" coords="944,1727,1173,1769"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a3cfbd23c4239f8a63ac5719007a8305b" title="This one further optimizes overwrite_record_primitive() for the frequent use case of incrementing som..." alt="" coords="1255,85,1425,141"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a5093ba18b241e5179a363476bdd20066" title="This is a faster increment that does not return the value after increment. " alt="" coords="1255,165,1425,221"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="1267,245,1413,301"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="1266,325,1414,381"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="1265,405,1415,461"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="1242,485,1438,541"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="1259,565,1421,621"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="1541,485,1703,541"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="1255,645,1425,701"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="1234,726,1446,767"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="1253,792,1427,848"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#af263fb1494c7ac6a5dbfd28b926ede3b" title="foedus::storage::masstree\l::MasstreeCursor::delete_record" alt="" coords="1236,873,1444,914"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="1515,965,1729,1006"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="1253,989,1427,1045"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="1232,1070,1448,1111"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="1253,1136,1427,1192"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#ab8b1919cb195dd063be409f772b36630" title="foedus::storage::masstree\l::MasstreeCursor::overwrite_record" alt="" coords="1229,1217,1451,1258"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a496370a645284f8578875529c6eacb0f" title="foedus::storage::masstree\l::MasstreeCursor::overwrite\l_record_primitive" alt="" coords="1250,1283,1430,1339"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="1507,1427,1737,1469"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="1247,1413,1433,1469"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="1247,1493,1433,1549"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="1245,1573,1435,1629"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a81ce493961aa7dedc518ca4230d01868" title="foedus::storage::masstree\l::MasstreeCursor::increment_record" alt="" coords="1225,1654,1455,1695"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="1221,1719,1459,1761"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="1243,1785,1437,1841"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3e2627f1192a077729257b27815a79ab"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* foedus::log::ThreadLogBuffer::get_buffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00383">383</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{ <span class="keywordflow">return</span> buffer_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa525c8fe95d9de46dcf22c9911959d86"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1Epoch.html">Epoch</a> foedus::log::ThreadLogBuffer::get_last_epoch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00361">361</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00251">foedus::log::ThreadLogBufferMeta::current_mark_index_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00061">foedus::log::ThreadEpockMark::new_epoch_</a>, and <a class="el" href="thread__log__buffer_8hpp_source.html#l00234">foedus::log::ThreadLogBufferMeta::thread_epoch_marks_</a>.</p>

<p>Referenced by <a class="el" href="thread__log__buffer_8hpp_source.html#l00345">publish_committed_log()</a>.</p>
<div class="fragment"><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                     {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">return</span> meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7071fa55176f66f7804f56bef61212a3">thread_epoch_marks_</a>[meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">current_mark_index_</a>].<a class="code" href="structfoedus_1_1log_1_1ThreadEpockMark.html#af21cdea3334ed52f3341f32de3167656">new_epoch_</a>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  }</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a9df21eea0d60c49c4f0a4fd7db148dbe"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">foedus::log::ThreadLogBufferMeta::current_mark_index_</a></div><div class="ttdeci">uint32_t current_mark_index_</div><div class="ttdoc">Array index in thread_epoch_marks_ that indicates the current epoch being appended by the thread...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00251">thread_log_buffer.hpp:251</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadEpockMark_html_af21cdea3334ed52f3341f32de3167656"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadEpockMark.html#af21cdea3334ed52f3341f32de3167656">foedus::log::ThreadEpockMark::new_epoch_</a></div><div class="ttdeci">Epoch new_epoch_</div><div class="ttdoc">The epoch of log entries this mark represents. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00061">thread_log_buffer.hpp:61</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a7071fa55176f66f7804f56bef61212a3"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7071fa55176f66f7804f56bef61212a3">foedus::log::ThreadLogBufferMeta::thread_epoch_marks_</a></div><div class="ttdeci">ThreadEpockMark thread_epoch_marks_[kMaxNonDurableEpochs]</div><div class="ttdoc">Circular array of epoch marks of a thread log buffer. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00234">thread_log_buffer.hpp:234</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_aa525c8fe95d9de46dcf22c9911959d86_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_aa525c8fe95d9de46dcf22c9911959d86_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_aa525c8fe95d9de46dcf22c9911959d86_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_aa525c8fe95d9de46dcf22c9911959d86_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a58d7c07a52d42d459002bc590421de8a" title="Called when the current transaction is successfully committed. " alt="" coords="240,5,427,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a777caaecec0e7bb19b1cd2841771f755" title="precommit_xct() if the transaction is read&#45;write " alt="" coords="475,5,669,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a014506b605e14b3df1b1b7522e8a23b2" title="This is the gut of commit protocol. " alt="" coords="717,5,912,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1xct_1_1XctManager.html#a486c653445cb64cc9514af3f1031bdf0" title="Prepares the currently running transaction on the thread for commit. " alt="" coords="960,5,1123,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a73cb4c21df0113f6c1dcad3029589225"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1log_1_1ThreadLogBuffer_1_1OffsetRange.html">ThreadLogBuffer::OffsetRange</a> foedus::log::ThreadLogBuffer::get_logs_to_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Epoch.html">Epoch</a>&#160;</td>
          <td class="paramname"><em>written_epoch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns begin/end offsets of logs in the given epoch. </p>
<p>It might be empty (0/0). </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8cpp_source.html#l00234">234</a> of file <a class="el" href="thread__log__buffer_8cpp_source.html">thread_log_buffer.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00386">foedus::log::ThreadLogBuffer::OffsetRange::begin_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00251">foedus::log::ThreadLogBufferMeta::current_mark_index_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00387">foedus::log::ThreadLogBuffer::OffsetRange::end_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00170">foedus::log::ThreadLogBufferMeta::increment_mark_index()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00157">foedus::log::ThreadLogBufferMeta::kMaxNonDurableEpochs</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00069">foedus::assorted::memory_fence_acq_rel()</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00046">foedus::assorted::memory_fence_acquire()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00061">foedus::log::ThreadEpockMark::new_epoch_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00066">foedus::log::ThreadEpockMark::offset_begin_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00221">foedus::log::ThreadLogBufferMeta::offset_committed_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00210">foedus::log::ThreadLogBufferMeta::offset_durable_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00074">foedus::log::ThreadEpockMark::offset_end_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00241">foedus::log::ThreadLogBufferMeta::oldest_mark_index_</a>, and <a class="el" href="thread__log__buffer_8hpp_source.html#l00234">foedus::log::ThreadLogBufferMeta::thread_epoch_marks_</a>.</p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                                                                 {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">// See ThreadLogBufferMeta&#39;s class comment about tricky cases (the thread being idle).</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// assert_consistent(); this verification assumes the worker is not working. we can&#39;t use it here</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  OffsetRange ret;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  ThreadEpockMark&amp; target = meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7071fa55176f66f7804f56bef61212a3">thread_epoch_marks_</a>[meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a>];</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span> (target.new_epoch_ &gt; written_epoch) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// Case 1) no logs in this epoch.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(target.offset_begin_ == meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">offset_durable_</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    ret.begin_ = 0;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    ret.end_ = 0;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target.new_epoch_ == written_epoch) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// Case 2) Is it 2-a? or 2-b?</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(target.offset_begin_ == meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">offset_durable_</a>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    ret.begin_ = target.offset_begin_;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">if</span> (meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a> != meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">current_mark_index_</a>) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="comment">// 2-a, easy.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      ret.end_ = target.offset_end_;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="comment">// 2-b, now we have to populate target.offset_end_ ourselves.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      VLOG(0) &lt;&lt; <span class="stringliteral">&quot;This guy seems sleeping for a while..&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="comment">// We can safely populate target.offset_end_, but be careful on reading offset_committed_.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">// If the thread now resumes working, it adds a new mark *and then* increments</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">// offset_committed_. So, it&#39;s safe as far as we take appropriate fences.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">// well, a bit redundant fences, but this part is not executed so often. no issue.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      uint64_t committed_copy = meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">offset_committed_</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordtype">bool</span> still_current = meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a> == meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">current_mark_index_</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf">assorted::memory_fence_acq_rel</a>();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">if</span> (still_current) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        target.offset_end_ = committed_copy;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Okay, the logger populated the offset_end on behalf.&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">// This is super-rare.</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Interesting. The thread has now awaken and added a new mark. offset_end&quot;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; should be now populated. &quot;</span>&lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      ret.end_ = target.offset_end_;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// Case 3) First, consume stale marks as much as possible</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// (note, in this case &quot;target.offset_begin_ == meta_.offset_durable_&quot; might not hold</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(target.new_epoch_ &lt; written_epoch);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">if</span> (meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a> != meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">current_mark_index_</a>) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Advancing oldest mark index. before=&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">while</span> (meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a> != meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">current_mark_index_</a></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          &amp;&amp; meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7071fa55176f66f7804f56bef61212a3">thread_epoch_marks_</a>[meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a>].<a class="code" href="structfoedus_1_1log_1_1ThreadEpockMark.html#af21cdea3334ed52f3341f32de3167656">new_epoch_</a> &lt; written_epoch) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          = <a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a5dd02cf36ffdb642d41badfc61381621">ThreadLogBufferMeta::increment_mark_index</a>(meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a> &lt; <a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7437875632a276e19368c9f64734210da70cf14e94a61f91db153188311db520f">ThreadLogBufferMeta::kMaxNonDurableEpochs</a>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span> (meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a> &gt;= <a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7437875632a276e19368c9f64734210da70cf14e94a61f91db153188311db520f">ThreadLogBufferMeta::kMaxNonDurableEpochs</a>) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;meta_.oldest_mark_index_ out of range. we must have waited.&quot;</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Advanced oldest mark index. after=&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="comment">// Then re-evaluate. It might be now Case 1 or 2. recursion, but essentially a retry.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      ret = <a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a73cb4c21df0113f6c1dcad3029589225">get_logs_to_write</a>(written_epoch);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Heh, this guy is still sleeping..&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      ret.begin_ = 0;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      ret.end_ = 0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a5dd02cf36ffdb642d41badfc61381621"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a5dd02cf36ffdb642d41badfc61381621">foedus::log::ThreadLogBufferMeta::increment_mark_index</a></div><div class="ttdeci">static uint32_t increment_mark_index(uint32_t index)</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00170">thread_log_buffer.hpp:170</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a9df21eea0d60c49c4f0a4fd7db148dbe"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">foedus::log::ThreadLogBufferMeta::current_mark_index_</a></div><div class="ttdeci">uint32_t current_mark_index_</div><div class="ttdoc">Array index in thread_epoch_marks_ that indicates the current epoch being appended by the thread...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00251">thread_log_buffer.hpp:251</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a7437875632a276e19368c9f64734210da70cf14e94a61f91db153188311db520f"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7437875632a276e19368c9f64734210da70cf14e94a61f91db153188311db520f">foedus::log::ThreadLogBufferMeta::kMaxNonDurableEpochs</a></div><div class="ttdoc">Each thread can have at most this number of epochs in this log buffer. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00157">thread_log_buffer.hpp:157</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a657d9371aa5deec7dfbbad85f4352f37"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">foedus::log::ThreadLogBufferMeta::offset_committed_</a></div><div class="ttdeci">uint64_t offset_committed_</div><div class="ttdoc">This marks the position upto which transaction logs are committed by the thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00221">thread_log_buffer.hpp:221</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadEpockMark_html_af21cdea3334ed52f3341f32de3167656"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadEpockMark.html#af21cdea3334ed52f3341f32de3167656">foedus::log::ThreadEpockMark::new_epoch_</a></div><div class="ttdeci">Epoch new_epoch_</div><div class="ttdoc">The epoch of log entries this mark represents. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00061">thread_log_buffer.hpp:61</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a7071fa55176f66f7804f56bef61212a3"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7071fa55176f66f7804f56bef61212a3">foedus::log::ThreadLogBufferMeta::thread_epoch_marks_</a></div><div class="ttdeci">ThreadEpockMark thread_epoch_marks_[kMaxNonDurableEpochs]</div><div class="ttdoc">Circular array of epoch marks of a thread log buffer. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00234">thread_log_buffer.hpp:234</a></div></div>
<div class="ttc" id="classfoedus_1_1log_1_1ThreadLogBuffer_html_a73cb4c21df0113f6c1dcad3029589225"><div class="ttname"><a href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a73cb4c21df0113f6c1dcad3029589225">foedus::log::ThreadLogBuffer::get_logs_to_write</a></div><div class="ttdeci">OffsetRange get_logs_to_write(Epoch written_epoch)</div><div class="ttdoc">Returns begin/end offsets of logs in the given epoch. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8cpp_source.html#l00234">thread_log_buffer.cpp:234</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_ace5d36306d82f856042d30c5eb5e5635"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">foedus::log::ThreadLogBufferMeta::offset_durable_</a></div><div class="ttdeci">uint64_t offset_durable_</div><div class="ttdoc">This marks the position upto which the log writer durably wrote out to log files. ...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00210">thread_log_buffer.hpp:210</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaf84f9944a16c5848f69beacdfeedf939"><div class="ttname"><a href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">foedus::assorted::memory_fence_acquire</a></div><div class="ttdeci">void memory_fence_acquire()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acquire). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00046">atomic_fences.hpp:46</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a396d005a0e874d98f42db6243d2af266"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">foedus::log::ThreadLogBufferMeta::oldest_mark_index_</a></div><div class="ttdeci">uint32_t oldest_mark_index_</div><div class="ttdoc">Array index in thread_epoch_marks_ that indicates the oldest epoch mark to be consumed by the logger...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00241">thread_log_buffer.hpp:241</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaff9fa4aedd631410da28740f6e1dddbf"><div class="ttname"><a href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf">foedus::assorted::memory_fence_acq_rel</a></div><div class="ttdeci">void memory_fence_acq_rel()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00069">atomic_fences.hpp:69</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a73cb4c21df0113f6c1dcad3029589225_cgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a73cb4c21df0113f6c1dcad3029589225_cgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a73cb4c21df0113f6c1dcad3029589225_cgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a73cb4c21df0113f6c1dcad3029589225_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a5dd02cf36ffdb642d41badfc61381621" title="foedus::log::ThreadLogBuffer\lMeta::increment_mark_index" alt="" coords="240,5,431,47"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#gaff9fa4aedd631410da28740f6e1dddbf" title="Equivalent to std::atomic_thread_fence(std::memory_order_acq_rel). " alt="" coords="249,71,422,112"/>
<area shape="rect" id="node4" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="249,136,422,177"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a238fd8c6c360ba499a51ef89e664be24"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html">ThreadLogBufferMeta</a>&amp; foedus::log::ThreadLogBuffer::get_meta </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the state of this buffer. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00382">382</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;{ <span class="keywordflow">return</span> meta_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad75e847585775d7c506815269a176941"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::log::ThreadLogBuffer::get_offset_committed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This marks the position upto which transaction logs are committed by the thread. </p>
<p>Log writers can safely read log entries and write them to log files up to this place. When the transaction commits, this value is advanced by the thread. The only possible update pattern to this variable is <b>advance</b> by this thread. Thus, the log writer can safely read this variable without any fence or lock thanks to regular (either old value or new value, never garbage) read of 64-bit. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00375">375</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00221">foedus::log::ThreadLogBufferMeta::offset_committed_</a>.</p>

<p>Referenced by <a class="el" href="xct__manager__pimpl_8cpp_source.html#l00307">foedus::xct::XctManagerPimpl::begin_xct()</a>, and <a class="el" href="xct__manager__pimpl_8cpp_source.html#l00371">foedus::xct::XctManagerPimpl::precommit_xct_readonly()</a>.</p>
<div class="fragment"><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{ <span class="keywordflow">return</span> meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">offset_committed_</a>; }</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a657d9371aa5deec7dfbbad85f4352f37"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">foedus::log::ThreadLogBufferMeta::offset_committed_</a></div><div class="ttdeci">uint64_t offset_committed_</div><div class="ttdoc">This marks the position upto which transaction logs are committed by the thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00221">thread_log_buffer.hpp:221</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_ad75e847585775d7c506815269a176941_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_ad75e847585775d7c506815269a176941_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_ad75e847585775d7c506815269a176941_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_ad75e847585775d7c506815269a176941_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#ad01b60a93f2e107d9c63e7c28799ac1a" title="User transactions related methods. " alt="" coords="240,5,435,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#add42c2f0d559eafa1f67fd9c048a4855" title="precommit_xct() if the transaction is read&#45;only " alt="" coords="240,71,435,112"/>
<area shape="rect" id="node3" href="classfoedus_1_1xct_1_1XctManager.html#a0cd2ffb750756de7132eabf6d6a284ce" title="Begins a new transaction on the thread. " alt="" coords="499,5,661,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a014506b605e14b3df1b1b7522e8a23b2" title="This is the gut of commit protocol. " alt="" coords="483,71,677,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1xct_1_1XctManager.html#a486c653445cb64cc9514af3f1031bdf0" title="Prepares the currently running transaction on the thread for commit. " alt="" coords="725,71,888,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aacfa81d1219856c2561f71dd14d10ddf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::log::ThreadLogBuffer::get_offset_durable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This marks the position upto which the log writer durably wrote out to log files. </p>
<p>Everything after this position must not be discarded because they are not yet durable. When the log writer reads log entries after here, writes them to log file, and calls fsync, this variable is advanced by the log writer. This variable is read by this thread to check the end of the circular buffer. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00372">372</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00210">foedus::log::ThreadLogBufferMeta::offset_durable_</a>.</p>
<div class="fragment"><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{ <span class="keywordflow">return</span> meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">offset_durable_</a>; }</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_ace5d36306d82f856042d30c5eb5e5635"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">foedus::log::ThreadLogBufferMeta::offset_durable_</a></div><div class="ttdeci">uint64_t offset_durable_</div><div class="ttdoc">This marks the position upto which the log writer durably wrote out to log files. ...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00210">thread_log_buffer.hpp:210</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5f5ce389d863a80f857b780295c71339"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::log::ThreadLogBuffer::get_offset_head </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This marks the position where log entries start. </p>
<p>This private log buffer is a circular buffer where the <em>head</em> is eaten by log gleaner. However, log gleaner is okay to get behind, reading from log file instead (but slower). Thus, offset_head_ is advanced either by log gleaner or this thread. If the latter happens, log gleaner has to give up using in-memory logs and instead read from log files. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00369">369</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00200">foedus::log::ThreadLogBufferMeta::offset_head_</a>.</p>
<div class="fragment"><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;{ <span class="keywordflow">return</span> meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a23d3ecc1c5c72bfc563b4397cb06925b">offset_head_</a>; }</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a23d3ecc1c5c72bfc563b4397cb06925b"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a23d3ecc1c5c72bfc563b4397cb06925b">foedus::log::ThreadLogBufferMeta::offset_head_</a></div><div class="ttdeci">uint64_t offset_head_</div><div class="ttdoc">This marks the position where log entries start. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00200">thread_log_buffer.hpp:200</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3077294533a21c3aa0a115cfd4c90224"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::log::ThreadLogBuffer::get_offset_tail </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The current cursor to which next log will be written. </p>
<p>This is the location the current transaction of this thread is writing to <b>before</b> commit. When the transaction commits, offset_committed_ catches up with this. When the transaction aborts, this value rolls back to offset_committed_. Only this thread reads/writes to this variable. No other threads access this. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00378">378</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00231">foedus::log::ThreadLogBufferMeta::offset_tail_</a>.</p>

<p>Referenced by <a class="el" href="xct__manager__pimpl_8cpp_source.html#l00307">foedus::xct::XctManagerPimpl::begin_xct()</a>, and <a class="el" href="xct__manager__pimpl_8cpp_source.html#l00371">foedus::xct::XctManagerPimpl::precommit_xct_readonly()</a>.</p>
<div class="fragment"><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{ <span class="keywordflow">return</span> meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">offset_tail_</a>; }</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_abed758916ac4cc7780cd57c4f5912a7b"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">foedus::log::ThreadLogBufferMeta::offset_tail_</a></div><div class="ttdeci">uint64_t offset_tail_</div><div class="ttdoc">The current cursor to which next log will be written. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00231">thread_log_buffer.hpp:231</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a3077294533a21c3aa0a115cfd4c90224_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a3077294533a21c3aa0a115cfd4c90224_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a3077294533a21c3aa0a115cfd4c90224_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a3077294533a21c3aa0a115cfd4c90224_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#ad01b60a93f2e107d9c63e7c28799ac1a" title="User transactions related methods. " alt="" coords="240,5,435,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#add42c2f0d559eafa1f67fd9c048a4855" title="precommit_xct() if the transaction is read&#45;only " alt="" coords="240,71,435,112"/>
<area shape="rect" id="node3" href="classfoedus_1_1xct_1_1XctManager.html#a0cd2ffb750756de7132eabf6d6a284ce" title="Begins a new transaction on the thread. " alt="" coords="499,5,661,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a014506b605e14b3df1b1b7522e8a23b2" title="This is the gut of commit protocol. " alt="" coords="483,71,677,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1xct_1_1XctManager.html#a486c653445cb64cc9514af3f1031bdf0" title="Prepares the currently running transaction on the thread for commit. " alt="" coords="725,71,888,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7bc325fbd47d760565ede70fa6be6aa5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__THREAD.html#ga709a79fc1ed05a3543d8309ba391da93">thread::ThreadId</a> foedus::log::ThreadLogBuffer::get_thread_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00311">311</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00174">foedus::log::ThreadLogBufferMeta::thread_id_</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{ <span class="keywordflow">return</span> meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#aa015fde211c913255fbed3a3bee54884">thread_id_</a>; }</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_aa015fde211c913255fbed3a3bee54884"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#aa015fde211c913255fbed3a3bee54884">foedus::log::ThreadLogBufferMeta::thread_id_</a></div><div class="ttdeci">thread::ThreadId thread_id_</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00174">thread_log_buffer.hpp:174</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af9fcb5a5ae968d079ee20e51e7418967"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::log::ThreadLogBuffer::head_to_tail_distance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00338">338</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00179">foedus::log::ThreadLogBufferMeta::buffer_size_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00274">distance()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00200">foedus::log::ThreadLogBufferMeta::offset_head_</a>, and <a class="el" href="thread__log__buffer_8hpp_source.html#l00231">foedus::log::ThreadLogBufferMeta::offset_tail_</a>.</p>

<p>Referenced by <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">reserve_new_log()</a>, and <a class="el" href="thread__log__buffer_8cpp_source.html#l00136">wait_for_space()</a>.</p>
<div class="fragment"><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                                          {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5">distance</a>(meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#acc65d5871a4da5bf8f4e2bf162e9ba9d">buffer_size_</a>, meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a23d3ecc1c5c72bfc563b4397cb06925b">offset_head_</a>, meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">offset_tail_</a>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  }</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_acc65d5871a4da5bf8f4e2bf162e9ba9d"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#acc65d5871a4da5bf8f4e2bf162e9ba9d">foedus::log::ThreadLogBufferMeta::buffer_size_</a></div><div class="ttdeci">uint64_t buffer_size_</div><div class="ttdoc">Size of the buffer assigned to this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00179">thread_log_buffer.hpp:179</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a23d3ecc1c5c72bfc563b4397cb06925b"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a23d3ecc1c5c72bfc563b4397cb06925b">foedus::log::ThreadLogBufferMeta::offset_head_</a></div><div class="ttdeci">uint64_t offset_head_</div><div class="ttdoc">This marks the position where log entries start. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00200">thread_log_buffer.hpp:200</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_abed758916ac4cc7780cd57c4f5912a7b"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">foedus::log::ThreadLogBufferMeta::offset_tail_</a></div><div class="ttdeci">uint64_t offset_tail_</div><div class="ttdoc">The current cursor to which next log will be written. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00231">thread_log_buffer.hpp:231</a></div></div>
<div class="ttc" id="classfoedus_1_1log_1_1ThreadLogBuffer_html_a824cf26a13eb7f42d5ae68f5725098c5"><div class="ttname"><a href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5">foedus::log::ThreadLogBuffer::distance</a></div><div class="ttdeci">static uint64_t distance(uint64_t buffer_size, uint64_t from, uint64_t to) __attribute__((always_inline))</div><div class="ttdoc">Subtract operator, considering wrapping around. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00274">thread_log_buffer.hpp:274</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_af9fcb5a5ae968d079ee20e51e7418967_cgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_af9fcb5a5ae968d079ee20e51e7418967_cgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_af9fcb5a5ae968d079ee20e51e7418967_cgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_af9fcb5a5ae968d079ee20e51e7418967_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5" title="Subtract operator, considering wrapping around. " alt="" coords="240,5,427,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_af9fcb5a5ae968d079ee20e51e7418967_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_af9fcb5a5ae968d079ee20e51e7418967_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_af9fcb5a5ae968d079ee20e51e7418967_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_af9fcb5a5ae968d079ee20e51e7418967_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="475,573,661,614"/>
<area shape="rect" id="node43" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="240,602,427,643"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7dde5581eee977242b5373e30365183f" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record" alt="" coords="725,5,923,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7d324da4dcd35490820cb97e7124001b" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record_primitive" alt="" coords="725,85,923,141"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a435ff8b148161ca7296b12eea744a344" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record" alt="" coords="722,165,926,221"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af77ff710cf2f8ef3800e97861ea94e8f" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record_oneshot" alt="" coords="722,245,926,301"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="735,325,913,381"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="733,405,915,461"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="733,485,915,541"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="726,565,922,621"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="723,645,925,701"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#af0b96482a874777c4871a152ad733da3" title="implementation of insert_record family. " alt="" coords="737,725,911,781"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a45396b70b246f330355397b447af55f3" title="implementation of delete_record family. " alt="" coords="737,895,911,951"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aeeccc272d2f9a4d895f4d117f6b96b27" title="implementation of upsert_record family. " alt="" coords="737,1063,911,1119"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ab9cc59cbbef3fd23a62cbd25cbd00abb" title="implementation of overwrite_record family. " alt="" coords="737,1348,911,1404"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa71566d3a4d56ded35df567784b13525" title="implementation of increment_record family. " alt="" coords="737,1647,911,1703"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1sequential_1_1SequentialStorage.html#ab8696b7ccf07c7b8e1efb038d8cd83c2" title="Append one record to this sequential storage. " alt="" coords="709,1727,939,1769"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a3cfbd23c4239f8a63ac5719007a8305b" title="This one further optimizes overwrite_record_primitive() for the frequent use case of incrementing som..." alt="" coords="1020,85,1191,141"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a5093ba18b241e5179a363476bdd20066" title="This is a faster increment that does not return the value after increment. " alt="" coords="1020,165,1191,221"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="1032,245,1179,301"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="1031,325,1179,381"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="1031,405,1180,461"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="1007,485,1203,541"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="1024,565,1187,621"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="1306,485,1469,541"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="1020,645,1191,701"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="999,726,1211,767"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="1019,792,1192,848"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#af263fb1494c7ac6a5dbfd28b926ede3b" title="foedus::storage::masstree\l::MasstreeCursor::delete_record" alt="" coords="1001,873,1209,914"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="1280,965,1495,1006"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="1019,989,1192,1045"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="997,1070,1213,1111"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="1019,1136,1192,1192"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#ab8b1919cb195dd063be409f772b36630" title="foedus::storage::masstree\l::MasstreeCursor::overwrite_record" alt="" coords="994,1217,1217,1258"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a496370a645284f8578875529c6eacb0f" title="foedus::storage::masstree\l::MasstreeCursor::overwrite\l_record_primitive" alt="" coords="1015,1283,1195,1339"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="1272,1427,1503,1469"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="1012,1413,1199,1469"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="1012,1493,1199,1549"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="1011,1573,1200,1629"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a81ce493961aa7dedc518ca4230d01868" title="foedus::storage::masstree\l::MasstreeCursor::increment_record" alt="" coords="990,1654,1221,1695"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="987,1719,1224,1761"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="1008,1785,1203,1841"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8303f5db549570913eefd0e123dbfc2e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::log::ThreadLogBuffer::initialize_once </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classfoedus_1_1DefaultInitializable.html#ab8ae37e5f20f312f8b945fc40d3e0250">foedus::DefaultInitializable</a>.</p>

<p>Definition at line <a class="el" href="thread__log__buffer_8cpp_source.html#l00110">110</a> of file <a class="el" href="thread__log__buffer_8cpp_source.html">thread_log_buffer.cpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00179">foedus::log::ThreadLogBufferMeta::buffer_size_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00189">foedus::log::ThreadLogBufferMeta::buffer_size_safe_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00251">foedus::log::ThreadLogBufferMeta::current_mark_index_</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00235">foedus::memory::AlignedMemorySlice::get_block()</a>, <a class="el" href="numa__node__memory_8hpp_source.html#l00067">foedus::memory::NumaNodeMemory::get_core_memory()</a>, <a class="el" href="savepoint__manager_8cpp_source.html#l00036">foedus::savepoint::SavepointManager::get_initial_current_epoch()</a>, <a class="el" href="savepoint__manager_8cpp_source.html#l00039">foedus::savepoint::SavepointManager::get_initial_durable_epoch()</a>, <a class="el" href="engine__memory_8hpp_source.html#l00073">foedus::memory::EngineMemory::get_local_memory()</a>, <a class="el" href="numa__core__memory_8hpp_source.html#l00064">foedus::memory::NumaCoreMemory::get_log_buffer_memory()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="engine_8cpp_source.html#l00053">foedus::Engine::get_savepoint_manager()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00234">foedus::memory::AlignedMemorySlice::get_size()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00221">foedus::log::ThreadLogBufferMeta::offset_committed_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00210">foedus::log::ThreadLogBufferMeta::offset_durable_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00200">foedus::log::ThreadLogBufferMeta::offset_head_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00231">foedus::log::ThreadLogBufferMeta::offset_tail_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00241">foedus::log::ThreadLogBufferMeta::oldest_mark_index_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00234">foedus::log::ThreadLogBufferMeta::thread_epoch_marks_</a>, and <a class="el" href="thread__log__buffer_8hpp_source.html#l00174">foedus::log::ThreadLogBufferMeta::thread_id_</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                            {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  memory::NumaCoreMemory *memory</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    = engine_-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a0c5065125240df0f59f2cd04ff5f8808">get_local_memory</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a58cd4f9c594cdcfd85fb3c3e9d47a983">get_core_memory</a>(meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#aa015fde211c913255fbed3a3bee54884">thread_id_</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  memory::AlignedMemorySlice buffer_memory = memory-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ab02e9bcb37082e31781b4b8ce8e4bf21">get_log_buffer_memory</a>();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  buffer_ = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(buffer_memory.get_block());</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#acc65d5871a4da5bf8f4e2bf162e9ba9d">buffer_size_</a> = buffer_memory.get_size();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a98ac9b46082c2120a347c175ebd0e340">buffer_size_safe_</a> = meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#acc65d5871a4da5bf8f4e2bf162e9ba9d">buffer_size_</a> - 64;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a23d3ecc1c5c72bfc563b4397cb06925b">offset_head_</a> = 0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">offset_durable_</a> = 0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">offset_committed_</a> = 0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">offset_tail_</a> = 0;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  Epoch initial_current = engine_-&gt;<a class="code" href="classfoedus_1_1Engine.html#a4f168d41ea00249fefe905def87e80c8">get_savepoint_manager</a>()-&gt;<a class="code" href="classfoedus_1_1savepoint_1_1SavepointManager.html#a82624b3d7edff1d02e29c1b8863dd4ee">get_initial_current_epoch</a>();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  Epoch initial_durable = engine_-&gt;<a class="code" href="classfoedus_1_1Engine.html#a4f168d41ea00249fefe905def87e80c8">get_savepoint_manager</a>()-&gt;<a class="code" href="classfoedus_1_1savepoint_1_1SavepointManager.html#a7fc7a7f62d25e8114ab15a340256f71a">get_initial_durable_epoch</a>();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">current_mark_index_</a> = 0;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a> = 0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7071fa55176f66f7804f56bef61212a3">thread_epoch_marks_</a>[0] = ThreadEpockMark(initial_durable, initial_current, 0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a9df21eea0d60c49c4f0a4fd7db148dbe"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">foedus::log::ThreadLogBufferMeta::current_mark_index_</a></div><div class="ttdeci">uint32_t current_mark_index_</div><div class="ttdoc">Array index in thread_epoch_marks_ that indicates the current epoch being appended by the thread...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00251">thread_log_buffer.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaNodeMemory_html_a58cd4f9c594cdcfd85fb3c3e9d47a983"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a58cd4f9c594cdcfd85fb3c3e9d47a983">foedus::memory::NumaNodeMemory::get_core_memory</a></div><div class="ttdeci">NumaCoreMemory * get_core_memory(foedus::thread::ThreadId id) const </div><div class="ttdef"><b>Definition:</b> <a href="numa__node__memory_8hpp_source.html#l00067">numa_node_memory.hpp:67</a></div></div>
<div class="ttc" id="classfoedus_1_1savepoint_1_1SavepointManager_html_a82624b3d7edff1d02e29c1b8863dd4ee"><div class="ttname"><a href="classfoedus_1_1savepoint_1_1SavepointManager.html#a82624b3d7edff1d02e29c1b8863dd4ee">foedus::savepoint::SavepointManager::get_initial_current_epoch</a></div><div class="ttdeci">Epoch get_initial_current_epoch() const </div><div class="ttdef"><b>Definition:</b> <a href="savepoint__manager_8cpp_source.html#l00036">savepoint_manager.cpp:36</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_acc65d5871a4da5bf8f4e2bf162e9ba9d"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#acc65d5871a4da5bf8f4e2bf162e9ba9d">foedus::log::ThreadLogBufferMeta::buffer_size_</a></div><div class="ttdeci">uint64_t buffer_size_</div><div class="ttdoc">Size of the buffer assigned to this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00179">thread_log_buffer.hpp:179</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_aa015fde211c913255fbed3a3bee54884"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#aa015fde211c913255fbed3a3bee54884">foedus::log::ThreadLogBufferMeta::thread_id_</a></div><div class="ttdeci">thread::ThreadId thread_id_</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00174">thread_log_buffer.hpp:174</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a657d9371aa5deec7dfbbad85f4352f37"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">foedus::log::ThreadLogBufferMeta::offset_committed_</a></div><div class="ttdeci">uint64_t offset_committed_</div><div class="ttdoc">This marks the position upto which transaction logs are committed by the thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00221">thread_log_buffer.hpp:221</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a4f168d41ea00249fefe905def87e80c8"><div class="ttname"><a href="classfoedus_1_1Engine.html#a4f168d41ea00249fefe905def87e80c8">foedus::Engine::get_savepoint_manager</a></div><div class="ttdeci">savepoint::SavepointManager * get_savepoint_manager() const </div><div class="ttdoc">See Savepoint Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00053">engine.cpp:53</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaCoreMemory_html_ab02e9bcb37082e31781b4b8ce8e4bf21"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ab02e9bcb37082e31781b4b8ce8e4bf21">foedus::memory::NumaCoreMemory::get_log_buffer_memory</a></div><div class="ttdeci">AlignedMemorySlice get_log_buffer_memory() const </div><div class="ttdef"><b>Definition:</b> <a href="numa__core__memory_8hpp_source.html#l00064">numa_core_memory.hpp:64</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a7071fa55176f66f7804f56bef61212a3"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7071fa55176f66f7804f56bef61212a3">foedus::log::ThreadLogBufferMeta::thread_epoch_marks_</a></div><div class="ttdeci">ThreadEpockMark thread_epoch_marks_[kMaxNonDurableEpochs]</div><div class="ttdoc">Circular array of epoch marks of a thread log buffer. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00234">thread_log_buffer.hpp:234</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a23d3ecc1c5c72bfc563b4397cb06925b"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a23d3ecc1c5c72bfc563b4397cb06925b">foedus::log::ThreadLogBufferMeta::offset_head_</a></div><div class="ttdeci">uint64_t offset_head_</div><div class="ttdoc">This marks the position where log entries start. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00200">thread_log_buffer.hpp:200</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_ace5d36306d82f856042d30c5eb5e5635"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">foedus::log::ThreadLogBufferMeta::offset_durable_</a></div><div class="ttdeci">uint64_t offset_durable_</div><div class="ttdoc">This marks the position upto which the log writer durably wrote out to log files. ...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00210">thread_log_buffer.hpp:210</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a0c5065125240df0f59f2cd04ff5f8808"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a0c5065125240df0f59f2cd04ff5f8808">foedus::memory::EngineMemory::get_local_memory</a></div><div class="ttdeci">NumaNodeMemory * get_local_memory() const </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00073">engine_memory.hpp:73</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_abed758916ac4cc7780cd57c4f5912a7b"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">foedus::log::ThreadLogBufferMeta::offset_tail_</a></div><div class="ttdeci">uint64_t offset_tail_</div><div class="ttdoc">The current cursor to which next log will be written. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00231">thread_log_buffer.hpp:231</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1savepoint_1_1SavepointManager_html_a7fc7a7f62d25e8114ab15a340256f71a"><div class="ttname"><a href="classfoedus_1_1savepoint_1_1SavepointManager.html#a7fc7a7f62d25e8114ab15a340256f71a">foedus::savepoint::SavepointManager::get_initial_durable_epoch</a></div><div class="ttdeci">Epoch get_initial_durable_epoch() const </div><div class="ttdef"><b>Definition:</b> <a href="savepoint__manager_8cpp_source.html#l00039">savepoint_manager.cpp:39</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a396d005a0e874d98f42db6243d2af266"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">foedus::log::ThreadLogBufferMeta::oldest_mark_index_</a></div><div class="ttdeci">uint32_t oldest_mark_index_</div><div class="ttdoc">Array index in thread_epoch_marks_ that indicates the oldest epoch mark to be consumed by the logger...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00241">thread_log_buffer.hpp:241</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a98ac9b46082c2120a347c175ebd0e340"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a98ac9b46082c2120a347c175ebd0e340">foedus::log::ThreadLogBufferMeta::buffer_size_safe_</a></div><div class="ttdeci">uint64_t buffer_size_safe_</div><div class="ttdoc">buffer_size_ - 64. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00189">thread_log_buffer.hpp:189</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a8303f5db549570913eefd0e123dbfc2e_cgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a8303f5db549570913eefd0e123dbfc2e_cgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a8303f5db549570913eefd0e123dbfc2e_cgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a8303f5db549570913eefd0e123dbfc2e_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1memory_1_1AlignedMemorySlice.html#ae3127a9ce40b34e15bc7257ddd332365" title="foedus::memory::AlignedMemory\lSlice::get_block" alt="" coords="240,5,453,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1NumaNodeMemory.html#a58cd4f9c594cdcfd85fb3c3e9d47a983" title="foedus::memory::NumaNode\lMemory::get_core_memory" alt="" coords="253,71,440,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1savepoint_1_1SavepointManager.html#a82624b3d7edff1d02e29c1b8863dd4ee" title="foedus::savepoint::\lSavepointManager::get\l_initial_current_epoch" alt="" coords="269,137,424,193"/>
<area shape="rect" id="node8" href="classfoedus_1_1savepoint_1_1SavepointManager.html#a7fc7a7f62d25e8114ab15a340256f71a" title="foedus::savepoint::\lSavepointManager::get\l_initial_durable_epoch" alt="" coords="269,217,424,273"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1EngineMemory.html#a0c5065125240df0f59f2cd04ff5f8808" title="foedus::memory::EngineMemory\l::get_local_memory" alt="" coords="241,297,452,339"/>
<area shape="rect" id="node11" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ab02e9bcb37082e31781b4b8ce8e4bf21" title="foedus::memory::NumaCore\lMemory::get_log_buffer\l_memory" alt="" coords="255,363,439,419"/>
<area shape="rect" id="node12" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="279,444,414,485"/>
<area shape="rect" id="node13" href="classfoedus_1_1Engine.html#a4f168d41ea00249fefe905def87e80c8" title="See Savepoint Manager. " alt="" coords="277,509,417,551"/>
<area shape="rect" id="node14" href="structfoedus_1_1memory_1_1AlignedMemorySlice.html#af257953672683e31e38f94cb187bcca0" title="foedus::memory::AlignedMemory\lSlice::get_size" alt="" coords="240,575,453,616"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="501,5,715,47"/>
<area shape="rect" id="node5" href="group__THREAD.html#ga93083d6b052db01851cb61c120522c1d" title="Extracts local ordinal from the given globally unique ID of Thread (core). " alt="" coords="519,71,697,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#a69656b017856d4e6b2bcda9085c0d316" title="foedus::savepoint::\lSavepointManagerPimpl\l::get_initial_current_epoch" alt="" coords="521,137,695,193"/>
<area shape="rect" id="node9" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#af3569e99d9295cf12b5ba4692bb5bb49" title="foedus::savepoint::\lSavepointManagerPimpl\l::get_initial_durable_epoch" alt="" coords="520,217,696,273"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af5955e8a6092c7486eda02ae3f18a051"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::log::ThreadLogBuffer::on_log_written </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Epoch.html">Epoch</a>&#160;</td>
          <td class="paramname"><em>written_epoch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when the logger wrote out all logs in the given epoch, advancing oldest_mark_index_. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8cpp_source.html#l00303">303</a> of file <a class="el" href="thread__log__buffer_8cpp_source.html">thread_log_buffer.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00251">foedus::log::ThreadLogBufferMeta::current_mark_index_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00170">foedus::log::ThreadLogBufferMeta::increment_mark_index()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00061">foedus::log::ThreadEpockMark::new_epoch_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00066">foedus::log::ThreadEpockMark::offset_begin_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00210">foedus::log::ThreadLogBufferMeta::offset_durable_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00074">foedus::log::ThreadEpockMark::offset_end_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00241">foedus::log::ThreadLogBufferMeta::oldest_mark_index_</a>, and <a class="el" href="thread__log__buffer_8hpp_source.html#l00234">foedus::log::ThreadLogBufferMeta::thread_epoch_marks_</a>.</p>
<div class="fragment"><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                                        {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">// See ThreadLogBufferMeta&#39;s class comment about tricky cases (the thread being idle).</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// assert_consistent(); this verification assumes the worker is not working. we can&#39;t use it here</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  ThreadEpockMark&amp; target = meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7071fa55176f66f7804f56bef61212a3">thread_epoch_marks_</a>[meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a>];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">if</span> (target.new_epoch_ &gt; written_epoch) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// Case 1) no thing to do.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(target.offset_begin_ == meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">offset_durable_</a>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target.new_epoch_ == written_epoch) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// Case 2) Is it 2-a? or 2-b?</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(target.offset_begin_ == meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">offset_durable_</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">offset_durable_</a> = target.offset_end_;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a> != meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">current_mark_index_</a>) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">// 2-a, go to next mark.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        = <a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a5dd02cf36ffdb642d41badfc61381621">ThreadLogBufferMeta::increment_mark_index</a>(meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">oldest_mark_index_</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="comment">// 2-b, remains here. Will be case-3 next time.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// Case 3 (even after consuming stale marks). Do nothing.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(target.new_epoch_ &lt; written_epoch);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  DVLOG(0) &lt;&lt; <span class="stringliteral">&quot;Logger has written out all logs in epoch-&quot;</span> &lt;&lt; written_epoch &lt;&lt; <span class="stringliteral">&quot;. &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// assert_consistent(); this verification assumes the worker is not working. we can&#39;t use it here</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a5dd02cf36ffdb642d41badfc61381621"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a5dd02cf36ffdb642d41badfc61381621">foedus::log::ThreadLogBufferMeta::increment_mark_index</a></div><div class="ttdeci">static uint32_t increment_mark_index(uint32_t index)</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00170">thread_log_buffer.hpp:170</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a9df21eea0d60c49c4f0a4fd7db148dbe"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a9df21eea0d60c49c4f0a4fd7db148dbe">foedus::log::ThreadLogBufferMeta::current_mark_index_</a></div><div class="ttdeci">uint32_t current_mark_index_</div><div class="ttdoc">Array index in thread_epoch_marks_ that indicates the current epoch being appended by the thread...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00251">thread_log_buffer.hpp:251</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a7071fa55176f66f7804f56bef61212a3"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a7071fa55176f66f7804f56bef61212a3">foedus::log::ThreadLogBufferMeta::thread_epoch_marks_</a></div><div class="ttdeci">ThreadEpockMark thread_epoch_marks_[kMaxNonDurableEpochs]</div><div class="ttdoc">Circular array of epoch marks of a thread log buffer. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00234">thread_log_buffer.hpp:234</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_ace5d36306d82f856042d30c5eb5e5635"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">foedus::log::ThreadLogBufferMeta::offset_durable_</a></div><div class="ttdeci">uint64_t offset_durable_</div><div class="ttdoc">This marks the position upto which the log writer durably wrote out to log files. ...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00210">thread_log_buffer.hpp:210</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a396d005a0e874d98f42db6243d2af266"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a396d005a0e874d98f42db6243d2af266">foedus::log::ThreadLogBufferMeta::oldest_mark_index_</a></div><div class="ttdeci">uint32_t oldest_mark_index_</div><div class="ttdoc">Array index in thread_epoch_marks_ that indicates the oldest epoch mark to be consumed by the logger...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00241">thread_log_buffer.hpp:241</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_af5955e8a6092c7486eda02ae3f18a051_cgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_af5955e8a6092c7486eda02ae3f18a051_cgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_af5955e8a6092c7486eda02ae3f18a051_cgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_af5955e8a6092c7486eda02ae3f18a051_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a5dd02cf36ffdb642d41badfc61381621" title="foedus::log::ThreadLogBuffer\lMeta::increment_mark_index" alt="" coords="240,5,431,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a817769f418cfa81df9ffde2973b7110f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html">ThreadLogBuffer</a>&amp; foedus::log::ThreadLogBuffer::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html">ThreadLogBuffer</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a58d7c07a52d42d459002bc590421de8a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::log::ThreadLogBuffer::publish_committed_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Epoch.html">Epoch</a>&#160;</td>
          <td class="paramname"><em>commit_epoch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called when the current transaction is successfully committed. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00345">345</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00361">get_last_epoch()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00221">foedus::log::ThreadLogBufferMeta::offset_committed_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00231">foedus::log::ThreadLogBufferMeta::offset_tail_</a>, and <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>.</p>

<p>Referenced by <a class="el" href="xct__manager__pimpl_8cpp_source.html#l00384">foedus::xct::XctManagerPimpl::precommit_xct_readwrite()</a>.</p>
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                                                      {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    Epoch last_epoch = <a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#aa525c8fe95d9de46dcf22c9911959d86">get_last_epoch</a>();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(commit_epoch &gt;= last_epoch);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(commit_epoch &gt; last_epoch)) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      on_new_epoch_observed(commit_epoch);  <span class="comment">// epoch switches!</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(commit_epoch &lt; last_epoch)) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="comment">// This MUST not happen because it means an already durable epoch received a new log!</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      crash_stale_commit_epoch(commit_epoch);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">offset_committed_</a> = meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">offset_tail_</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a657d9371aa5deec7dfbbad85f4352f37"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">foedus::log::ThreadLogBufferMeta::offset_committed_</a></div><div class="ttdeci">uint64_t offset_committed_</div><div class="ttdoc">This marks the position upto which transaction logs are committed by the thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00221">thread_log_buffer.hpp:221</a></div></div>
<div class="ttc" id="classfoedus_1_1log_1_1ThreadLogBuffer_html_aa525c8fe95d9de46dcf22c9911959d86"><div class="ttname"><a href="classfoedus_1_1log_1_1ThreadLogBuffer.html#aa525c8fe95d9de46dcf22c9911959d86">foedus::log::ThreadLogBuffer::get_last_epoch</a></div><div class="ttdeci">Epoch get_last_epoch() const </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00361">thread_log_buffer.hpp:361</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_abed758916ac4cc7780cd57c4f5912a7b"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">foedus::log::ThreadLogBufferMeta::offset_tail_</a></div><div class="ttdeci">uint64_t offset_tail_</div><div class="ttdoc">The current cursor to which next log will be written. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00231">thread_log_buffer.hpp:231</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a58d7c07a52d42d459002bc590421de8a_cgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a58d7c07a52d42d459002bc590421de8a_cgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a58d7c07a52d42d459002bc590421de8a_cgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a58d7c07a52d42d459002bc590421de8a_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#aa525c8fe95d9de46dcf22c9911959d86" title="foedus::log::ThreadLogBuffer\l::get_last_epoch" alt="" coords="240,5,427,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a58d7c07a52d42d459002bc590421de8a_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a58d7c07a52d42d459002bc590421de8a_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a58d7c07a52d42d459002bc590421de8a_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a58d7c07a52d42d459002bc590421de8a_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a777caaecec0e7bb19b1cd2841771f755" title="precommit_xct() if the transaction is read&#45;write " alt="" coords="240,5,435,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a014506b605e14b3df1b1b7522e8a23b2" title="This is the gut of commit protocol. " alt="" coords="483,5,677,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1xct_1_1XctManager.html#a486c653445cb64cc9514af3f1031bdf0" title="Prepares the currently running transaction on the thread for commit. " alt="" coords="725,5,888,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9a8c4e8f3a994272f52ddddb312f15b9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char* foedus::log::ThreadLogBuffer::reserve_new_log </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>log_length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reserves a space for a new (uncommitted) log entry at the tail. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">log_length</td><td>byte size of the log. You have to give it beforehand.</td></tr>
  </table>
  </dd>
</dl>
<p>If the circular buffer's tail reaches the head, this method might block. But it will be rare as we release a large region of buffer at each time. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">320</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00284">advance()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00179">foedus::log::ThreadLogBufferMeta::buffer_size_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00189">foedus::log::ThreadLogBufferMeta::buffer_size_safe_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00338">head_to_tail_distance()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00231">foedus::log::ThreadLogBufferMeta::offset_tail_</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, and <a class="el" href="thread__log__buffer_8cpp_source.html#l00136">wait_for_space()</a>.</p>

<p>Referenced by <a class="el" href="sequential__storage__pimpl_8cpp_source.html#l00056">foedus::storage::sequential::SequentialStorage::append_record()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00691">foedus::storage::masstree::MasstreeStoragePimpl::delete_general()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00356">foedus::storage::hash::HashStoragePimpl::delete_record()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00806">foedus::storage::masstree::MasstreeStoragePimpl::increment_general()</a>, <a class="el" href="array__storage__pimpl_8cpp_source.html#l00486">foedus::storage::array::ArrayStoragePimpl::increment_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00554">foedus::storage::hash::HashStoragePimpl::increment_record()</a>, <a class="el" href="array__storage__pimpl_8cpp_source.html#l00512">foedus::storage::array::ArrayStoragePimpl::increment_record_oneshot()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00661">foedus::storage::masstree::MasstreeStoragePimpl::insert_general()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00277">foedus::storage::hash::HashStoragePimpl::insert_record()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00772">foedus::storage::masstree::MasstreeStoragePimpl::overwrite_general()</a>, <a class="el" href="array__storage__pimpl_8cpp_source.html#l00449">foedus::storage::array::ArrayStoragePimpl::overwrite_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00502">foedus::storage::hash::HashStoragePimpl::overwrite_record()</a>, <a class="el" href="array__storage__pimpl_8cpp_source.html#l00468">foedus::storage::array::ArrayStoragePimpl::overwrite_record_primitive()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00711">foedus::storage::masstree::MasstreeStoragePimpl::upsert_general()</a>, and <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00390">foedus::storage::hash::HashStoragePimpl::upsert_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                                                 {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(log_length + meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">offset_tail_</a> &gt;= meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#acc65d5871a4da5bf8f4e2bf162e9ba9d">buffer_size_</a>)) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">// now we need wrap around. to simplify, let&#39;s avoid having a log entry spanning the</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="comment">// end of the buffer. put a filler log to fill the rest.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      fillup_tail();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">offset_tail_</a> == 0);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// also make sure tail isn&#39;t too close to head (full). in that case, we wait for loggers</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967">head_to_tail_distance</a>() + log_length &gt;= meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a98ac9b46082c2120a347c175ebd0e340">buffer_size_safe_</a>)) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469">wait_for_space</a>(log_length);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967">head_to_tail_distance</a>() + log_length &lt; meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a98ac9b46082c2120a347c175ebd0e340">buffer_size_safe_</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967">head_to_tail_distance</a>() + log_length &lt; meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a98ac9b46082c2120a347c175ebd0e340">buffer_size_safe_</a>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordtype">char</span> *buffer = buffer_ + meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">offset_tail_</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc">advance</a>(meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#acc65d5871a4da5bf8f4e2bf162e9ba9d">buffer_size_</a>, &amp;meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">offset_tail_</a>, log_length);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">return</span> buffer;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1log_1_1ThreadLogBuffer_html_af9fcb5a5ae968d079ee20e51e7418967"><div class="ttname"><a href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967">foedus::log::ThreadLogBuffer::head_to_tail_distance</a></div><div class="ttdeci">uint64_t head_to_tail_distance() const __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00338">thread_log_buffer.hpp:338</a></div></div>
<div class="ttc" id="classfoedus_1_1log_1_1ThreadLogBuffer_html_a8de2c4c08a42a349476956be1b853469"><div class="ttname"><a href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469">foedus::log::ThreadLogBuffer::wait_for_space</a></div><div class="ttdeci">void wait_for_space(uint16_t required_space)</div><div class="ttdoc">Called when we have to wait till offset_head_ advances so that we can put new logs. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8cpp_source.html#l00136">thread_log_buffer.cpp:136</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_acc65d5871a4da5bf8f4e2bf162e9ba9d"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#acc65d5871a4da5bf8f4e2bf162e9ba9d">foedus::log::ThreadLogBufferMeta::buffer_size_</a></div><div class="ttdeci">uint64_t buffer_size_</div><div class="ttdoc">Size of the buffer assigned to this thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00179">thread_log_buffer.hpp:179</a></div></div>
<div class="ttc" id="classfoedus_1_1log_1_1ThreadLogBuffer_html_a6e105bf908004fd08f79432b326067bc"><div class="ttname"><a href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc">foedus::log::ThreadLogBuffer::advance</a></div><div class="ttdeci">static void advance(uint64_t buffer_size, uint64_t *target, uint64_t amount) __attribute__((always_inline))</div><div class="ttdoc">Addition operator, considering wrapping around. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00284">thread_log_buffer.hpp:284</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_abed758916ac4cc7780cd57c4f5912a7b"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#abed758916ac4cc7780cd57c4f5912a7b">foedus::log::ThreadLogBufferMeta::offset_tail_</a></div><div class="ttdeci">uint64_t offset_tail_</div><div class="ttdoc">The current cursor to which next log will be written. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00231">thread_log_buffer.hpp:231</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a98ac9b46082c2120a347c175ebd0e340"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a98ac9b46082c2120a347c175ebd0e340">foedus::log::ThreadLogBufferMeta::buffer_size_safe_</a></div><div class="ttdeci">uint64_t buffer_size_safe_</div><div class="ttdoc">buffer_size_ - 64. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00189">thread_log_buffer.hpp:189</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a9a8c4e8f3a994272f52ddddb312f15b9_cgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a9a8c4e8f3a994272f52ddddb312f15b9_cgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a9a8c4e8f3a994272f52ddddb312f15b9_cgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a9a8c4e8f3a994272f52ddddb312f15b9_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="240,5,427,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="475,27,661,68"/>
<area shape="rect" id="node5" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="240,191,427,232"/>
<area shape="rect" id="node4" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5" title="Subtract operator, considering wrapping around. " alt="" coords="715,27,901,68"/>
<area shape="rect" id="node6" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6" title="Only for Debug&#45;assertion. " alt="" coords="475,92,661,133"/>
<area shape="rect" id="node10" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="501,157,635,199"/>
<area shape="rect" id="node11" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7" title="Equivalent to std::atomic_thread_fence(std::memory_order_release). " alt="" coords="481,223,655,264"/>
<area shape="rect" id="node12" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="481,288,655,329"/>
<area shape="rect" id="node13" href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc" title="See Log Manager. " alt="" coords="501,353,635,395"/>
<area shape="rect" id="node14" href="classfoedus_1_1log_1_1LogManager.html#a5c844c3bc8d71ce709999fd286a5e7b8" title="Wake up loggers if they are sleeping. " alt="" coords="486,419,650,460"/>
<area shape="rect" id="node7" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a05db4e7c61f07d2320aa7b2c3c76d520" title="Only for Debug&#45;assertion. " alt="" coords="715,92,901,133"/>
<area shape="rect" id="node8" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a5dd02cf36ffdb642d41badfc61381621" title="foedus::log::ThreadLogBuffer\lMeta::increment_mark_index" alt="" coords="955,63,1145,104"/>
<area shape="rect" id="node9" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="973,129,1127,155"/>
<area shape="rect" id="node15" href="classfoedus_1_1log_1_1LogManagerPimpl.html#ae0a0fc275f36ad22a57786bc7d17413e" title="foedus::log::LogManagerPimpl\l::wakeup_loggers" alt="" coords="709,419,907,460"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a9a8c4e8f3a994272f52ddddb312f15b9_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a9a8c4e8f3a994272f52ddddb312f15b9_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a9a8c4e8f3a994272f52ddddb312f15b9_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a9a8c4e8f3a994272f52ddddb312f15b9_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1sequential_1_1SequentialStorage.html#ab8696b7ccf07c7b8e1efb038d8cd83c2" title="Append one record to this sequential storage. " alt="" coords="240,56,469,97"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a45396b70b246f330355397b447af55f3" title="implementation of delete_record family. " alt="" coords="268,122,441,178"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="264,267,445,323"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa71566d3a4d56ded35df567784b13525" title="implementation of increment_record family. " alt="" coords="268,413,441,469"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a435ff8b148161ca7296b12eea744a344" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record" alt="" coords="253,497,457,553"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="253,585,456,641"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af77ff710cf2f8ef3800e97861ea94e8f" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record_oneshot" alt="" coords="253,681,457,737"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#af0b96482a874777c4871a152ad733da3" title="implementation of insert_record family. " alt="" coords="268,765,441,821"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="265,878,444,934"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ab9cc59cbbef3fd23a62cbd25cbd00abb" title="implementation of overwrite_record family. " alt="" coords="268,1059,441,1115"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7dde5581eee977242b5373e30365183f" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record" alt="" coords="256,1139,453,1195"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="257,1321,453,1377"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7d324da4dcd35490820cb97e7124001b" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record_primitive" alt="" coords="256,1401,453,1457"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aeeccc272d2f9a4d895f4d117f6b96b27" title="implementation of upsert_record family. " alt="" coords="268,1551,441,1607"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="263,1667,446,1723"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#af263fb1494c7ac6a5dbfd28b926ede3b" title="foedus::storage::masstree\l::MasstreeCursor::delete_record" alt="" coords="532,5,740,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="811,97,1025,139"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="549,122,723,178"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="562,202,710,258"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a81ce493961aa7dedc518ca4230d01868" title="foedus::storage::masstree\l::MasstreeCursor::increment_record" alt="" coords="521,283,751,324"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="517,348,755,389"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="539,414,733,470"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a3cfbd23c4239f8a63ac5719007a8305b" title="This one further optimizes overwrite_record_primitive() for the frequent use case of incrementing som..." alt="" coords="551,494,721,550"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="551,574,721,630"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a5093ba18b241e5179a363476bdd20066" title="This is a faster increment that does not return the value after increment. " alt="" coords="551,654,721,710"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="530,735,742,776"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="549,801,723,857"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="563,881,709,937"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#ab8b1919cb195dd063be409f772b36630" title="foedus::storage::masstree\l::MasstreeCursor::overwrite_record" alt="" coords="525,961,747,1003"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a496370a645284f8578875529c6eacb0f" title="foedus::storage::masstree\l::MasstreeCursor::overwrite\l_record_primitive" alt="" coords="546,1027,726,1083"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="803,1173,1033,1215"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="543,1158,729,1214"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="543,1238,729,1294"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="541,1318,731,1374"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="538,1398,734,1454"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="555,1478,717,1534"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="837,1398,999,1454"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="528,1559,744,1600"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="549,1625,723,1681"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="561,1705,711,1761"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae5eadb53d972505cb49cfa6d900ae9b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::log::ThreadLogBuffer::uninitialize_once </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b">foedus::DefaultInitializable</a>.</p>

<p>Definition at line <a class="el" href="thread__log__buffer_8cpp_source.html#l00131">131</a> of file <a class="el" href="thread__log__buffer_8cpp_source.html">thread_log_buffer.cpp</a>.</p>

<p>References <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                              {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  buffer_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8de2c4c08a42a349476956be1b853469"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::log::ThreadLogBuffer::wait_for_space </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>required_space</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when we have to wait till offset_head_ advances so that we can put new logs. </p>

<p>Definition at line <a class="el" href="thread__log__buffer_8cpp_source.html#l00136">136</a> of file <a class="el" href="thread__log__buffer_8cpp_source.html">thread_log_buffer.cpp</a>.</p>

<p>References <a class="el" href="thread__log__buffer_8hpp_source.html#l00306">assert_consistent()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00189">foedus::log::ThreadLogBufferMeta::buffer_size_safe_</a>, <a class="el" href="log__options_8hpp_source.html#l00104">foedus::log::LogOptions::emulation_</a>, <a class="el" href="engine_8cpp_source.html#l00049">foedus::Engine::get_log_manager()</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00338">head_to_tail_distance()</a>, <a class="el" href="engine__options_8hpp_source.html#l00138">foedus::EngineOptions::log_</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00046">foedus::assorted::memory_fence_acquire()</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00058">foedus::assorted::memory_fence_release()</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00049">foedus::fs::DeviceEmulationOptions::null_device_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00221">foedus::log::ThreadLogBufferMeta::offset_committed_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00210">foedus::log::ThreadLogBufferMeta::offset_durable_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00200">foedus::log::ThreadLogBufferMeta::offset_head_</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00174">foedus::log::ThreadLogBufferMeta::thread_id_</a>, and <a class="el" href="log__manager_8cpp_source.html#l00035">foedus::log::LogManager::wakeup_loggers()</a>.</p>

<p>Referenced by <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">reserve_new_log()</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                                            {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6">assert_consistent</a>();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#aa015fde211c913255fbed3a3bee54884">thread_id_</a> &lt;&lt; <span class="stringliteral">&quot; waiting for space to write logs..&quot;</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">if</span> (engine_-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#aee56a2e02a140b766a74d9e9c3088ddb">log_</a>.<a class="code" href="structfoedus_1_1log_1_1LogOptions.html#a75c5412a901752fecbf7117d6829c444">emulation_</a>.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">null_device_</a>) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// logging disabled</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a23d3ecc1c5c72bfc563b4397cb06925b">offset_head_</a> = meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">offset_durable_</a> = meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">offset_committed_</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7">assorted::memory_fence_release</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// @spinlock, but with a sleep (not in critical path, usually).</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967">head_to_tail_distance</a>() + required_space &gt;= meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a98ac9b46082c2120a347c175ebd0e340">buffer_size_safe_</a>) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">offset_durable_</a> != meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a23d3ecc1c5c72bfc563b4397cb06925b">offset_head_</a>) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">// TASK(Hideaki) actually we should kick axx of log gleaner in this case.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#aa015fde211c913255fbed3a3bee54884">thread_id_</a> &lt;&lt; <span class="stringliteral">&quot; moving head to durable: &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <a class="code" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7">assorted::memory_fence_release</a>();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a23d3ecc1c5c72bfc563b4397cb06925b">offset_head_</a> = meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">offset_durable_</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7">assorted::memory_fence_release</a>();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#aa015fde211c913255fbed3a3bee54884">thread_id_</a> &lt;&lt; <span class="stringliteral">&quot; logger is getting behind. sleeping &quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; for a while..&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      engine_-&gt;<a class="code" href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc">get_log_manager</a>()-&gt;<a class="code" href="classfoedus_1_1log_1_1LogManager.html#a5c844c3bc8d71ce709999fd286a5e7b8">wakeup_loggers</a>();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">// TASK(Hideaki) this duration should be configurable.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      std::this_thread::sleep_for(std::chrono::milliseconds(20));</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967">head_to_tail_distance</a>() + required_space &lt; meta_.<a class="code" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a98ac9b46082c2120a347c175ebd0e340">buffer_size_safe_</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6">assert_consistent</a>();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1log_1_1ThreadLogBuffer_html_af9fcb5a5ae968d079ee20e51e7418967"><div class="ttname"><a href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967">foedus::log::ThreadLogBuffer::head_to_tail_distance</a></div><div class="ttdeci">uint64_t head_to_tail_distance() const __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00338">thread_log_buffer.hpp:338</a></div></div>
<div class="ttc" id="classfoedus_1_1log_1_1LogManager_html_a5c844c3bc8d71ce709999fd286a5e7b8"><div class="ttname"><a href="classfoedus_1_1log_1_1LogManager.html#a5c844c3bc8d71ce709999fd286a5e7b8">foedus::log::LogManager::wakeup_loggers</a></div><div class="ttdeci">void wakeup_loggers()</div><div class="ttdoc">Wake up loggers if they are sleeping. </div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8cpp_source.html#l00035">log_manager.cpp:35</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_aa015fde211c913255fbed3a3bee54884"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#aa015fde211c913255fbed3a3bee54884">foedus::log::ThreadLogBufferMeta::thread_id_</a></div><div class="ttdeci">thread::ThreadId thread_id_</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00174">thread_log_buffer.hpp:174</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a657d9371aa5deec7dfbbad85f4352f37"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a657d9371aa5deec7dfbbad85f4352f37">foedus::log::ThreadLogBufferMeta::offset_committed_</a></div><div class="ttdeci">uint64_t offset_committed_</div><div class="ttdoc">This marks the position upto which transaction logs are committed by the thread. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00221">thread_log_buffer.hpp:221</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a23d3ecc1c5c72bfc563b4397cb06925b"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a23d3ecc1c5c72bfc563b4397cb06925b">foedus::log::ThreadLogBufferMeta::offset_head_</a></div><div class="ttdeci">uint64_t offset_head_</div><div class="ttdoc">This marks the position where log entries start. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00200">thread_log_buffer.hpp:200</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_aa27f031bd1e256d38e616ec9a499eefc"><div class="ttname"><a href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc">foedus::Engine::get_log_manager</a></div><div class="ttdeci">log::LogManager * get_log_manager() const </div><div class="ttdoc">See Log Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00049">engine.cpp:49</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_ace5d36306d82f856042d30c5eb5e5635"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#ace5d36306d82f856042d30c5eb5e5635">foedus::log::ThreadLogBufferMeta::offset_durable_</a></div><div class="ttdeci">uint64_t offset_durable_</div><div class="ttdoc">This marks the position upto which the log writer durably wrote out to log files. ...</div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00210">thread_log_buffer.hpp:210</a></div></div>
<div class="ttc" id="classfoedus_1_1log_1_1ThreadLogBuffer_html_a9aa20c59a7d75cf94742beb43b777de6"><div class="ttname"><a href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6">foedus::log::ThreadLogBuffer::assert_consistent</a></div><div class="ttdeci">void assert_consistent() const </div><div class="ttdoc">Only for Debug-assertion. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00306">thread_log_buffer.hpp:306</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1LogOptions_html_a75c5412a901752fecbf7117d6829c444"><div class="ttname"><a href="structfoedus_1_1log_1_1LogOptions.html#a75c5412a901752fecbf7117d6829c444">foedus::log::LogOptions::emulation_</a></div><div class="ttdeci">foedus::fs::DeviceEmulationOptions emulation_</div><div class="ttdoc">Settings to emulate slower logging device. </div><div class="ttdef"><b>Definition:</b> <a href="log__options_8hpp_source.html#l00104">log_options.hpp:104</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaf84f9944a16c5848f69beacdfeedf939"><div class="ttname"><a href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">foedus::assorted::memory_fence_acquire</a></div><div class="ttdeci">void memory_fence_acquire()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acquire). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00046">atomic_fences.hpp:46</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a965362432b72417b499d4dcfabc94505"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">foedus::fs::DeviceEmulationOptions::null_device_</a></div><div class="ttdeci">bool null_device_</div><div class="ttdoc">[Experiments] as if we write out to /dev/null. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00049">device_emulation_options.hpp:49</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gafc1110de4c6bb85c7e1f7feccc27f6d7"><div class="ttname"><a href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7">foedus::assorted::memory_fence_release</a></div><div class="ttdeci">void memory_fence_release()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_release). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00058">atomic_fences.hpp:58</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_aee56a2e02a140b766a74d9e9c3088ddb"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#aee56a2e02a140b766a74d9e9c3088ddb">foedus::EngineOptions::log_</a></div><div class="ttdeci">log::LogOptions log_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00138">engine_options.hpp:138</a></div></div>
<div class="ttc" id="structfoedus_1_1log_1_1ThreadLogBufferMeta_html_a98ac9b46082c2120a347c175ebd0e340"><div class="ttname"><a href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a98ac9b46082c2120a347c175ebd0e340">foedus::log::ThreadLogBufferMeta::buffer_size_safe_</a></div><div class="ttdeci">uint64_t buffer_size_safe_</div><div class="ttdoc">buffer_size_ - 64. </div><div class="ttdef"><b>Definition:</b> <a href="thread__log__buffer_8hpp_source.html#l00189">thread_log_buffer.hpp:189</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a8de2c4c08a42a349476956be1b853469_cgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a8de2c4c08a42a349476956be1b853469_cgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a8de2c4c08a42a349476956be1b853469_cgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a8de2c4c08a42a349476956be1b853469_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6" title="Only for Debug&#45;assertion. " alt="" coords="240,35,427,76"/>
<area shape="rect" id="node6" href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc" title="See Log Manager. " alt="" coords="266,100,401,141"/>
<area shape="rect" id="node7" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="266,165,401,207"/>
<area shape="rect" id="node8" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="240,231,427,272"/>
<area shape="rect" id="node10" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="247,296,420,337"/>
<area shape="rect" id="node11" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7" title="Equivalent to std::atomic_thread_fence(std::memory_order_release). " alt="" coords="247,361,420,403"/>
<area shape="rect" id="node12" href="classfoedus_1_1log_1_1LogManager.html#a5c844c3bc8d71ce709999fd286a5e7b8" title="Wake up loggers if they are sleeping. " alt="" coords="251,427,415,468"/>
<area shape="rect" id="node3" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a05db4e7c61f07d2320aa7b2c3c76d520" title="Only for Debug&#45;assertion. " alt="" coords="480,35,667,76"/>
<area shape="rect" id="node4" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a5dd02cf36ffdb642d41badfc61381621" title="foedus::log::ThreadLogBuffer\lMeta::increment_mark_index" alt="" coords="720,5,911,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="738,71,893,98"/>
<area shape="rect" id="node9" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5" title="Subtract operator, considering wrapping around. " alt="" coords="480,231,667,272"/>
<area shape="rect" id="node13" href="classfoedus_1_1log_1_1LogManagerPimpl.html#ae0a0fc275f36ad22a57786bc7d17413e" title="foedus::log::LogManagerPimpl\l::wakeup_loggers" alt="" coords="475,427,672,468"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1log_1_1ThreadLogBuffer_a8de2c4c08a42a349476956be1b853469_icgraph.png" border="0" usemap="#classfoedus_1_1log_1_1ThreadLogBuffer_a8de2c4c08a42a349476956be1b853469_icgraph" alt=""/></div>
<map name="classfoedus_1_1log_1_1ThreadLogBuffer_a8de2c4c08a42a349476956be1b853469_icgraph" id="classfoedus_1_1log_1_1ThreadLogBuffer_a8de2c4c08a42a349476956be1b853469_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="240,772,427,813"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1sequential_1_1SequentialStorage.html#ab8696b7ccf07c7b8e1efb038d8cd83c2" title="Append one record to this sequential storage. " alt="" coords="475,56,704,97"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a45396b70b246f330355397b447af55f3" title="implementation of delete_record family. " alt="" coords="503,122,676,178"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="499,267,680,323"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa71566d3a4d56ded35df567784b13525" title="implementation of increment_record family. " alt="" coords="503,413,676,469"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a435ff8b148161ca7296b12eea744a344" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record" alt="" coords="487,497,691,553"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="488,585,691,641"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af77ff710cf2f8ef3800e97861ea94e8f" title="foedus::storage::array\l::ArrayStoragePimpl::increment\l_record_oneshot" alt="" coords="487,681,691,737"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#af0b96482a874777c4871a152ad733da3" title="implementation of insert_record family. " alt="" coords="503,765,676,821"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="500,878,679,934"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ab9cc59cbbef3fd23a62cbd25cbd00abb" title="implementation of overwrite_record family. " alt="" coords="503,1059,676,1115"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7dde5581eee977242b5373e30365183f" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record" alt="" coords="491,1139,688,1195"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="491,1321,687,1377"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a7d324da4dcd35490820cb97e7124001b" title="foedus::storage::array\l::ArrayStoragePimpl::overwrite\l_record_primitive" alt="" coords="491,1401,688,1457"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aeeccc272d2f9a4d895f4d117f6b96b27" title="implementation of upsert_record family. " alt="" coords="503,1551,676,1607"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="498,1667,681,1723"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#af263fb1494c7ac6a5dbfd28b926ede3b" title="foedus::storage::masstree\l::MasstreeCursor::delete_record" alt="" coords="767,5,975,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="1045,97,1260,139"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="784,122,957,178"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="797,202,945,258"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a81ce493961aa7dedc518ca4230d01868" title="foedus::storage::masstree\l::MasstreeCursor::increment_record" alt="" coords="755,283,986,324"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="752,348,989,389"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="773,414,968,470"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a3cfbd23c4239f8a63ac5719007a8305b" title="This one further optimizes overwrite_record_primitive() for the frequent use case of incrementing som..." alt="" coords="785,494,956,550"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="785,574,956,630"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a5093ba18b241e5179a363476bdd20066" title="This is a faster increment that does not return the value after increment. " alt="" coords="785,654,956,710"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="765,735,977,776"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="784,801,957,857"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="797,881,944,937"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#ab8b1919cb195dd063be409f772b36630" title="foedus::storage::masstree\l::MasstreeCursor::overwrite_record" alt="" coords="759,961,982,1003"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a496370a645284f8578875529c6eacb0f" title="foedus::storage::masstree\l::MasstreeCursor::overwrite\l_record_primitive" alt="" coords="781,1027,961,1083"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="1037,1173,1268,1215"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="777,1158,964,1214"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="777,1238,964,1294"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="776,1318,965,1374"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="773,1398,969,1454"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="789,1478,952,1534"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="1071,1398,1234,1454"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="763,1559,979,1600"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="784,1625,957,1681"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="796,1705,945,1761"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="aff02b76416d2846736b7ecd798921a0a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classfoedus_1_1log_1_1Logger.html">Logger</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="thread__log__buffer_8hpp_source.html#l00268">268</a> of file <a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad026f1f955a2f9ae5ef826a4821b58ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html">ThreadLogBuffer</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="thread__log__buffer_8cpp_source.html#l00330">330</a> of file <a class="el" href="thread__log__buffer_8cpp_source.html">thread_log_buffer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                                                {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  o &lt;&lt; v.meta_;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/log/<a class="el" href="thread__log__buffer_8hpp_source.html">thread_log_buffer.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/log/<a class="el" href="thread__log__buffer_8cpp_source.html">thread_log_buffer.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1log.html">log</a></li><li class="navelem"><a class="el" href="classfoedus_1_1log_1_1ThreadLogBuffer.html">ThreadLogBuffer</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

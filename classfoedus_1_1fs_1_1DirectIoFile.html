<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::fs::DirectIoFile Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1fs_1_1DirectIoFile.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfoedus_1_1fs_1_1DirectIoFile-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::fs::DirectIoFile Class Reference<div class="ingroups"><a class="el" href="group__IDIOMS.html">FOEDUS Programming Idioms</a> &raquo; <a class="el" href="group__FILESYSTEM.html">Filesystem wrapper</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Represents an I/O stream on one file without filesystem caching.  
 <a href="classfoedus_1_1fs_1_1DirectIoFile.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Represents an I/O stream on one file without filesystem caching. </p>
<p>This class bypasses filesystem caching for disk I/O for three purposes. </p><ul>
<li>Performance, as DBMS has better knowledge of disk accesses than OS. </li>
<li>Memory footprint, as we might end up doubled memory consumption. </li>
<li>Durability, as write-cache would undermine the synchronous flush during commit.</li>
</ul>
<p>This class is used for two kinds of files. </p><ul>
<li>Data file, or snapshot files. </li>
<li>Log file <dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Support Windows. MUCH later. </dd></dl>
</li>
</ul>

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00048">48</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:aa410f6dd215b5f28e131ae7f77e326d1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1">Constants</a> { <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">kInvalidDescriptor</a> = -1
 }<tr class="memdesc:aa410f6dd215b5f28e131ae7f77e326d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant values.  <a href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1">More...</a><br /></td></tr>
<tr class="separator:aa410f6dd215b5f28e131ae7f77e326d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</td></tr>
<tr class="memitem:a2f503633c8a49e8745f55ccba6002b8d"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8d">SeekType</a> { <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84">kDirectIoSeekSet</a> = 0, 
<a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da24b881dc332947bf8f4b5d5a769bab93">kDirectIoSeekCur</a>, 
<a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da4768c64279d891c7d87fb4be4ed5409a">kDirectIoSeekEnd</a>
 }<tr class="memdesc:a2f503633c8a49e8745f55ccba6002b8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analogue of SEEK_SET/SEEK_CUR/SEEK_END in POSIX.  <a href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8d">More...</a><br /></td></tr>
<tr class="separator:a2f503633c8a49e8745f55ccba6002b8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</td></tr>
<tr class="memitem:aab88d4ac2911c1fd4c16502a8134873a"><td class="memItemLeft" align="right" valign="top">typedef int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aab88d4ac2911c1fd4c16502a8134873a">file_descriptor</a></td></tr>
<tr class="memdesc:aab88d4ac2911c1fd4c16502a8134873a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents low-level file descriptor.  <a href="#aab88d4ac2911c1fd4c16502a8134873a">More...</a><br /></td></tr>
<tr class="separator:aab88d4ac2911c1fd4c16502a8134873a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7ff349bd9981a14770ef70d8e5b1f5f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a7ff349bd9981a14770ef70d8e5b1f5f0">DirectIoFile</a> (const <a class="el" href="classfoedus_1_1fs_1_1Path.html">Path</a> &amp;path, const <a class="el" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html">DeviceEmulationOptions</a> &amp;emulation=<a class="el" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html">DeviceEmulationOptions</a>())</td></tr>
<tr class="memdesc:a7ff349bd9981a14770ef70d8e5b1f5f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs this object without opening it yet.  <a href="#a7ff349bd9981a14770ef70d8e5b1f5f0">More...</a><br /></td></tr>
<tr class="separator:a7ff349bd9981a14770ef70d8e5b1f5f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1d39b73fb8a72ae3bbf680341801875"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa1d39b73fb8a72ae3bbf680341801875">~DirectIoFile</a> ()</td></tr>
<tr class="memdesc:aa1d39b73fb8a72ae3bbf680341801875"><td class="mdescLeft">&#160;</td><td class="mdescRight">Automatically closes the file if it is opened.  <a href="#aa1d39b73fb8a72ae3bbf680341801875">More...</a><br /></td></tr>
<tr class="separator:aa1d39b73fb8a72ae3bbf680341801875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c30876afd4bdf92cd00287141b0eb35"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a8c30876afd4bdf92cd00287141b0eb35">DirectIoFile</a> ()=delete</td></tr>
<tr class="separator:a8c30876afd4bdf92cd00287141b0eb35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9b561f551f225bc07afc34fe7717932"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#ac9b561f551f225bc07afc34fe7717932">DirectIoFile</a> (const <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html">DirectIoFile</a> &amp;)=delete</td></tr>
<tr class="separator:ac9b561f551f225bc07afc34fe7717932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27497da49f8afb11369f7d2b05780ec0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html">DirectIoFile</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a27497da49f8afb11369f7d2b05780ec0">operator=</a> (const <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html">DirectIoFile</a> &amp;)=delete</td></tr>
<tr class="separator:a27497da49f8afb11369f7d2b05780ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa3c1e50680d02783b61f5fe23f98b14"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aaa3c1e50680d02783b61f5fe23f98b14">open</a> (bool <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40">read</a>, bool <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">write</a>, bool append, bool create)</td></tr>
<tr class="memdesc:aaa3c1e50680d02783b61f5fe23f98b14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to open the file for the specified volume.  <a href="#aaa3c1e50680d02783b61f5fe23f98b14">More...</a><br /></td></tr>
<tr class="separator:aaa3c1e50680d02783b61f5fe23f98b14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d89a9c761a388f13f9b59490b6caa00"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00">is_opened</a> () const </td></tr>
<tr class="memdesc:a1d89a9c761a388f13f9b59490b6caa00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether the file is already and successfully opened.  <a href="#a1d89a9c761a388f13f9b59490b6caa00">More...</a><br /></td></tr>
<tr class="separator:a1d89a9c761a388f13f9b59490b6caa00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7888a3b0c169fbc6b2e6e83c86d5f267"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267">close</a> ()</td></tr>
<tr class="memdesc:a7888a3b0c169fbc6b2e6e83c86d5f267"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the file if not yet closed.  <a href="#a7888a3b0c169fbc6b2e6e83c86d5f267">More...</a><br /></td></tr>
<tr class="separator:a7888a3b0c169fbc6b2e6e83c86d5f267"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c6bff6aafc955fd4c2a8e11e7f41f40"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40">read</a> (uint64_t desired_bytes, <a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">foedus::memory::AlignedMemory</a> *buffer)</td></tr>
<tr class="memdesc:a1c6bff6aafc955fd4c2a8e11e7f41f40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sequentially read the given amount of contents from the current position.  <a href="#a1c6bff6aafc955fd4c2a8e11e7f41f40">More...</a><br /></td></tr>
<tr class="separator:a1c6bff6aafc955fd4c2a8e11e7f41f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f9c1053d076007620b4d1c4dfec9bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a16f9c1053d076007620b4d1c4dfec9bf">read</a> (uint64_t desired_bytes, const <a class="el" href="structfoedus_1_1memory_1_1AlignedMemorySlice.html">foedus::memory::AlignedMemorySlice</a> &amp;slice)</td></tr>
<tr class="memdesc:a16f9c1053d076007620b4d1c4dfec9bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory slice version.  <a href="#a16f9c1053d076007620b4d1c4dfec9bf">More...</a><br /></td></tr>
<tr class="separator:a16f9c1053d076007620b4d1c4dfec9bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5353bbb3b2a815d6c858c8190edeccf4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4">read_raw</a> (uint64_t desired_bytes, void *buffer)</td></tr>
<tr class="memdesc:a5353bbb3b2a815d6c858c8190edeccf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">A version that receives a raw pointer that has to be aligned (be careful to use this ver).  <a href="#a5353bbb3b2a815d6c858c8190edeccf4">More...</a><br /></td></tr>
<tr class="separator:a5353bbb3b2a815d6c858c8190edeccf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f19d10be82ac60706853e106a5de0e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">write</a> (uint64_t desired_bytes, const <a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">foedus::memory::AlignedMemory</a> &amp;buffer)</td></tr>
<tr class="memdesc:a9f19d10be82ac60706853e106a5de0e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sequentially write the given amount of contents from the current position.  <a href="#a9f19d10be82ac60706853e106a5de0e1">More...</a><br /></td></tr>
<tr class="separator:a9f19d10be82ac60706853e106a5de0e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2419b5b2a19b6307143876baffcc783"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#ad2419b5b2a19b6307143876baffcc783">write</a> (uint64_t desired_bytes, const <a class="el" href="structfoedus_1_1memory_1_1AlignedMemorySlice.html">foedus::memory::AlignedMemorySlice</a> &amp;slice)</td></tr>
<tr class="memdesc:ad2419b5b2a19b6307143876baffcc783"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory slice version.  <a href="#ad2419b5b2a19b6307143876baffcc783">More...</a><br /></td></tr>
<tr class="separator:ad2419b5b2a19b6307143876baffcc783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee93267c52644978643dedc44965970"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#abee93267c52644978643dedc44965970">write_raw</a> (uint64_t desired_bytes, const void *buffer)</td></tr>
<tr class="memdesc:abee93267c52644978643dedc44965970"><td class="mdescLeft">&#160;</td><td class="mdescRight">A version that receives a raw pointer that has to be aligned (be careful to use this ver).  <a href="#abee93267c52644978643dedc44965970">More...</a><br /></td></tr>
<tr class="separator:abee93267c52644978643dedc44965970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad59b9d5dc37a89ee993565865bb36b01"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#ad59b9d5dc37a89ee993565865bb36b01">truncate</a> (uint64_t new_length, bool <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a357db1ed5dbab29245011a2c79d12023">sync</a>=false)</td></tr>
<tr class="memdesc:ad59b9d5dc37a89ee993565865bb36b01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discard the content of the file after the given offset.  <a href="#ad59b9d5dc37a89ee993565865bb36b01">More...</a><br /></td></tr>
<tr class="separator:ad59b9d5dc37a89ee993565865bb36b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35814dfec4dab81d5bb46e453f1993e6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6">seek</a> (uint64_t offset, <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8d">SeekType</a> seek_type)</td></tr>
<tr class="memdesc:a35814dfec4dab81d5bb46e453f1993e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the position of the next byte to be written/extracted from/to the stream.  <a href="#a35814dfec4dab81d5bb46e453f1993e6">More...</a><br /></td></tr>
<tr class="separator:a35814dfec4dab81d5bb46e453f1993e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a357db1ed5dbab29245011a2c79d12023"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a357db1ed5dbab29245011a2c79d12023">sync</a> ()</td></tr>
<tr class="memdesc:a357db1ed5dbab29245011a2c79d12023"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analogues of POSIX <a class="el" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e" title="Makes the content and metadata of the file durable all the way up to devices. ">fsync()</a>.  <a href="#a357db1ed5dbab29245011a2c79d12023">More...</a><br /></td></tr>
<tr class="separator:a357db1ed5dbab29245011a2c79d12023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91315b18dee7b839ba47cfa80116295c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1fs_1_1Path.html">Path</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a91315b18dee7b839ba47cfa80116295c">get_path</a> () const </td></tr>
<tr class="separator:a91315b18dee7b839ba47cfa80116295c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1a1dd0e5f02772b7e972a86ba34c846"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html">DeviceEmulationOptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#ab1a1dd0e5f02772b7e972a86ba34c846">get_emulation</a> () const </td></tr>
<tr class="separator:ab1a1dd0e5f02772b7e972a86ba34c846"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dd9b756660726698ebfc6e2078c7610"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aab88d4ac2911c1fd4c16502a8134873a">file_descriptor</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5dd9b756660726698ebfc6e2078c7610">get_descriptor</a> () const </td></tr>
<tr class="separator:a5dd9b756660726698ebfc6e2078c7610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6848e9b0a2e9ecce1570c49803b3f375"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a6848e9b0a2e9ecce1570c49803b3f375">get_current_offset</a> () const </td></tr>
<tr class="separator:a6848e9b0a2e9ecce1570c49803b3f375"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ba190a64d26f1b5182bdc75ebe97e37"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a7ba190a64d26f1b5182bdc75ebe97e37">is_read</a> () const </td></tr>
<tr class="separator:a7ba190a64d26f1b5182bdc75ebe97e37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae86509a918643c3bd8eba937f6803fb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aae86509a918643c3bd8eba937f6803fb">is_write</a> () const </td></tr>
<tr class="separator:aae86509a918643c3bd8eba937f6803fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50516ffc3876c5808808651c2c0cb6e8"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a50516ffc3876c5808808651c2c0cb6e8">to_string</a> () const </td></tr>
<tr class="separator:a50516ffc3876c5808808651c2c0cb6e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a1aabc2de30f24b0d5072a9b9b36d4fdb"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1aabc2de30f24b0d5072a9b9b36d4fdb">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html">DirectIoFile</a> &amp;v)</td></tr>
<tr class="separator:a1aabc2de30f24b0d5072a9b9b36d4fdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="aab88d4ac2911c1fd4c16502a8134873a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aab88d4ac2911c1fd4c16502a8134873a">foedus::fs::DirectIoFile::file_descriptor</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Represents low-level file descriptor. </p>

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00051">51</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="aa410f6dd215b5f28e131ae7f77e326d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1">foedus::fs::DirectIoFile::Constants</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constant values. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6"></a>kInvalidDescriptor&#160;</td><td class="fielddoc">
<p>POSIX <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aaa3c1e50680d02783b61f5fe23f98b14" title="Tries to open the file for the specified volume. ">open()</a> semantics says -1 is invalid or not-yet-opened. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00053">53</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                 {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">kInvalidDescriptor</a> = -1,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  };</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">foedus::fs::DirectIoFile::kInvalidDescriptor</a></div><div class="ttdoc">POSIX open() semantics says -1 is invalid or not-yet-opened. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00055">direct_io_file.hpp:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f503633c8a49e8745f55ccba6002b8d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8d">foedus::fs::DirectIoFile::SeekType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Analogue of SEEK_SET/SEEK_CUR/SEEK_END in POSIX. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84"></a>kDirectIoSeekSet&#160;</td><td class="fielddoc">
<p>The offset is set to offset bytes. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a2f503633c8a49e8745f55ccba6002b8da24b881dc332947bf8f4b5d5a769bab93"></a>kDirectIoSeekCur&#160;</td><td class="fielddoc">
<p>The offset is set to its current location plus offset bytes. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a2f503633c8a49e8745f55ccba6002b8da4768c64279d891c7d87fb4be4ed5409a"></a>kDirectIoSeekEnd&#160;</td><td class="fielddoc">
<p>The offset is set to the size of the file plus offset bytes. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00059">59</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84">kDirectIoSeekSet</a> = 0,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da24b881dc332947bf8f4b5d5a769bab93">kDirectIoSeekCur</a>,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da4768c64279d891c7d87fb4be4ed5409a">kDirectIoSeekEnd</a>,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  };</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a2f503633c8a49e8745f55ccba6002b8da24b881dc332947bf8f4b5d5a769bab93"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da24b881dc332947bf8f4b5d5a769bab93">foedus::fs::DirectIoFile::kDirectIoSeekCur</a></div><div class="ttdoc">The offset is set to its current location plus offset bytes. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00063">direct_io_file.hpp:63</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a2f503633c8a49e8745f55ccba6002b8da4768c64279d891c7d87fb4be4ed5409a"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da4768c64279d891c7d87fb4be4ed5409a">foedus::fs::DirectIoFile::kDirectIoSeekEnd</a></div><div class="ttdoc">The offset is set to the size of the file plus offset bytes. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00065">direct_io_file.hpp:65</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84">foedus::fs::DirectIoFile::kDirectIoSeekSet</a></div><div class="ttdoc">The offset is set to offset bytes. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00061">direct_io_file.hpp:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7ff349bd9981a14770ef70d8e5b1f5f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">foedus::fs::DirectIoFile::DirectIoFile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1fs_1_1Path.html">Path</a> &amp;&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html">DeviceEmulationOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>emulation</em> = <code><a class="el" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html">DeviceEmulationOptions</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs this object without opening it yet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td><a class="el" href="classfoedus_1_1fs_1_1Path.html" title="Analogue of boost::filesystem::path. ">Path</a> of the file to manipulate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">emulation</td><td>Optional argument to emulate slower devices. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00044">44</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  : path_(path), emulation_(emulation),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  descriptor_(<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">kInvalidDescriptor</a>), read_(<span class="keyword">false</span>), write_(<span class="keyword">false</span>), current_offset_(0) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">foedus::fs::DirectIoFile::kInvalidDescriptor</a></div><div class="ttdoc">POSIX open() semantics says -1 is invalid or not-yet-opened. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00055">direct_io_file.hpp:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa1d39b73fb8a72ae3bbf680341801875"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">foedus::fs::DirectIoFile::~DirectIoFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Automatically closes the file if it is opened. </p>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00051">51</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>References <a class="el" href="direct__io__file_8cpp_source.html#l00129">close()</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                            {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267">close</a>();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a7888a3b0c169fbc6b2e6e83c86d5f267"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267">foedus::fs::DirectIoFile::close</a></div><div class="ttdeci">bool close()</div><div class="ttdoc">Close the file if not yet closed. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00129">direct_io_file.cpp:129</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_aa1d39b73fb8a72ae3bbf680341801875_cgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_aa1d39b73fb8a72ae3bbf680341801875_cgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_aa1d39b73fb8a72ae3bbf680341801875_cgraph" id="classfoedus_1_1fs_1_1DirectIoFile_aa1d39b73fb8a72ae3bbf680341801875_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267" title="Close the file if not yet closed. " alt="" coords="204,5,355,47"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="403,5,543,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8c30876afd4bdf92cd00287141b0eb35"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::fs::DirectIoFile::DirectIoFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac9b561f551f225bc07afc34fe7717932"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::fs::DirectIoFile::DirectIoFile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html">DirectIoFile</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a7888a3b0c169fbc6b2e6e83c86d5f267"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::fs::DirectIoFile::close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the file if not yet closed. </p>
<dl class="section return"><dt>Returns</dt><dd>Whether successfully closed. Even it fails, the file descriptor is already invalid. You cannot call this method again to close it appropriately. </dd></dl>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00129">129</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00055">kInvalidDescriptor</a>, and <a class="el" href="assorted__func_8cpp_source.html#l00067">foedus::assorted::os_error()</a>.</p>

<p>Referenced by <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00053">foedus::snapshot::SnapshotWriter::close()</a>, <a class="el" href="externalizable_8cpp_source.html#l00096">foedus::externalize::Externalizable::save_to_file()</a>, <a class="el" href="meta__logger__impl_8cpp_source.html#l00164">foedus::log::MetaLogger::uninitialize_once()</a>, <a class="el" href="logger__impl_8cpp_source.html#l00136">foedus::log::Logger::uninitialize_once()</a>, and <a class="el" href="direct__io__file_8cpp_source.html#l00051">~DirectIoFile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                         {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> (descriptor_ != <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">kInvalidDescriptor</a>) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">int</span> ret = <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267">::close</a>(descriptor_);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::close(): closed. &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="comment">// Error at file close is nasty, we can&#39;t do much. We just report it in log.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::close(): error:&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">foedus::assorted::os_error</a>()</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; file=&quot;</span> &lt;&lt; *<span class="keyword">this</span> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<span class="keyword">false</span>);  <span class="comment">// crash only in debug mode</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    descriptor_ = <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">kInvalidDescriptor</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> ret == 0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a7888a3b0c169fbc6b2e6e83c86d5f267"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a7888a3b0c169fbc6b2e6e83c86d5f267">foedus::fs::DirectIoFile::close</a></div><div class="ttdeci">bool close()</div><div class="ttdoc">Close the file if not yet closed. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00129">direct_io_file.cpp:129</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaaa260096daf8620266c2799d1f5a0270"><div class="ttname"><a href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">foedus::assorted::os_error</a></div><div class="ttdeci">std::string os_error()</div><div class="ttdoc">Thread-safe strerror(errno). </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8cpp_source.html#l00067">assorted_func.cpp:67</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">foedus::fs::DirectIoFile::kInvalidDescriptor</a></div><div class="ttdoc">POSIX open() semantics says -1 is invalid or not-yet-opened. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00055">direct_io_file.hpp:55</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a7888a3b0c169fbc6b2e6e83c86d5f267_cgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a7888a3b0c169fbc6b2e6e83c86d5f267_cgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a7888a3b0c169fbc6b2e6e83c86d5f267_cgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a7888a3b0c169fbc6b2e6e83c86d5f267_cgraph">
<area shape="rect" id="node2" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="204,5,344,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a7888a3b0c169fbc6b2e6e83c86d5f267_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a7888a3b0c169fbc6b2e6e83c86d5f267_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a7888a3b0c169fbc6b2e6e83c86d5f267_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a7888a3b0c169fbc6b2e6e83c86d5f267_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4944523eeeba60c3b677a8147b1f9e42" title="Close the file and makes sure all writes become durable (including the directory entry). " alt="" coords="204,71,388,112"/>
<area shape="rect" id="node5" href="structfoedus_1_1externalize_1_1Externalizable.html#af4e4989a732573c1bbd538a3fbfad930" title="Atomically and durably writes out this object to the specified XML file. " alt="" coords="223,162,369,218"/>
<area shape="rect" id="node14" href="classfoedus_1_1log_1_1MetaLogger.html#a708d39dc0dfcc07538391f10dc5dc8e5" title="foedus::log::MetaLogger\l::uninitialize_once" alt="" coords="215,243,377,284"/>
<area shape="rect" id="node15" href="classfoedus_1_1log_1_1Logger.html#a3c738ffc16ed6cfe54e66bbbd1ccc043" title="foedus::log::Logger\l::uninitialize_once" alt="" coords="230,308,362,349"/>
<area shape="rect" id="node16" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa1d39b73fb8a72ae3bbf680341801875" title="Automatically closes the file if it is opened. " alt="" coords="221,373,371,415"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a3c24b7f707e02abf63c2708b0090c02e" title="foedus::snapshot::Snapshot\lWriter::~SnapshotWriter" alt="" coords="436,5,620,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a7d71f940f088efa51d0b5769d4fdd31f" title="Open the file so that the writer can start writing. " alt="" coords="436,71,620,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#ad75cdea74e547a1f66d62b85a938a2cd" title="foedus::savepoint::\lSavepointManagerPimpl\l::initialize_once" alt="" coords="693,155,854,211"/>
<area shape="rect" id="node7" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#ae5e8a2671c819fc0ada038b3fa47105a" title="foedus::savepoint::\lSavepointManagerPimpl\l::savepoint_main" alt="" coords="447,187,609,243"/>
<area shape="rect" id="node8" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a4ae6b016213cb70bb6e5df636b24d129" title="Sub&#45;routine of handle_snapshot_triggered(). " alt="" coords="436,267,620,323"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a905ccf76fe0e076980dc1965f038fe10" title="handle_snapshot() calls this when it should start snapshotting. " alt="" coords="668,267,879,323"/>
<area shape="rect" id="node10" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="955,241,1109,283"/>
<area shape="rect" id="node12" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a64e3c7594b7d7d0d5f8a144bd802d910" title="Main routine for snapshot_thread_ in master engine. " alt="" coords="927,307,1137,348"/>
<area shape="rect" id="node11" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a868dca9015af77e04202ead68fd7a136" title="foedus::restart::Restart\lManagerPimpl::initialize_once" alt="" coords="1185,241,1380,283"/>
<area shape="rect" id="node13" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a632a4da7b3c67dd687f7eba4f6ec1d76" title="foedus::snapshot::Snapshot\lManagerPimpl::initialize_once" alt="" coords="1185,307,1380,348"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6848e9b0a2e9ecce1570c49803b3f375"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t foedus::fs::DirectIoFile::get_current_offset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00173">173</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>

<p>Referenced by <a class="el" href="meta__logger__impl_8cpp_source.html#l00036">foedus::log::MetaLogger::initialize_once()</a>, <a class="el" href="logger__impl_8cpp_source.html#l00074">foedus::log::Logger::initialize_once()</a>, <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00082">foedus::snapshot::SnapshotWriter::open()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00388">foedus::fs::operator&lt;&lt;()</a>, <a class="el" href="logger__impl_8cpp_source.html#l00533">foedus::log::operator&lt;&lt;()</a>, and <a class="el" href="log__buffer_8cpp_source.html#l00082">foedus::snapshot::DumpFileSortedBuffer::wind()</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{ <span class="keywordflow">return</span> current_offset_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a6848e9b0a2e9ecce1570c49803b3f375_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a6848e9b0a2e9ecce1570c49803b3f375_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a6848e9b0a2e9ecce1570c49803b3f375_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a6848e9b0a2e9ecce1570c49803b3f375_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1MetaLogger.html#a5a3484d094947ced0a08a5e162f08a88" title="foedus::log::MetaLogger\l::initialize_once" alt="" coords="215,5,377,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1log_1_1Logger.html#a3b1d647f1458d1172a511b7e57a2a237" title="foedus::log::Logger\l::initialize_once" alt="" coords="230,71,362,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a7d71f940f088efa51d0b5769d4fdd31f" title="Open the file so that the writer can start writing. " alt="" coords="204,136,388,177"/>
<area shape="rect" id="node5" href="namespacefoedus_1_1fs.html#accc36bb6a6995d99162f835fe186d2ef" title="foedus::fs::operator\&lt;\&lt;" alt="" coords="221,202,371,229"/>
<area shape="rect" id="node6" href="namespacefoedus_1_1log.html#a182df022267417563df5c7f1552ddbee" title="foedus::log::operator\&lt;\&lt;" alt="" coords="218,253,374,279"/>
<area shape="rect" id="node7" href="classfoedus_1_1snapshot_1_1DumpFileSortedBuffer.html#a22900418b253b1a5164b63eacd15d654" title="Loads next data block to be consumed by the caller (composer). " alt="" coords="204,304,388,345"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5dd9b756660726698ebfc6e2078c7610"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aab88d4ac2911c1fd4c16502a8134873a">file_descriptor</a> foedus::fs::DirectIoFile::get_descriptor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00172">172</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>

<p>Referenced by <a class="el" href="direct__io__file_8cpp_source.html#l00388">foedus::fs::operator&lt;&lt;()</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{ <span class="keywordflow">return</span> descriptor_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a5dd9b756660726698ebfc6e2078c7610_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a5dd9b756660726698ebfc6e2078c7610_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a5dd9b756660726698ebfc6e2078c7610_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a5dd9b756660726698ebfc6e2078c7610_icgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1fs.html#accc36bb6a6995d99162f835fe186d2ef" title="foedus::fs::operator\&lt;\&lt;" alt="" coords="204,13,353,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab1a1dd0e5f02772b7e972a86ba34c846"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html">DeviceEmulationOptions</a> foedus::fs::DirectIoFile::get_emulation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00171">171</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;{ <span class="keywordflow">return</span> emulation_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a91315b18dee7b839ba47cfa80116295c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1fs_1_1Path.html">Path</a> foedus::fs::DirectIoFile::get_path </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00170">170</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>

<p>Referenced by <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00053">foedus::snapshot::SnapshotWriter::close()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00388">foedus::fs::operator&lt;&lt;()</a>, and <a class="el" href="log__buffer_8cpp_source.html#l00069">foedus::snapshot::DumpFileSortedBuffer::to_string()</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;{ <span class="keywordflow">return</span> path_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a91315b18dee7b839ba47cfa80116295c_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a91315b18dee7b839ba47cfa80116295c_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a91315b18dee7b839ba47cfa80116295c_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a91315b18dee7b839ba47cfa80116295c_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4944523eeeba60c3b677a8147b1f9e42" title="Close the file and makes sure all writes become durable (including the directory entry). " alt="" coords="204,37,388,79"/>
<area shape="rect" id="node5" href="namespacefoedus_1_1fs.html#accc36bb6a6995d99162f835fe186d2ef" title="foedus::fs::operator\&lt;\&lt;" alt="" coords="221,103,371,130"/>
<area shape="rect" id="node6" href="classfoedus_1_1snapshot_1_1DumpFileSortedBuffer.html#a0aff73ef8d123277b26335ddca043cca" title="Returns a short string that briefly describes this object. " alt="" coords="204,155,388,196"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a3c24b7f707e02abf63c2708b0090c02e" title="foedus::snapshot::Snapshot\lWriter::~SnapshotWriter" alt="" coords="436,5,620,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a7d71f940f088efa51d0b5769d4fdd31f" title="Open the file so that the writer can start writing. " alt="" coords="436,71,620,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1d89a9c761a388f13f9b59490b6caa00"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::fs::DirectIoFile::is_opened </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether the file is already and successfully opened. </p>

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00095">95</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>

<p>References <a class="el" href="direct__io__file_8hpp_source.html#l00055">kInvalidDescriptor</a>.</p>

<p>Referenced by <a class="el" href="direct__io__file_8cpp_source.html#l00162">read_raw()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00360">sync()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00296">truncate()</a>, and <a class="el" href="direct__io__file_8cpp_source.html#l00236">write_raw()</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{ <span class="keywordflow">return</span> descriptor_ != <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">kInvalidDescriptor</a>; }</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">foedus::fs::DirectIoFile::kInvalidDescriptor</a></div><div class="ttdoc">POSIX open() semantics says -1 is invalid or not-yet-opened. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00055">direct_io_file.hpp:55</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a1d89a9c761a388f13f9b59490b6caa00_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a1d89a9c761a388f13f9b59490b6caa00_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a1d89a9c761a388f13f9b59490b6caa00_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a1d89a9c761a388f13f9b59490b6caa00_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="204,1192,355,1233"/>
<area shape="rect" id="node46" href="classfoedus_1_1fs_1_1DirectIoFile.html#a357db1ed5dbab29245011a2c79d12023" title="Analogues of POSIX fsync(). " alt="" coords="204,1257,355,1299"/>
<area shape="rect" id="node47" href="classfoedus_1_1fs_1_1DirectIoFile.html#ad59b9d5dc37a89ee993565865bb36b01" title="Discard the content of the file after the given offset. " alt="" coords="204,1323,355,1364"/>
<area shape="rect" id="node49" href="classfoedus_1_1fs_1_1DirectIoFile.html#abee93267c52644978643dedc44965970" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="204,1388,355,1429"/>
<area shape="rect" id="node3" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="403,389,589,431"/>
<area shape="rect" id="node40" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#aae67209f9aa9d03e45a9934067c8245b" title="Read contiguous pages in one shot. " alt="" coords="403,1192,589,1233"/>
<area shape="rect" id="node45" href="classfoedus_1_1fs_1_1DirectIoFile.html#a16f9c1053d076007620b4d1c4dfec9bf" title="Memory slice version. " alt="" coords="421,1257,571,1299"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#a2c812e46a7502abe6f506ecda0edf9ab" title="foedus::storage::array\l::ArrayComposer::construct_root" alt="" coords="653,5,863,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#ac5ad2e7fa792d58965a05be6bd43e43c" title="foedus::storage::hash\l::HashComposer::construct_root" alt="" coords="653,71,863,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a91db842a6ef8780d3fe4ba2f0f625da7" title="foedus::storage::sequential\l::SequentialComposer::construct_root" alt="" coords="637,136,879,177"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread_follow" alt="" coords="655,202,861,258"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePartitioner.html#a1aedc45cc5621bd3889f1bf2d47ab79c" title="foedus::storage::masstree\l::MasstreePartitioner::\ldesign_partition" alt="" coords="671,299,845,355"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#a32fb943620383e597308852094ba4ac3" title="foedus::storage::hash\l::TmpSnashotPage::init" alt="" coords="679,389,837,431"/>
<area shape="rect" id="node19" href="classfoedus_1_1memory_1_1EngineMemory.html#a3c3c8902b7000d09878a5a2085f6058c" title="Another convenience method that also reads an existing snapshot page to the volatile page..." alt="" coords="653,561,863,603"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="657,717,859,773"/>
<area shape="rect" id="node29" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="666,929,850,971"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1StorageManagerPimpl.html#ad5f949c2d00aea4cb2186c93108b7dcc" title="Special method called only from recovery manager. " alt="" coords="673,1050,843,1106"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c" title="Construct root page(s) for one storage based on the ouputs of compose(). " alt="" coords="951,39,1130,80"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a41e664c7035f1b89121ef06678a71386" title="These are defined in masstree_storage_debug.cpp. " alt="" coords="954,105,1127,161"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread\l_recurse" alt="" coords="954,185,1127,256"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a9d2f5eb65777d851bee6809acf6fe153" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="1212,105,1403,161"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1Partitioner.html#a31a7e393bf1f87a9a039c60b291ac9d1" title="Determines partitioning scheme for this storage. " alt="" coords="951,280,1130,321"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae68923a3afe20ce445002b85764a9f17" title="These are defined in hash_storage_debug.cpp. " alt="" coords="1465,365,1664,421"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_intermediate" alt="" coords="1208,397,1407,453"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa220f1f2d268290263483476d85be47b" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_data" alt="" coords="941,447,1140,503"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a144b7a6f95482f2ab8f8564776689fb9" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="1726,365,1893,421"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a577ab7f32ca2b4d48a7fa174263de47d" title="foedus::storage::array\l::ArrayStoragePimpl::load" alt="" coords="955,528,1126,569"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a44bc6cd5427daadbee9fd6fcc366af09" title="foedus::storage::hash\l::HashStoragePimpl::load" alt="" coords="955,593,1126,635"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a8d4ac5a88e7ce112f83b67597719fa82" title="foedus::storage::masstree\l::MasstreeStoragePimpl::load" alt="" coords="943,659,1138,700"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#aa0f536b8252655076528b290abb84a87" title="foedus::storage::array\l::ArrayStorage::load" alt="" coords="1233,528,1381,569"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a200dd1b1b2b5bc937cae55120e1befc9" title="foedus::storage::hash\l::HashStorage::load" alt="" coords="1234,593,1381,635"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a2731aaf3a733c773a63df6d691ede3ac" title="foedus::storage::masstree\l::MasstreeStorage::load" alt="" coords="1221,659,1394,700"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="927,724,1155,765"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="939,790,1142,846"/>
<area shape="rect" id="node30" href="classfoedus_1_1thread_1_1Thread.html#a29e87db0559d67ac9a942e345e3a2ea2" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="959,871,1123,912"/>
<area shape="rect" id="node31" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1203,929,1412,971"/>
<area shape="rect" id="node35" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a98de2aa47bebca5add3e0550f2c602bf" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="1215,1039,1399,1095"/>
<area shape="rect" id="node37" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="949,988,1133,1029"/>
<area shape="rect" id="node32" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1460,860,1669,901"/>
<area shape="rect" id="node33" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="1473,925,1657,967"/>
<area shape="rect" id="node34" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1717,955,1901,996"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1Thread.html#a878c3aa228a6e8925e21a3b7b0592349" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="1485,1042,1645,1098"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1StorageManager.html#ad207f2d607f78db439621dd82a4b9470" title="Special method called only from recovery manager. " alt="" coords="958,1105,1123,1161"/>
<area shape="rect" id="node41" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a5fe3533ff092920e41ddc56ebcd4165c" title="Read pages to buffer_. " alt="" coords="683,1185,833,1241"/>
<area shape="rect" id="node43" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4c828d75840906244fd52c44a793232d" title="Read contiguous pages in one shot. " alt="" coords="666,1265,850,1307"/>
<area shape="rect" id="node42" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a87975eab41db6a99b88424bd2d6dbb90" title="Moves on to next bin. " alt="" coords="965,1185,1116,1241"/>
<area shape="rect" id="node44" href="classfoedus_1_1thread_1_1Thread.html#a1455488538dd235b4de2730693bfd718" title="Read contiguous pages in one shot. " alt="" coords="962,1265,1119,1307"/>
<area shape="rect" id="node48" href="classfoedus_1_1log_1_1Logger.html#a3b1d647f1458d1172a511b7e57a2a237" title="foedus::log::Logger\l::initialize_once" alt="" coords="430,1323,562,1364"/>
<area shape="rect" id="node50" href="classfoedus_1_1fs_1_1DirectIoFile.html#ad2419b5b2a19b6307143876baffcc783" title="Memory slice version. " alt="" coords="421,1388,571,1429"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7ba190a64d26f1b5182bdc75ebe97e37"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::fs::DirectIoFile::is_read </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00174">174</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>

<p>Referenced by <a class="el" href="direct__io__file_8cpp_source.html#l00388">foedus::fs::operator&lt;&lt;()</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{ <span class="keywordflow">return</span> read_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a7ba190a64d26f1b5182bdc75ebe97e37_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a7ba190a64d26f1b5182bdc75ebe97e37_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a7ba190a64d26f1b5182bdc75ebe97e37_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a7ba190a64d26f1b5182bdc75ebe97e37_icgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1fs.html#accc36bb6a6995d99162f835fe186d2ef" title="foedus::fs::operator\&lt;\&lt;" alt="" coords="204,13,353,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aae86509a918643c3bd8eba937f6803fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::fs::DirectIoFile::is_write </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="direct__io__file_8hpp_source.html#l00175">175</a> of file <a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a>.</p>

<p>Referenced by <a class="el" href="direct__io__file_8cpp_source.html#l00388">foedus::fs::operator&lt;&lt;()</a>, and <a class="el" href="direct__io__file_8cpp_source.html#l00360">sync()</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;{ <span class="keywordflow">return</span> write_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_aae86509a918643c3bd8eba937f6803fb_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_aae86509a918643c3bd8eba937f6803fb_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_aae86509a918643c3bd8eba937f6803fb_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_aae86509a918643c3bd8eba937f6803fb_icgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1fs.html#accc36bb6a6995d99162f835fe186d2ef" title="foedus::fs::operator\&lt;\&lt;" alt="" coords="205,5,354,32"/>
<area shape="rect" id="node3" href="classfoedus_1_1fs_1_1DirectIoFile.html#a357db1ed5dbab29245011a2c79d12023" title="Analogues of POSIX fsync(). " alt="" coords="204,57,355,98"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaa3c1e50680d02783b61f5fe23f98b14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::fs::DirectIoFile::open </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>append</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>create</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tries to open the file for the specified volume. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">read</td><td>whether to allow read accesses on the opened file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">write</td><td>whether to allow write accesses on the opened file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">append</td><td>whether to set initial offset at the end of the file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">create</td><td>whether to create the file. if already exists, does nothing. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00055">55</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>References <a class="el" href="path_8hpp_source.html#l00064">foedus::fs::Path::c_str()</a>, <a class="el" href="filesystem_8cpp_source.html#l00089">foedus::fs::create_directories()</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00046">foedus::fs::DeviceEmulationOptions::disable_direct_io_</a>, <a class="el" href="filesystem_8hpp_source.html#l00128">foedus::fs::exists()</a>, <a class="el" href="filesystem_8cpp_source.html#l00120">foedus::fs::file_size()</a>, <a class="el" href="error__code_8hpp_source.html#l00126">foedus::kErrorCodeFsAlreadyOpened</a>, <a class="el" href="error__code_8hpp_source.html#l00127">foedus::kErrorCodeFsFailedToOpen</a>, <a class="el" href="error__code_8hpp_source.html#l00138">foedus::kErrorCodeFsMkdirFailed</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00055">kInvalidDescriptor</a>, <a class="el" href="assorted__func_8cpp_source.html#l00067">foedus::assorted::os_error()</a>, <a class="el" href="path_8cpp_source.html#l00055">foedus::fs::Path::parent_path()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00144">read()</a>, and <a class="el" href="direct__io__file_8cpp_source.html#l00216">write()</a>.</p>

<p>Referenced by <a class="el" href="meta__logger__impl_8cpp_source.html#l00036">foedus::log::MetaLogger::initialize_once()</a>, <a class="el" href="logger__impl_8cpp_source.html#l00074">foedus::log::Logger::initialize_once()</a>, <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00082">foedus::snapshot::SnapshotWriter::open()</a>, and <a class="el" href="externalizable_8cpp_source.html#l00096">foedus::externalize::Externalizable::save_to_file()</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                                                             {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">if</span> (descriptor_ != <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">kInvalidDescriptor</a>) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::open(): already opened. this=&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56aee9b4a7ef6471fd3b532021c61ff4826">kErrorCodeFsAlreadyOpened</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  Path folder(path_.<a class="code" href="classfoedus_1_1fs_1_1Path.html#a9859706102ecca097e723d762ec468ae">parent_path</a>());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="group__FILESYSTEM.html#ga4f8f53901e9c98fce72b6b3c52cf83a4">exists</a>(folder)) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group__FILESYSTEM.html#gaca1dd0a627c83ff76e30603ea67c4816">create_directories</a>(folder, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__FILESYSTEM.html#ga4f8f53901e9c98fce72b6b3c52cf83a4">exists</a>(folder)) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Interesting. other thread has created the folder:&quot;</span> &lt;&lt; folder;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::open(): failed to create parent folder: &quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          &lt;&lt; folder &lt;&lt; <span class="stringliteral">&quot;. err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56aebb349586ff80831796c84138fd32f68">kErrorCodeFsMkdirFailed</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::open(): opening: &quot;</span> &lt;&lt; path_ &lt;&lt; <span class="stringliteral">&quot;..  read =&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40">read</a> &lt;&lt; <span class="stringliteral">&quot; write=&quot;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    &lt;&lt; <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">write</a> &lt;&lt; <span class="stringliteral">&quot;, append=&quot;</span> &lt;&lt; append &lt;&lt; <span class="stringliteral">&quot;, create=&quot;</span> &lt;&lt; create;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">int</span> oflags = O_LARGEFILE;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">if</span> (!emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a9f2ec2ba101506a0eae393068cea6efa">disable_direct_io_</a>) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    oflags |= O_DIRECT;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40">read</a>) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">write</a>) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      oflags |= O_RDWR;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      oflags |= O_RDONLY;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">write</a>) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// oflags |= O_WRONLY;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    oflags |= O_RDWR;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (append) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    oflags |= O_APPEND;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">if</span> (create) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    oflags |= O_CREAT;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  mode_t permissions = S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP | S_IROTH;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  descriptor_ = <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aaa3c1e50680d02783b61f5fe23f98b14">::open</a>(path_.<a class="code" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f">c_str</a>(), oflags, permissions);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// tmpfs (such as /tmp, /dev/shm) refuses to receive O_DIRECT, returning EINVAL (22).</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// In that case, let&#39;s retry without O_DIRECT flag. MySQL does similar thing, too.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">if</span> (descriptor_ == <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">kInvalidDescriptor</a> &amp;&amp; (oflags &amp; O_DIRECT) == O_DIRECT &amp;&amp; errno == EINVAL) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    descriptor_ = <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aaa3c1e50680d02783b61f5fe23f98b14">::open</a>(path_.<a class="code" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f">c_str</a>(), oflags ^ O_DIRECT, permissions);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">if</span> (descriptor_ != <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">kInvalidDescriptor</a>) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="comment">// Okay, O_DIRECT was the cause. Just complain. go on.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::open(): O_DIRECT flag for &quot;</span> &lt;&lt; path_</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; was rejected and automatically removed. This usually means you specified&quot;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; tmpfs, such as /tmp, /dev/shm. Such non-durable devices should be used only&quot;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; for testing and performance experiments.&quot;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; Related URL: http://www.gossamer-threads.com/lists/linux/kernel/720702&quot;</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// else the normal error flow below.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span> (descriptor_ == <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">kInvalidDescriptor</a>) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::open(): failed to open: &quot;</span> &lt;&lt; path_</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;. err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56add88d630012b5dd08348fe2846275ebc">kErrorCodeFsFailedToOpen</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    read_ = <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40">read</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    write_ = <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">write</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    current_offset_ = 0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span> (append) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      current_offset_ = <a class="code" href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8">file_size</a>(path_);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::open(): successfully opened. &quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56aebb349586ff80831796c84138fd32f68"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56aebb349586ff80831796c84138fd32f68">foedus::kErrorCodeFsMkdirFailed</a></div><div class="ttdoc">0x020D : "FILESYS: Failed to create a directory" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00138">error_code.hpp:138</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56add88d630012b5dd08348fe2846275ebc"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56add88d630012b5dd08348fe2846275ebc">foedus::kErrorCodeFsFailedToOpen</a></div><div class="ttdoc">0x0202 : "FILESYS: Failed to open a file" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00127">error_code.hpp:127</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a9f19d10be82ac60706853e106a5de0e1"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">foedus::fs::DirectIoFile::write</a></div><div class="ttdeci">ErrorCode write(uint64_t desired_bytes, const foedus::memory::AlignedMemory &amp;buffer)</div><div class="ttdoc">Sequentially write the given amount of contents from the current position. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00216">direct_io_file.cpp:216</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_aaa3c1e50680d02783b61f5fe23f98b14"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#aaa3c1e50680d02783b61f5fe23f98b14">foedus::fs::DirectIoFile::open</a></div><div class="ttdeci">ErrorCode open(bool read, bool write, bool append, bool create)</div><div class="ttdoc">Tries to open the file for the specified volume. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00055">direct_io_file.cpp:55</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56aee9b4a7ef6471fd3b532021c61ff4826"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56aee9b4a7ef6471fd3b532021c61ff4826">foedus::kErrorCodeFsAlreadyOpened</a></div><div class="ttdoc">0x0201 : "FILESYS: Already opened" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00126">error_code.hpp:126</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__FILESYSTEM_html_gaca1dd0a627c83ff76e30603ea67c4816"><div class="ttname"><a href="group__FILESYSTEM.html#gaca1dd0a627c83ff76e30603ea67c4816">foedus::fs::create_directories</a></div><div class="ttdeci">bool create_directories(const Path &amp;p, bool sync=false)</div><div class="ttdoc">Recursive mkdir (mkdirs). </div><div class="ttdef"><b>Definition:</b> <a href="filesystem_8cpp_source.html#l00089">filesystem.cpp:89</a></div></div>
<div class="ttc" id="group__FILESYSTEM_html_ga4f8f53901e9c98fce72b6b3c52cf83a4"><div class="ttname"><a href="group__FILESYSTEM.html#ga4f8f53901e9c98fce72b6b3c52cf83a4">foedus::fs::exists</a></div><div class="ttdeci">bool exists(const Path &amp;p)</div><div class="ttdoc">Returns if the file exists. </div><div class="ttdef"><b>Definition:</b> <a href="filesystem_8hpp_source.html#l00128">filesystem.hpp:128</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a1c6bff6aafc955fd4c2a8e11e7f41f40"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40">foedus::fs::DirectIoFile::read</a></div><div class="ttdeci">ErrorCode read(uint64_t desired_bytes, foedus::memory::AlignedMemory *buffer)</div><div class="ttdoc">Sequentially read the given amount of contents from the current position. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00144">direct_io_file.cpp:144</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1Path_html_a9859706102ecca097e723d762ec468ae"><div class="ttname"><a href="classfoedus_1_1fs_1_1Path.html#a9859706102ecca097e723d762ec468ae">foedus::fs::Path::parent_path</a></div><div class="ttdeci">Path parent_path() const </div><div class="ttdef"><b>Definition:</b> <a href="path_8cpp_source.html#l00055">path.cpp:55</a></div></div>
<div class="ttc" id="group__FILESYSTEM_html_ga1048a33bafe4dcea89991112ae2660d8"><div class="ttname"><a href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8">foedus::fs::file_size</a></div><div class="ttdeci">uint64_t file_size(const Path &amp;p)</div><div class="ttdoc">Returns size of the file. </div><div class="ttdef"><b>Definition:</b> <a href="filesystem_8cpp_source.html#l00120">filesystem.cpp:120</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1Path_html_a821cee2f2cec808d90e187513064f40f"><div class="ttname"><a href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f">foedus::fs::Path::c_str</a></div><div class="ttdeci">const char * c_str() const </div><div class="ttdef"><b>Definition:</b> <a href="path_8hpp_source.html#l00064">path.hpp:64</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaaa260096daf8620266c2799d1f5a0270"><div class="ttname"><a href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">foedus::assorted::os_error</a></div><div class="ttdeci">std::string os_error()</div><div class="ttdoc">Thread-safe strerror(errno). </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8cpp_source.html#l00067">assorted_func.cpp:67</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#aa410f6dd215b5f28e131ae7f77e326d1a70baec601b55037a417bdd9211b5bdd6">foedus::fs::DirectIoFile::kInvalidDescriptor</a></div><div class="ttdoc">POSIX open() semantics says -1 is invalid or not-yet-opened. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00055">direct_io_file.hpp:55</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a9f2ec2ba101506a0eae393068cea6efa"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a9f2ec2ba101506a0eae393068cea6efa">foedus::fs::DeviceEmulationOptions::disable_direct_io_</a></div><div class="ttdeci">bool disable_direct_io_</div><div class="ttdoc">[Experiments] Whether to disable Direct I/O and use non-direct I/O instead. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00046">device_emulation_options.hpp:46</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_aaa3c1e50680d02783b61f5fe23f98b14_cgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_aaa3c1e50680d02783b61f5fe23f98b14_cgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_aaa3c1e50680d02783b61f5fe23f98b14_cgraph" id="classfoedus_1_1fs_1_1DirectIoFile_aaa3c1e50680d02783b61f5fe23f98b14_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="1235,188,1385,215"/>
<area shape="rect" id="node3" href="group__FILESYSTEM.html#gaca1dd0a627c83ff76e30603ea67c4816" title="Recursive mkdir (mkdirs). " alt="" coords="218,286,341,327"/>
<area shape="rect" id="node9" href="classfoedus_1_1fs_1_1Path.html#a9859706102ecca097e723d762ec468ae" title="foedus::fs::Path::parent_path" alt="" coords="801,407,991,433"/>
<area shape="rect" id="node12" href="group__FILESYSTEM.html#ga4f8f53901e9c98fce72b6b3c52cf83a4" title="Returns if the file exists. " alt="" coords="421,184,542,211"/>
<area shape="rect" id="node14" href="group__FILESYSTEM.html#ga1048a33bafe4dcea89991112ae2660d8" title="Returns size of the file. " alt="" coords="614,24,747,51"/>
<area shape="rect" id="node15" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="209,429,349,470"/>
<area shape="rect" id="node16" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="204,494,355,535"/>
<area shape="rect" id="node17" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1" title="Sequentially write the given amount of contents from the current position. " alt="" coords="204,559,355,601"/>
<area shape="rect" id="node4" href="group__FILESYSTEM.html#ga5cf40c936f78178ef58af0a900031b8b" title="mkdir. " alt="" coords="420,286,543,327"/>
<area shape="rect" id="node11" href="classfoedus_1_1fs_1_1Path.html#a4efe9caad4e61d844b04a90a4c43b3cb" title="foedus::fs::Path::empty" alt="" coords="403,235,560,261"/>
<area shape="rect" id="node5" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e" title="Makes the content and metadata of the file durable all the way up to devices. " alt="" coords="622,299,739,325"/>
<area shape="rect" id="node6" href="group__FILESYSTEM.html#ga87c90d834f65aad6f7b6540ae226f305" title="Returns if the file is a directory. " alt="" coords="819,297,973,324"/>
<area shape="rect" id="node7" href="structfoedus_1_1fs_1_1FileStatus.html#a7b8858f191dee3d9a92cae0cd759c1e5" title="foedus::fs::FileStatus\l::is_directory" alt="" coords="1040,290,1185,331"/>
<area shape="rect" id="node8" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="1051,188,1174,215"/>
<area shape="rect" id="node10" href="classfoedus_1_1fs_1_1Path.html#a95efbd1ef2b5f97560bdc964ab0b00ed" title="foedus::fs::Path::Path" alt="" coords="1039,407,1187,433"/>
<area shape="rect" id="node13" href="structfoedus_1_1fs_1_1FileStatus.html#ac4ab24d4308aab673c8d1606a84367e5" title="foedus::fs::FileStatus\l::exists" alt="" coords="608,126,753,167"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_aaa3c1e50680d02783b61f5fe23f98b14_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_aaa3c1e50680d02783b61f5fe23f98b14_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_aaa3c1e50680d02783b61f5fe23f98b14_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_aaa3c1e50680d02783b61f5fe23f98b14_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1MetaLogger.html#a5a3484d094947ced0a08a5e162f08a88" title="foedus::log::MetaLogger\l::initialize_once" alt="" coords="215,5,377,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1log_1_1Logger.html#a3b1d647f1458d1172a511b7e57a2a237" title="foedus::log::Logger\l::initialize_once" alt="" coords="230,71,362,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a7d71f940f088efa51d0b5769d4fdd31f" title="Open the file so that the writer can start writing. " alt="" coords="204,136,388,177"/>
<area shape="rect" id="node5" href="structfoedus_1_1externalize_1_1Externalizable.html#af4e4989a732573c1bbd538a3fbfad930" title="Atomically and durably writes out this object to the specified XML file. " alt="" coords="223,202,369,258"/>
<area shape="rect" id="node6" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#ad75cdea74e547a1f66d62b85a938a2cd" title="foedus::savepoint::\lSavepointManagerPimpl\l::initialize_once" alt="" coords="693,170,854,226"/>
<area shape="rect" id="node7" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#ae5e8a2671c819fc0ada038b3fa47105a" title="foedus::savepoint::\lSavepointManagerPimpl\l::savepoint_main" alt="" coords="447,202,609,258"/>
<area shape="rect" id="node8" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a4ae6b016213cb70bb6e5df636b24d129" title="Sub&#45;routine of handle_snapshot_triggered(). " alt="" coords="436,282,620,338"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a905ccf76fe0e076980dc1965f038fe10" title="handle_snapshot() calls this when it should start snapshotting. " alt="" coords="668,282,879,338"/>
<area shape="rect" id="node10" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="955,256,1109,297"/>
<area shape="rect" id="node12" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a64e3c7594b7d7d0d5f8a144bd802d910" title="Main routine for snapshot_thread_ in master engine. " alt="" coords="927,321,1137,363"/>
<area shape="rect" id="node11" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a868dca9015af77e04202ead68fd7a136" title="foedus::restart::Restart\lManagerPimpl::initialize_once" alt="" coords="1185,256,1380,297"/>
<area shape="rect" id="node13" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a632a4da7b3c67dd687f7eba4f6ec1d76" title="foedus::snapshot::Snapshot\lManagerPimpl::initialize_once" alt="" coords="1185,321,1380,363"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a27497da49f8afb11369f7d2b05780ec0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html">DirectIoFile</a>&amp; foedus::fs::DirectIoFile::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html">DirectIoFile</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1c6bff6aafc955fd4c2a8e11e7f41f40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::fs::DirectIoFile::read </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>desired_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">foedus::memory::AlignedMemory</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sequentially read the given amount of contents from the current position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">desired_bytes</td><td>Number of bytes to read. If we can't read this many bytes, we return errors. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buffer</td><td>Memory to copy into. As this is Direct-IO, it must be aligned. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. ">is_opened()</a> </dd>
<dd>
buffer.get_size() &gt;= desired_bytes </dd>
<dd>
(buffer-&gt;get_alignment() &amp; 0xFFF) == 0 (4kb alignment) </dd></dl>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00144">144</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>Referenced by <a class="el" href="direct__io__file_8cpp_source.html#l00055">open()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00162">read_raw()</a>, and <a class="el" href="log__buffer_8cpp_source.html#l00082">foedus::snapshot::DumpFileSortedBuffer::wind()</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                                                                 {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40">read</a>(desired_bytes, memory::AlignedMemorySlice(buffer));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a1c6bff6aafc955fd4c2a8e11e7f41f40"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40">foedus::fs::DirectIoFile::read</a></div><div class="ttdeci">ErrorCode read(uint64_t desired_bytes, foedus::memory::AlignedMemory *buffer)</div><div class="ttdoc">Sequentially read the given amount of contents from the current position. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00144">direct_io_file.cpp:144</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a1c6bff6aafc955fd4c2a8e11e7f41f40_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a1c6bff6aafc955fd4c2a8e11e7f41f40_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a1c6bff6aafc955fd4c2a8e11e7f41f40_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a1c6bff6aafc955fd4c2a8e11e7f41f40_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1fs_1_1DirectIoFile.html#aaa3c1e50680d02783b61f5fe23f98b14" title="Tries to open the file for the specified volume. " alt="" coords="221,144,371,185"/>
<area shape="rect" id="node13" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="221,900,371,941"/>
<area shape="rect" id="node50" href="classfoedus_1_1snapshot_1_1DumpFileSortedBuffer.html#a22900418b253b1a5164b63eacd15d654" title="Loads next data block to be consumed by the caller (composer). " alt="" coords="204,965,388,1007"/>
<area shape="rect" id="node3" href="classfoedus_1_1log_1_1MetaLogger.html#a5a3484d094947ced0a08a5e162f08a88" title="foedus::log::MetaLogger\l::initialize_once" alt="" coords="449,217,610,259"/>
<area shape="rect" id="node4" href="classfoedus_1_1log_1_1Logger.html#a3b1d647f1458d1172a511b7e57a2a237" title="foedus::log::Logger\l::initialize_once" alt="" coords="463,5,595,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a7d71f940f088efa51d0b5769d4fdd31f" title="Open the file so that the writer can start writing. " alt="" coords="437,71,621,112"/>
<area shape="rect" id="node6" href="structfoedus_1_1externalize_1_1Externalizable.html#af4e4989a732573c1bbd538a3fbfad930" title="Atomically and durably writes out this object to the specified XML file. " alt="" coords="456,137,603,193"/>
<area shape="rect" id="node7" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#ad75cdea74e547a1f66d62b85a938a2cd" title="foedus::savepoint::\lSavepointManagerPimpl\l::initialize_once" alt="" coords="993,63,1155,119"/>
<area shape="rect" id="node8" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#ae5e8a2671c819fc0ada038b3fa47105a" title="foedus::savepoint::\lSavepointManagerPimpl\l::savepoint_main" alt="" coords="711,38,872,94"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a4ae6b016213cb70bb6e5df636b24d129" title="Sub&#45;routine of handle_snapshot_triggered(). " alt="" coords="699,169,883,225"/>
<area shape="rect" id="node10" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a905ccf76fe0e076980dc1965f038fe10" title="handle_snapshot() calls this when it should start snapshotting. " alt="" coords="969,155,1179,211"/>
<area shape="rect" id="node11" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="1264,236,1419,277"/>
<area shape="rect" id="node12" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a64e3c7594b7d7d0d5f8a144bd802d910" title="Main routine for snapshot_thread_ in master engine. " alt="" coords="1236,163,1447,204"/>
<area shape="rect" id="node14" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="436,932,623,973"/>
<area shape="rect" id="node44" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#aae67209f9aa9d03e45a9934067c8245b" title="Read contiguous pages in one shot. " alt="" coords="436,1381,623,1423"/>
<area shape="rect" id="node49" href="classfoedus_1_1fs_1_1DirectIoFile.html#a16f9c1053d076007620b4d1c4dfec9bf" title="Memory slice version. " alt="" coords="454,867,605,908"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#a2c812e46a7502abe6f506ecda0edf9ab" title="foedus::storage::array\l::ArrayComposer::construct_root" alt="" coords="686,964,897,1005"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#ac5ad2e7fa792d58965a05be6bd43e43c" title="foedus::storage::hash\l::HashComposer::construct_root" alt="" coords="686,1029,897,1071"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a91db842a6ef8780d3fe4ba2f0f625da7" title="foedus::storage::sequential\l::SequentialComposer::construct_root" alt="" coords="671,1095,912,1136"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread_follow" alt="" coords="688,1175,895,1231"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePartitioner.html#a1aedc45cc5621bd3889f1bf2d47ab79c" title="foedus::storage::masstree\l::MasstreePartitioner::\ldesign_partition" alt="" coords="705,1285,878,1341"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#a32fb943620383e597308852094ba4ac3" title="foedus::storage::hash\l::TmpSnashotPage::init" alt="" coords="712,413,871,455"/>
<area shape="rect" id="node30" href="classfoedus_1_1memory_1_1EngineMemory.html#a3c3c8902b7000d09878a5a2085f6058c" title="Another convenience method that also reads an existing snapshot page to the volatile page..." alt="" coords="686,596,897,637"/>
<area shape="rect" id="node34" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="690,767,893,823"/>
<area shape="rect" id="node37" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="699,899,883,940"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1StorageManagerPimpl.html#ad5f949c2d00aea4cb2186c93108b7dcc" title="Special method called only from recovery manager. " alt="" coords="706,285,877,341"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c" title="Construct root page(s) for one storage based on the ouputs of compose(). " alt="" coords="985,1075,1163,1116"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a41e664c7035f1b89121ef06678a71386" title="These are defined in masstree_storage_debug.cpp. " alt="" coords="987,1141,1161,1197"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread\l_recurse" alt="" coords="987,1221,1161,1292"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a9d2f5eb65777d851bee6809acf6fe153" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="1246,1141,1437,1197"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1Partitioner.html#a31a7e393bf1f87a9a039c60b291ac9d1" title="Determines partitioning scheme for this storage. " alt="" coords="985,1316,1163,1357"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae68923a3afe20ce445002b85764a9f17" title="These are defined in hash_storage_debug.cpp. " alt="" coords="1495,399,1693,455"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_intermediate" alt="" coords="1242,366,1441,422"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa220f1f2d268290263483476d85be47b" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_data" alt="" coords="975,315,1173,371"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a144b7a6f95482f2ab8f8564776689fb9" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="1741,399,1908,455"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a577ab7f32ca2b4d48a7fa174263de47d" title="foedus::storage::array\l::ArrayStoragePimpl::load" alt="" coords="989,497,1159,539"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a44bc6cd5427daadbee9fd6fcc366af09" title="foedus::storage::hash\l::HashStoragePimpl::load" alt="" coords="989,563,1159,604"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a8d4ac5a88e7ce112f83b67597719fa82" title="foedus::storage::masstree\l::MasstreeStoragePimpl::load" alt="" coords="977,628,1171,669"/>
<area shape="rect" id="node35" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="960,775,1188,816"/>
<area shape="rect" id="node36" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="973,694,1175,750"/>
<area shape="rect" id="node38" href="classfoedus_1_1thread_1_1Thread.html#a29e87db0559d67ac9a942e345e3a2ea2" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="992,840,1156,881"/>
<area shape="rect" id="node39" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1237,920,1446,961"/>
<area shape="rect" id="node40" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a98de2aa47bebca5add3e0550f2c602bf" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="1249,998,1433,1054"/>
<area shape="rect" id="node41" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="982,957,1166,999"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1StorageManager.html#ad207f2d607f78db439621dd82a4b9470" title="Special method called only from recovery manager. " alt="" coords="991,235,1157,291"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a5fe3533ff092920e41ddc56ebcd4165c" title="Read pages to buffer_. " alt="" coords="716,1447,867,1503"/>
<area shape="rect" id="node47" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4c828d75840906244fd52c44a793232d" title="Read contiguous pages in one shot. " alt="" coords="699,1381,883,1423"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a87975eab41db6a99b88424bd2d6dbb90" title="Moves on to next bin. " alt="" coords="999,1447,1149,1503"/>
<area shape="rect" id="node48" href="classfoedus_1_1thread_1_1Thread.html#a1455488538dd235b4de2730693bfd718" title="Read contiguous pages in one shot. " alt="" coords="995,1381,1153,1423"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a16f9c1053d076007620b4d1c4dfec9bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::fs::DirectIoFile::read </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>desired_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1memory_1_1AlignedMemorySlice.html">foedus::memory::AlignedMemorySlice</a> &amp;&#160;</td>
          <td class="paramname"><em>slice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Memory slice version. </p>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00147">147</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00242">foedus::memory::AlignedMemorySlice::count_</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00174">foedus::memory::AlignedMemory::get_alignment()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00235">foedus::memory::AlignedMemorySlice::get_block()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00037">foedus::fs::is_odirect_aligned()</a>, <a class="el" href="error__code_8hpp_source.html#l00131">foedus::kErrorCodeFsBufferNotAligned</a>, <a class="el" href="error__code_8hpp_source.html#l00130">foedus::kErrorCodeFsBufferTooSmall</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00238">foedus::memory::AlignedMemorySlice::memory_</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00049">foedus::fs::DeviceEmulationOptions::null_device_</a>, and <a class="el" href="direct__io__file_8cpp_source.html#l00162">read_raw()</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                                                                            {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">null_device_</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">if</span> (desired_bytes &gt; buffer.count_) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::read(): too small buffer is given. desired_bytes=&quot;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      &lt;&lt; desired_bytes &lt;&lt; <span class="stringliteral">&quot;, buffer=&quot;</span> &lt;&lt; buffer;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae2286d0c73a59867229ffc9b1b8c42f3">kErrorCodeFsBufferTooSmall</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(buffer.memory_-&gt;get_alignment())</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      || !<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(buffer.get_block())</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      || !<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(desired_bytes)) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::read(): non-aligned input is given. buffer=&quot;</span> &lt;&lt; buffer</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;, desired_bytes=&quot;</span> &lt;&lt; desired_bytes;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31">kErrorCodeFsBufferNotAligned</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4">read_raw</a>(desired_bytes, buffer.get_block());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a5353bbb3b2a815d6c858c8190edeccf4"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4">foedus::fs::DirectIoFile::read_raw</a></div><div class="ttdeci">ErrorCode read_raw(uint64_t desired_bytes, void *buffer)</div><div class="ttdoc">A version that receives a raw pointer that has to be aligned (be careful to use this ver)...</div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00162">direct_io_file.cpp:162</a></div></div>
<div class="ttc" id="namespacefoedus_1_1fs_html_a1a3ea81bf627928d9a5f154986af9c48"><div class="ttname"><a href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">foedus::fs::is_odirect_aligned</a></div><div class="ttdeci">bool is_odirect_aligned(uint64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00037">direct_io_file.cpp:37</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31">foedus::kErrorCodeFsBufferNotAligned</a></div><div class="ttdoc">0x0206 : "FILESYS: file buffer is not aligned" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00131">error_code.hpp:131</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a965362432b72417b499d4dcfabc94505"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">foedus::fs::DeviceEmulationOptions::null_device_</a></div><div class="ttdeci">bool null_device_</div><div class="ttdoc">[Experiments] as if we write out to /dev/null. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00049">device_emulation_options.hpp:49</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ae2286d0c73a59867229ffc9b1b8c42f3"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae2286d0c73a59867229ffc9b1b8c42f3">foedus::kErrorCodeFsBufferTooSmall</a></div><div class="ttdoc">0x0205 : "FILESYS: file buffer is too small" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00130">error_code.hpp:130</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a16f9c1053d076007620b4d1c4dfec9bf_cgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a16f9c1053d076007620b4d1c4dfec9bf_cgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a16f9c1053d076007620b4d1c4dfec9bf_cgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a16f9c1053d076007620b4d1c4dfec9bf_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#a781e5fea7e2fa128936ed3321b7312a4" title="Returns the alignment of the memory block. " alt="" coords="204,5,417,47"/>
<area shape="rect" id="node3" href="structfoedus_1_1memory_1_1AlignedMemorySlice.html#ae3127a9ce40b34e15bc7257ddd332365" title="foedus::memory::AlignedMemory\lSlice::get_block" alt="" coords="204,71,417,112"/>
<area shape="rect" id="node5" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="501,129,643,171"/>
<area shape="rect" id="node6" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="235,228,386,269"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="465,64,679,105"/>
<area shape="rect" id="node7" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="497,195,647,236"/>
<area shape="rect" id="node8" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="497,260,647,301"/>
<area shape="rect" id="node9" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="502,325,642,367"/>
<area shape="rect" id="node10" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="505,391,639,432"/>
<area shape="rect" id="node11" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="727,391,861,432"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5353bbb3b2a815d6c858c8190edeccf4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::fs::DirectIoFile::read_raw </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>desired_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A version that receives a raw pointer that has to be aligned (be careful to use this ver). </p>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00162">162</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00046">foedus::fs::DeviceEmulationOptions::disable_direct_io_</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00058">foedus::fs::DeviceEmulationOptions::emulated_read_kb_cycles_</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00037">foedus::fs::is_odirect_aligned()</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00095">is_opened()</a>, <a class="el" href="error__code_8hpp_source.html#l00133">foedus::kErrorCodeFsExcessRead</a>, <a class="el" href="error__code_8hpp_source.html#l00136">foedus::kErrorCodeFsNotOpened</a>, <a class="el" href="error__code_8hpp_source.html#l00140">foedus::kErrorCodeFsResultNotAligned</a>, <a class="el" href="error__code_8hpp_source.html#l00132">foedus::kErrorCodeFsTooShortRead</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00049">foedus::fs::DeviceEmulationOptions::null_device_</a>, <a class="el" href="assorted__func_8cpp_source.html#l00067">foedus::assorted::os_error()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00144">read()</a>, and <a class="el" href="rdtsc_8hpp_source.html#l00060">foedus::debugging::wait_rdtsc_cycles()</a>.</p>

<p>Referenced by <a class="el" href="direct__io__file_8cpp_source.html#l00147">read()</a>, <a class="el" href="snapshot__file__set_8cpp_source.html#l00095">foedus::cache::SnapshotFileSet::read_page()</a>, and <a class="el" href="snapshot__file__set_8cpp_source.html#l00107">foedus::cache::SnapshotFileSet::read_pages()</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                                                      {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">null_device_</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00">is_opened</a>()) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;File not opened yet, or closed. this=&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9">kErrorCodeFsNotOpened</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (desired_bytes == 0) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">// underlying POSIX filesystem might split the read for severel reasons. so, while loop.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  uint64_t total_read = 0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  uint64_t remaining = desired_bytes;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">while</span> (remaining &gt; 0) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">char</span>* position = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(buffer) + total_read;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(position));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    ssize_t read_bytes = <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40">::read</a>(descriptor_, position, remaining);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (read_bytes &lt;= 0) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="comment">// zero means end of file (unexpected). negative value means error.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::read(): error. this=&quot;</span> &lt;&lt; *<span class="keyword">this</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, total_read=&quot;</span> &lt;&lt; total_read &lt;&lt; <span class="stringliteral">&quot;, desired_bytes=&quot;</span> &lt;&lt; desired_bytes</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, remaining=&quot;</span> &lt;&lt; remaining &lt;&lt; <span class="stringliteral">&quot;, read_bytes=&quot;</span> &lt;&lt; read_bytes</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a34cde65d4ab13bb3bd5f7db34bcda235">kErrorCodeFsTooShortRead</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (static_cast&lt;uint64_t&gt;(read_bytes) &gt; remaining) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::read(): wtf? this=&quot;</span> &lt;&lt; *<span class="keyword">this</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, total_read=&quot;</span> &lt;&lt; total_read &lt;&lt; <span class="stringliteral">&quot;, desired_bytes=&quot;</span> &lt;&lt; desired_bytes</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, remaining=&quot;</span> &lt;&lt; remaining &lt;&lt; <span class="stringliteral">&quot;, read_bytes=&quot;</span> &lt;&lt; read_bytes</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a0bae50178c88ea87c6d5f468d2290562">kErrorCodeFsExcessRead</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a9f2ec2ba101506a0eae393068cea6efa">disable_direct_io_</a> &amp;&amp; !<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(read_bytes)) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::read(): wtf2? this=&quot;</span> &lt;&lt; *<span class="keyword">this</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, total_read=&quot;</span> &lt;&lt; total_read &lt;&lt; <span class="stringliteral">&quot;, desired_bytes=&quot;</span> &lt;&lt; desired_bytes</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, remaining=&quot;</span> &lt;&lt; remaining &lt;&lt; <span class="stringliteral">&quot;, read_bytes=&quot;</span> &lt;&lt; read_bytes</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afb3f2cfc8f5e3fda3256a103937808bd">kErrorCodeFsResultNotAligned</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    total_read += read_bytes;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    remaining -= read_bytes;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    current_offset_ += read_bytes;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span> (remaining &gt; 0) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Interesting. POSIX read() didn&#39;t complete the reads in one call.&quot;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; total_read=&quot;</span> &lt;&lt; total_read &lt;&lt; <span class="stringliteral">&quot;, desired_bytes=&quot;</span> &lt;&lt; desired_bytes</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, remaining=&quot;</span> &lt;&lt; remaining;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">if</span> (emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#aa383913249e3ec5a1c07e27800af83b6">emulated_read_kb_cycles_</a> &gt; 0) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620">debugging::wait_rdtsc_cycles</a>(emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#aa383913249e3ec5a1c07e27800af83b6">emulated_read_kb_cycles_</a> * (desired_bytes &gt;&gt; 10));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afb3f2cfc8f5e3fda3256a103937808bd"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afb3f2cfc8f5e3fda3256a103937808bd">foedus::kErrorCodeFsResultNotAligned</a></div><div class="ttdoc">0x020F : "FILESYS: Direct I/O operation resulted in non-aligned count of bytes. Filesyste bug...</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00140">error_code.hpp:140</a></div></div>
<div class="ttc" id="group__DEBUGGING_html_gac7eac15b41b0fab4e689f62d147ce620"><div class="ttname"><a href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620">foedus::debugging::wait_rdtsc_cycles</a></div><div class="ttdeci">void wait_rdtsc_cycles(uint64_t cycles)</div><div class="ttdoc">Wait until the given CPU cycles elapse. </div><div class="ttdef"><b>Definition:</b> <a href="rdtsc_8hpp_source.html#l00060">rdtsc.hpp:60</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a1d89a9c761a388f13f9b59490b6caa00"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00">foedus::fs::DirectIoFile::is_opened</a></div><div class="ttdeci">bool is_opened() const </div><div class="ttdoc">Whether the file is already and successfully opened. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00095">direct_io_file.hpp:95</a></div></div>
<div class="ttc" id="namespacefoedus_1_1fs_html_a1a3ea81bf627928d9a5f154986af9c48"><div class="ttname"><a href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">foedus::fs::is_odirect_aligned</a></div><div class="ttdeci">bool is_odirect_aligned(uint64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00037">direct_io_file.cpp:37</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a1c6bff6aafc955fd4c2a8e11e7f41f40"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40">foedus::fs::DirectIoFile::read</a></div><div class="ttdeci">ErrorCode read(uint64_t desired_bytes, foedus::memory::AlignedMemory *buffer)</div><div class="ttdoc">Sequentially read the given amount of contents from the current position. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00144">direct_io_file.cpp:144</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a34cde65d4ab13bb3bd5f7db34bcda235"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a34cde65d4ab13bb3bd5f7db34bcda235">foedus::kErrorCodeFsTooShortRead</a></div><div class="ttdoc">0x0207 : "FILESYS: reached end of file before completing reads" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00132">error_code.hpp:132</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaaa260096daf8620266c2799d1f5a0270"><div class="ttname"><a href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">foedus::assorted::os_error</a></div><div class="ttdeci">std::string os_error()</div><div class="ttdoc">Thread-safe strerror(errno). </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8cpp_source.html#l00067">assorted_func.cpp:67</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a0bae50178c88ea87c6d5f468d2290562"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a0bae50178c88ea87c6d5f468d2290562">foedus::kErrorCodeFsExcessRead</a></div><div class="ttdoc">0x0208 : "FILESYS: read more than expected" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00133">error_code.hpp:133</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9">foedus::kErrorCodeFsNotOpened</a></div><div class="ttdoc">0x020B : "FILESYS: File not opened yet or failed to open." . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00136">error_code.hpp:136</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a965362432b72417b499d4dcfabc94505"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">foedus::fs::DeviceEmulationOptions::null_device_</a></div><div class="ttdeci">bool null_device_</div><div class="ttdoc">[Experiments] as if we write out to /dev/null. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00049">device_emulation_options.hpp:49</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_aa383913249e3ec5a1c07e27800af83b6"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#aa383913249e3ec5a1c07e27800af83b6">foedus::fs::DeviceEmulationOptions::emulated_read_kb_cycles_</a></div><div class="ttdeci">uint32_t emulated_read_kb_cycles_</div><div class="ttdoc">[Experiments] additional CPU cycles to busy-wait for each 1KB read. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00058">device_emulation_options.hpp:58</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a9f2ec2ba101506a0eae393068cea6efa"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a9f2ec2ba101506a0eae393068cea6efa">foedus::fs::DeviceEmulationOptions::disable_direct_io_</a></div><div class="ttdeci">bool disable_direct_io_</div><div class="ttdoc">[Experiments] Whether to disable Direct I/O and use non-direct I/O instead. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00046">device_emulation_options.hpp:46</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a5353bbb3b2a815d6c858c8190edeccf4_cgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a5353bbb3b2a815d6c858c8190edeccf4_cgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a5353bbb3b2a815d6c858c8190edeccf4_cgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a5353bbb3b2a815d6c858c8190edeccf4_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="208,5,351,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="204,71,355,112"/>
<area shape="rect" id="node4" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="209,136,349,177"/>
<area shape="rect" id="node5" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="204,201,355,243"/>
<area shape="rect" id="node6" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="212,267,347,308"/>
<area shape="rect" id="node7" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="403,267,537,308"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a5353bbb3b2a815d6c858c8190edeccf4_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a5353bbb3b2a815d6c858c8190edeccf4_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a5353bbb3b2a815d6c858c8190edeccf4_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a5353bbb3b2a815d6c858c8190edeccf4_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1fs_1_1DirectIoFile.html#a16f9c1053d076007620b4d1c4dfec9bf" title="Memory slice version. " alt="" coords="222,324,373,365"/>
<area shape="rect" id="node3" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="204,389,391,431"/>
<area shape="rect" id="node45" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#aae67209f9aa9d03e45a9934067c8245b" title="Read contiguous pages in one shot. " alt="" coords="204,1192,391,1233"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#a2c812e46a7502abe6f506ecda0edf9ab" title="foedus::storage::array\l::ArrayComposer::construct_root" alt="" coords="454,5,665,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#ac5ad2e7fa792d58965a05be6bd43e43c" title="foedus::storage::hash\l::HashComposer::construct_root" alt="" coords="454,71,665,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a91db842a6ef8780d3fe4ba2f0f625da7" title="foedus::storage::sequential\l::SequentialComposer::construct_root" alt="" coords="439,136,680,177"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread_follow" alt="" coords="456,202,663,258"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePartitioner.html#a1aedc45cc5621bd3889f1bf2d47ab79c" title="foedus::storage::masstree\l::MasstreePartitioner::\ldesign_partition" alt="" coords="473,299,646,355"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#a32fb943620383e597308852094ba4ac3" title="foedus::storage::hash\l::TmpSnashotPage::init" alt="" coords="480,389,639,431"/>
<area shape="rect" id="node19" href="classfoedus_1_1memory_1_1EngineMemory.html#a3c3c8902b7000d09878a5a2085f6058c" title="Another convenience method that also reads an existing snapshot page to the volatile page..." alt="" coords="454,560,665,601"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="458,717,661,773"/>
<area shape="rect" id="node29" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="467,929,651,971"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1StorageManagerPimpl.html#ad5f949c2d00aea4cb2186c93108b7dcc" title="Special method called only from recovery manager. " alt="" coords="474,1050,645,1106"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c" title="Construct root page(s) for one storage based on the ouputs of compose(). " alt="" coords="753,39,931,80"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a41e664c7035f1b89121ef06678a71386" title="These are defined in masstree_storage_debug.cpp. " alt="" coords="755,105,929,161"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread\l_recurse" alt="" coords="755,185,929,256"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a9d2f5eb65777d851bee6809acf6fe153" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="1013,105,1204,161"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1Partitioner.html#a31a7e393bf1f87a9a039c60b291ac9d1" title="Determines partitioning scheme for this storage. " alt="" coords="753,280,931,321"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae68923a3afe20ce445002b85764a9f17" title="These are defined in hash_storage_debug.cpp. " alt="" coords="1267,365,1465,421"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_intermediate" alt="" coords="1009,397,1208,453"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa220f1f2d268290263483476d85be47b" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_data" alt="" coords="743,447,941,503"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a144b7a6f95482f2ab8f8564776689fb9" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="1532,365,1699,421"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a577ab7f32ca2b4d48a7fa174263de47d" title="foedus::storage::array\l::ArrayStoragePimpl::load" alt="" coords="757,528,927,569"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a44bc6cd5427daadbee9fd6fcc366af09" title="foedus::storage::hash\l::HashStoragePimpl::load" alt="" coords="757,593,927,635"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a8d4ac5a88e7ce112f83b67597719fa82" title="foedus::storage::masstree\l::MasstreeStoragePimpl::load" alt="" coords="745,659,939,700"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#aa0f536b8252655076528b290abb84a87" title="foedus::storage::array\l::ArrayStorage::load" alt="" coords="1035,528,1183,569"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a200dd1b1b2b5bc937cae55120e1befc9" title="foedus::storage::hash\l::HashStorage::load" alt="" coords="1035,593,1182,635"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a2731aaf3a733c773a63df6d691ede3ac" title="foedus::storage::masstree\l::MasstreeStorage::load" alt="" coords="1022,659,1195,700"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="728,724,956,765"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="741,790,943,846"/>
<area shape="rect" id="node30" href="classfoedus_1_1thread_1_1Thread.html#a29e87db0559d67ac9a942e345e3a2ea2" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="760,871,924,912"/>
<area shape="rect" id="node31" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1004,929,1213,971"/>
<area shape="rect" id="node38" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a98de2aa47bebca5add3e0550f2c602bf" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="1017,1034,1201,1090"/>
<area shape="rect" id="node41" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="750,988,934,1029"/>
<area shape="rect" id="node32" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1261,845,1471,887"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="1274,917,1458,959"/>
<area shape="rect" id="node37" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1523,976,1707,1017"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af22fe9e661763ca3225eeedf7fa62879" title="foedus::storage::array\l::ArrayStoragePimpl::prefetch\l_pages_recurse" alt="" coords="1519,765,1712,821"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="1760,871,1973,912"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="1526,895,1705,951"/>
<area shape="rect" id="node39" href="classfoedus_1_1thread_1_1Thread.html#a878c3aa228a6e8925e21a3b7b0592349" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="1286,1034,1446,1090"/>
<area shape="rect" id="node40" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a89fe2af2a31e70a89e143cbc2d687ffb" title="Batched version of follow_page_pointer with will_modify==false. " alt="" coords="1274,1114,1458,1170"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1StorageManager.html#ad207f2d607f78db439621dd82a4b9470" title="Special method called only from recovery manager. " alt="" coords="759,1105,925,1161"/>
<area shape="rect" id="node44" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="1031,1115,1186,1156"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a5fe3533ff092920e41ddc56ebcd4165c" title="Read pages to buffer_. " alt="" coords="484,1185,635,1241"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4c828d75840906244fd52c44a793232d" title="Read contiguous pages in one shot. " alt="" coords="467,1265,651,1307"/>
<area shape="rect" id="node47" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a87975eab41db6a99b88424bd2d6dbb90" title="Moves on to next bin. " alt="" coords="767,1185,917,1241"/>
<area shape="rect" id="node48" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac3a65cebf835d18357a69bd523a3bc9d" title="Consumes inputs for the cur_path_[0] page and install snapshot pointers there. " alt="" coords="1007,1185,1210,1241"/>
<area shape="rect" id="node50" href="classfoedus_1_1thread_1_1Thread.html#a1455488538dd235b4de2730693bfd718" title="Read contiguous pages in one shot. " alt="" coords="763,1265,921,1307"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a35814dfec4dab81d5bb46e453f1993e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::fs::DirectIoFile::seek </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8d">SeekType</a>&#160;</td>
          <td class="paramname"><em>seek_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the position of the next byte to be written/extracted from/to the stream. </p>
<dl class="section pre"><dt>Precondition</dt><dd><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. ">is_opened()</a> </dd></dl>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00326">326</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>References <a class="el" href="device__emulation__options_8hpp_source.html#l00052">foedus::fs::DeviceEmulationOptions::emulated_seek_latency_cycles_</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00037">foedus::fs::is_odirect_aligned()</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00063">kDirectIoSeekCur</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00065">kDirectIoSeekEnd</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00061">kDirectIoSeekSet</a>, <a class="el" href="error__code_8hpp_source.html#l00128">foedus::kErrorCodeFsBadSeekInput</a>, <a class="el" href="error__code_8hpp_source.html#l00131">foedus::kErrorCodeFsBufferNotAligned</a>, <a class="el" href="error__code_8hpp_source.html#l00129">foedus::kErrorCodeFsSeekFailed</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00049">foedus::fs::DeviceEmulationOptions::null_device_</a>, <a class="el" href="assorted__func_8cpp_source.html#l00067">foedus::assorted::os_error()</a>, and <a class="el" href="rdtsc_8hpp_source.html#l00060">foedus::debugging::wait_rdtsc_cycles()</a>.</p>

<p>Referenced by <a class="el" href="snapshot__file__set_8cpp_source.html#l00095">foedus::cache::SnapshotFileSet::read_page()</a>, and <a class="el" href="snapshot__file__set_8cpp_source.html#l00107">foedus::cache::SnapshotFileSet::read_pages()</a>.</p>
<div class="fragment"><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                                                 {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(offset)) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::seek(): non-aligned input is given. offset=&quot;</span> &lt;&lt; offset;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31">kErrorCodeFsBufferNotAligned</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">if</span> (emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">null_device_</a>) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  __off_t ret;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">switch</span> (seek_type) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84">kDirectIoSeekSet</a>:</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      ret = ::lseek(descriptor_, offset, SEEK_SET);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da24b881dc332947bf8f4b5d5a769bab93">kDirectIoSeekCur</a>:</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      ret = ::lseek(descriptor_, offset, SEEK_CUR);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da4768c64279d891c7d87fb4be4ed5409a">kDirectIoSeekEnd</a>:</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      ret = ::lseek(descriptor_, offset, SEEK_END);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::seek(): wtf?? seek_type=&quot;</span> &lt;&lt; seek_type;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ab7ed502da25361ca31b84715f084313f">kErrorCodeFsBadSeekInput</a>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::seek(): failed. this=&quot;</span> &lt;&lt; *<span class="keyword">this</span> &lt;&lt; <span class="stringliteral">&quot;,err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a343a8966f1ff602c891277b7af0c9ec6">kErrorCodeFsSeekFailed</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  current_offset_ = ret;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">if</span> (emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a2d2a52d5d36a6905b327c30b314bb95d">emulated_seek_latency_cycles_</a> &gt; 0) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620">debugging::wait_rdtsc_cycles</a>(emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a2d2a52d5d36a6905b327c30b314bb95d">emulated_seek_latency_cycles_</a>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a2f503633c8a49e8745f55ccba6002b8da24b881dc332947bf8f4b5d5a769bab93"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da24b881dc332947bf8f4b5d5a769bab93">foedus::fs::DirectIoFile::kDirectIoSeekCur</a></div><div class="ttdoc">The offset is set to its current location plus offset bytes. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00063">direct_io_file.hpp:63</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a2d2a52d5d36a6905b327c30b314bb95d"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a2d2a52d5d36a6905b327c30b314bb95d">foedus::fs::DeviceEmulationOptions::emulated_seek_latency_cycles_</a></div><div class="ttdeci">uint32_t emulated_seek_latency_cycles_</div><div class="ttdoc">[Experiments] additional CPU cycles to busy-wait for each seek. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00052">device_emulation_options.hpp:52</a></div></div>
<div class="ttc" id="group__DEBUGGING_html_gac7eac15b41b0fab4e689f62d147ce620"><div class="ttname"><a href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620">foedus::debugging::wait_rdtsc_cycles</a></div><div class="ttdeci">void wait_rdtsc_cycles(uint64_t cycles)</div><div class="ttdoc">Wait until the given CPU cycles elapse. </div><div class="ttdef"><b>Definition:</b> <a href="rdtsc_8hpp_source.html#l00060">rdtsc.hpp:60</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ab7ed502da25361ca31b84715f084313f"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ab7ed502da25361ca31b84715f084313f">foedus::kErrorCodeFsBadSeekInput</a></div><div class="ttdoc">0x0203 : "FILESYS: Invalid arguments for seek()" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00128">error_code.hpp:128</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a343a8966f1ff602c891277b7af0c9ec6"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a343a8966f1ff602c891277b7af0c9ec6">foedus::kErrorCodeFsSeekFailed</a></div><div class="ttdoc">0x0204 : "FILESYS: file seek failed" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00129">error_code.hpp:129</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a2f503633c8a49e8745f55ccba6002b8da4768c64279d891c7d87fb4be4ed5409a"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da4768c64279d891c7d87fb4be4ed5409a">foedus::fs::DirectIoFile::kDirectIoSeekEnd</a></div><div class="ttdoc">The offset is set to the size of the file plus offset bytes. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00065">direct_io_file.hpp:65</a></div></div>
<div class="ttc" id="namespacefoedus_1_1fs_html_a1a3ea81bf627928d9a5f154986af9c48"><div class="ttname"><a href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">foedus::fs::is_odirect_aligned</a></div><div class="ttdeci">bool is_odirect_aligned(uint64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00037">direct_io_file.cpp:37</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaaa260096daf8620266c2799d1f5a0270"><div class="ttname"><a href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">foedus::assorted::os_error</a></div><div class="ttdeci">std::string os_error()</div><div class="ttdoc">Thread-safe strerror(errno). </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8cpp_source.html#l00067">assorted_func.cpp:67</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31">foedus::kErrorCodeFsBufferNotAligned</a></div><div class="ttdoc">0x0206 : "FILESYS: file buffer is not aligned" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00131">error_code.hpp:131</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a965362432b72417b499d4dcfabc94505"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">foedus::fs::DeviceEmulationOptions::null_device_</a></div><div class="ttdeci">bool null_device_</div><div class="ttdoc">[Experiments] as if we write out to /dev/null. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00049">device_emulation_options.hpp:49</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a2f503633c8a49e8745f55ccba6002b8da9930fb0c0570c46c1456f17657df0b84">foedus::fs::DirectIoFile::kDirectIoSeekSet</a></div><div class="ttdoc">The offset is set to offset bytes. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00061">direct_io_file.hpp:61</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a35814dfec4dab81d5bb46e453f1993e6_cgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a35814dfec4dab81d5bb46e453f1993e6_cgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a35814dfec4dab81d5bb46e453f1993e6_cgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a35814dfec4dab81d5bb46e453f1993e6_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="204,5,347,47"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="205,71,345,112"/>
<area shape="rect" id="node4" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="208,136,343,177"/>
<area shape="rect" id="node5" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="395,136,529,177"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a35814dfec4dab81d5bb46e453f1993e6_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a35814dfec4dab81d5bb46e453f1993e6_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a35814dfec4dab81d5bb46e453f1993e6_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a35814dfec4dab81d5bb46e453f1993e6_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="204,389,391,431"/>
<area shape="rect" id="node45" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#aae67209f9aa9d03e45a9934067c8245b" title="Read contiguous pages in one shot. " alt="" coords="204,1192,391,1233"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#a2c812e46a7502abe6f506ecda0edf9ab" title="foedus::storage::array\l::ArrayComposer::construct_root" alt="" coords="454,5,665,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#ac5ad2e7fa792d58965a05be6bd43e43c" title="foedus::storage::hash\l::HashComposer::construct_root" alt="" coords="454,71,665,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a91db842a6ef8780d3fe4ba2f0f625da7" title="foedus::storage::sequential\l::SequentialComposer::construct_root" alt="" coords="439,136,680,177"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread_follow" alt="" coords="456,202,663,258"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePartitioner.html#a1aedc45cc5621bd3889f1bf2d47ab79c" title="foedus::storage::masstree\l::MasstreePartitioner::\ldesign_partition" alt="" coords="473,299,646,355"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#a32fb943620383e597308852094ba4ac3" title="foedus::storage::hash\l::TmpSnashotPage::init" alt="" coords="480,389,639,431"/>
<area shape="rect" id="node18" href="classfoedus_1_1memory_1_1EngineMemory.html#a3c3c8902b7000d09878a5a2085f6058c" title="Another convenience method that also reads an existing snapshot page to the volatile page..." alt="" coords="454,560,665,601"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#a230f7dbb47f1b22e7295fe7c00a96fa4" title="Recursively opens pages down from fixed_upto_level. " alt="" coords="458,717,661,773"/>
<area shape="rect" id="node28" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="467,929,651,971"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1StorageManagerPimpl.html#ad5f949c2d00aea4cb2186c93108b7dcc" title="Special method called only from recovery manager. " alt="" coords="474,1050,645,1106"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c" title="Construct root page(s) for one storage based on the ouputs of compose(). " alt="" coords="753,39,931,80"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a41e664c7035f1b89121ef06678a71386" title="These are defined in masstree_storage_debug.cpp. " alt="" coords="755,105,929,161"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread\l_recurse" alt="" coords="755,185,929,256"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a9d2f5eb65777d851bee6809acf6fe153" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="1013,105,1204,161"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1Partitioner.html#a31a7e393bf1f87a9a039c60b291ac9d1" title="Determines partitioning scheme for this storage. " alt="" coords="753,280,931,321"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae68923a3afe20ce445002b85764a9f17" title="These are defined in hash_storage_debug.cpp. " alt="" coords="1267,365,1465,421"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_intermediate" alt="" coords="1009,397,1208,453"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa220f1f2d268290263483476d85be47b" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_data" alt="" coords="743,447,941,503"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a144b7a6f95482f2ab8f8564776689fb9" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="1532,365,1699,421"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#a577ab7f32ca2b4d48a7fa174263de47d" title="foedus::storage::array\l::ArrayStoragePimpl::load" alt="" coords="757,528,927,569"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a44bc6cd5427daadbee9fd6fcc366af09" title="foedus::storage::hash\l::HashStoragePimpl::load" alt="" coords="757,593,927,635"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a8d4ac5a88e7ce112f83b67597719fa82" title="foedus::storage::masstree\l::MasstreeStoragePimpl::load" alt="" coords="745,659,939,700"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#aa0f536b8252655076528b290abb84a87" title="foedus::storage::array\l::ArrayStorage::load" alt="" coords="1035,528,1183,569"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a200dd1b1b2b5bc937cae55120e1befc9" title="foedus::storage::hash\l::HashStorage::load" alt="" coords="1035,593,1182,635"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a2731aaf3a733c773a63df6d691ede3ac" title="foedus::storage::masstree\l::MasstreeStorage::load" alt="" coords="1022,659,1195,700"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#af617a04eb5df3795abfe4900a20a6db6" title="foedus::storage::hash\l::ComposedBinsMergedStream::init" alt="" coords="728,724,956,765"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ad9d314f5d6c1a5f698ca623ef7d0188e" title="Moves cur_path_ to a page that cotains the specified bin. " alt="" coords="741,790,943,846"/>
<area shape="rect" id="node29" href="classfoedus_1_1thread_1_1Thread.html#a29e87db0559d67ac9a942e345e3a2ea2" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="760,871,924,912"/>
<area shape="rect" id="node30" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1004,929,1213,971"/>
<area shape="rect" id="node38" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a98de2aa47bebca5add3e0550f2c602bf" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="1017,1034,1201,1090"/>
<area shape="rect" id="node41" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="750,988,934,1029"/>
<area shape="rect" id="node31" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1261,823,1471,864"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="1274,917,1458,959"/>
<area shape="rect" id="node37" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1523,976,1707,1017"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1array_1_1ArrayStoragePimpl.html#af22fe9e661763ca3225eeedf7fa62879" title="foedus::storage::array\l::ArrayStoragePimpl::prefetch\l_pages_recurse" alt="" coords="1519,685,1712,741"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="1760,791,1973,832"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="1526,815,1705,871"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="1525,895,1706,951"/>
<area shape="rect" id="node39" href="classfoedus_1_1thread_1_1Thread.html#a878c3aa228a6e8925e21a3b7b0592349" title="Batched version of find_or_read_a_snapshot_page(). " alt="" coords="1286,1034,1446,1090"/>
<area shape="rect" id="node40" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a89fe2af2a31e70a89e143cbc2d687ffb" title="Batched version of follow_page_pointer with will_modify==false. " alt="" coords="1274,1114,1458,1170"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1StorageManager.html#ad207f2d607f78db439621dd82a4b9470" title="Special method called only from recovery manager. " alt="" coords="759,1105,925,1161"/>
<area shape="rect" id="node44" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="1031,1115,1186,1156"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a5fe3533ff092920e41ddc56ebcd4165c" title="Read pages to buffer_. " alt="" coords="484,1185,635,1241"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4c828d75840906244fd52c44a793232d" title="Read contiguous pages in one shot. " alt="" coords="467,1265,651,1307"/>
<area shape="rect" id="node47" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsBuffer.html#a87975eab41db6a99b88424bd2d6dbb90" title="Moves on to next bin. " alt="" coords="767,1185,917,1241"/>
<area shape="rect" id="node48" href="structfoedus_1_1storage_1_1hash_1_1ComposedBinsMergedStream.html#ac3a65cebf835d18357a69bd523a3bc9d" title="Consumes inputs for the cur_path_[0] page and install snapshot pointers there. " alt="" coords="1007,1185,1210,1241"/>
<area shape="rect" id="node50" href="classfoedus_1_1thread_1_1Thread.html#a1455488538dd235b4de2730693bfd718" title="Read contiguous pages in one shot. " alt="" coords="763,1265,921,1307"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a357db1ed5dbab29245011a2c79d12023"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::fs::DirectIoFile::sync </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Analogues of POSIX <a class="el" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e" title="Makes the content and metadata of the file durable all the way up to devices. ">fsync()</a>. </p>
<dl class="section user"><dt>POSIX fsync()</dt><dd>Transfers ("flushes") all modified in-core data of (i.e., modified buffer cache pages for) the file referred to by the file descriptor fd to the disk device (or other permanent storage device) so that all changed information can be retrieved even after the system crashed or was rebooted. </dd></dl>
<dl class="section user"><dt>No fdatasync analogue</dt><dd>All of our data writes are appends. So, there is no case we are benefited by fdatasync. Hence, we have only <a class="el" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e" title="Makes the content and metadata of the file durable all the way up to devices. ">fsync()</a> analogue. </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. ">is_opened()</a> </dd>
<dd>
<a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#aae86509a918643c3bd8eba937f6803fb">is_write()</a> </dd></dl>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00360">360</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>References <a class="el" href="filesystem_8cpp_source.html#l00203">foedus::fs::fsync()</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00095">is_opened()</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00175">is_write()</a>, <a class="el" href="error__code_8hpp_source.html#l00136">foedus::kErrorCodeFsNotOpened</a>, <a class="el" href="error__code_8hpp_source.html#l00137">foedus::kErrorCodeFsSyncFailed</a>, <a class="el" href="error__code_8hpp_source.html#l00106">foedus::kErrorCodeInvalidParameter</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00049">foedus::fs::DeviceEmulationOptions::null_device_</a>, and <a class="el" href="assorted__func_8cpp_source.html#l00067">foedus::assorted::os_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                              {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00">is_opened</a>()) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;File not opened yet, or closed. this=&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9">kErrorCodeFsNotOpened</a>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#aae86509a918643c3bd8eba937f6803fb">is_write</a>()) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a01914ad44c1e130dd69580da3c04a195">kErrorCodeInvalidParameter</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">if</span> (emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">null_device_</a>) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordtype">int</span> ret = <a class="code" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e">::fsync</a>(descriptor_);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::sync(): fsync failed. this=&quot;</span> &lt;&lt; *<span class="keyword">this</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;, err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ad5e5ef1c622bf310b6fa0e777df3282b">kErrorCodeFsSyncFailed</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a01914ad44c1e130dd69580da3c04a195"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a01914ad44c1e130dd69580da3c04a195">foedus::kErrorCodeInvalidParameter</a></div><div class="ttdoc">0x0002 : "GENERAL: Invalid parameter given" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00106">error_code.hpp:106</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_aae86509a918643c3bd8eba937f6803fb"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#aae86509a918643c3bd8eba937f6803fb">foedus::fs::DirectIoFile::is_write</a></div><div class="ttdeci">bool is_write() const </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00175">direct_io_file.hpp:175</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a1d89a9c761a388f13f9b59490b6caa00"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00">foedus::fs::DirectIoFile::is_opened</a></div><div class="ttdeci">bool is_opened() const </div><div class="ttdoc">Whether the file is already and successfully opened. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00095">direct_io_file.hpp:95</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ad5e5ef1c622bf310b6fa0e777df3282b"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ad5e5ef1c622bf310b6fa0e777df3282b">foedus::kErrorCodeFsSyncFailed</a></div><div class="ttdoc">0x020C : "FILESYS: fsync() failed." . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00137">error_code.hpp:137</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaaa260096daf8620266c2799d1f5a0270"><div class="ttname"><a href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">foedus::assorted::os_error</a></div><div class="ttdeci">std::string os_error()</div><div class="ttdoc">Thread-safe strerror(errno). </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8cpp_source.html#l00067">assorted_func.cpp:67</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9">foedus::kErrorCodeFsNotOpened</a></div><div class="ttdoc">0x020B : "FILESYS: File not opened yet or failed to open." . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00136">error_code.hpp:136</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a965362432b72417b499d4dcfabc94505"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">foedus::fs::DeviceEmulationOptions::null_device_</a></div><div class="ttdeci">bool null_device_</div><div class="ttdoc">[Experiments] as if we write out to /dev/null. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00049">device_emulation_options.hpp:49</a></div></div>
<div class="ttc" id="group__FILESYSTEM_html_ga08865450d848cb894243005bdd226d1e"><div class="ttname"><a href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e">foedus::fs::fsync</a></div><div class="ttdeci">bool fsync(const Path &amp;path, bool sync_parent_directory=false)</div><div class="ttdoc">Makes the content and metadata of the file durable all the way up to devices. </div><div class="ttdef"><b>Definition:</b> <a href="filesystem_8cpp_source.html#l00203">filesystem.cpp:203</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a357db1ed5dbab29245011a2c79d12023_cgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a357db1ed5dbab29245011a2c79d12023_cgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a357db1ed5dbab29245011a2c79d12023_cgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a357db1ed5dbab29245011a2c79d12023_cgraph">
<area shape="rect" id="node2" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e" title="Makes the content and metadata of the file durable all the way up to devices. " alt="" coords="221,61,338,88"/>
<area shape="rect" id="node9" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="204,112,355,154"/>
<area shape="rect" id="node10" href="classfoedus_1_1fs_1_1DirectIoFile.html#aae86509a918643c3bd8eba937f6803fb" title="foedus::fs::DirectIoFile\l::is_write" alt="" coords="204,178,355,219"/>
<area shape="rect" id="node11" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="209,243,349,284"/>
<area shape="rect" id="node3" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="836,32,987,58"/>
<area shape="rect" id="node4" href="group__FILESYSTEM.html#ga87c90d834f65aad6f7b6540ae226f305" title="Returns if the file is a directory. " alt="" coords="421,61,574,88"/>
<area shape="rect" id="node7" href="classfoedus_1_1fs_1_1Path.html#a9859706102ecca097e723d762ec468ae" title="foedus::fs::Path::parent_path" alt="" coords="403,126,592,153"/>
<area shape="rect" id="node5" href="structfoedus_1_1fs_1_1FileStatus.html#a7b8858f191dee3d9a92cae0cd759c1e5" title="foedus::fs::FileStatus\l::is_directory" alt="" coords="641,24,787,66"/>
<area shape="rect" id="node6" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="653,90,775,117"/>
<area shape="rect" id="node8" href="classfoedus_1_1fs_1_1Path.html#a95efbd1ef2b5f97560bdc964ab0b00ed" title="foedus::fs::Path::Path" alt="" coords="640,141,788,168"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a50516ffc3876c5808808651c2c0cb6e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string foedus::fs::DirectIoFile::to_string </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00383">383</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                        {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  std::stringstream stream;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  stream &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">return</span> stream.str();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad59b9d5dc37a89ee993565865bb36b01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::fs::DirectIoFile::truncate </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>new_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sync</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Discard the content of the file after the given offset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">new_length</td><td>The size of this file would become this value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sync</td><td>Whether to call fsync on the file and its parent folder after the truncation.</td></tr>
  </table>
  </dd>
</dl>
<p>After a successful call of this method, the cursor would be at new_length, too. This method is used only when we restart the engine in order to discard non-durable parts of log files (regions after durable watermark). </p><dl class="section pre"><dt>Precondition</dt><dd><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. ">is_opened()</a> </dd></dl>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00296">296</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>References <a class="el" href="filesystem_8cpp_source.html#l00203">foedus::fs::fsync()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00037">foedus::fs::is_odirect_aligned()</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00095">is_opened()</a>, <a class="el" href="error__code_8hpp_source.html#l00131">foedus::kErrorCodeFsBufferNotAligned</a>, <a class="el" href="error__code_8hpp_source.html#l00136">foedus::kErrorCodeFsNotOpened</a>, <a class="el" href="error__code_8hpp_source.html#l00139">foedus::kErrorCodeFsTruncateFailed</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00049">foedus::fs::DeviceEmulationOptions::null_device_</a>, and <a class="el" href="assorted__func_8cpp_source.html#l00067">foedus::assorted::os_error()</a>.</p>

<p>Referenced by <a class="el" href="logger__impl_8cpp_source.html#l00074">foedus::log::Logger::initialize_once()</a>.</p>
<div class="fragment"><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                                                {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(new_length)) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::truncate(): non-aligned input is given. &quot;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; new_length=&quot;</span> &lt;&lt; new_length;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31">kErrorCodeFsBufferNotAligned</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::truncate(): truncating &quot;</span> &lt;&lt; *<span class="keyword">this</span> &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; new_length</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; bytes..&quot;</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00">is_opened</a>()) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9">kErrorCodeFsNotOpened</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">if</span> (emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">null_device_</a>) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    current_offset_ = new_length;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">if</span> (::ftruncate(descriptor_, new_length) != 0) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::truncate(): failed. this=&quot;</span> &lt;&lt; *<span class="keyword">this</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a8fa09f93ae2480ca44b7575a3fd549e8">kErrorCodeFsTruncateFailed</a>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  current_offset_ = new_length;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a357db1ed5dbab29245011a2c79d12023">sync</a>) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::truncate(): also fsync..&quot;</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e">foedus::fs::fsync</a>(path_, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a8fa09f93ae2480ca44b7575a3fd549e8"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a8fa09f93ae2480ca44b7575a3fd549e8">foedus::kErrorCodeFsTruncateFailed</a></div><div class="ttdoc">0x020E : "FILESYS: File truncation failed" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00139">error_code.hpp:139</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a1d89a9c761a388f13f9b59490b6caa00"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00">foedus::fs::DirectIoFile::is_opened</a></div><div class="ttdeci">bool is_opened() const </div><div class="ttdoc">Whether the file is already and successfully opened. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00095">direct_io_file.hpp:95</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a357db1ed5dbab29245011a2c79d12023"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a357db1ed5dbab29245011a2c79d12023">foedus::fs::DirectIoFile::sync</a></div><div class="ttdeci">ErrorCode sync()</div><div class="ttdoc">Analogues of POSIX fsync(). </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00360">direct_io_file.cpp:360</a></div></div>
<div class="ttc" id="namespacefoedus_1_1fs_html_a1a3ea81bf627928d9a5f154986af9c48"><div class="ttname"><a href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">foedus::fs::is_odirect_aligned</a></div><div class="ttdeci">bool is_odirect_aligned(uint64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00037">direct_io_file.cpp:37</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaaa260096daf8620266c2799d1f5a0270"><div class="ttname"><a href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">foedus::assorted::os_error</a></div><div class="ttdeci">std::string os_error()</div><div class="ttdoc">Thread-safe strerror(errno). </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8cpp_source.html#l00067">assorted_func.cpp:67</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9">foedus::kErrorCodeFsNotOpened</a></div><div class="ttdoc">0x020B : "FILESYS: File not opened yet or failed to open." . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00136">error_code.hpp:136</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31">foedus::kErrorCodeFsBufferNotAligned</a></div><div class="ttdoc">0x0206 : "FILESYS: file buffer is not aligned" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00131">error_code.hpp:131</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a965362432b72417b499d4dcfabc94505"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">foedus::fs::DeviceEmulationOptions::null_device_</a></div><div class="ttdeci">bool null_device_</div><div class="ttdoc">[Experiments] as if we write out to /dev/null. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00049">device_emulation_options.hpp:49</a></div></div>
<div class="ttc" id="group__FILESYSTEM_html_ga08865450d848cb894243005bdd226d1e"><div class="ttname"><a href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e">foedus::fs::fsync</a></div><div class="ttdeci">bool fsync(const Path &amp;path, bool sync_parent_directory=false)</div><div class="ttdoc">Makes the content and metadata of the file durable all the way up to devices. </div><div class="ttdef"><b>Definition:</b> <a href="filesystem_8cpp_source.html#l00203">filesystem.cpp:203</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_ad59b9d5dc37a89ee993565865bb36b01_cgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_ad59b9d5dc37a89ee993565865bb36b01_cgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_ad59b9d5dc37a89ee993565865bb36b01_cgraph" id="classfoedus_1_1fs_1_1DirectIoFile_ad59b9d5dc37a89ee993565865bb36b01_cgraph">
<area shape="rect" id="node2" href="group__FILESYSTEM.html#ga08865450d848cb894243005bdd226d1e" title="Makes the content and metadata of the file durable all the way up to devices. " alt="" coords="221,61,338,88"/>
<area shape="rect" id="node9" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="208,112,351,154"/>
<area shape="rect" id="node10" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="204,178,355,219"/>
<area shape="rect" id="node11" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="209,243,349,284"/>
<area shape="rect" id="node3" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="836,32,987,58"/>
<area shape="rect" id="node4" href="group__FILESYSTEM.html#ga87c90d834f65aad6f7b6540ae226f305" title="Returns if the file is a directory. " alt="" coords="421,61,574,88"/>
<area shape="rect" id="node7" href="classfoedus_1_1fs_1_1Path.html#a9859706102ecca097e723d762ec468ae" title="foedus::fs::Path::parent_path" alt="" coords="403,126,592,153"/>
<area shape="rect" id="node5" href="structfoedus_1_1fs_1_1FileStatus.html#a7b8858f191dee3d9a92cae0cd759c1e5" title="foedus::fs::FileStatus\l::is_directory" alt="" coords="641,24,787,66"/>
<area shape="rect" id="node6" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="653,90,775,117"/>
<area shape="rect" id="node8" href="classfoedus_1_1fs_1_1Path.html#a95efbd1ef2b5f97560bdc964ab0b00ed" title="foedus::fs::Path::Path" alt="" coords="640,141,788,168"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_ad59b9d5dc37a89ee993565865bb36b01_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_ad59b9d5dc37a89ee993565865bb36b01_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_ad59b9d5dc37a89ee993565865bb36b01_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_ad59b9d5dc37a89ee993565865bb36b01_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1log_1_1Logger.html#a3b1d647f1458d1172a511b7e57a2a237" title="foedus::log::Logger\l::initialize_once" alt="" coords="204,5,336,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9f19d10be82ac60706853e106a5de0e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::fs::DirectIoFile::write </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>desired_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1memory_1_1AlignedMemory.html">foedus::memory::AlignedMemory</a> &amp;&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sequentially write the given amount of contents from the current position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">desired_bytes</td><td>Number of bytes to write. If we can't write this many bytes, we return errors. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffer</td><td>Memory to read from. As this is Direct-IO, it must be aligned. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. ">is_opened()</a> </dd>
<dd>
buffer.get_size() &gt;= desired_bytes </dd>
<dd>
(buffer-&gt;get_alignment() &amp; 0xFFF) == 0 (4kb alignment) </dd></dl>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00216">216</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>Referenced by <a class="el" href="snapshot__writer__impl_8cpp_source.html#l00082">foedus::snapshot::SnapshotWriter::open()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00055">open()</a>, <a class="el" href="externalizable_8cpp_source.html#l00096">foedus::externalize::Externalizable::save_to_file()</a>, and <a class="el" href="direct__io__file_8cpp_source.html#l00236">write_raw()</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                                                                        {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">write</a>(desired_bytes, memory::AlignedMemorySlice(</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    const_cast&lt;memory::AlignedMemory*&gt;(&amp;buffer)));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a9f19d10be82ac60706853e106a5de0e1"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">foedus::fs::DirectIoFile::write</a></div><div class="ttdeci">ErrorCode write(uint64_t desired_bytes, const foedus::memory::AlignedMemory &amp;buffer)</div><div class="ttdoc">Sequentially write the given amount of contents from the current position. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00216">direct_io_file.cpp:216</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_a9f19d10be82ac60706853e106a5de0e1_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_a9f19d10be82ac60706853e106a5de0e1_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_a9f19d10be82ac60706853e106a5de0e1_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_a9f19d10be82ac60706853e106a5de0e1_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a7d71f940f088efa51d0b5769d4fdd31f" title="Open the file so that the writer can start writing. " alt="" coords="403,5,587,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1fs_1_1DirectIoFile.html#aaa3c1e50680d02783b61f5fe23f98b14" title="Tries to open the file for the specified volume. " alt="" coords="204,136,355,177"/>
<area shape="rect" id="node6" href="structfoedus_1_1externalize_1_1Externalizable.html#af4e4989a732573c1bbd538a3fbfad930" title="Atomically and durably writes out this object to the specified XML file. " alt="" coords="421,202,568,258"/>
<area shape="rect" id="node15" href="classfoedus_1_1fs_1_1DirectIoFile.html#abee93267c52644978643dedc44965970" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="204,268,355,309"/>
<area shape="rect" id="node4" href="classfoedus_1_1log_1_1MetaLogger.html#a5a3484d094947ced0a08a5e162f08a88" title="foedus::log::MetaLogger\l::initialize_once" alt="" coords="414,71,575,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1log_1_1Logger.html#a3b1d647f1458d1172a511b7e57a2a237" title="foedus::log::Logger\l::initialize_once" alt="" coords="429,136,561,177"/>
<area shape="rect" id="node7" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#ad75cdea74e547a1f66d62b85a938a2cd" title="foedus::savepoint::\lSavepointManagerPimpl\l::initialize_once" alt="" coords="891,170,1053,226"/>
<area shape="rect" id="node8" href="classfoedus_1_1savepoint_1_1SavepointManagerPimpl.html#ae5e8a2671c819fc0ada038b3fa47105a" title="foedus::savepoint::\lSavepointManagerPimpl\l::savepoint_main" alt="" coords="646,202,807,258"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a4ae6b016213cb70bb6e5df636b24d129" title="Sub&#45;routine of handle_snapshot_triggered(). " alt="" coords="635,282,819,338"/>
<area shape="rect" id="node10" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a905ccf76fe0e076980dc1965f038fe10" title="handle_snapshot() calls this when it should start snapshotting. " alt="" coords="867,282,1077,338"/>
<area shape="rect" id="node11" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="1153,256,1308,297"/>
<area shape="rect" id="node13" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a64e3c7594b7d7d0d5f8a144bd802d910" title="Main routine for snapshot_thread_ in master engine. " alt="" coords="1125,321,1336,363"/>
<area shape="rect" id="node12" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a868dca9015af77e04202ead68fd7a136" title="foedus::restart::Restart\lManagerPimpl::initialize_once" alt="" coords="1384,256,1579,297"/>
<area shape="rect" id="node14" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a632a4da7b3c67dd687f7eba4f6ec1d76" title="foedus::snapshot::Snapshot\lManagerPimpl::initialize_once" alt="" coords="1384,321,1579,363"/>
<area shape="rect" id="node16" href="classfoedus_1_1fs_1_1DirectIoFile.html#ad2419b5b2a19b6307143876baffcc783" title="Memory slice version. " alt="" coords="419,283,570,324"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad2419b5b2a19b6307143876baffcc783"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::fs::DirectIoFile::write </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>desired_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1memory_1_1AlignedMemorySlice.html">foedus::memory::AlignedMemorySlice</a> &amp;&#160;</td>
          <td class="paramname"><em>slice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Memory slice version. </p>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00221">221</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00242">foedus::memory::AlignedMemorySlice::count_</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00174">foedus::memory::AlignedMemory::get_alignment()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00235">foedus::memory::AlignedMemorySlice::get_block()</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00037">foedus::fs::is_odirect_aligned()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00233">foedus::memory::AlignedMemorySlice::is_valid()</a>, <a class="el" href="error__code_8hpp_source.html#l00131">foedus::kErrorCodeFsBufferNotAligned</a>, <a class="el" href="error__code_8hpp_source.html#l00130">foedus::kErrorCodeFsBufferTooSmall</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00238">foedus::memory::AlignedMemorySlice::memory_</a>, and <a class="el" href="direct__io__file_8cpp_source.html#l00236">write_raw()</a>.</p>
<div class="fragment"><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                                                                             {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(buffer.is_valid());</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">if</span> (desired_bytes &gt; buffer.count_) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::write(): too small buffer is given. desired_bytes=&quot;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      &lt;&lt; desired_bytes &lt;&lt; <span class="stringliteral">&quot;, buffer=&quot;</span> &lt;&lt; buffer;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae2286d0c73a59867229ffc9b1b8c42f3">kErrorCodeFsBufferTooSmall</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(buffer.memory_-&gt;get_alignment())</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      || !<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(buffer.get_block())</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      || !<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(desired_bytes)) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::write(): non-aligned input is given. buffer=&quot;</span> &lt;&lt; buffer</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;, desired_bytes=&quot;</span> &lt;&lt; desired_bytes;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31">kErrorCodeFsBufferNotAligned</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#abee93267c52644978643dedc44965970">write_raw</a>(desired_bytes, buffer.get_block());</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1fs_html_a1a3ea81bf627928d9a5f154986af9c48"><div class="ttname"><a href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">foedus::fs::is_odirect_aligned</a></div><div class="ttdeci">bool is_odirect_aligned(uint64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00037">direct_io_file.cpp:37</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_abee93267c52644978643dedc44965970"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#abee93267c52644978643dedc44965970">foedus::fs::DirectIoFile::write_raw</a></div><div class="ttdeci">ErrorCode write_raw(uint64_t desired_bytes, const void *buffer)</div><div class="ttdoc">A version that receives a raw pointer that has to be aligned (be careful to use this ver)...</div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00236">direct_io_file.cpp:236</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a8f1175392cf40810c9e3c6fbba4bfd31">foedus::kErrorCodeFsBufferNotAligned</a></div><div class="ttdoc">0x0206 : "FILESYS: file buffer is not aligned" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00131">error_code.hpp:131</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ae2286d0c73a59867229ffc9b1b8c42f3"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae2286d0c73a59867229ffc9b1b8c42f3">foedus::kErrorCodeFsBufferTooSmall</a></div><div class="ttdoc">0x0205 : "FILESYS: file buffer is too small" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00130">error_code.hpp:130</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_ad2419b5b2a19b6307143876baffcc783_cgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_ad2419b5b2a19b6307143876baffcc783_cgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_ad2419b5b2a19b6307143876baffcc783_cgraph" id="classfoedus_1_1fs_1_1DirectIoFile_ad2419b5b2a19b6307143876baffcc783_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#a781e5fea7e2fa128936ed3321b7312a4" title="Returns the alignment of the memory block. " alt="" coords="204,5,417,47"/>
<area shape="rect" id="node3" href="structfoedus_1_1memory_1_1AlignedMemorySlice.html#ae3127a9ce40b34e15bc7257ddd332365" title="foedus::memory::AlignedMemory\lSlice::get_block" alt="" coords="204,71,417,112"/>
<area shape="rect" id="node5" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="501,129,643,171"/>
<area shape="rect" id="node6" href="structfoedus_1_1memory_1_1AlignedMemorySlice.html#a61e89ebc636e95e61698c2a523daac29" title="foedus::memory::AlignedMemory\lSlice::is_valid" alt="" coords="204,188,417,229"/>
<area shape="rect" id="node7" href="classfoedus_1_1fs_1_1DirectIoFile.html#abee93267c52644978643dedc44965970" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="235,257,386,299"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="465,64,679,105"/>
<area shape="rect" id="node8" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="497,195,647,236"/>
<area shape="rect" id="node9" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1" title="Sequentially write the given amount of contents from the current position. " alt="" coords="497,260,647,301"/>
<area shape="rect" id="node10" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="502,325,642,367"/>
<area shape="rect" id="node11" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="505,391,639,432"/>
<area shape="rect" id="node12" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="727,391,861,432"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abee93267c52644978643dedc44965970"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::fs::DirectIoFile::write_raw </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>desired_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A version that receives a raw pointer that has to be aligned (be careful to use this ver). </p>

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00236">236</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00046">foedus::fs::DeviceEmulationOptions::disable_direct_io_</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00063">foedus::fs::DeviceEmulationOptions::emulated_write_kb_cycles_</a>, <a class="el" href="direct__io__file_8cpp_source.html#l00037">foedus::fs::is_odirect_aligned()</a>, <a class="el" href="direct__io__file_8hpp_source.html#l00095">is_opened()</a>, <a class="el" href="error__code_8hpp_source.html#l00135">foedus::kErrorCodeFsExcessWrite</a>, <a class="el" href="error__code_8hpp_source.html#l00136">foedus::kErrorCodeFsNotOpened</a>, <a class="el" href="error__code_8hpp_source.html#l00140">foedus::kErrorCodeFsResultNotAligned</a>, <a class="el" href="error__code_8hpp_source.html#l00134">foedus::kErrorCodeFsWriteFail</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="device__emulation__options_8hpp_source.html#l00049">foedus::fs::DeviceEmulationOptions::null_device_</a>, <a class="el" href="assorted__func_8cpp_source.html#l00067">foedus::assorted::os_error()</a>, <a class="el" href="rdtsc_8hpp_source.html#l00060">foedus::debugging::wait_rdtsc_cycles()</a>, and <a class="el" href="direct__io__file_8cpp_source.html#l00216">write()</a>.</p>

<p>Referenced by <a class="el" href="direct__io__file_8cpp_source.html#l00221">write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                                                             {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00">is_opened</a>()) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;File not opened yet, or closed. this=&quot;</span> &lt;&lt; *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9">kErrorCodeFsNotOpened</a>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (desired_bytes == 0) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">if</span> (emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">null_device_</a>) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">// underlying POSIX filesystem might split the write for severel reasons. so, while loop.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  VLOG(1) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::write(). desired_bytes=&quot;</span> &lt;&lt; desired_bytes &lt;&lt; <span class="stringliteral">&quot;, buffer=&quot;</span> &lt;&lt; buffer;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  uint64_t total_written = 0;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  uint64_t remaining = desired_bytes;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">while</span> (remaining &gt; 0) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">void</span>* position = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(buffer) + total_written;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::write(). position=&quot;</span> &lt;&lt; position;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(position));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    ssize_t written_bytes = <a class="code" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">::write</a>(descriptor_, position, remaining);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (written_bytes &lt; 0) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">// negative value means error.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::write(): error. this=&quot;</span> &lt;&lt; *<span class="keyword">this</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, total_written=&quot;</span> &lt;&lt; total_written &lt;&lt; <span class="stringliteral">&quot;, desired_bytes=&quot;</span> &lt;&lt; desired_bytes</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, remaining=&quot;</span> &lt;&lt; remaining &lt;&lt; <span class="stringliteral">&quot;, written_bytes=&quot;</span> &lt;&lt; written_bytes</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="comment">// TASK(Hideaki) more error codes depending on errno. but mostly it should be disk-full</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56aa7950cfb3977bb18436e36517bfe7818">kErrorCodeFsWriteFail</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span> (static_cast&lt;uint64_t&gt;(written_bytes) &gt; remaining) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::write(): wtf? this=&quot;</span> &lt;&lt; *<span class="keyword">this</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, total_written=&quot;</span> &lt;&lt; total_written &lt;&lt; <span class="stringliteral">&quot;, desired_bytes=&quot;</span> &lt;&lt; desired_bytes</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, remaining=&quot;</span> &lt;&lt; remaining &lt;&lt; <span class="stringliteral">&quot;, written_bytes=&quot;</span> &lt;&lt; written_bytes</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56aa70a1c5e15ed9919fb3d111829e67e56">kErrorCodeFsExcessWrite</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a9f2ec2ba101506a0eae393068cea6efa">disable_direct_io_</a> &amp;&amp; !<a class="code" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">is_odirect_aligned</a>(written_bytes)) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;DirectIoFile::write(): wtf2? this=&quot;</span> &lt;&lt; *<span class="keyword">this</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, total_written=&quot;</span> &lt;&lt; total_written &lt;&lt; <span class="stringliteral">&quot;, desired_bytes=&quot;</span> &lt;&lt; desired_bytes</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, remaining=&quot;</span> &lt;&lt; remaining &lt;&lt; <span class="stringliteral">&quot;, written_bytes=&quot;</span> &lt;&lt; written_bytes</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, err=&quot;</span> &lt;&lt; <a class="code" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">assorted::os_error</a>();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afb3f2cfc8f5e3fda3256a103937808bd">kErrorCodeFsResultNotAligned</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    total_written += written_bytes;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    remaining -= written_bytes;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    current_offset_ += written_bytes;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (remaining &gt; 0) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Interesting. POSIX write() didn&#39;t complete the writes in one call.&quot;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; total_written=&quot;</span> &lt;&lt; total_written &lt;&lt; <span class="stringliteral">&quot;, desired_bytes=&quot;</span> &lt;&lt; desired_bytes</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, remaining=&quot;</span> &lt;&lt; remaining;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span> (emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a88bdc0f91a8b22b2483e7a51ec533c5d">emulated_write_kb_cycles_</a> &gt; 0) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620">debugging::wait_rdtsc_cycles</a>(emulation_.<a class="code" href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a88bdc0f91a8b22b2483e7a51ec533c5d">emulated_write_kb_cycles_</a> * (desired_bytes &gt;&gt; 10));</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afb3f2cfc8f5e3fda3256a103937808bd"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afb3f2cfc8f5e3fda3256a103937808bd">foedus::kErrorCodeFsResultNotAligned</a></div><div class="ttdoc">0x020F : "FILESYS: Direct I/O operation resulted in non-aligned count of bytes. Filesyste bug...</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00140">error_code.hpp:140</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a9f19d10be82ac60706853e106a5de0e1"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1">foedus::fs::DirectIoFile::write</a></div><div class="ttdeci">ErrorCode write(uint64_t desired_bytes, const foedus::memory::AlignedMemory &amp;buffer)</div><div class="ttdoc">Sequentially write the given amount of contents from the current position. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00216">direct_io_file.cpp:216</a></div></div>
<div class="ttc" id="group__DEBUGGING_html_gac7eac15b41b0fab4e689f62d147ce620"><div class="ttname"><a href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620">foedus::debugging::wait_rdtsc_cycles</a></div><div class="ttdeci">void wait_rdtsc_cycles(uint64_t cycles)</div><div class="ttdoc">Wait until the given CPU cycles elapse. </div><div class="ttdef"><b>Definition:</b> <a href="rdtsc_8hpp_source.html#l00060">rdtsc.hpp:60</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56aa7950cfb3977bb18436e36517bfe7818"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56aa7950cfb3977bb18436e36517bfe7818">foedus::kErrorCodeFsWriteFail</a></div><div class="ttdoc">0x0209 : "FILESYS: Disk write failed." . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00134">error_code.hpp:134</a></div></div>
<div class="ttc" id="classfoedus_1_1fs_1_1DirectIoFile_html_a1d89a9c761a388f13f9b59490b6caa00"><div class="ttname"><a href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00">foedus::fs::DirectIoFile::is_opened</a></div><div class="ttdeci">bool is_opened() const </div><div class="ttdoc">Whether the file is already and successfully opened. </div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8hpp_source.html#l00095">direct_io_file.hpp:95</a></div></div>
<div class="ttc" id="namespacefoedus_1_1fs_html_a1a3ea81bf627928d9a5f154986af9c48"><div class="ttname"><a href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48">foedus::fs::is_odirect_aligned</a></div><div class="ttdeci">bool is_odirect_aligned(uint64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="direct__io__file_8cpp_source.html#l00037">direct_io_file.cpp:37</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a88bdc0f91a8b22b2483e7a51ec533c5d"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a88bdc0f91a8b22b2483e7a51ec533c5d">foedus::fs::DeviceEmulationOptions::emulated_write_kb_cycles_</a></div><div class="ttdeci">uint32_t emulated_write_kb_cycles_</div><div class="ttdoc">[Experiments] additional CPU cycles to busy-wait for each 1KB write. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00063">device_emulation_options.hpp:63</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaaa260096daf8620266c2799d1f5a0270"><div class="ttname"><a href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270">foedus::assorted::os_error</a></div><div class="ttdeci">std::string os_error()</div><div class="ttdoc">Thread-safe strerror(errno). </div><div class="ttdef"><b>Definition:</b> <a href="assorted__func_8cpp_source.html#l00067">assorted_func.cpp:67</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56aa70a1c5e15ed9919fb3d111829e67e56"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56aa70a1c5e15ed9919fb3d111829e67e56">foedus::kErrorCodeFsExcessWrite</a></div><div class="ttdoc">0x020A : "FILESYS: wrote more than expected" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00135">error_code.hpp:135</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae714869269871b4b08555b924c8827f9">foedus::kErrorCodeFsNotOpened</a></div><div class="ttdoc">0x020B : "FILESYS: File not opened yet or failed to open." . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00136">error_code.hpp:136</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a965362432b72417b499d4dcfabc94505"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a965362432b72417b499d4dcfabc94505">foedus::fs::DeviceEmulationOptions::null_device_</a></div><div class="ttdeci">bool null_device_</div><div class="ttdoc">[Experiments] as if we write out to /dev/null. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00049">device_emulation_options.hpp:49</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="structfoedus_1_1fs_1_1DeviceEmulationOptions_html_a9f2ec2ba101506a0eae393068cea6efa"><div class="ttname"><a href="structfoedus_1_1fs_1_1DeviceEmulationOptions.html#a9f2ec2ba101506a0eae393068cea6efa">foedus::fs::DeviceEmulationOptions::disable_direct_io_</a></div><div class="ttdeci">bool disable_direct_io_</div><div class="ttdoc">[Experiments] Whether to disable Direct I/O and use non-direct I/O instead. </div><div class="ttdef"><b>Definition:</b> <a href="device__emulation__options_8hpp_source.html#l00046">device_emulation_options.hpp:46</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_abee93267c52644978643dedc44965970_cgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_abee93267c52644978643dedc44965970_cgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_abee93267c52644978643dedc44965970_cgraph" id="classfoedus_1_1fs_1_1DirectIoFile_abee93267c52644978643dedc44965970_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="208,5,351,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="204,71,355,112"/>
<area shape="rect" id="node4" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="209,136,349,177"/>
<area shape="rect" id="node5" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="212,201,347,243"/>
<area shape="rect" id="node7" href="classfoedus_1_1fs_1_1DirectIoFile.html#a9f19d10be82ac60706853e106a5de0e1" title="Sequentially write the given amount of contents from the current position. " alt="" coords="204,267,355,308"/>
<area shape="rect" id="node6" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="403,201,537,243"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1fs_1_1DirectIoFile_abee93267c52644978643dedc44965970_icgraph.png" border="0" usemap="#classfoedus_1_1fs_1_1DirectIoFile_abee93267c52644978643dedc44965970_icgraph" alt=""/></div>
<map name="classfoedus_1_1fs_1_1DirectIoFile_abee93267c52644978643dedc44965970_icgraph" id="classfoedus_1_1fs_1_1DirectIoFile_abee93267c52644978643dedc44965970_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1fs_1_1DirectIoFile.html#ad2419b5b2a19b6307143876baffcc783" title="Memory slice version. " alt="" coords="204,5,355,47"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a1aabc2de30f24b0d5072a9b9b36d4fdb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html">DirectIoFile</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="direct__io__file_8cpp_source.html#l00388">388</a> of file <a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                                             {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;DirectIoFile&gt;&quot;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;path&gt;&quot;</span> &lt;&lt; v.get_path() &lt;&lt; <span class="stringliteral">&quot;&lt;/path&gt;&quot;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;descriptor&gt;&quot;</span> &lt;&lt; v.get_descriptor() &lt;&lt; <span class="stringliteral">&quot;&lt;/descriptor&gt;&quot;</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;read&gt;&quot;</span> &lt;&lt; v.is_read() &lt;&lt; <span class="stringliteral">&quot;&lt;/read&gt;&quot;</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;write&gt;&quot;</span> &lt;&lt; v.is_write() &lt;&lt; <span class="stringliteral">&quot;&lt;/write&gt;&quot;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;current_offset&gt;&quot;</span> &lt;&lt; v.get_current_offset() &lt;&lt; <span class="stringliteral">&quot;&lt;/current_offset&gt;&quot;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;/DirectIoFile&gt;&quot;</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/fs/<a class="el" href="direct__io__file_8hpp_source.html">direct_io_file.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/fs/<a class="el" href="direct__io__file_8cpp_source.html">direct_io_file.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1fs.html">fs</a></li><li class="navelem"><a class="el" href="classfoedus_1_1fs_1_1DirectIoFile.html">DirectIoFile</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

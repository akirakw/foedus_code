<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::storage::hash::HashStoragePimpl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::storage::hash::HashStoragePimpl Class Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__STORAGE.html">Storage Manager</a> &raquo; <a class="el" href="group__HASH.html">Hashtable Storage</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Pimpl object of <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html" title="Represents a key-value store based on a dense and regular hash. ">HashStorage</a>.  
 <a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Pimpl object of <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html" title="Represents a key-value store based on a dense and regular hash. ">HashStorage</a>. </p>
<p>A private pimpl object for <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html" title="Represents a key-value store based on a dense and regular hash. ">HashStorage</a>. Do not include this header from a client program unless you know what you are doing. </p>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00093">93</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for foedus::storage::hash::HashStoragePimpl:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl__inherit__graph.png" border="0" usemap="#foedus_1_1storage_1_1hash_1_1HashStoragePimpl_inherit__map" alt="Inheritance graph"/></div>
<map name="foedus_1_1storage_1_1hash_1_1HashStoragePimpl_inherit__map" id="foedus_1_1storage_1_1hash_1_1HashStoragePimpl_inherit__map">
<area shape="rect" id="node2" href="classfoedus_1_1Attachable.html" title="foedus::Attachable\l\&lt; HashStorageControlBlock \&gt;" alt="" coords="5,5,200,47"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for foedus::storage::hash::HashStoragePimpl:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl__coll__graph.png" border="0" usemap="#foedus_1_1storage_1_1hash_1_1HashStoragePimpl_coll__map" alt="Collaboration graph"/></div>
<map name="foedus_1_1storage_1_1hash_1_1HashStoragePimpl_coll__map" id="foedus_1_1storage_1_1hash_1_1HashStoragePimpl_coll__map">
<area shape="rect" id="node2" href="classfoedus_1_1Attachable.html" title="foedus::Attachable\l\&lt; HashStorageControlBlock \&gt;" alt="" coords="1349,53,1544,94"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html" title="Database engine object that holds all resources and provides APIs. " alt="" coords="1069,21,1177,48"/>
<area shape="rect" id="node4" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="717,5,849,32"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1HashStorageControlBlock.html" title="Shared data of this storage type. " alt="" coords="1033,102,1212,143"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html" title="Metadata of an hash storage. " alt="" coords="710,57,857,98"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1Metadata.html" title="Metadata of one storage. " alt="" coords="377,64,551,91"/>
<area shape="rect" id="node8" href="classfoedus_1_1assorted_1_1FixedString.html" title="foedus::assorted::FixedString\l\&lt; 60 \&gt;" alt="" coords="5,23,197,65"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1Metadata_1_1SnapshotThresholds.html" title="Tuning parameters related to snapshotting. " alt="" coords="15,89,188,130"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1DualPagePointer.html" title="Represents a pointer to another page (usually a child page). " alt="" coords="696,122,871,163"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1VolatilePagePointer.html" title="Represents a pointer to a volatile page with modification count for preventing ABA. " alt="" coords="383,122,545,163"/>
<area shape="rect" id="node12" href="classfoedus_1_1soc_1_1SharedMutex.html" title="A mutex that can be placed in shared memory and used from multiple processes. " alt="" coords="696,188,871,215"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa8140d836d6269e200a07bdcad761cb5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa8140d836d6269e200a07bdcad761cb5">HashStoragePimpl</a> ()</td></tr>
<tr class="separator:aa8140d836d6269e200a07bdcad761cb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d89aae46df4fd565ae1cddabd486e51"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d89aae46df4fd565ae1cddabd486e51">HashStoragePimpl</a> (<a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html">HashStorage</a> *storage)</td></tr>
<tr class="separator:a3d89aae46df4fd565ae1cddabd486e51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9438b8e6a0c0c582ede319a25b20fe2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9438b8e6a0c0c582ede319a25b20fe2">release_pages_recursive_root</a> (<a class="el" href="classfoedus_1_1memory_1_1PageReleaseBatch.html">memory::PageReleaseBatch</a> *batch, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *page, <a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a> volatile_page_id)</td></tr>
<tr class="memdesc:ac9438b8e6a0c0c582ede319a25b20fe2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used only from uninitialize()  <a href="#ac9438b8e6a0c0c582ede319a25b20fe2">More...</a><br /></td></tr>
<tr class="separator:ac9438b8e6a0c0c582ede319a25b20fe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a4ac4693aa40798617e4cbadc13c5d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4a4ac4693aa40798617e4cbadc13c5d8">release_pages_recursive_intermediate</a> (<a class="el" href="classfoedus_1_1memory_1_1PageReleaseBatch.html">memory::PageReleaseBatch</a> *batch, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *page, <a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a> volatile_page_id)</td></tr>
<tr class="separator:a4a4ac4693aa40798617e4cbadc13c5d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad03735f87f525d0919a2d10b955409e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad03735f87f525d0919a2d10b955409e4">release_pages_recursive_data</a> (<a class="el" href="classfoedus_1_1memory_1_1PageReleaseBatch.html">memory::PageReleaseBatch</a> *batch, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *page, <a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a> volatile_page_id)</td></tr>
<tr class="separator:ad03735f87f525d0919a2d10b955409e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3a7066a8881f653e759362cf39e01c4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1xct_1_1TrackMovedRecordResult.html">xct::TrackMovedRecordResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af3a7066a8881f653e759362cf39e01c4">track_moved_record</a> (<a class="el" href="structfoedus_1_1xct_1_1RwLockableXctId.html">xct::RwLockableXctId</a> *old_address, <a class="el" href="structfoedus_1_1xct_1_1WriteXctAccess.html">xct::WriteXctAccess</a> *write_set)</td></tr>
<tr class="separator:af3a7066a8881f653e759362cf39e01c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a144ddbe7819e7b3576611d456aa46c77"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1xct_1_1TrackMovedRecordResult.html">xct::TrackMovedRecordResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a144ddbe7819e7b3576611d456aa46c77">track_moved_record_search</a> (<a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *page, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo)</td></tr>
<tr class="separator:a144ddbe7819e7b3576611d456aa46c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1d255af4c59e5d9eb4696da85b77121"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae1d255af4c59e5d9eb4696da85b77121">verify_single_thread</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine)</td></tr>
<tr class="memdesc:ae1d255af4c59e5d9eb4696da85b77121"><td class="mdescLeft">&#160;</td><td class="mdescRight">These are defined in <a class="el" href="hash__storage__verify_8cpp.html">hash_storage_verify.cpp</a>.  <a href="#ae1d255af4c59e5d9eb4696da85b77121">More...</a><br /></td></tr>
<tr class="separator:ae1d255af4c59e5d9eb4696da85b77121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e66818c84450f40fdb3d84a945cc36c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3e66818c84450f40fdb3d84a945cc36c">verify_single_thread</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context)</td></tr>
<tr class="separator:a3e66818c84450f40fdb3d84a945cc36c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc1a73e49f6386098d3fff98bc1baf78"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afc1a73e49f6386098d3fff98bc1baf78">verify_single_thread_intermediate</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *page)</td></tr>
<tr class="separator:afc1a73e49f6386098d3fff98bc1baf78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad137d51b31782b8e525481bb69816848"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad137d51b31782b8e525481bb69816848">verify_single_thread_data</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *head)</td></tr>
<tr class="separator:ad137d51b31782b8e525481bb69816848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9075ef5e205fc3e6284e56894b1c8c4b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a9075ef5e205fc3e6284e56894b1c8c4b">hcc_reset_all_temperature_stat</a> ()</td></tr>
<tr class="memdesc:a9075ef5e205fc3e6284e56894b1c8c4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">For stupid reasons (I'm lazy!) these are defined in _debug.cpp.  <a href="#a9075ef5e205fc3e6284e56894b1c8c4b">More...</a><br /></td></tr>
<tr class="separator:a9075ef5e205fc3e6284e56894b1c8c4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece3aacb3a8a9fd362fbad83321cacaf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aece3aacb3a8a9fd362fbad83321cacaf">hcc_reset_all_temperature_stat_intermediate</a> (<a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a> intermediate_page_id)</td></tr>
<tr class="separator:aece3aacb3a8a9fd362fbad83321cacaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab283888fe4b6038d8885f385a136f40b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab283888fe4b6038d8885f385a136f40b">hcc_reset_all_temperature_stat_data</a> (<a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a> head_page_id)</td></tr>
<tr class="separator:ab283888fe4b6038d8885f385a136f40b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae68923a3afe20ce445002b85764a9f17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae68923a3afe20ce445002b85764a9f17">debugout_single_thread</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, bool volatile_only, bool intermediate_only, uint32_t max_pages)</td></tr>
<tr class="memdesc:ae68923a3afe20ce445002b85764a9f17"><td class="mdescLeft">&#160;</td><td class="mdescRight">These are defined in <a class="el" href="hash__storage__debug_8cpp.html">hash_storage_debug.cpp</a>.  <a href="#ae68923a3afe20ce445002b85764a9f17">More...</a><br /></td></tr>
<tr class="separator:ae68923a3afe20ce445002b85764a9f17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9f8e63fe91ea8623c537e3fffc1f3c1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1">debugout_single_thread_intermediate</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, <a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *fileset, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *parent, bool follow_volatile, bool intermediate_only, uint32_t *remaining_pages)</td></tr>
<tr class="separator:ad9f8e63fe91ea8623c537e3fffc1f3c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa220f1f2d268290263483476d85be47b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa220f1f2d268290263483476d85be47b">debugout_single_thread_data</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, <a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *fileset, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *head, bool follow_volatile, uint32_t *remaining_pages)</td></tr>
<tr class="separator:aa220f1f2d268290263483476d85be47b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2823bcc0a488ad58faee46d876db8abe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a2823bcc0a488ad58faee46d876db8abe">create</a> (const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html">HashMetadata</a> &amp;metadata)</td></tr>
<tr class="separator:a2823bcc0a488ad58faee46d876db8abe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44bc6cd5427daadbee9fd6fcc366af09"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a44bc6cd5427daadbee9fd6fcc366af09">load</a> (const <a class="el" href="structfoedus_1_1storage_1_1StorageControlBlock.html">StorageControlBlock</a> &amp;snapshot_block)</td></tr>
<tr class="separator:a44bc6cd5427daadbee9fd6fcc366af09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c499b589d9e31709b066f1457bc1e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a79c499b589d9e31709b066f1457bc1e3">drop</a> ()</td></tr>
<tr class="separator:a79c499b589d9e31709b066f1457bc1e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f9309d223f938ee13a247f1a7b1da46"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4f9309d223f938ee13a247f1a7b1da46">exists</a> () const </td></tr>
<tr class="separator:a4f9309d223f938ee13a247f1a7b1da46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdd0cbf1f438986888173779270bab4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">get_id</a> () const </td></tr>
<tr class="separator:abdd0cbf1f438986888173779270bab4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdf4bd9f7349768099f6aaf621ff3a70"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespacefoedus_1_1storage.html#a0c15c034d49af969335271617a73a846">StorageName</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70">get_name</a> () const </td></tr>
<tr class="separator:afdf4bd9f7349768099f6aaf621ff3a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4578ade774f828985930b8e36269e8e"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html">HashMetadata</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e">get_meta</a> () const </td></tr>
<tr class="separator:ab4578ade774f828985930b8e36269e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4120c099e570a27e391917bc7f76ca07"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4120c099e570a27e391917bc7f76ca07">get_levels</a> () const </td></tr>
<tr class="separator:a4120c099e570a27e391917bc7f76ca07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38d765f971d163f274b24fa920565074"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a38d765f971d163f274b24fa920565074">get_bin_count</a> () const </td></tr>
<tr class="separator:a38d765f971d163f274b24fa920565074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff4c87787f9e6ce9c4306b8bcaf36a47"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">get_bin_bits</a> () const </td></tr>
<tr class="separator:aff4c87787f9e6ce9c4306b8bcaf36a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa792fc726c1bd0f52f3458a78fe8e0ce"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa792fc726c1bd0f52f3458a78fe8e0ce">get_bin_shifts</a> () const </td></tr>
<tr class="separator:aa792fc726c1bd0f52f3458a78fe8e0ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a222e0d485305f3253b0e1c97720dc0c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a222e0d485305f3253b0e1c97720dc0c8">get_record</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, void *payload, uint16_t *payload_capacity, bool read_only)</td></tr>
<tr class="separator:a222e0d485305f3253b0e1c97720dc0c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660df9f0d685df28fbe19f52cdbdc7e2"><td class="memTemplParams" colspan="2">template&lt;typename PAYLOAD &gt; </td></tr>
<tr class="memitem:a660df9f0d685df28fbe19f52cdbdc7e2"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a660df9f0d685df28fbe19f52cdbdc7e2">get_record_primitive</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, PAYLOAD *payload, uint16_t payload_offset, bool read_only)</td></tr>
<tr class="separator:a660df9f0d685df28fbe19f52cdbdc7e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eff8bc4e42a5973c8553830890d8a24"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24">get_record_part</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, void *payload, uint16_t payload_offset, uint16_t payload_count, bool read_only)</td></tr>
<tr class="separator:a4eff8bc4e42a5973c8553830890d8a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeea83aff996263bc8e9b3623fbe305a1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">register_record_write_log</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html">RecordLocation</a> &amp;location, <a class="el" href="structfoedus_1_1log_1_1RecordLogType.html">log::RecordLogType</a> *log_entry)</td></tr>
<tr class="memdesc:aeea83aff996263bc8e9b3623fbe305a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used in the following methods.  <a href="#aeea83aff996263bc8e9b3623fbe305a1">More...</a><br /></td></tr>
<tr class="separator:aeea83aff996263bc8e9b3623fbe305a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9c35890555ddb10d908b77602a1f28c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c">insert_record</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, const void *payload, uint16_t payload_count, uint16_t physical_payload_hint)</td></tr>
<tr class="separator:ac9c35890555ddb10d908b77602a1f28c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a357386c8e5be667334520a33aff51725"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725">delete_record</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo)</td></tr>
<tr class="separator:a357386c8e5be667334520a33aff51725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49df48b50c0c645d3a047e8b153c4015"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015">upsert_record</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, const void *payload, uint16_t payload_count, uint16_t physical_payload_hint)</td></tr>
<tr class="separator:a49df48b50c0c645d3a047e8b153c4015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add8aafbb32713dc6be20804da789f43d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d">overwrite_record</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, const void *payload, uint16_t payload_offset, uint16_t payload_count)</td></tr>
<tr class="separator:add8aafbb32713dc6be20804da789f43d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26fdac44f55a502f17cb82e98966dd84"><td class="memTemplParams" colspan="2">template&lt;typename PAYLOAD &gt; </td></tr>
<tr class="memitem:a26fdac44f55a502f17cb82e98966dd84"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84">overwrite_record_primitive</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, PAYLOAD payload, uint16_t payload_offset)</td></tr>
<tr class="separator:a26fdac44f55a502f17cb82e98966dd84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a233fcd7ffd24bd59d2d0943af3d0de03"><td class="memTemplParams" colspan="2">template&lt;typename PAYLOAD &gt; </td></tr>
<tr class="memitem:a233fcd7ffd24bd59d2d0943af3d0de03"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03">increment_record</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, PAYLOAD *value, uint16_t payload_offset)</td></tr>
<tr class="separator:a233fcd7ffd24bd59d2d0943af3d0de03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a579927a24cc690c8d4d6362bcb9e8538"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538">get_root_page</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool for_write, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> **root)</td></tr>
<tr class="memdesc:a579927a24cc690c8d4d6362bcb9e8538"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the root page of this storage.  <a href="#a579927a24cc690c8d4d6362bcb9e8538">More...</a><br /></td></tr>
<tr class="separator:a579927a24cc690c8d4d6362bcb9e8538"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d443bf6ef79608f06b5ca1aa4ea7e6f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f">follow_page</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool for_write, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *parent, uint16_t index_in_parent, <a class="el" href="structfoedus_1_1storage_1_1Page.html">Page</a> **page)</td></tr>
<tr class="memdesc:a3d443bf6ef79608f06b5ca1aa4ea7e6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">for non-root  <a href="#a3d443bf6ef79608f06b5ca1aa4ea7e6f">More...</a><br /></td></tr>
<tr class="separator:a3d443bf6ef79608f06b5ca1aa4ea7e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21ed664fcd1889aa4dab0f150fd06c02"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02">follow_page_bin_head</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool for_write, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *parent, uint16_t index_in_parent, <a class="el" href="structfoedus_1_1storage_1_1Page.html">Page</a> **page)</td></tr>
<tr class="memdesc:a21ed664fcd1889aa4dab0f150fd06c02"><td class="mdescLeft">&#160;</td><td class="mdescRight">subroutine to follow a pointer to head of bin from a volatile parent  <a href="#a21ed664fcd1889aa4dab0f150fd06c02">More...</a><br /></td></tr>
<tr class="separator:a21ed664fcd1889aa4dab0f150fd06c02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f073a76a5abeac0829ba1e47a40c02c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">locate_bin</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool for_write, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> **bin_head)</td></tr>
<tr class="memdesc:a0f073a76a5abeac0829ba1e47a40c02c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a pointer to the bin that contains records for the hash.  <a href="#a0f073a76a5abeac0829ba1e47a40c02c">More...</a><br /></td></tr>
<tr class="separator:a0f073a76a5abeac0829ba1e47a40c02c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86af9aa3326dd20ffdac2a1beffea0b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4">locate_record</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool for_write, bool physical_only, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *bin_head, <a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html">RecordLocation</a> *result)</td></tr>
<tr class="memdesc:a86af9aa3326dd20ffdac2a1beffea0b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Usually follows locate_bin to locate the exact physical record for the key, or create a new one if not exists (only when for_write).  <a href="#a86af9aa3326dd20ffdac2a1beffea0b4">More...</a><br /></td></tr>
<tr class="separator:a86af9aa3326dd20ffdac2a1beffea0b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8d098fb8e3b997b1dc52ede62b8acb6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa8d098fb8e3b997b1dc52ede62b8acb6">locate_record_physical_only</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool for_write, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *bin_head, <a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html">RecordLocation</a> *result)</td></tr>
<tr class="memdesc:aa8d098fb8e3b997b1dc52ede62b8acb6"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no...">locate_record()</a>'s physical_only version.  <a href="#aa8d098fb8e3b997b1dc52ede62b8acb6">More...</a><br /></td></tr>
<tr class="separator:aa8d098fb8e3b997b1dc52ede62b8acb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07025464a0eba08710f6fa92d7c0f32d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">locate_record_logical</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool for_write, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *bin_head, <a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html">RecordLocation</a> *result)</td></tr>
<tr class="memdesc:a07025464a0eba08710f6fa92d7c0f32d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no...">locate_record()</a>'s logical+physical version.  <a href="#a07025464a0eba08710f6fa92d7c0f32d">More...</a><br /></td></tr>
<tr class="separator:a07025464a0eba08710f6fa92d7c0f32d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af64ca224598812767abe9631f280b105"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105">locate_record_in_snapshot</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *bin_head, <a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html">RecordLocation</a> *result)</td></tr>
<tr class="memdesc:af64ca224598812767abe9631f280b105"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simpler version of locate_record for when we are in snapshot world.  <a href="#af64ca224598812767abe9631f280b105">More...</a><br /></td></tr>
<tr class="separator:af64ca224598812767abe9631f280b105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa2342b5f0a374e38f0ec00242494a34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34">locate_record_reserve_physical</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, uint16_t key_length, const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;combo, uint16_t payload_length, <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> **page_in_out, uint16_t examined_records, <a class="el" href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">DataPageSlotIndex</a> *new_location)</td></tr>
<tr class="memdesc:afa2342b5f0a374e38f0ec00242494a34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine of <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no...">locate_record()</a> to create/migrate a physical record of the given key in the page or its next pages.  <a href="#afa2342b5f0a374e38f0ec00242494a34">More...</a><br /></td></tr>
<tr class="separator:afa2342b5f0a374e38f0ec00242494a34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1Attachable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1Attachable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1Attachable.html">foedus::Attachable&lt; HashStorageControlBlock &gt;</a></td></tr>
<tr class="memitem:ab3209bc9bd57c99f0ad601f33ec77d1e inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#ab3209bc9bd57c99f0ad601f33ec77d1e">Attachable</a> ()</td></tr>
<tr class="separator:ab3209bc9bd57c99f0ad601f33ec77d1e inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad91af21656ffcf7eeb56a5f7d0f5f661 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#ad91af21656ffcf7eeb56a5f7d0f5f661">Attachable</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine)</td></tr>
<tr class="separator:ad91af21656ffcf7eeb56a5f7d0f5f661 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac28be42953c806e4c4e0ad8f99201dae inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#ac28be42953c806e4c4e0ad8f99201dae">Attachable</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, HashStorageControlBlock *control_block)</td></tr>
<tr class="separator:ac28be42953c806e4c4e0ad8f99201dae inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1182f6bd28f64e3c48bf5ee36d54cce inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#ad1182f6bd28f64e3c48bf5ee36d54cce">Attachable</a> (HashStorageControlBlock *control_block)</td></tr>
<tr class="separator:ad1182f6bd28f64e3c48bf5ee36d54cce inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7892c78e38fb5f025ea73939a25c9d2e inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a7892c78e38fb5f025ea73939a25c9d2e">Attachable</a> (const <a class="el" href="classfoedus_1_1Attachable.html">Attachable</a> &amp;other)</td></tr>
<tr class="separator:a7892c78e38fb5f025ea73939a25c9d2e inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed95388e1a77a81a5d7d04cf28ef3577 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#aed95388e1a77a81a5d7d04cf28ef3577">~Attachable</a> ()</td></tr>
<tr class="separator:aed95388e1a77a81a5d7d04cf28ef3577 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0666676a4eaed1c0fdf94a2e1b00c099 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Attachable.html">Attachable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a0666676a4eaed1c0fdf94a2e1b00c099">operator=</a> (const <a class="el" href="classfoedus_1_1Attachable.html">Attachable</a> &amp;other)</td></tr>
<tr class="separator:a0666676a4eaed1c0fdf94a2e1b00c099 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a484796b2fffa361b9a6ed2f1b7f61a35 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a484796b2fffa361b9a6ed2f1b7f61a35">attach</a> (HashStorageControlBlock *control_block)</td></tr>
<tr class="memdesc:a484796b2fffa361b9a6ed2f1b7f61a35 inherit pub_methods_classfoedus_1_1Attachable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attaches to the given shared memory.  <a href="#a484796b2fffa361b9a6ed2f1b7f61a35">More...</a><br /></td></tr>
<tr class="separator:a484796b2fffa361b9a6ed2f1b7f61a35 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebf4adece08c298864ce05ddd9461a0c inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#aebf4adece08c298864ce05ddd9461a0c">is_attached</a> () const</td></tr>
<tr class="memdesc:aebf4adece08c298864ce05ddd9461a0c inherit pub_methods_classfoedus_1_1Attachable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the object has been already attached to some shared memory.  <a href="#aebf4adece08c298864ce05ddd9461a0c">More...</a><br /></td></tr>
<tr class="separator:aebf4adece08c298864ce05ddd9461a0c inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b324e3abf302a59801aa73419bb4fad inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">HashStorageControlBlock *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a5b324e3abf302a59801aa73419bb4fad">get_control_block</a> () const</td></tr>
<tr class="separator:a5b324e3abf302a59801aa73419bb4fad inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44f07b6dbb803d41d16b40182e8ff583 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a44f07b6dbb803d41d16b40182e8ff583">get_engine</a> () const</td></tr>
<tr class="separator:a44f07b6dbb803d41d16b40182e8ff583 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd701f80820c2ef1f665bda157346021 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#acd701f80820c2ef1f665bda157346021">set_engine</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine)</td></tr>
<tr class="separator:acd701f80820c2ef1f665bda157346021 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classfoedus_1_1Attachable"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classfoedus_1_1Attachable')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classfoedus_1_1Attachable.html">foedus::Attachable&lt; HashStorageControlBlock &gt;</a></td></tr>
<tr class="memitem:a5f84f871a1d36f9ee990f3175661cd99 inherit pro_attribs_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a></td></tr>
<tr class="memdesc:a5f84f871a1d36f9ee990f3175661cd99 inherit pro_attribs_classfoedus_1_1Attachable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Most attachable object stores an engine pointer (local engine), so we define it here.  <a href="#a5f84f871a1d36f9ee990f3175661cd99">More...</a><br /></td></tr>
<tr class="separator:a5f84f871a1d36f9ee990f3175661cd99 inherit pro_attribs_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f87c691e2df0b04322e6df8d7c0d81 inherit pro_attribs_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">HashStorageControlBlock *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a></td></tr>
<tr class="memdesc:af9f87c691e2df0b04322e6df8d7c0d81 inherit pro_attribs_classfoedus_1_1Attachable"><td class="mdescLeft">&#160;</td><td class="mdescRight">The shared data on shared memory that has been initialized in some SOC or master engine.  <a href="#af9f87c691e2df0b04322e6df8d7c0d81">More...</a><br /></td></tr>
<tr class="separator:af9f87c691e2df0b04322e6df8d7c0d81 inherit pro_attribs_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa8140d836d6269e200a07bdcad761cb5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::storage::hash::HashStoragePimpl::HashStoragePimpl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00095">95</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;: Attachable&lt;HashStorageControlBlock&gt;() {}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3d89aae46df4fd565ae1cddabd486e51"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::storage::hash::HashStoragePimpl::HashStoragePimpl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html">HashStorage</a> *&#160;</td>
          <td class="paramname"><em>storage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00096">96</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    : Attachable&lt;HashStorageControlBlock&gt;(</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      storage-&gt;get_engine(),</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      storage-&gt;get_control_block()) {}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a2823bcc0a488ad58faee46d876db8abe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::create </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html">HashMetadata</a> &amp;&#160;</td>
          <td class="paramname"><em>metadata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00076">76</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00110">foedus::storage::hash::HashIntermediatePage::assert_range()</a>, <a class="el" href="hash__id_8hpp_source.html#l00090">foedus::storage::hash::bins_to_level()</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a>, <a class="el" href="error__stack_8hpp_source.html#l00480">ERROR_STACK</a>, <a class="el" href="error__stack_8hpp_source.html#l00498">ERROR_STACK_MSG</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00160">exists()</a>, <a class="el" href="hash__id_8hpp_source.html#l00056">foedus::storage::hash::fanout_power()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00166">get_bin_bits()</a>, <a class="el" href="hash__metadata_8hpp_source.html#l00062">foedus::storage::hash::HashMetadata::get_bin_count()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00165">get_bin_count()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00161">get_id()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00164">get_levels()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00162">get_name()</a>, <a class="el" href="engine__memory_8hpp_source.html#l00076">foedus::memory::EngineMemory::get_node_memory()</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="page__pool_8cpp_source.html#l00146">foedus::memory::PagePool::get_resolver()</a>, <a class="el" href="numa__node__memory_8hpp_source.html#l00175">foedus::memory::NumaNodeMemoryRef::get_volatile_pool()</a>, <a class="el" href="page__pool_8cpp_source.html#l00132">foedus::memory::PagePool::grab_one()</a>, <a class="el" href="hash__page__impl_8cpp_source.html#l00040">foedus::storage::hash::HashIntermediatePage::initialize_volatile_page()</a>, <a class="el" href="error__code_8hpp_source.html#l00168">foedus::kErrorCodeStrAlreadyExists</a>, <a class="el" href="error__code_8hpp_source.html#l00179">foedus::kErrorCodeStrHashBinsTooMany</a>, <a class="el" href="storage__id_8hpp_source.html#l00158">foedus::storage::kExists</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="storage__options_8hpp_source.html#l00051">foedus::storage::StorageOptions::partitioner_data_memory_mb_</a>, <a class="el" href="page__resolver_8hpp_source.html#l00064">foedus::memory::LocalPageResolver::resolve_offset_newpage()</a>, <a class="el" href="engine__options_8hpp_source.html#l00145">foedus::EngineOptions::storage_</a>, and <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00065">foedus::storage::hash::HashStorage::create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                                                {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4f9309d223f938ee13a247f1a7b1da46">exists</a>()) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;This hash-storage already exists: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70">get_name</a>();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#gaa598b0ca7f0de626ecfa17f2cd58d5b4">ERROR_STACK</a>(<a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a0a03edf7d6ab7385275f50b23173dce8">kErrorCodeStrAlreadyExists</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// hash-specific check.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Due to the current design of hash_partitioner, we spend hashbins bytes</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// out of the partitioner memory.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  uint64_t required_partitioner_bytes = metadata.get_bin_count() + 4096ULL;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  uint64_t partitioner_bytes</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    = <a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">get_options</a>().<a class="code" href="structfoedus_1_1EngineOptions.html#a3e40cfe4530b10e87344b42be16927e1">storage_</a>.<a class="code" href="structfoedus_1_1storage_1_1StorageOptions.html#a127e9bf3b4309f1dafca757fc11ae6e5">partitioner_data_memory_mb_</a> * (1ULL &lt;&lt; 20);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// we don&#39;t bother checking other storages&#39; consumption. the config might later change anyways.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// Instead, leave a bit of margin (25%) for others.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">if</span> (partitioner_bytes &lt; required_partitioner_bytes * 1.25) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    std::stringstream str;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    str &lt;&lt; metadata &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;To accomodate this number of hash bins, partitioner_data_memory_mb_ must be&quot;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; at least &quot;</span> &lt;&lt; (required_partitioner_bytes * 1.25 / (1ULL &lt;&lt; 20));</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#gac6707c46c408c0bd492f44d648bf9e10">ERROR_STACK_MSG</a>(<a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a3fbd07f82917c7d7458e01f87851a6f5">kErrorCodeStrHashBinsTooMany</a>, str.str().c_str());</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_ = metadata;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Newly creating an hash-storage &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70">get_name</a>();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;bin_count_ = 1ULL &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">get_bin_bits</a>();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;levels_ = <a class="code" href="group__HASH.html#gacfc9ccab28ee4ffc1a7317ec51b332f4">bins_to_level</a>(<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;bin_count_);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;levels_ &gt;= 1U);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;bin_count_ &lt;= <a class="code" href="group__HASH.html#gad584a49d2de255afd325aa2ddbb7e726">fanout_power</a>(<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;levels_));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;bin_count_ &gt; <a class="code" href="group__HASH.html#gad584a49d2de255afd325aa2ddbb7e726">fanout_power</a>(<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;levels_ - 1U));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;bin_count=&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a38d765f971d163f274b24fa920565074">get_bin_count</a>() &lt;&lt; <span class="stringliteral">&quot;, levels=&quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4120c099e570a27e391917bc7f76ca07">get_levels</a>());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// small number of root pages. we should at least have that many free pages.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">// so far grab all of them from node 0. no round robbin</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keyword">const</span> uint16_t kTheNode = 0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  memory::PagePool* pool</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    = <a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8">get_node_memory</a>(kTheNode)-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774">get_volatile_pool</a>();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">const</span> memory::LocalPageResolver &amp;local_resolver = pool-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e">get_resolver</a>();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// allocate only the root page</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> root_offset;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(pool-&gt;grab_one(&amp;root_offset));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(root_offset);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  HashIntermediatePage* root_page = <span class="keyword">reinterpret_cast&lt;</span>HashIntermediatePage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    local_resolver.resolve_offset_newpage(root_offset));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.snapshot_pointer_ = 0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_.set(kTheNode, root_offset);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  root_page-&gt;initialize_volatile_page(</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">get_id</a>(),</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;levels_ - 1U,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  root_page-&gt;assert_range();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Newly created an hash-storage &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70">get_name</a>();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;status_ = <a class="code" href="group__STORAGE.html#ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1">kExists</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a3fbd07f82917c7d7458e01f87851a6f5"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a3fbd07f82917c7d7458e01f87851a6f5">foedus::kErrorCodeStrHashBinsTooMany</a></div><div class="ttdoc">0x080D : "STORAGE: HASH: Number of hash-bins too large compared to storage.partitioner_data_memory_mb...</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00179">error_code.hpp:179</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa598b0ca7f0de626ecfa17f2cd58d5b4"><div class="ttname"><a href="group__ERRORCODES.html#gaa598b0ca7f0de626ecfa17f2cd58d5b4">ERROR_STACK</a></div><div class="ttdeci">#define ERROR_STACK(e)        </div><div class="ttdoc">Instantiates ErrorStack with the given foedus::error_code, creating an error stack with the current f...</div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00480">error_stack.hpp:480</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a4f9309d223f938ee13a247f1a7b1da46"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4f9309d223f938ee13a247f1a7b1da46">foedus::storage::hash::HashStoragePimpl::exists</a></div><div class="ttdeci">bool exists() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00160">hash_storage_pimpl.hpp:160</a></div></div>
<div class="ttc" id="group__MEMORY_html_gaf7ed7c23d184b14ce978b1775a86dfae"><div class="ttname"><a href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">foedus::memory::PagePoolOffset</a></div><div class="ttdeci">uint32_t PagePoolOffset</div><div class="ttdoc">Offset in PagePool that compactly represents the page address (unlike 8 bytes pointer). </div><div class="ttdef"><b>Definition:</b> <a href="memory__id_8hpp_source.html#l00044">memory_id.hpp:44</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="group__STORAGE_html_ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1"><div class="ttname"><a href="group__STORAGE.html#ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1">foedus::storage::kExists</a></div><div class="ttdoc">The storage has been created and ready for use. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00158">storage_id.hpp:158</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_afdf4bd9f7349768099f6aaf621ff3a70"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70">foedus::storage::hash::HashStoragePimpl::get_name</a></div><div class="ttdeci">const StorageName &amp; get_name() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00162">hash_storage_pimpl.hpp:162</a></div></div>
<div class="ttc" id="group__HASH_html_gacfc9ccab28ee4ffc1a7317ec51b332f4"><div class="ttname"><a href="group__HASH.html#gacfc9ccab28ee4ffc1a7317ec51b332f4">foedus::storage::hash::bins_to_level</a></div><div class="ttdeci">uint8_t bins_to_level(uint64_t bins)</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00090">hash_id.hpp:90</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_abdd0cbf1f438986888173779270bab4a"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">foedus::storage::hash::HashStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00161">hash_storage_pimpl.hpp:161</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a38d765f971d163f274b24fa920565074"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a38d765f971d163f274b24fa920565074">foedus::storage::hash::HashStoragePimpl::get_bin_count</a></div><div class="ttdeci">HashBin get_bin_count() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00165">hash_storage_pimpl.hpp:165</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a6546930099132529543c320327367ef1"><div class="ttname"><a href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1">foedus::Engine::get_options</a></div><div class="ttdeci">const EngineOptions &amp; get_options() const </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00039">engine.cpp:39</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a4120c099e570a27e391917bc7f76ca07"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4120c099e570a27e391917bc7f76ca07">foedus::storage::hash::HashStoragePimpl::get_levels</a></div><div class="ttdeci">uint8_t get_levels() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00164">hash_storage_pimpl.hpp:164</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1StorageOptions_html_a127e9bf3b4309f1dafca757fc11ae6e5"><div class="ttname"><a href="structfoedus_1_1storage_1_1StorageOptions.html#a127e9bf3b4309f1dafca757fc11ae6e5">foedus::storage::StorageOptions::partitioner_data_memory_mb_</a></div><div class="ttdeci">uint32_t partitioner_data_memory_mb_</div><div class="ttdoc">Size in MB of a shared memory buffer allocated for all partitioners during log gleaning. </div><div class="ttdef"><b>Definition:</b> <a href="storage__options_8hpp_source.html#l00051">storage_options.hpp:51</a></div></div>
<div class="ttc" id="group__HASH_html_gad584a49d2de255afd325aa2ddbb7e726"><div class="ttname"><a href="group__HASH.html#gad584a49d2de255afd325aa2ddbb7e726">foedus::storage::hash::fanout_power</a></div><div class="ttdeci">uint64_t fanout_power(uint8_t exponent)</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00056">hash_id.hpp:56</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="structfoedus_1_1EngineOptions_html_a3e40cfe4530b10e87344b42be16927e1"><div class="ttname"><a href="structfoedus_1_1EngineOptions.html#a3e40cfe4530b10e87344b42be16927e1">foedus::EngineOptions::storage_</a></div><div class="ttdeci">storage::StorageOptions storage_</div><div class="ttdef"><b>Definition:</b> <a href="engine__options_8hpp_source.html#l00145">engine_options.hpp:145</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a0a03edf7d6ab7385275f50b23173dce8"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a0a03edf7d6ab7385275f50b23173dce8">foedus::kErrorCodeStrAlreadyExists</a></div><div class="ttdoc">0x0802 : "STORAGE: This storage already exists" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00168">error_code.hpp:168</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a8bf8832e627cd97fe92c60d38ed96ac8"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8">foedus::memory::EngineMemory::get_node_memory</a></div><div class="ttdeci">NumaNodeMemoryRef * get_node_memory(foedus::thread::ThreadGroupId group) const </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00076">engine_memory.hpp:76</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aff4c87787f9e6ce9c4306b8bcaf36a47"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">foedus::storage::hash::HashStoragePimpl::get_bin_bits</a></div><div class="ttdeci">uint8_t get_bin_bits() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00166">hash_storage_pimpl.hpp:166</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaNodeMemoryRef_html_a70b68580143ce771f5b5b1f9a209f774"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774">foedus::memory::NumaNodeMemoryRef::get_volatile_pool</a></div><div class="ttdeci">PagePool * get_volatile_pool()</div><div class="ttdef"><b>Definition:</b> <a href="numa__node__memory_8hpp_source.html#l00175">numa_node_memory.hpp:175</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gac6707c46c408c0bd492f44d648bf9e10"><div class="ttname"><a href="group__ERRORCODES.html#gac6707c46c408c0bd492f44d648bf9e10">ERROR_STACK_MSG</a></div><div class="ttdeci">#define ERROR_STACK_MSG(e, m)  </div><div class="ttdoc">Overload of ERROR_STACK(e) to receive a custom error message. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00498">error_stack.hpp:498</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePool_html_a18916c76eea7aa49572e69e48e75717e"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e">foedus::memory::PagePool::get_resolver</a></div><div class="ttdeci">const LocalPageResolver &amp; get_resolver() const </div><div class="ttdoc">Gives an object to resolve an offset in this page pool (thus local) to an actual pointer and vice ver...</div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8cpp_source.html#l00146">page_pool.cpp:146</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a2823bcc0a488ad58faee46d876db8abe_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a2823bcc0a488ad58faee46d876db8abe_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a2823bcc0a488ad58faee46d876db8abe_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a2823bcc0a488ad58faee46d876db8abe_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a949b3f4b505de0f1595eabf801d37741" title="foedus::storage::hash\l::HashIntermediatePage\l::assert_range" alt="" coords="261,205,422,261"/>
<area shape="rect" id="node6" href="group__HASH.html#gacfc9ccab28ee4ffc1a7317ec51b332f4" title="foedus::storage::hash\l::bins_to_level" alt="" coords="268,285,415,327"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4f9309d223f938ee13a247f1a7b1da46" title="foedus::storage::hash\l::HashStoragePimpl::exists" alt="" coords="251,351,432,392"/>
<area shape="rect" id="node8" href="group__HASH.html#gad584a49d2de255afd325aa2ddbb7e726" title="foedus::storage::hash\l::fanout_power" alt="" coords="268,416,415,457"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_bits" alt="" coords="259,482,423,538"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html#ac79017c3fbfd8dde111006ba43e97a5e" title="Number of bins in this hash storage. " alt="" coords="495,601,697,643"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a38d765f971d163f274b24fa920565074" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_count" alt="" coords="259,562,423,618"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a" title="foedus::storage::hash\l::HashStoragePimpl::get_id" alt="" coords="251,693,432,735"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4120c099e570a27e391917bc7f76ca07" title="foedus::storage::hash\l::HashStoragePimpl::get\l_levels" alt="" coords="259,759,423,815"/>
<area shape="rect" id="node15" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="274,840,409,881"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70" title="foedus::storage::hash\l::HashStoragePimpl::get_name" alt="" coords="240,905,443,947"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8" title="foedus::memory::EngineMemory\l::get_node_memory" alt="" coords="236,971,447,1012"/>
<area shape="rect" id="node18" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="274,1036,409,1077"/>
<area shape="rect" id="node19" href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e" title="Gives an object to resolve an offset in this page pool (thus local) to an actual pointer and vice ver..." alt="" coords="252,1101,431,1143"/>
<area shape="rect" id="node21" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774" title="foedus::memory::NumaNode\lMemoryRef::get_volatile_pool" alt="" coords="246,1167,437,1208"/>
<area shape="rect" id="node22" href="classfoedus_1_1memory_1_1PagePool.html#a3e9390381783077a504116988cae05c4" title="Grab only one page. " alt="" coords="252,1232,431,1273"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#aeb01df00186ad7f69875d7bd1ff0108e" title="Called only when this page is initialized. " alt="" coords="261,125,422,181"/>
<area shape="rect" id="node39" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="249,1298,433,1354"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="515,202,677,258"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html#ae2b145559047e486059fec93c35ebfc1" title="foedus::storage::hash\l::HashBinRange::length" alt="" coords="517,283,675,324"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="757,209,948,251"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="496,496,696,537"/>
<area shape="rect" id="node20" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#ae901dc06f6b6f4594626ed0b233daec6" title="foedus::memory::PagePool\lPimpl::get_resolver" alt="" coords="507,1101,685,1143"/>
<area shape="rect" id="node23" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a3293a43a76f3720cf5c92c5fbcf2d02f" title="foedus::memory::PagePool\lPimpl::grab_one" alt="" coords="507,1232,685,1273"/>
<area shape="rect" id="node24" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a1a41295b63274fb300e5937a9bb1eca7" title="foedus::memory::PagePool\lPimpl::decrease_free_pool_count" alt="" coords="745,1329,960,1371"/>
<area shape="rect" id="node25" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#aa545fc1cffac905225d3a7c7c457b5a8" title="foedus::memory::PagePool\lPimpl::free_pool_head" alt="" coords="763,1133,942,1175"/>
<area shape="rect" id="node26" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#abd594ac94d8ac0445ebef734b7305fb6" title="foedus::memory::PagePool\lPimpl::get_debug_pool_name" alt="" coords="756,1199,949,1240"/>
<area shape="rect" id="node29" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="763,1264,942,1305"/>
<area shape="rect" id="node27" href="classfoedus_1_1assorted_1_1FixedString.html#a3269f7c68f175a1fd42e78110a57cbf2" title="Test if string is empty. " alt="" coords="1019,1169,1211,1211"/>
<area shape="rect" id="node28" href="classfoedus_1_1assorted_1_1FixedString.html#a16f6de0859f599127e2d4a51a6537a01" title="Convert to a std::string object. " alt="" coords="1008,1235,1223,1262"/>
<area shape="rect" id="node31" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html#af492eb6df181653434b727ba29e5c833" title="foedus::storage::hash\l::HashBinRange::contains" alt="" coords="509,5,683,47"/>
<area shape="rect" id="node32" href="structfoedus_1_1storage_1_1PageHeader.html#a5a84eed10b8675e5df2f35f791991eb5" title="foedus::storage::PageHeader\l::init_volatile" alt="" coords="501,71,691,112"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1PageHeader.html#a1956943904b68b6472f53b4e9ed6df87" title="foedus::storage::PageHeader\l::set_in_layer_level" alt="" coords="501,136,691,177"/>
<area shape="rect" id="node33" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="753,104,952,145"/>
<area shape="rect" id="node34" href="structfoedus_1_1storage_1_1PageVersion.html#ae40168c82f16645e85bb66f9019e53cf" title="used only while page initialization " alt="" coords="757,39,949,80"/>
<area shape="rect" id="node35" href="structfoedus_1_1storage_1_1PageVersionStatus.html#af49ef4f3320148130f46f494f1c845aa" title="foedus::storage::PageVersion\lStatus::reset" alt="" coords="1019,7,1211,48"/>
<area shape="rect" id="node36" href="structfoedus_1_1xct_1_1McsWwLock.html#a4114c2dec151ad650a294dedac4f239d" title="used only while page initialization " alt="" coords="1031,72,1200,113"/>
<area shape="rect" id="node37" href="structfoedus_1_1xct_1_1McsWwBlockData.html#a3161e47c41388e9c1b50929f585e366b" title="foedus::xct::McsWwBlockData\l::clear" alt="" coords="1271,72,1472,113"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a2823bcc0a488ad58faee46d876db8abe_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a2823bcc0a488ad58faee46d876db8abe_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a2823bcc0a488ad58faee46d876db8abe_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a2823bcc0a488ad58faee46d876db8abe_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac77a3ace0e46fc133fa68affc8901409" title="foedus::storage::hash\l::HashStorage::create" alt="" coords="236,5,385,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae68923a3afe20ce445002b85764a9f17"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::debugout_single_thread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>volatile_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>intermediate_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>max_pages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>These are defined in <a class="el" href="hash__storage__debug_8cpp.html">hash_storage_debug.cpp</a>. </p>

<p>Definition at line <a class="el" href="hash__storage__debug_8cpp_source.html#l00053">53</a> of file <a class="el" href="hash__storage__debug_8cpp_source.html">hash_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="hash__storage__debug_8cpp_source.html#l00046">foedus::storage::hash::TmpSnashotPage::as_intermediate()</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>, <a class="el" href="hash__storage__debug_8cpp_source.html#l00116">debugout_single_thread_intermediate()</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="hash__storage__debug_8cpp_source.html#l00037">foedus::storage::hash::TmpSnashotPage::init()</a>, <a class="el" href="initializable_8hpp_source.html#l00169">foedus::DefaultInitializable::initialize()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="initializable_8hpp_source.html#l00243">foedus::UninitializeGuard::kWarnIfUninitializeError</a>, <a class="el" href="page__resolver_8hpp_source.html#l00120">foedus::memory::GlobalVolatilePageResolver::resolve_offset()</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, <a class="el" href="initializable_8hpp_source.html#l00187">foedus::DefaultInitializable::uninitialize()</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00279">foedus::storage::hash::HashStorage::debugout_single_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                      {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;**&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***************************************************************&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***   Dumping &quot;</span> &lt;&lt; HashStorage(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>, <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>) &lt;&lt; <span class="stringliteral">&quot; in details. &quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;*** volatile_only=&quot;</span> &lt;&lt; volatile_only</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;, intermediate_only=&quot;</span> &lt;&lt; intermediate_only &lt;&lt; <span class="stringliteral">&quot;, max_pages=&quot;</span> &lt;&lt; max_pages</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***************************************************************&quot;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">if</span> (max_pages == 0) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  cache::SnapshotFileSet files(engine);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(files.initialize());</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  UninitializeGuard files_guard(&amp;files, <a class="code" href="classfoedus_1_1UninitializeGuard.html#ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568">UninitializeGuard::kWarnIfUninitializeError</a>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;First, dumping volatile pages...&quot;</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  DualPagePointer pointer = <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">if</span> (pointer.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;No volatile pages.&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    HashIntermediatePage* root = <span class="keyword">reinterpret_cast&lt;</span>HashIntermediatePage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      engine-&gt;get_memory_manager()-&gt;get_global_volatile_page_resolver().resolve_offset(</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        pointer.volatile_pointer_));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    uint32_t remaining = max_pages - 1U;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1">debugout_single_thread_intermediate</a>(</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      engine,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      &amp;files,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      root,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keyword">true</span>,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      intermediate_only,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      &amp;remaining));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Dumped volatile pages.&quot;</span>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (!volatile_only) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Now dumping snapshot pages...&quot;</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> (pointer.snapshot_pointer_ == 0) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;No snapshot pages.&quot;</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      TmpSnashotPage tmp;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(tmp.init(&amp;files, pointer.snapshot_pointer_));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      HashIntermediatePage* root = tmp.as_intermediate();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      uint32_t remaining = max_pages - 1U;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1">debugout_single_thread_intermediate</a>(</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        engine,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        &amp;files,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        root,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keyword">false</span>,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        intermediate_only,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        &amp;remaining));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Dumped snapshot pages.&quot;</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(files.uninitialize());</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1UninitializeGuard_html_ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568"><div class="ttname"><a href="classfoedus_1_1UninitializeGuard.html#ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568">foedus::UninitializeGuard::kWarnIfUninitializeError</a></div><div class="ttdoc">Automatically calls if uninitialize() wasn&#39;t called when it gets out of scope, and just complains whe...</div><div class="ttdef"><b>Definition:</b> <a href="initializable_8hpp_source.html#l00243">initializable.hpp:243</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_ad9f8e63fe91ea8623c537e3fffc1f3c1"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1">foedus::storage::hash::HashStoragePimpl::debugout_single_thread_intermediate</a></div><div class="ttdeci">ErrorStack debugout_single_thread_intermediate(Engine *engine, cache::SnapshotFileSet *fileset, HashIntermediatePage *parent, bool follow_volatile, bool intermediate_only, uint32_t *remaining_pages)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__debug_8cpp_source.html#l00116">hash_storage_debug.cpp:116</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae68923a3afe20ce445002b85764a9f17_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae68923a3afe20ce445002b85764a9f17_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae68923a3afe20ce445002b85764a9f17_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae68923a3afe20ce445002b85764a9f17_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#afa00b8ffee7f35512f78d8a512fa1373" title="foedus::storage::hash\l::TmpSnashotPage::as\l_intermediate" alt="" coords="527,120,681,176"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_intermediate" alt="" coords="254,415,453,471"/>
<area shape="rect" id="node6" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="791,193,926,234"/>
<area shape="rect" id="node7" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="753,316,964,372"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="778,693,939,734"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#a32fb943620383e597308852094ba4ac3" title="foedus::storage::hash\l::TmpSnashotPage::init" alt="" coords="779,505,938,546"/>
<area shape="rect" id="node38" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff" title="Typical implementation of Initializable::initialize() that provides initialize&#45;once semantics..." alt="" coords="267,1123,439,1165"/>
<area shape="rect" id="node43" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="252,875,455,917"/>
<area shape="rect" id="node50" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb" title="Typical implementation of Initializable::uninitialize() that provides uninitialize&#45;once semantics..." alt="" coords="267,1189,439,1230"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="523,613,685,669"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="523,251,685,307"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa220f1f2d268290263483476d85be47b" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_data" alt="" coords="505,381,703,437"/>
<area shape="rect" id="node37" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#a0f3f54ed3c98cfbc6d9c1f3d72362b4c" title="foedus::storage::hash\l::TmpSnashotPage::as_data" alt="" coords="765,418,952,459"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="763,621,954,662"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1038,781,1199,822"/>
<area shape="rect" id="node13" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="1012,570,1225,611"/>
<area shape="rect" id="node14" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="1012,635,1225,677"/>
<area shape="rect" id="node15" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e" title="Allocate a memory, releasing the current memory if exists. " alt="" coords="1012,439,1225,481"/>
<area shape="rect" id="node28" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="1012,505,1225,546"/>
<area shape="rect" id="node29" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="1273,169,1460,210"/>
<area shape="rect" id="node16" href="namespacefoedus_1_1memory.html#ac2422aa4fe378da8a9594901762e17df" title="foedus::memory::alloc_mmap" alt="" coords="1511,359,1705,385"/>
<area shape="rect" id="node18" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1781,259,1921,301"/>
<area shape="rect" id="node19" href="namespacefoedus_1_1memory.html#ae51e4a90f52316ba9dce8ff783f30d84" title="foedus::memory::alloc\l_mmap_1gb_pages" alt="" coords="1291,410,1442,451"/>
<area shape="rect" id="node20" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="1527,515,1689,557"/>
<area shape="rect" id="node21" href="group__ASSORTED.html#gab3d1892edaa7db4b02029567b7993f37" title="In order to run even on a non&#45;numa machine or a machine with fewer sockets, we allow specifying arbit..." alt="" coords="1291,695,1442,737"/>
<area shape="rect" id="node22" href="numa_8h.html#a413cadd87796fff247c83d9ad817cc7e" title="numa_available" alt="" coords="1553,647,1663,673"/>
<area shape="rect" id="node24" href="numa_8h.html#aba49c14c68d23dc05d046db02766b928" title="numa_preferred" alt="" coords="1311,257,1422,284"/>
<area shape="rect" id="node25" href="numa_8h.html#a56f33968932f6550e5e5eb4d1acc67b3" title="numa_set_preferred" alt="" coords="1299,476,1435,503"/>
<area shape="rect" id="node26" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="1299,578,1434,619"/>
<area shape="rect" id="node17" href="namespacefoedus_1_1memory.html#af6145d9296231995c84badafb6a2a0a9" title="Returns if 1GB hugepages were enabled. " alt="" coords="1769,351,1934,393"/>
<area shape="rect" id="node23" href="numa_8h.html#a22585176d6e08c221de8377637bd72a7" title="numa_num_configured\l_nodes" alt="" coords="1532,698,1684,739"/>
<area shape="rect" id="node27" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="1541,581,1675,622"/>
<area shape="rect" id="node30" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="1508,161,1708,217"/>
<area shape="rect" id="node31" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="1515,30,1701,71"/>
<area shape="rect" id="node34" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="1533,242,1683,283"/>
<area shape="rect" id="node36" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="1533,95,1683,137"/>
<area shape="rect" id="node32" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1757,85,1945,141"/>
<area shape="rect" id="node33" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1756,5,1947,61"/>
<area shape="rect" id="node35" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="1780,175,1923,217"/>
<area shape="rect" id="node39" href="classfoedus_1_1DefaultInitializable.html#ab8ae37e5f20f312f8b945fc40d3e0250" title="foedus::DefaultInitializable\l::initialize_once" alt="" coords="518,1123,690,1165"/>
<area shape="rect" id="node40" href="classfoedus_1_1ErrorStack.html#a9c7b3a8b3806ff623c7fb4a9db5cbeec" title="Returns if this return code is not kErrorCodeOk. " alt="" coords="539,1058,669,1099"/>
<area shape="rect" id="node41" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="518,1254,690,1295"/>
<area shape="rect" id="node42" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b" title="foedus::DefaultInitializable\l::uninitialize_once" alt="" coords="518,1189,690,1230"/>
<area shape="rect" id="node44" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="527,875,681,917"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="784,993,933,1034"/>
<area shape="rect" id="node48" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="517,941,691,982"/>
<area shape="rect" id="node49" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="503,795,705,851"/>
<area shape="rect" id="node45" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="781,802,936,843"/>
<area shape="rect" id="node47" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="763,919,954,961"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae68923a3afe20ce445002b85764a9f17_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae68923a3afe20ce445002b85764a9f17_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae68923a3afe20ce445002b85764a9f17_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae68923a3afe20ce445002b85764a9f17_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a144b7a6f95482f2ab8f8564776689fb9" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="252,5,419,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa220f1f2d268290263483476d85be47b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::debugout_single_thread_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *&#160;</td>
          <td class="paramname"><em>fileset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *&#160;</td>
          <td class="paramname"><em>head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>follow_volatile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>remaining_pages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__debug_8cpp_source.html#l00181">181</a> of file <a class="el" href="hash__storage__debug_8cpp_source.html">hash_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="hash__storage__debug_8cpp_source.html#l00047">foedus::storage::hash::TmpSnashotPage::as_data()</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="hash__storage__debug_8cpp_source.html#l00037">foedus::storage::hash::TmpSnashotPage::init()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__debug_8cpp_source.html#l00116">debugout_single_thread_intermediate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                       {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  TmpSnashotPage tmp;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resolver = engine-&gt;get_memory_manager()-&gt;get_global_volatile_page_resolver();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">for</span> (HashDataPage* cur = head; cur;) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    LOG(INFO) &lt;&lt; *cur;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span> ((*remaining) == 0 || --(*remaining) == 0) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Reached write-out max. skip the following&quot;</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// here, we take a copy of pointer so that &quot;cur&quot; might be okay to become invalid after here.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    DualPagePointer pointer = cur-&gt;next_page();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    cur = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> (follow_volatile) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">if</span> (!pointer.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        cur = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(resolver.resolve_offset(pointer.volatile_pointer_));</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">if</span> (pointer.snapshot_pointer_) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(tmp.init(files, pointer.snapshot_pointer_));  <span class="comment">// note, this overwrites tmp</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        cur = tmp.as_data();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa220f1f2d268290263483476d85be47b_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa220f1f2d268290263483476d85be47b_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa220f1f2d268290263483476d85be47b_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa220f1f2d268290263483476d85be47b_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#a0f3f54ed3c98cfbc6d9c1f3d72362b4c" title="foedus::storage::hash\l::TmpSnashotPage::as_data" alt="" coords="264,271,451,313"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="252,337,463,393"/>
<area shape="rect" id="node4" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="290,418,425,459"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#a32fb943620383e597308852094ba4ac3" title="foedus::storage::hash\l::TmpSnashotPage::init" alt="" coords="278,483,437,525"/>
<area shape="rect" id="node34" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="277,578,438,619"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="511,389,724,430"/>
<area shape="rect" id="node7" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="511,454,724,495"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e" title="Allocate a memory, releasing the current memory if exists. " alt="" coords="511,571,724,613"/>
<area shape="rect" id="node21" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="511,323,724,365"/>
<area shape="rect" id="node22" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="772,231,959,273"/>
<area shape="rect" id="node9" href="namespacefoedus_1_1memory.html#ac2422aa4fe378da8a9594901762e17df" title="foedus::memory::alloc_mmap" alt="" coords="1010,477,1203,504"/>
<area shape="rect" id="node11" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1280,427,1420,469"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1memory.html#ae51e4a90f52316ba9dce8ff783f30d84" title="foedus::memory::alloc\l_mmap_1gb_pages" alt="" coords="790,437,941,478"/>
<area shape="rect" id="node13" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="1026,593,1187,634"/>
<area shape="rect" id="node14" href="group__ASSORTED.html#gab3d1892edaa7db4b02029567b7993f37" title="In order to run even on a non&#45;numa machine or a machine with fewer sockets, we allow specifying arbit..." alt="" coords="790,773,941,814"/>
<area shape="rect" id="node15" href="numa_8h.html#a413cadd87796fff247c83d9ad817cc7e" title="numa_available" alt="" coords="1051,724,1162,751"/>
<area shape="rect" id="node17" href="numa_8h.html#aba49c14c68d23dc05d046db02766b928" title="numa_preferred" alt="" coords="810,839,921,865"/>
<area shape="rect" id="node18" href="numa_8h.html#a56f33968932f6550e5e5eb4d1acc67b3" title="numa_set_preferred" alt="" coords="797,553,933,580"/>
<area shape="rect" id="node19" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="798,655,933,697"/>
<area shape="rect" id="node10" href="namespacefoedus_1_1memory.html#af6145d9296231995c84badafb6a2a0a9" title="Returns if 1GB hugepages were enabled. " alt="" coords="1267,493,1433,534"/>
<area shape="rect" id="node16" href="numa_8h.html#a22585176d6e08c221de8377637bd72a7" title="numa_num_configured\l_nodes" alt="" coords="1031,775,1183,817"/>
<area shape="rect" id="node20" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="1039,658,1174,699"/>
<area shape="rect" id="node23" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="1007,49,1207,105"/>
<area shape="rect" id="node24" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="1013,130,1200,171"/>
<area shape="rect" id="node27" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="1031,297,1182,338"/>
<area shape="rect" id="node33" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="1031,231,1182,273"/>
<area shape="rect" id="node25" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1256,5,1444,61"/>
<area shape="rect" id="node26" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1255,85,1445,141"/>
<area shape="rect" id="node28" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="1279,166,1421,207"/>
<area shape="rect" id="node29" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="1275,297,1425,338"/>
<area shape="rect" id="node30" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="1275,362,1425,403"/>
<area shape="rect" id="node31" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="1283,231,1417,273"/>
<area shape="rect" id="node32" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="1493,231,1628,273"/>
<area shape="rect" id="node35" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="537,637,698,678"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa220f1f2d268290263483476d85be47b_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa220f1f2d268290263483476d85be47b_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa220f1f2d268290263483476d85be47b_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa220f1f2d268290263483476d85be47b_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_intermediate" alt="" coords="252,5,451,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae68923a3afe20ce445002b85764a9f17" title="These are defined in hash_storage_debug.cpp. " alt="" coords="499,5,697,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a144b7a6f95482f2ab8f8564776689fb9" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="745,5,912,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad9f8e63fe91ea8623c537e3fffc1f3c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::debugout_single_thread_intermediate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *&#160;</td>
          <td class="paramname"><em>fileset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>follow_volatile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>intermediate_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>remaining_pages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__debug_8cpp_source.html#l00116">116</a> of file <a class="el" href="hash__storage__debug_8cpp_source.html">hash_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="hash__storage__debug_8cpp_source.html#l00047">foedus::storage::hash::TmpSnashotPage::as_data()</a>, <a class="el" href="hash__storage__debug_8cpp_source.html#l00046">foedus::storage::hash::TmpSnashotPage::as_intermediate()</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="hash__storage__debug_8cpp_source.html#l00181">debugout_single_thread_data()</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00105">foedus::storage::hash::HashIntermediatePage::get_level()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00080">foedus::storage::hash::HashIntermediatePage::get_pointer()</a>, <a class="el" href="hash__storage__debug_8cpp_source.html#l00037">foedus::storage::hash::TmpSnashotPage::init()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__debug_8cpp_source.html#l00053">debugout_single_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                       {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (((*remaining) == 0) || --(*remaining) == 0) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Reached write-out max. skip the following&quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  LOG(INFO) &lt;&lt; *parent;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">bool</span> bottom = parent-&gt;get_level() == 0;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> (bottom &amp;&amp; intermediate_only) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resolver = engine-&gt;get_memory_manager()-&gt;get_global_volatile_page_resolver();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  TmpSnashotPage tmp;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; kHashIntermediatePageFanout &amp;&amp; ((*remaining) &gt; 0); ++i) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    DualPagePointer pointer = parent-&gt;get_pointer(i);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (follow_volatile) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">if</span> (pointer.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">if</span> (bottom) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        HashDataPage* page = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          resolver.resolve_offset(pointer.volatile_pointer_));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa220f1f2d268290263483476d85be47b">debugout_single_thread_data</a>(engine, files, page, <span class="keyword">true</span>, remaining));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        HashIntermediatePage* page = <span class="keyword">reinterpret_cast&lt;</span>HashIntermediatePage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          resolver.resolve_offset(pointer.volatile_pointer_));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1">debugout_single_thread_intermediate</a>(</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          engine,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          files,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          page,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="keyword">true</span>,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          intermediate_only,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          remaining));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">if</span> (pointer.snapshot_pointer_ == 0) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(tmp.init(files, pointer.snapshot_pointer_));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">if</span> (bottom) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        HashDataPage* page = tmp.as_data();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa220f1f2d268290263483476d85be47b">debugout_single_thread_data</a>(engine, files, page, <span class="keyword">false</span>, remaining));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        HashIntermediatePage* page = tmp.as_intermediate();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1">debugout_single_thread_intermediate</a>(</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          engine,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          files,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          page,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="keyword">false</span>,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          intermediate_only,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          remaining));</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aa220f1f2d268290263483476d85be47b"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa220f1f2d268290263483476d85be47b">foedus::storage::hash::HashStoragePimpl::debugout_single_thread_data</a></div><div class="ttdeci">ErrorStack debugout_single_thread_data(Engine *engine, cache::SnapshotFileSet *fileset, HashDataPage *head, bool follow_volatile, uint32_t *remaining_pages)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__debug_8cpp_source.html#l00181">hash_storage_debug.cpp:181</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_ad9f8e63fe91ea8623c537e3fffc1f3c1"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad9f8e63fe91ea8623c537e3fffc1f3c1">foedus::storage::hash::HashStoragePimpl::debugout_single_thread_intermediate</a></div><div class="ttdeci">ErrorStack debugout_single_thread_intermediate(Engine *engine, cache::SnapshotFileSet *fileset, HashIntermediatePage *parent, bool follow_volatile, bool intermediate_only, uint32_t *remaining_pages)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__debug_8cpp_source.html#l00116">hash_storage_debug.cpp:116</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad9f8e63fe91ea8623c537e3fffc1f3c1_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad9f8e63fe91ea8623c537e3fffc1f3c1_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad9f8e63fe91ea8623c537e3fffc1f3c1_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad9f8e63fe91ea8623c537e3fffc1f3c1_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#a0f3f54ed3c98cfbc6d9c1f3d72362b4c" title="foedus::storage::hash\l::TmpSnashotPage::as_data" alt="" coords="511,271,697,313"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#afa00b8ffee7f35512f78d8a512fa1373" title="foedus::storage::hash\l::TmpSnashotPage::as\l_intermediate" alt="" coords="274,612,429,668"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa220f1f2d268290263483476d85be47b" title="foedus::storage::hash\l::HashStoragePimpl::debugout\l_single_thread_data" alt="" coords="252,431,451,487"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="499,337,709,393"/>
<area shape="rect" id="node6" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="537,418,671,459"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1hash_1_1TmpSnashotPage.html#a32fb943620383e597308852094ba4ac3" title="foedus::storage::hash\l::TmpSnashotPage::init" alt="" coords="525,483,683,525"/>
<area shape="rect" id="node36" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="523,554,685,595"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="271,692,432,748"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="271,772,432,828"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1AlignedMemory.html#ad11d2289458b26db2aaef9de984045a0" title="Returns if this object doesn&#39;t hold a valid memory block. " alt="" coords="757,389,971,430"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="757,454,971,495"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e" title="Allocate a memory, releasing the current memory if exists. " alt="" coords="757,571,971,613"/>
<area shape="rect" id="node23" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="757,323,971,365"/>
<area shape="rect" id="node24" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="1019,231,1205,273"/>
<area shape="rect" id="node11" href="namespacefoedus_1_1memory.html#ac2422aa4fe378da8a9594901762e17df" title="foedus::memory::alloc_mmap" alt="" coords="1257,477,1450,504"/>
<area shape="rect" id="node13" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1527,427,1667,469"/>
<area shape="rect" id="node14" href="namespacefoedus_1_1memory.html#ae51e4a90f52316ba9dce8ff783f30d84" title="foedus::memory::alloc\l_mmap_1gb_pages" alt="" coords="1037,437,1187,478"/>
<area shape="rect" id="node15" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="1273,593,1434,634"/>
<area shape="rect" id="node16" href="group__ASSORTED.html#gab3d1892edaa7db4b02029567b7993f37" title="In order to run even on a non&#45;numa machine or a machine with fewer sockets, we allow specifying arbit..." alt="" coords="1037,773,1187,814"/>
<area shape="rect" id="node17" href="numa_8h.html#a413cadd87796fff247c83d9ad817cc7e" title="numa_available" alt="" coords="1298,724,1409,751"/>
<area shape="rect" id="node19" href="numa_8h.html#aba49c14c68d23dc05d046db02766b928" title="numa_preferred" alt="" coords="1057,839,1167,865"/>
<area shape="rect" id="node20" href="numa_8h.html#a56f33968932f6550e5e5eb4d1acc67b3" title="numa_set_preferred" alt="" coords="1044,553,1180,580"/>
<area shape="rect" id="node21" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="1045,655,1179,697"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1memory.html#af6145d9296231995c84badafb6a2a0a9" title="Returns if 1GB hugepages were enabled. " alt="" coords="1514,493,1679,534"/>
<area shape="rect" id="node18" href="numa_8h.html#a22585176d6e08c221de8377637bd72a7" title="numa_num_configured\l_nodes" alt="" coords="1277,775,1429,817"/>
<area shape="rect" id="node22" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="1286,658,1421,699"/>
<area shape="rect" id="node25" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="1253,49,1453,105"/>
<area shape="rect" id="node26" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="1260,130,1447,171"/>
<area shape="rect" id="node29" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="1278,297,1429,338"/>
<area shape="rect" id="node35" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="1278,231,1429,273"/>
<area shape="rect" id="node27" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1503,5,1691,61"/>
<area shape="rect" id="node28" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1501,85,1692,141"/>
<area shape="rect" id="node30" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="1525,166,1668,207"/>
<area shape="rect" id="node31" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="1521,297,1672,338"/>
<area shape="rect" id="node32" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="1521,362,1672,403"/>
<area shape="rect" id="node33" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="1529,231,1664,273"/>
<area shape="rect" id="node34" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="1740,231,1875,273"/>
<area shape="rect" id="node37" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="783,637,945,678"/>
<area shape="rect" id="node39" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="509,699,699,741"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad9f8e63fe91ea8623c537e3fffc1f3c1_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad9f8e63fe91ea8623c537e3fffc1f3c1_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad9f8e63fe91ea8623c537e3fffc1f3c1_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad9f8e63fe91ea8623c537e3fffc1f3c1_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae68923a3afe20ce445002b85764a9f17" title="These are defined in hash_storage_debug.cpp. " alt="" coords="252,5,451,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a144b7a6f95482f2ab8f8564776689fb9" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="499,5,665,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a357386c8e5be667334520a33aff51725"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::delete_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a45ccd51d0939bd6922ecb7d80c56fbeb" title="Deletes a record of the given key from this hash storage. ">foedus::storage::hash::HashStorage::delete_record()</a> </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00356">356</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00095">foedus::storage::hash::HashCommonLogType::calculate_log_length()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00166">get_bin_bits()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00161">get_id()</a>, <a class="el" href="thread_8cpp_source.html#l00078">foedus::thread::Thread::get_thread_log_buffer()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00049">foedus::storage::hash::HashCombo::hash_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00108">foedus::storage::hash::RecordLocation::is_found()</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00842">locate_bin()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00400">locate_record_logical()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00100">foedus::storage::hash::RecordLocation::observed_</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00274">foedus::storage::hash::HashDeleteLogType::populate()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00260">register_record_write_log()</a>, and <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">foedus::log::ThreadLogBuffer::reserve_new_log()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00179">foedus::storage::hash::HashStorage::delete_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                          {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  HashDataPage* bin_head;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">locate_bin</a>(context, <span class="keyword">true</span>, combo, &amp;bin_head));</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin_head);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  RecordLocation location;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">locate_record_logical</a>(</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    context,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keyword">true</span>,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">false</span>,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    0,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    key,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    key_length,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    combo,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    bin_head,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    &amp;location));</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">if</span> (!location.is_found()) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;  <span class="comment">// protected by page version set, so we are done</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;  <span class="comment">// protected by the read set</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">HashDeleteLogType::calculate_log_length</a>(key_length, 0);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  HashDeleteLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>HashDeleteLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  log_entry-&gt;populate(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">get_id</a>(), key, key_length, <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">get_bin_bits</a>(), combo.hash_);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">register_record_write_log</a>(context, location, log_entry);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a07025464a0eba08710f6fa92d7c0f32d"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">foedus::storage::hash::HashStoragePimpl::locate_record_logical</a></div><div class="ttdeci">ErrorCode locate_record_logical(thread::Thread *context, bool for_write, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const HashCombo &amp;combo, HashDataPage *bin_head, RecordLocation *result)</div><div class="ttdoc">locate_record()&#39;s logical+physical version. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00400">hash_storage_pimpl.hpp:400</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_abdd0cbf1f438986888173779270bab4a"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">foedus::storage::hash::HashStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00161">hash_storage_pimpl.hpp:161</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a0f073a76a5abeac0829ba1e47a40c02c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">foedus::storage::hash::HashStoragePimpl::locate_bin</a></div><div class="ttdeci">ErrorCode locate_bin(thread::Thread *context, bool for_write, const HashCombo &amp;combo, HashDataPage **bin_head)</div><div class="ttdoc">Find a pointer to the bin that contains records for the hash. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00842">hash_storage_pimpl.cpp:842</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aff4c87787f9e6ce9c4306b8bcaf36a47"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">foedus::storage::hash::HashStoragePimpl::get_bin_bits</a></div><div class="ttdeci">uint8_t get_bin_bits() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00166">hash_storage_pimpl.hpp:166</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aeea83aff996263bc8e9b3623fbe305a1"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">foedus::storage::hash::HashStoragePimpl::register_record_write_log</a></div><div class="ttdeci">ErrorCode register_record_write_log(thread::Thread *context, const RecordLocation &amp;location, log::RecordLogType *log_entry)</div><div class="ttdoc">Used in the following methods. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00260">hash_storage_pimpl.cpp:260</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType_html_a04238b5b4aec46d0a24b5489553b793a"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">foedus::storage::hash::HashCommonLogType::calculate_log_length</a></div><div class="ttdeci">static uint16_t calculate_log_length(uint16_t key_length, uint16_t payload_count) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="hash__log__types_8hpp_source.html#l00095">hash_log_types.hpp:95</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a357386c8e5be667334520a33aff51725_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a357386c8e5be667334520a33aff51725_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a357386c8e5be667334520a33aff51725_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a357386c8e5be667334520a33aff51725_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a" title="foedus::storage::hash\l::HashCommonLogType::\lcalculate_log_length" alt="" coords="253,5,421,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_bits" alt="" coords="255,88,419,144"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a" title="foedus::storage::hash\l::HashStoragePimpl::get_id" alt="" coords="504,133,685,174"/>
<area shape="rect" id="node7" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="261,1086,414,1127"/>
<area shape="rect" id="node8" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="276,1151,399,1193"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab29603dc5748833bc006e129a152a4d1" title="foedus::storage::hash\l::RecordLocation::is_found" alt="" coords="507,198,683,239"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="235,874,440,915"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="247,940,428,996"/>
<area shape="rect" id="node43" href="structfoedus_1_1storage_1_1hash_1_1HashDeleteLogType.html#a3c2ca8fb362ef7876a14e22608b9aa35" title="foedus::storage::hash\l::HashDeleteLogType::\lpopulate" alt="" coords="261,1217,414,1273"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1" title="Used in the following methods. " alt="" coords="243,308,432,364"/>
<area shape="rect" id="node47" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="244,1021,431,1062"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="515,16,675,43"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="495,67,695,109"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="763,1048,927,1104"/>
<area shape="rect" id="node13" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="1019,539,1169,581"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="1013,417,1175,473"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="488,874,701,915"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="1013,620,1175,676"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="765,1208,926,1264"/>
<area shape="rect" id="node23" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1025,1201,1163,1242"/>
<area shape="rect" id="node24" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="1013,1266,1175,1307"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="1011,1398,1177,1439"/>
<area shape="rect" id="node30" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="524,585,665,626"/>
<area shape="rect" id="node12" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1019,1055,1169,1097"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1264,425,1455,466"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="999,874,1189,915"/>
<area shape="rect" id="node20" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="989,1135,1199,1177"/>
<area shape="rect" id="node21" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="754,867,937,923"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="756,1128,935,1184"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="765,685,926,741"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="1012,1466,1176,1507"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="1019,1532,1169,1588"/>
<area shape="rect" id="node28" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="1019,1331,1169,1373"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="504,1693,685,1749"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="755,1693,936,1749"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="1247,1971,1472,2013"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="1012,1924,1176,1980"/>
<area shape="rect" id="node36" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="1298,1783,1421,1825"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="1007,2004,1181,2060"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab1d971d633ca8153c6a7363694e254a0" title="Populates fields other than readset_. " alt="" coords="1005,1612,1183,1668"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a5c39383806af101855b26268abbb00e3" title="Populates the result with XID and possibly readset. " alt="" coords="1005,1743,1183,1799"/>
<area shape="rect" id="node41" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="759,2094,932,2135"/>
<area shape="rect" id="node42" href="structfoedus_1_1storage_1_1PageVersionStatus.html#a8360836cebd9fbeadfeb2a31809270c2" title="foedus::storage::PageVersion\lStatus::has_next_page" alt="" coords="749,1926,941,1967"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="1274,1612,1445,1668"/>
<area shape="rect" id="node45" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="524,315,665,357"/>
<area shape="rect" id="node46" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="775,261,916,302"/>
<area shape="rect" id="node48" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="501,2051,688,2093"/>
<area shape="rect" id="node49" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="752,2159,939,2201"/>
<area shape="rect" id="node50" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="501,1934,688,1975"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a357386c8e5be667334520a33aff51725_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a357386c8e5be667334520a33aff51725_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a357386c8e5be667334520a33aff51725_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a357386c8e5be667334520a33aff51725_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="235,5,383,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a79c499b589d9e31709b066f1457bc1e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::drop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00059">59</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00162">get_name()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="hash__page__impl_8cpp_source.html#l00271">foedus::storage::hash::HashIntermediatePage::release_pages_recursive_parallel()</a>, and <a class="el" href="page__resolver_8hpp_source.html#l00120">foedus::memory::GlobalVolatilePageResolver::resolve_offset()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00073">foedus::storage::hash::HashStorage::drop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                  {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Uninitializing an hash-storage &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70">get_name</a>();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// release volatile pages</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">const</span> memory::GlobalVolatilePageResolver&amp; page_resolver</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      = <a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">get_global_volatile_page_resolver</a>();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    HashIntermediatePage* root = <span class="keyword">reinterpret_cast&lt;</span>HashIntermediatePage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      page_resolver.resolve_offset(<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    root-&gt;release_pages_recursive_parallel(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_.word = 0;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a62b2d4de6a72644e9e31d35a7f9beae0"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">foedus::memory::EngineMemory::get_global_volatile_page_resolver</a></div><div class="ttdeci">const GlobalVolatilePageResolver &amp; get_global_volatile_page_resolver() const </div><div class="ttdoc">Returns the page resolver to convert volatile page ID to page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00090">engine_memory.hpp:90</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_afdf4bd9f7349768099f6aaf621ff3a70"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70">foedus::storage::hash::HashStoragePimpl::get_name</a></div><div class="ttdeci">const StorageName &amp; get_name() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00162">hash_storage_pimpl.hpp:162</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a79c499b589d9e31709b066f1457bc1e3_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a79c499b589d9e31709b066f1457bc1e3_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a79c499b589d9e31709b066f1457bc1e3_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a79c499b589d9e31709b066f1457bc1e3_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="723,368,933,424"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="1019,406,1154,447"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70" title="foedus::storage::hash\l::HashStoragePimpl::get_name" alt="" coords="224,661,427,702"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a72474ba11f14c8e37ab6b9b3bd92d64b" title="foedus::storage::hash\l::HashIntermediatePage\l::release_pages_recursive\l_parallel" alt="" coords="239,566,411,637"/>
<area shape="rect" id="node34" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1246,745,1449,786"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="1006,1001,1167,1057"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8" title="foedus::memory::EngineMemory\l::get_node_memory" alt="" coords="981,602,1192,643"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="478,434,671,475"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1768,1342,1929,1383"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="1006,769,1167,825"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1267,1342,1428,1383"/>
<area shape="rect" id="node13" href="classfoedus_1_1memory_1_1PageReleaseBatch.html#aacfb0dd808ba1a987cea4d957e8e511b" title="Called at the end to return all batched pages to their pools. " alt="" coords="475,551,675,593"/>
<area shape="rect" id="node18" href="classfoedus_1_1memory_1_1PagePool.html#aa7220391af1f368d1fd36b48cc1e2995" title="Returns only one page. " alt="" coords="485,214,664,255"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a7a5b98d7f141ded1682a9e46ae3b8589" title="foedus::storage::hash\l::HashIntermediatePage\l::release_pages_recursive" alt="" coords="742,936,914,992"/>
<area shape="rect" id="node40" href="namespacefoedus_1_1storage_1_1hash.html#a05601cf00ffeb4df540a0d43379d3387" title="foedus::storage::hash\l::release_parallel" alt="" coords="501,669,648,710"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1252,1009,1443,1050"/>
<area shape="rect" id="node14" href="classfoedus_1_1memory_1_1PageReleaseBatch.html#af16728969f6c3544544000355b6d4f30" title="Return all batched pages in the given chunk to its pool. " alt="" coords="728,551,928,593"/>
<area shape="rect" id="node15" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774" title="foedus::memory::NumaNode\lMemoryRef::get_volatile_pool" alt="" coords="991,537,1182,578"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1PagePool.html#a802171ff0578875748d20b4e9c8c9463" title="Returns the specified number of free pages from the chunk. " alt="" coords="997,471,1176,513"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a13d785355359fd936c2b3863d296ba2c" title="foedus::memory::PagePool\lPimpl::release" alt="" coords="1258,471,1437,513"/>
<area shape="rect" id="node19" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a741d98bc9dd15581c1316ae5eaf492d5" title="foedus::memory::PagePool\lPimpl::release_one" alt="" coords="739,211,917,253"/>
<area shape="rect" id="node20" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#aa545fc1cffac905225d3a7c7c457b5a8" title="foedus::memory::PagePool\lPimpl::free_pool_head" alt="" coords="997,341,1176,382"/>
<area shape="rect" id="node21" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#abd594ac94d8ac0445ebef734b7305fb6" title="foedus::memory::PagePool\lPimpl::get_debug_pool_name" alt="" coords="990,27,1183,69"/>
<area shape="rect" id="node24" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="997,145,1176,186"/>
<area shape="rect" id="node25" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a3b5b895c26ed502d93e753389ce0a21b" title="foedus::memory::PagePool\lPimpl::increase_free_pool_count" alt="" coords="981,210,1192,251"/>
<area shape="rect" id="node26" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="1001,275,1173,317"/>
<area shape="rect" id="node22" href="classfoedus_1_1assorted_1_1FixedString.html#a3269f7c68f175a1fd42e78110a57cbf2" title="Test if string is empty. " alt="" coords="1251,57,1443,98"/>
<area shape="rect" id="node23" href="classfoedus_1_1assorted_1_1FixedString.html#a16f6de0859f599127e2d4a51a6537a01" title="Convert to a std::string object. " alt="" coords="1240,5,1455,32"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="1267,1077,1428,1118"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1753,835,1944,877"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="1265,1211,1429,1253"/>
<area shape="rect" id="node31" href="classfoedus_1_1memory_1_1PageReleaseBatch.html#afe13efbf3cc2111936b08e31bd18e179" title="Returns the given in&#45;memory volatile page to appropriate NUMA node. " alt="" coords="1247,1277,1447,1318"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a752f776127f131ccc60744c10d5cf490" title="foedus::storage::hash\l::HashDataPage::release\l_pages_recursive" alt="" coords="1003,1156,1170,1212"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="1264,1146,1431,1187"/>
<area shape="rect" id="node35" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1527,835,1681,877"/>
<area shape="rect" id="node37" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1774,741,1923,782"/>
<area shape="rect" id="node38" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1517,770,1691,811"/>
<area shape="rect" id="node39" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1503,588,1705,644"/>
<area shape="rect" id="node36" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1771,635,1926,677"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a79c499b589d9e31709b066f1457bc1e3_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a79c499b589d9e31709b066f1457bc1e3_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a79c499b589d9e31709b066f1457bc1e3_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a79c499b589d9e31709b066f1457bc1e3_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ab5edd3becb0d83ffab431754e2d80118" title="foedus::storage::hash\l::HashStorage::drop" alt="" coords="224,5,371,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4f9309d223f938ee13a247f1a7b1da46"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::storage::hash::HashStoragePimpl::exists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00160">160</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00076">create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;exists(); }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4f9309d223f938ee13a247f1a7b1da46_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4f9309d223f938ee13a247f1a7b1da46_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4f9309d223f938ee13a247f1a7b1da46_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4f9309d223f938ee13a247f1a7b1da46_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a2823bcc0a488ad58faee46d876db8abe" title="foedus::storage::hash\l::HashStoragePimpl::create" alt="" coords="235,5,417,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac77a3ace0e46fc133fa68affc8901409" title="foedus::storage::hash\l::HashStorage::create" alt="" coords="465,5,615,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3d443bf6ef79608f06b5ca1aa4ea7e6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::follow_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>index_in_parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1Page.html">Page</a> **&#160;</td>
          <td class="paramname"><em>page</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>for non-root </p>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00625">625</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__id_8hpp_source.html#l00191">foedus::storage::hash::HashBinRange::begin_</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="thread_8cpp_source.html#l00095">foedus::thread::Thread::find_or_read_a_snapshot_page()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00679">follow_page_bin_head()</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00353">foedus::thread::Thread::follow_page_pointer()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00104">foedus::storage::hash::HashIntermediatePage::get_bin_range()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00105">foedus::storage::hash::HashIntermediatePage::get_level()</a>, <a class="el" href="page_8hpp_source.html#l00280">foedus::storage::PageHeader::get_page_type()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00080">foedus::storage::hash::HashIntermediatePage::get_pointer()</a>, <a class="el" href="hash__page__impl_8cpp_source.html#l00213">foedus::storage::hash::hash_intermediate_volatile_page_init()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00070">foedus::storage::hash::HashIntermediatePage::header()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="page_8hpp_source.html#l00054">foedus::storage::kHashDataPageType</a>, <a class="el" href="hash__id_8hpp_source.html#l00049">foedus::storage::hash::kHashIntermediatePageFanout</a>, <a class="el" href="page_8hpp_source.html#l00053">foedus::storage::kHashIntermediatePageType</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, and <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00842">locate_bin()</a>.</p>
<div class="fragment"><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;               {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(index_in_parent &lt; <a class="code" href="group__HASH.html#ga4398665205e13bd71e8b2c1691ba1ba3">kHashIntermediatePageFanout</a>);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(parent);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(parent-&gt;header().get_page_type() == <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714">kHashIntermediatePageType</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordtype">bool</span> is_parent_snapshot = parent-&gt;header().snapshot_;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  uint8_t parent_level = parent-&gt;get_level();</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!is_parent_snapshot || !for_write);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  DualPagePointer&amp; pointer = parent-&gt;get_pointer(index_in_parent);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordtype">bool</span> child_intermediate = (parent_level &gt; 0);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordflow">if</span> (is_parent_snapshot) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">// if we are in snapshot world, there is no choice.</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">// separating this out also handles SI level well.</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!for_write);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">if</span> (pointer.snapshot_pointer_ == 0) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      *page = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;find_or_read_a_snapshot_page(pointer.snapshot_pointer_, page));</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*page)-&gt;get_header().snapshot_);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child_intermediate) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;follow_page_pointer(</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <a class="code" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a">hash_intermediate_volatile_page_init</a>,</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      !for_write,  <span class="comment">// null page is a valid result only for reads (&quot;not found&quot;)</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      for_write,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keyword">true</span>,   <span class="comment">// if we jump to snapshot page, we need to add it to pointer set for serializability.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      &amp;pointer,</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      page,</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      reinterpret_cast&lt;Page*&gt;(parent),</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      index_in_parent));</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">// we are in a level-0 volatile page. so the pointee is a bin-head.</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">// we need a bit special handling in this case</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02">follow_page_bin_head</a>(context, for_write, parent, index_in_parent, page));</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">if</span> (*page) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">if</span> (child_intermediate) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*page)-&gt;get_page_type() == <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714">kHashIntermediatePageType</a>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*page)-&gt;get_header().get_in_layer_level() + 1U == parent_level);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*page)-&gt;get_page_type() == <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba6c1740f811f2524fac6cd76aa2a31c6c">kHashDataPageType</a>);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(reinterpret_cast&lt;HashDataPage*&gt;(*page)-&gt;get_bin()</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        == parent-&gt;get_bin_range().begin_ + index_in_parent);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714"><div class="ttname"><a href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714">foedus::storage::kHashIntermediatePageType</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00053">page.hpp:53</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a21ed664fcd1889aa4dab0f150fd06c02"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02">foedus::storage::hash::HashStoragePimpl::follow_page_bin_head</a></div><div class="ttdeci">ErrorCode follow_page_bin_head(thread::Thread *context, bool for_write, HashIntermediatePage *parent, uint16_t index_in_parent, Page **page)</div><div class="ttdoc">subroutine to follow a pointer to head of bin from a volatile parent </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00679">hash_storage_pimpl.cpp:679</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__ARRAY_html_ga2823bcd484e4e7cb47ceca880584000a"><div class="ttname"><a href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a">foedus::storage::hash::hash_intermediate_volatile_page_init</a></div><div class="ttdeci">void hash_intermediate_volatile_page_init(const VolatilePageInitArguments &amp;args)</div><div class="ttdoc">volatile page initialize callback for HashIntermediatePage. </div><div class="ttdef"><b>Definition:</b> <a href="hash__page__impl_8cpp_source.html#l00213">hash_page_impl.cpp:213</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__HASH_html_ga4398665205e13bd71e8b2c1691ba1ba3"><div class="ttname"><a href="group__HASH.html#ga4398665205e13bd71e8b2c1691ba1ba3">foedus::storage::hash::kHashIntermediatePageFanout</a></div><div class="ttdeci">const uint8_t kHashIntermediatePageFanout</div><div class="ttdoc">Number of pointers in an intermediate page of hash storage. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00049">hash_id.hpp:49</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga14e35f7fbe4bc18276fde8e8ba460f5ba6c1740f811f2524fac6cd76aa2a31c6c"><div class="ttname"><a href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba6c1740f811f2524fac6cd76aa2a31c6c">foedus::storage::kHashDataPageType</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00054">page.hpp:54</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3d443bf6ef79608f06b5ca1aa4ea7e6f_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3d443bf6ef79608f06b5ca1aa4ea7e6f_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3d443bf6ef79608f06b5ca1aa4ea7e6f_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3d443bf6ef79608f06b5ca1aa4ea7e6f_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="503,95,712,137"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="267,920,445,976"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="527,161,688,217"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1011,1705,1202,1746"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="1026,2125,1187,2181"/>
<area shape="rect" id="node27" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="532,1431,683,1473"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="1026,1363,1187,1419"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="275,2075,437,2131"/>
<area shape="rect" id="node49" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="516,2043,699,2099"/>
<area shape="rect" id="node3" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1002,175,1211,217"/>
<area shape="rect" id="node4" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="1296,241,1431,282"/>
<area shape="rect" id="node5" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="1260,306,1467,347"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8" title="foedus::memory::PagePool\l::get_base" alt="" coords="1517,207,1696,249"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1289,1322,1438,1363"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="1271,45,1455,86"/>
<area shape="rect" id="node9" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="1515,15,1699,57"/>
<area shape="rect" id="node10" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="1260,110,1467,151"/>
<area shape="rect" id="node11" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8" title="Get a tentative work memory of the specified size from pre&#45;allocated thread&#45;private memory..." alt="" coords="1282,175,1445,217"/>
<area shape="rect" id="node17" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="532,803,683,845"/>
<area shape="rect" id="node18" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1037,694,1176,735"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#aa72388dc98c566a63c723184449a830f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer_address" alt="" coords="527,920,688,976"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1026,759,1187,801"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1283,591,1444,633"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="786,1109,937,1150"/>
<area shape="rect" id="node25" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1277,953,1450,994"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="527,1167,688,1209"/>
<area shape="rect" id="node30" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1015,963,1199,1019"/>
<area shape="rect" id="node31" href="group__ARRAY.html#ga8423aae479f4b36ddc54127b07268c8c" title="volatile page initialize callback for HashDataPage. " alt="" coords="534,1608,681,1664"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="1023,1822,1190,1863"/>
<area shape="rect" id="node38" href="classfoedus_1_1thread_1_1Thread.html#a4e553f5e14ec00d8ba23fbdfa26d687e" title="Returns the private memory repository of this thread. " alt="" coords="532,1285,683,1326"/>
<area shape="rect" id="node39" href="classfoedus_1_1thread_1_1Thread.html#ac8953b86c90ec5ee1730b05397a259da" title="Returns page resolver to convert only local page ID to page pointer. " alt="" coords="526,1351,689,1407"/>
<area shape="rect" id="node40" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="769,1196,953,1252"/>
<area shape="rect" id="node41" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a6c9bf7d6b21ac33a61d6f7176023ea3a" title="Returns one free volatile page to local page pool. " alt="" coords="493,293,721,334"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="525,358,689,399"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac977ed25935d3fa3a8d9651f96349c32" title="foedus::storage::hash\l::HashDataPage::next_page" alt="" coords="515,423,700,465"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="532,489,683,545"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="511,570,704,611"/>
<area shape="rect" id="node46" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="532,635,683,677"/>
<area shape="rect" id="node47" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="532,1102,683,1143"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1268,2133,1459,2174"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#aa77cde98794b5a55e0d295284acb3e6d" title="Returns the page resolver to convert page ID to page pointer. " alt="" coords="1031,1160,1182,1216"/>
<area shape="rect" id="node24" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1005,1043,1208,1085"/>
<area shape="rect" id="node28" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="769,1043,953,1085"/>
<area shape="rect" id="node29" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1001,1241,1212,1282"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a6dc142a2ed0509104e377e10a6d6a034" title="foedus::storage::hash\l::HashStorage::get_bin\l_shifts" alt="" coords="784,1428,939,1484"/>
<area shape="rect" id="node35" href="classfoedus_1_1thread_1_1Thread.html#a64fa1150b812810a2697bd6293aaac9a" title="foedus::thread::Thread\l::get_engine" alt="" coords="786,1509,937,1550"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a03dc5746931434bcc27b2b3b6856c33f" title="foedus::storage::hash\l::HashDataPage::initialize\l_volatile_page" alt="" coords="775,1640,947,1696"/>
<area shape="rect" id="node37" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html#ae2b145559047e486059fec93c35ebfc1" title="foedus::storage::hash\l::HashBinRange::length" alt="" coords="782,1574,941,1615"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#aeb01df00186ad7f69875d7bd1ff0108e" title="Called only when this page is initialized. " alt="" coords="781,2125,942,2181"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3d443bf6ef79608f06b5ca1aa4ea7e6f_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3d443bf6ef79608f06b5ca1aa4ea7e6f_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3d443bf6ef79608f06b5ca1aa4ea7e6f_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3d443bf6ef79608f06b5ca1aa4ea7e6f_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="267,305,472,347"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a222e0d485305f3253b0e1c97720dc0c8" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record" alt="" coords="539,29,703,85"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_part" alt="" coords="539,138,703,194"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="532,218,711,274"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="531,298,712,354"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="530,378,713,434"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="523,458,719,514"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="520,578,723,634"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af64f22f350167426098b6a99c15f864d" title="If you have already computed HashCombo, use this. " alt="" coords="785,5,959,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a660df9f0d685df28fbe19f52cdbdc7e2" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_primitive" alt="" coords="790,71,954,127"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac9ae382b1110aec44a1df2a768c4cee3" title="If you have already computed HashCombo, use this. " alt="" coords="771,152,973,193"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac8f3eb87098b114b9d4f8b151fee17c1" title="If you have already computed HashCombo, use this. " alt="" coords="1021,71,1196,127"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="799,218,945,274"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="798,298,946,354"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="797,378,947,434"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="774,458,970,514"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="791,538,953,594"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="1027,458,1190,514"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="787,618,957,674"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a21ed664fcd1889aa4dab0f150fd06c02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::follow_page_bin_head </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>index_in_parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1Page.html">Page</a> **&#160;</td>
          <td class="paramname"><em>page</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>subroutine to follow a pointer to head of bin from a volatile parent </p>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00679">679</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="storage__id_8hpp_source.html#l00211">foedus::storage::VolatilePagePointer::clear()</a>, <a class="el" href="storage__id_8hpp_source.html#l00230">foedus::storage::construct_volatile_page_pointer()</a>, <a class="el" href="thread_8cpp_source.html#l00095">foedus::thread::Thread::find_or_read_a_snapshot_page()</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00353">foedus::thread::Thread::follow_page_pointer()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00412">foedus::storage::hash::HashDataPage::get_bin()</a>, <a class="el" href="thread_8cpp_source.html#l00075">foedus::thread::Thread::get_current_xct()</a>, <a class="el" href="xct_8hpp_source.html#l00149">foedus::xct::Xct::get_isolation_level()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00105">foedus::storage::hash::HashIntermediatePage::get_level()</a>, <a class="el" href="thread_8cpp_source.html#l00080">foedus::thread::Thread::get_local_volatile_page_resolver()</a>, <a class="el" href="thread_8hpp_source.html#l00066">foedus::thread::Thread::get_numa_node()</a>, <a class="el" href="storage__id_8hpp_source.html#l00201">foedus::storage::VolatilePagePointer::get_numa_node()</a>, <a class="el" href="storage__id_8hpp_source.html#l00202">foedus::storage::VolatilePagePointer::get_offset()</a>, <a class="el" href="page_8hpp_source.html#l00280">foedus::storage::PageHeader::get_page_type()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00082">foedus::storage::hash::HashIntermediatePage::get_pointer_address()</a>, <a class="el" href="thread_8cpp_source.html#l00057">foedus::thread::Thread::get_thread_memory()</a>, <a class="el" href="numa__core__memory_8cpp_source.html#l00208">foedus::memory::NumaCoreMemory::grab_free_volatile_page_pointer()</a>, <a class="el" href="hash__page__impl_8cpp_source.html#l00232">foedus::storage::hash::hash_data_volatile_page_init()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00070">foedus::storage::hash::HashIntermediatePage::header()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00225">foedus::storage::hash::HashDataPage::header()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__code_8hpp_source.html#l00142">foedus::kErrorCodeMemoryNoFreePages</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="page_8hpp_source.html#l00053">foedus::storage::kHashIntermediatePageType</a>, <a class="el" href="storage__id_8hpp_source.html#l00045">foedus::storage::kPageSize</a>, <a class="el" href="xct__id_8hpp_source.html#l00086">foedus::xct::kSerializable</a>, <a class="el" href="xct__id_8hpp_source.html#l00078">foedus::xct::kSnapshot</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00238">foedus::storage::hash::HashDataPage::next_page()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00240">foedus::storage::hash::HashDataPage::next_page_address()</a>, <a class="el" href="page_8hpp_source.html#l00191">foedus::storage::PageHeader::page_id_</a>, <a class="el" href="numa__core__memory_8cpp_source.html#l00213">foedus::memory::NumaCoreMemory::release_free_volatile_page()</a>, <a class="el" href="thread_8cpp_source.html#l00129">foedus::thread::Thread::resolve()</a>, <a class="el" href="thread_8hpp_source.html#l00110">foedus::thread::Thread::resolve_cast()</a>, <a class="el" href="page__resolver_8hpp_source.html#l00064">foedus::memory::LocalPageResolver::resolve_offset_newpage()</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>, and <a class="el" href="storage__id_8hpp_source.html#l00195">foedus::storage::VolatilePagePointer::word</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00625">follow_page()</a>.</p>
<div class="fragment"><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;               {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="comment">// do we have to newly create a volatile version of the pointed bin?</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!parent-&gt;header().snapshot_);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(parent-&gt;header().get_page_type() == <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714">kHashIntermediatePageType</a>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(parent-&gt;get_level() == 0);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  xct::Xct&amp; cur_xct = context-&gt;get_current_xct();</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <a class="code" href="group__XCT.html#ga9ac5dae4b91a288e9d887f28a7124c13">xct::IsolationLevel</a> isolation = cur_xct.get_isolation_level();</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  DualPagePointer* pointer = parent-&gt;get_pointer_address(index_in_parent);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="comment">// otherwise why in volatile page.</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(for_write || isolation != <a class="code" href="group__XCT.html#gga9ac5dae4b91a288e9d887f28a7124c13a993994249cc0179cf24c63cc329e7934">xct::kSnapshot</a> || pointer-&gt;snapshot_pointer_ == 0);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="comment">// in other words, we can safely &quot;prefer&quot; volatile page here.</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">if</span> (!pointer-&gt;volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    *page = context-&gt;resolve(pointer-&gt;volatile_pointer_);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">SnapshotPagePointer</a> snapshot_pointer = pointer-&gt;snapshot_pointer_;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">if</span> (!for_write) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="comment">// reads don&#39;t have to create a new page. easy</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordflow">if</span> (snapshot_pointer == 0) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        *page = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;find_or_read_a_snapshot_page(snapshot_pointer, page));</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keywordflow">if</span> (isolation == <a class="code" href="group__XCT.html#gga9ac5dae4b91a288e9d887f28a7124c13a5e9c22688eea55cea2bf4380b03a8630">xct::kSerializable</a>) {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        VolatilePagePointer null_pointer;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        null_pointer.clear();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        cur_xct.add_to_pointer_set(&amp;(pointer-&gt;volatile_pointer_), null_pointer);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <span class="comment">// writes need the volatile version.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">if</span> (snapshot_pointer == 0) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="comment">// The bin is completely empty. we just make a new empty page.</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;follow_page_pointer(</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;          <a class="code" href="group__ARRAY.html#ga8423aae479f4b36ddc54127b07268c8c">hash_data_volatile_page_init</a>,</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          <span class="keyword">false</span>,</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;          <span class="keyword">true</span>,</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;          <span class="keyword">true</span>,</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;          pointer,</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;          page,</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          reinterpret_cast&lt;Page*&gt;(parent),</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          index_in_parent));</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="comment">// Otherwise, we must create a volatile version of the existing page.</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="comment">// a special rule for hash storage in this case: we create/drop volatile versions</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="comment">// in the granularity of hash bin. all or nothing.</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="comment">// thus, not just the head page of the bin, we have to volatilize the entire bin.</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        memory::NumaCoreMemory* core_memory = context-&gt;get_thread_memory();</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keyword">const</span> memory::LocalPageResolver&amp; local_resolver</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          = context-&gt;get_local_volatile_page_resolver();</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        VolatilePagePointer head_page_id = core_memory-&gt;grab_free_volatile_page_pointer();</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> offset = head_page_id.get_offset();</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(head_page_id.is_null())) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a2ddd0cd462e4ae138f0e572106ad098c">kErrorCodeMemoryNoFreePages</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        HashDataPage* head_page</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(local_resolver.resolve_offset_newpage(offset));</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        storage::Page* snapshot_head;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> code = context-&gt;find_or_read_a_snapshot_page(snapshot_pointer, &amp;snapshot_head);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">if</span> (code != <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          core_memory-&gt;release_free_volatile_page(offset);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          <span class="keywordflow">return</span> code;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        std::memcpy(head_page, snapshot_head, <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">kPageSize</a>);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(head_page-&gt;header().snapshot_);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        head_page-&gt;header().snapshot_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        head_page-&gt;header().page_id_ = head_page_id.word;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="comment">// load following pages. hopefully this is a rare case.</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> last_error = <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(head_page-&gt;next_page().snapshot_pointer_)) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          HashDataPage* cur_page = head_page;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(last_error == <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">SnapshotPagePointer</a> next = cur_page-&gt;next_page().snapshot_pointer_;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="keywordflow">if</span> (next == 0) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            DVLOG(1) &lt;&lt; <span class="stringliteral">&quot;Following next-link in hash data pages. Hopefully it&#39;s not that long..&quot;</span>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            VolatilePagePointer next_page_id = core_memory-&gt;grab_free_volatile_page_pointer();</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> next_offset = next_page_id.get_offset();</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(next_page_id.is_null())) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;              <span class="comment">// we have to release preceding pages too</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;              last_error = <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a2ddd0cd462e4ae138f0e572106ad098c">kErrorCodeMemoryNoFreePages</a>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            HashDataPage* next_page</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;              = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(local_resolver.resolve_offset_newpage(next_offset));</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="comment">// immediately install because:</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="comment">// 1) we don&#39;t have any race here, 2) we need to follow them to release on error.</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            DualPagePointer* target = cur_page-&gt;next_page_address();</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(target-&gt;volatile_pointer_.is_null());</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            target-&gt;volatile_pointer_ = next_page_id;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            target-&gt;snapshot_pointer_ = 0;  <span class="comment">// will be no longer used, let&#39;s clear them</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            storage::Page* snapshot_page;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            last_error = context-&gt;find_or_read_a_snapshot_page(next, &amp;snapshot_page);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="keywordflow">if</span> (last_error != <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            std::memcpy(next_page, snapshot_page, <a class="code" href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">kPageSize</a>);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(next_page-&gt;header().snapshot_);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(next_page-&gt;get_bin() == cur_page-&gt;get_bin());</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            next_page-&gt;header().snapshot_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            next_page-&gt;header().page_id_ = next_page_id.word;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            cur_page = next_page;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;          }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="comment">// all rihgt, now atomically install the pointer to the volatile head page.</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordtype">bool</span> must_release_pages = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">if</span> (last_error == <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          uint64_t expected = 0;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;          <span class="keywordflow">if</span> (assorted::raw_atomic_compare_exchange_strong&lt;uint64_t&gt;(</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            &amp;(pointer-&gt;volatile_pointer_.word),</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            &amp;expected,</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            head_page_id.word)) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="comment">// successfully installed the head pointer. fine.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            *page = <span class="keyword">reinterpret_cast&lt;</span>Page*<span class="keyword">&gt;</span>(head_page);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(expected);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            <span class="comment">// someone else has installed it, which is also fine.</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="comment">// but, we must release pages we created (which turned out to be a waste effort)</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Interesting. Someone else has installed a volatile version.&quot;</span>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            *page = context-&gt;resolve(pointer-&gt;volatile_pointer_);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            must_release_pages = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;          must_release_pages = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordflow">if</span> (must_release_pages) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;          HashDataPage* cur = head_page;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;          <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            VolatilePagePointer cur_id = <a class="code" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6">construct_volatile_page_pointer</a>(cur-&gt;header().page_id_);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur_id.get_numa_node() == context-&gt;get_numa_node());</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!cur_id.is_null());</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="comment">// retrieve next_id BEFORE releasing (revoking) cur page.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            VolatilePagePointer next_id = cur-&gt;next_page().volatile_pointer_;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            core_memory-&gt;release_free_volatile_page(cur_id.get_offset());</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="keywordflow">if</span> (next_id.is_null()) {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            cur = context-&gt;resolve_cast&lt;HashDataPage&gt;(next_id);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;          }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(last_error);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714"><div class="ttname"><a href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714">foedus::storage::kHashIntermediatePageType</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00053">page.hpp:53</a></div></div>
<div class="ttc" id="group__MEMORY_html_gaf7ed7c23d184b14ce978b1775a86dfae"><div class="ttname"><a href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">foedus::memory::PagePoolOffset</a></div><div class="ttdeci">uint32_t PagePoolOffset</div><div class="ttdoc">Offset in PagePool that compactly represents the page address (unlike 8 bytes pointer). </div><div class="ttdef"><b>Definition:</b> <a href="memory__id_8hpp_source.html#l00044">memory_id.hpp:44</a></div></div>
<div class="ttc" id="group__XCT_html_gga9ac5dae4b91a288e9d887f28a7124c13a993994249cc0179cf24c63cc329e7934"><div class="ttname"><a href="group__XCT.html#gga9ac5dae4b91a288e9d887f28a7124c13a993994249cc0179cf24c63cc329e7934">foedus::xct::kSnapshot</a></div><div class="ttdoc">Snapshot isolation (SI), meaning the transaction reads a consistent and complete image of the databas...</div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00078">xct_id.hpp:78</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga629d4b8103bfb83ef9c11b842a4fd398"><div class="ttname"><a href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">foedus::storage::SnapshotPagePointer</a></div><div class="ttdeci">uint64_t SnapshotPagePointer</div><div class="ttdoc">Page ID of a snapshot page. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00079">storage_id.hpp:79</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a2ddd0cd462e4ae138f0e572106ad098c"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a2ddd0cd462e4ae138f0e572106ad098c">foedus::kErrorCodeMemoryNoFreePages</a></div><div class="ttdoc">0x0301 : "MEMORY : Not enough free volatile pages. Check the config of MemoryOptions" ...</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00142">error_code.hpp:142</a></div></div>
<div class="ttc" id="group__XCT_html_ga9ac5dae4b91a288e9d887f28a7124c13"><div class="ttname"><a href="group__XCT.html#ga9ac5dae4b91a288e9d887f28a7124c13">foedus::xct::IsolationLevel</a></div><div class="ttdeci">IsolationLevel</div><div class="ttdoc">Specifies the level of isolation during transaction processing. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00055">xct_id.hpp:55</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__ARRAY_html_ga8423aae479f4b36ddc54127b07268c8c"><div class="ttname"><a href="group__ARRAY.html#ga8423aae479f4b36ddc54127b07268c8c">foedus::storage::hash::hash_data_volatile_page_init</a></div><div class="ttdeci">void hash_data_volatile_page_init(const VolatilePageInitArguments &amp;args)</div><div class="ttdoc">volatile page initialize callback for HashDataPage. </div><div class="ttdef"><b>Definition:</b> <a href="hash__page__impl_8cpp_source.html#l00232">hash_page_impl.cpp:232</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_html_a67e1af2de6e13b000e66609cf60849b6"><div class="ttname"><a href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6">foedus::storage::construct_volatile_page_pointer</a></div><div class="ttdeci">VolatilePagePointer construct_volatile_page_pointer(uint64_t word)</div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00230">storage_id.hpp:230</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga1a3c05fe1d44455fc3e761947c6e21e6"><div class="ttname"><a href="group__STORAGE.html#ga1a3c05fe1d44455fc3e761947c6e21e6">foedus::storage::kPageSize</a></div><div class="ttdeci">const uint16_t kPageSize</div><div class="ttdoc">A constant defining the page size (in bytes) of both snapshot pages and volatile pages. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00045">storage_id.hpp:45</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaae5f98d1b4caace7febc49e59ae5ac56"><div class="ttname"><a href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">foedus::ErrorCode</a></div><div class="ttdeci">ErrorCode</div><div class="ttdoc">Enum of error codes defined in error_code.xmacro. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00085">error_code.hpp:85</a></div></div>
<div class="ttc" id="group__XCT_html_gga9ac5dae4b91a288e9d887f28a7124c13a5e9c22688eea55cea2bf4380b03a8630"><div class="ttname"><a href="group__XCT.html#gga9ac5dae4b91a288e9d887f28a7124c13a5e9c22688eea55cea2bf4380b03a8630">foedus::xct::kSerializable</a></div><div class="ttdoc">Protects against all anomalies in all situations. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00086">xct_id.hpp:86</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a21ed664fcd1889aa4dab0f150fd06c02_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a21ed664fcd1889aa4dab0f150fd06c02_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a21ed664fcd1889aa4dab0f150fd06c02_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a21ed664fcd1889aa4dab0f150fd06c02_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="265,16,427,57"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1041,451,1214,492"/>
<area shape="rect" id="node4" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="508,199,717,240"/>
<area shape="rect" id="node13" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="271,417,421,459"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="790,133,951,175"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1047,5,1208,47"/>
<area shape="rect" id="node18" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="779,315,963,371"/>
<area shape="rect" id="node21" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="801,396,940,437"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="787,1440,954,1481"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="271,535,421,576"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="790,1534,951,1590"/>
<area shape="rect" id="node26" href="classfoedus_1_1thread_1_1Thread.html#ac8953b86c90ec5ee1730b05397a259da" title="Returns page resolver to convert only local page ID to page pointer. " alt="" coords="265,666,427,722"/>
<area shape="rect" id="node27" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="271,600,421,641"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="249,797,443,839"/>
<area shape="rect" id="node31" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="775,1047,966,1088"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#aa72388dc98c566a63c723184449a830f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer_address" alt="" coords="265,929,427,985"/>
<area shape="rect" id="node33" href="classfoedus_1_1thread_1_1Thread.html#a4e553f5e14ec00d8ba23fbdfa26d687e" title="Returns the private memory repository of this thread. " alt="" coords="271,1009,421,1051"/>
<area shape="rect" id="node34" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="521,519,705,575"/>
<area shape="rect" id="node35" href="group__ARRAY.html#ga8423aae479f4b36ddc54127b07268c8c" title="volatile page initialize callback for HashDataPage. " alt="" coords="273,1126,419,1182"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="265,1206,427,1262"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="264,1287,428,1328"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac977ed25935d3fa3a8d9651f96349c32" title="foedus::storage::hash\l::HashDataPage::next_page" alt="" coords="253,1352,439,1393"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="271,1418,421,1474"/>
<area shape="rect" id="node45" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a6c9bf7d6b21ac33a61d6f7176023ea3a" title="Returns one free volatile page to local page pool. " alt="" coords="232,1651,460,1692"/>
<area shape="rect" id="node48" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="537,739,688,780"/>
<area shape="rect" id="node50" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="271,863,421,904"/>
<area shape="rect" id="node5" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="766,199,975,240"/>
<area shape="rect" id="node6" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="1060,201,1195,243"/>
<area shape="rect" id="node7" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="1024,267,1231,308"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8" title="foedus::memory::PagePool\l::get_base" alt="" coords="1279,355,1457,396"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1053,520,1202,561"/>
<area shape="rect" id="node10" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="1035,384,1219,425"/>
<area shape="rect" id="node11" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="1024,71,1231,112"/>
<area shape="rect" id="node12" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8" title="Get a tentative work memory of the specified size from pre&#45;allocated thread&#45;private memory..." alt="" coords="1046,136,1209,177"/>
<area shape="rect" id="node14" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="521,417,705,459"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="765,579,976,620"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="790,644,951,685"/>
<area shape="rect" id="node20" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="769,461,972,503"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1032,1541,1223,1583"/>
<area shape="rect" id="node28" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="523,600,702,641"/>
<area shape="rect" id="node29" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="537,665,688,707"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="790,1302,951,1358"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a6dc142a2ed0509104e377e10a6d6a034" title="foedus::storage::hash\l::HashStorage::get_bin\l_shifts" alt="" coords="535,1105,690,1161"/>
<area shape="rect" id="node38" href="classfoedus_1_1thread_1_1Thread.html#a64fa1150b812810a2697bd6293aaac9a" title="foedus::thread::Thread\l::get_engine" alt="" coords="537,1185,688,1227"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a03dc5746931434bcc27b2b3b6856c33f" title="foedus::storage::hash\l::HashDataPage::initialize\l_volatile_page" alt="" coords="527,1367,699,1423"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1hash_1_1HashBinRange.html#ae2b145559047e486059fec93c35ebfc1" title="foedus::storage::hash\l::HashBinRange::length" alt="" coords="533,1251,692,1292"/>
<area shape="rect" id="node46" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ace44cb03e7da84d29f3a02a790c69191" title="foedus::memory::PagePool\lOffsetChunk::full" alt="" coords="781,1680,960,1721"/>
<area shape="rect" id="node47" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#a6f558bb023b2c5c7dd9bf7ab9d054ef0" title="foedus::memory::PagePool\lOffsetChunk::push_back" alt="" coords="523,1651,702,1692"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1Thread.html#aa77cde98794b5a55e0d295284acb3e6d" title="Returns the page resolver to convert page ID to page pointer. " alt="" coords="795,731,946,787"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a21ed664fcd1889aa4dab0f150fd06c02_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a21ed664fcd1889aa4dab0f150fd06c02_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a21ed664fcd1889aa4dab0f150fd06c02_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a21ed664fcd1889aa4dab0f150fd06c02_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="232,305,445,347"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="493,305,699,347"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a222e0d485305f3253b0e1c97720dc0c8" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record" alt="" coords="766,29,930,85"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_part" alt="" coords="766,138,930,194"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="759,218,937,274"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="757,298,939,354"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="757,378,939,434"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="750,458,946,514"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="747,578,949,634"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af64f22f350167426098b6a99c15f864d" title="If you have already computed HashCombo, use this. " alt="" coords="1011,5,1186,47"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a660df9f0d685df28fbe19f52cdbdc7e2" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_primitive" alt="" coords="1017,71,1181,127"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac9ae382b1110aec44a1df2a768c4cee3" title="If you have already computed HashCombo, use this. " alt="" coords="997,152,1200,193"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac8f3eb87098b114b9d4f8b151fee17c1" title="If you have already computed HashCombo, use this. " alt="" coords="1248,71,1423,127"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="1025,218,1172,274"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="1025,298,1173,354"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="1024,378,1173,434"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="1001,458,1197,514"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="1017,538,1180,594"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="1254,458,1417,514"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="1013,618,1184,674"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aff4c87787f9e6ce9c4306b8bcaf36a47"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t foedus::storage::hash::HashStoragePimpl::get_bin_bits </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00166">166</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="hash__metadata_8hpp_source.html#l00075">foedus::storage::hash::HashMetadata::bin_bits_</a>, and <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00163">get_meta()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00076">create()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00356">delete_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00554">increment_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00277">insert_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00135">load()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00502">overwrite_record()</a>, and <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00390">upsert_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e">get_meta</a>().<a class="code" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html#ae960604e67e191aa73cac527acf05d42">bin_bits_</a>; }</div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1HashMetadata_html_ae960604e67e191aa73cac527acf05d42"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html#ae960604e67e191aa73cac527acf05d42">foedus::storage::hash::HashMetadata::bin_bits_</a></div><div class="ttdeci">uint8_t bin_bits_</div><div class="ttdoc">Number of bins in exponent of two. </div><div class="ttdef"><b>Definition:</b> <a href="hash__metadata_8hpp_source.html#l00075">hash_metadata.hpp:75</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_ab4578ade774f828985930b8e36269e8e"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e">foedus::storage::hash::HashStoragePimpl::get_meta</a></div><div class="ttdeci">const HashMetadata &amp; get_meta() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00163">hash_storage_pimpl.hpp:163</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aff4c87787f9e6ce9c4306b8bcaf36a47_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aff4c87787f9e6ce9c4306b8bcaf36a47_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aff4c87787f9e6ce9c4306b8bcaf36a47_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aff4c87787f9e6ce9c4306b8bcaf36a47_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="217,13,417,54"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aff4c87787f9e6ce9c4306b8bcaf36a47_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aff4c87787f9e6ce9c4306b8bcaf36a47_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aff4c87787f9e6ce9c4306b8bcaf36a47_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aff4c87787f9e6ce9c4306b8bcaf36a47_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a2823bcc0a488ad58faee46d876db8abe" title="foedus::storage::hash\l::HashStoragePimpl::create" alt="" coords="227,5,410,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="228,71,409,127"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="217,151,420,207"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="229,231,408,287"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a44bc6cd5427daadbee9fd6fcc366af09" title="foedus::storage::hash\l::HashStoragePimpl::load" alt="" coords="233,312,404,353"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="221,378,417,434"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="227,498,410,554"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac77a3ace0e46fc133fa68affc8901409" title="foedus::storage::hash\l::HashStorage::create" alt="" coords="491,5,641,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="492,71,640,127"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="481,151,651,207"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="493,231,639,287"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a200dd1b1b2b5bc937cae55120e1befc9" title="foedus::storage::hash\l::HashStorage::load" alt="" coords="493,312,639,353"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="468,378,664,434"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="485,458,647,514"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="712,378,875,434"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="491,538,641,594"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a38d765f971d163f274b24fa920565074"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a> foedus::storage::hash::HashStoragePimpl::get_bin_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00165">165</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="hash__metadata_8hpp_source.html#l00062">foedus::storage::hash::HashMetadata::get_bin_count()</a>, and <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00163">get_meta()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00076">create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e">get_meta</a>().<a class="code" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html#ac79017c3fbfd8dde111006ba43e97a5e">get_bin_count</a>(); }</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_ab4578ade774f828985930b8e36269e8e"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e">foedus::storage::hash::HashStoragePimpl::get_meta</a></div><div class="ttdeci">const HashMetadata &amp; get_meta() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00163">hash_storage_pimpl.hpp:163</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1HashMetadata_html_ac79017c3fbfd8dde111006ba43e97a5e"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html#ac79017c3fbfd8dde111006ba43e97a5e">foedus::storage::hash::HashMetadata::get_bin_count</a></div><div class="ttdeci">uint64_t get_bin_count() const </div><div class="ttdoc">Number of bins in this hash storage. </div><div class="ttdef"><b>Definition:</b> <a href="hash__metadata_8hpp_source.html#l00062">hash_metadata.hpp:62</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a38d765f971d163f274b24fa920565074_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a38d765f971d163f274b24fa920565074_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a38d765f971d163f274b24fa920565074_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a38d765f971d163f274b24fa920565074_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html#ac79017c3fbfd8dde111006ba43e97a5e" title="Number of bins in this hash storage. " alt="" coords="217,5,420,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="219,71,419,112"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a38d765f971d163f274b24fa920565074_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a38d765f971d163f274b24fa920565074_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a38d765f971d163f274b24fa920565074_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a38d765f971d163f274b24fa920565074_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a2823bcc0a488ad58faee46d876db8abe" title="foedus::storage::hash\l::HashStoragePimpl::create" alt="" coords="217,13,400,54"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac77a3ace0e46fc133fa68affc8901409" title="foedus::storage::hash\l::HashStorage::create" alt="" coords="448,13,597,54"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa792fc726c1bd0f52f3458a78fe8e0ce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t foedus::storage::hash::HashStoragePimpl::get_bin_shifts </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00167">167</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="hash__metadata_8hpp_source.html#l00064">foedus::storage::hash::HashMetadata::get_bin_shifts()</a>, and <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00163">get_meta()</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e">get_meta</a>().<a class="code" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html#abb07207c670562f82b96dd6d51681c4f">get_bin_shifts</a>(); }</div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1HashMetadata_html_abb07207c670562f82b96dd6d51681c4f"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html#abb07207c670562f82b96dd6d51681c4f">foedus::storage::hash::HashMetadata::get_bin_shifts</a></div><div class="ttdeci">uint8_t get_bin_shifts() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__metadata_8hpp_source.html#l00064">hash_metadata.hpp:64</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_ab4578ade774f828985930b8e36269e8e"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e">foedus::storage::hash::HashStoragePimpl::get_meta</a></div><div class="ttdeci">const HashMetadata &amp; get_meta() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00163">hash_storage_pimpl.hpp:163</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa792fc726c1bd0f52f3458a78fe8e0ce_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa792fc726c1bd0f52f3458a78fe8e0ce_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa792fc726c1bd0f52f3458a78fe8e0ce_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa792fc726c1bd0f52f3458a78fe8e0ce_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html#abb07207c670562f82b96dd6d51681c4f" title="foedus::storage::hash\l::HashMetadata::get_bin\l_shifts" alt="" coords="235,5,399,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="217,86,417,127"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abdd0cbf1f438986888173779270bab4a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a> foedus::storage::hash::HashStoragePimpl::get_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00161">161</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00076">create()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00356">delete_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00554">increment_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00277">insert_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00502">overwrite_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00260">register_record_write_log()</a>, and <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00390">upsert_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_.id_; }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_abdd0cbf1f438986888173779270bab4a_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_abdd0cbf1f438986888173779270bab4a_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_abdd0cbf1f438986888173779270bab4a_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_abdd0cbf1f438986888173779270bab4a_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a2823bcc0a488ad58faee46d876db8abe" title="foedus::storage::hash\l::HashStoragePimpl::create" alt="" coords="238,15,421,56"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="483,71,664,127"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="472,151,675,207"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="484,231,663,287"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="475,311,671,367"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1" title="Used in the following methods. " alt="" coords="235,246,424,302"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="482,391,665,447"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac77a3ace0e46fc133fa68affc8901409" title="foedus::storage::hash\l::HashStorage::create" alt="" coords="499,5,648,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="747,71,895,127"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="735,151,906,207"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="747,231,894,287"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="723,311,919,367"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="739,391,902,447"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="967,311,1129,367"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="746,471,895,527"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4120c099e570a27e391917bc7f76ca07"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t foedus::storage::hash::HashStoragePimpl::get_levels </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00164">164</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00076">create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;levels_; }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4120c099e570a27e391917bc7f76ca07_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4120c099e570a27e391917bc7f76ca07_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4120c099e570a27e391917bc7f76ca07_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4120c099e570a27e391917bc7f76ca07_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a2823bcc0a488ad58faee46d876db8abe" title="foedus::storage::hash\l::HashStoragePimpl::create" alt="" coords="217,13,400,54"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac77a3ace0e46fc133fa68affc8901409" title="foedus::storage::hash\l::HashStorage::create" alt="" coords="448,13,597,54"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab4578ade774f828985930b8e36269e8e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashMetadata.html">HashMetadata</a>&amp; foedus::storage::hash::HashStoragePimpl::get_meta </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00163">163</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00166">get_bin_bits()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00165">get_bin_count()</a>, and <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00167">get_bin_shifts()</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_; }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab4578ade774f828985930b8e36269e8e_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab4578ade774f828985930b8e36269e8e_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab4578ade774f828985930b8e36269e8e_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab4578ade774f828985930b8e36269e8e_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_bits" alt="" coords="253,191,417,247"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a38d765f971d163f274b24fa920565074" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_count" alt="" coords="253,34,417,90"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa792fc726c1bd0f52f3458a78fe8e0ce" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_shifts" alt="" coords="253,271,417,327"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a2823bcc0a488ad58faee46d876db8abe" title="foedus::storage::hash\l::HashStoragePimpl::create" alt="" coords="475,5,658,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="476,71,657,127"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="465,151,668,207"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="477,231,656,287"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a44bc6cd5427daadbee9fd6fcc366af09" title="foedus::storage::hash\l::HashStoragePimpl::load" alt="" coords="481,312,652,353"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="469,378,665,434"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="475,498,658,554"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac77a3ace0e46fc133fa68affc8901409" title="foedus::storage::hash\l::HashStorage::create" alt="" coords="739,5,889,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="740,71,888,127"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="729,151,899,207"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="741,231,887,287"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a200dd1b1b2b5bc937cae55120e1befc9" title="foedus::storage::hash\l::HashStorage::load" alt="" coords="741,312,887,353"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="716,378,912,434"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="733,458,895,514"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="960,378,1123,434"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="739,538,889,594"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afdf4bd9f7349768099f6aaf621ff3a70"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacefoedus_1_1storage.html#a0c15c034d49af969335271617a73a846">StorageName</a>&amp; foedus::storage::hash::HashStoragePimpl::get_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00162">162</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00076">create()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00059">drop()</a>, and <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00135">load()</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_.name_; }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afdf4bd9f7349768099f6aaf621ff3a70_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afdf4bd9f7349768099f6aaf621ff3a70_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afdf4bd9f7349768099f6aaf621ff3a70_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afdf4bd9f7349768099f6aaf621ff3a70_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a2823bcc0a488ad58faee46d876db8abe" title="foedus::storage::hash\l::HashStoragePimpl::create" alt="" coords="256,5,439,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a79c499b589d9e31709b066f1457bc1e3" title="foedus::storage::hash\l::HashStoragePimpl::drop" alt="" coords="262,71,433,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a44bc6cd5427daadbee9fd6fcc366af09" title="foedus::storage::hash\l::HashStoragePimpl::load" alt="" coords="262,136,433,177"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac77a3ace0e46fc133fa68affc8901409" title="foedus::storage::hash\l::HashStorage::create" alt="" coords="487,5,636,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ab5edd3becb0d83ffab431754e2d80118" title="foedus::storage::hash\l::HashStorage::drop" alt="" coords="488,71,635,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a200dd1b1b2b5bc937cae55120e1befc9" title="foedus::storage::hash\l::HashStorage::load" alt="" coords="488,136,635,177"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a222e0d485305f3253b0e1c97720dc0c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::get_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>payload_capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>read_only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a13470768ac9156eb4861e1389ab6d069" title="Retrieves an entire payload of the given key in this hash storage. ">foedus::storage::hash::HashStorage::get_record()</a> </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00166">166</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00086">foedus::storage::hash::RecordLocation::cur_payload_length_</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00109">foedus::storage::hash::RecordLocation::get_aligned_key_length()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00108">foedus::storage::hash::RecordLocation::is_found()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="error__code_8hpp_source.html#l00175">foedus::kErrorCodeStrTooSmallPayloadBuffer</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00842">locate_bin()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00400">locate_record_logical()</a>, and <a class="el" href="hash__record__location_8hpp_source.html#l00093">foedus::storage::hash::RecordLocation::record_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00080">foedus::storage::hash::HashStorage::get_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                  {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  HashDataPage* bin_head;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">locate_bin</a>(context, !read_only, combo, &amp;bin_head));</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">if</span> (!bin_head) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;  <span class="comment">// protected by pointer set, so we are done</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  RecordLocation location;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">locate_record_logical</a>(</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    context,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    !read_only,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keyword">false</span>,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    0,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    key,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    key_length,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    combo,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    bin_head,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    &amp;location));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">if</span> (!location.is_found()) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;  <span class="comment">// protected by page version set, so we are done</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// here, we do NOT have to do another optimistic-read protocol because we already took</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// the owner_id into read-set. If this read is corrupted, we will be aware of it at commit time.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  uint16_t payload_length = location.cur_payload_length_;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">if</span> (payload_length &gt; *payload_capacity) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// buffer too small</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    DVLOG(0) &lt;&lt; <span class="stringliteral">&quot;buffer too small??&quot;</span> &lt;&lt; payload_length &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; *payload_capacity;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    *payload_capacity = payload_length;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae0409810fc5028d8885fe6025cb6fdbe">kErrorCodeStrTooSmallPayloadBuffer</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  *payload_capacity = payload_length;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  uint16_t key_offset = location.get_aligned_key_length();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  std::memcpy(payload, location.record_ + key_offset, payload_length);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a07025464a0eba08710f6fa92d7c0f32d"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">foedus::storage::hash::HashStoragePimpl::locate_record_logical</a></div><div class="ttdeci">ErrorCode locate_record_logical(thread::Thread *context, bool for_write, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const HashCombo &amp;combo, HashDataPage *bin_head, RecordLocation *result)</div><div class="ttdoc">locate_record()&#39;s logical+physical version. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00400">hash_storage_pimpl.hpp:400</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a0f073a76a5abeac0829ba1e47a40c02c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">foedus::storage::hash::HashStoragePimpl::locate_bin</a></div><div class="ttdeci">ErrorCode locate_bin(thread::Thread *context, bool for_write, const HashCombo &amp;combo, HashDataPage **bin_head)</div><div class="ttdoc">Find a pointer to the bin that contains records for the hash. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00842">hash_storage_pimpl.cpp:842</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ae0409810fc5028d8885fe6025cb6fdbe"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae0409810fc5028d8885fe6025cb6fdbe">foedus::kErrorCodeStrTooSmallPayloadBuffer</a></div><div class="ttdoc">0x0809 : "STORAGE: The record&#39;s payload is larger than the buffer" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00175">error_code.hpp:175</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a222e0d485305f3253b0e1c97720dc0c8_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a222e0d485305f3253b0e1c97720dc0c8_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a222e0d485305f3253b0e1c97720dc0c8_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a222e0d485305f3253b0e1c97720dc0c8_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#abed92a9a4809cce3c1cc33bc4fb07a81" title="foedus::storage::hash\l::RecordLocation::get\l_aligned_key_length" alt="" coords="247,64,393,120"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab29603dc5748833bc006e129a152a4d1" title="foedus::storage::hash\l::RecordLocation::is_found" alt="" coords="232,286,408,327"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="217,351,423,393"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="229,1009,411,1065"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="497,5,657,32"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="495,395,659,451"/>
<area shape="rect" id="node12" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1538,507,1677,549"/>
<area shape="rect" id="node13" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="1537,246,1678,287"/>
<area shape="rect" id="node14" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="1001,1107,1152,1149"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="996,237,1157,293"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="471,554,684,595"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="996,318,1157,359"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="993,1369,1160,1410"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="996,157,1157,213"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="747,923,909,979"/>
<area shape="rect" id="node7" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1001,383,1152,425"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1250,566,1434,607"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1527,1057,1688,1098"/>
<area shape="rect" id="node11" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1503,678,1712,719"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1760,1027,1921,1069"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1247,245,1437,286"/>
<area shape="rect" id="node18" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="972,1303,1181,1345"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="739,712,917,768"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="981,449,1172,490"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="747,843,909,899"/>
<area shape="rect" id="node36" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="737,579,919,635"/>
<area shape="rect" id="node21" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="990,793,1163,834"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#ac8953b86c90ec5ee1730b05397a259da" title="Returns page resolver to convert only local page ID to page pointer. " alt="" coords="995,859,1158,915"/>
<area shape="rect" id="node24" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="1001,1238,1152,1279"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="980,939,1173,981"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#aa72388dc98c566a63c723184449a830f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer_address" alt="" coords="996,565,1157,621"/>
<area shape="rect" id="node28" href="classfoedus_1_1thread_1_1Thread.html#a4e553f5e14ec00d8ba23fbdfa26d687e" title="Returns the private memory repository of this thread. " alt="" coords="1001,646,1152,687"/>
<area shape="rect" id="node29" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="985,712,1169,768"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="995,1566,1159,1607"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="1001,1485,1152,1541"/>
<area shape="rect" id="node33" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="1001,1173,1152,1214"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="487,1669,668,1725"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="737,1637,919,1693"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a490056e5b2e5617cf640ea99d278ac21" title="foedus::storage::hash\l::RecordLocation::clear" alt="" coords="999,2023,1155,2065"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="1229,1783,1455,1825"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="995,1915,1159,1971"/>
<area shape="rect" id="node43" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="1281,2057,1403,2098"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="989,1835,1164,1891"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab1d971d633ca8153c6a7363694e254a0" title="Populates fields other than readset_. " alt="" coords="988,2104,1165,2160"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a5c39383806af101855b26268abbb00e3" title="Populates the result with XID and possibly readset. " alt="" coords="739,2249,917,2305"/>
<area shape="rect" id="node47" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="741,1819,915,1861"/>
<area shape="rect" id="node48" href="structfoedus_1_1storage_1_1PageVersionStatus.html#a8360836cebd9fbeadfeb2a31809270c2" title="foedus::storage::PageVersion\lStatus::has_next_page" alt="" coords="732,1885,924,1926"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34" title="Subroutine of locate_record() to create/migrate a physical record of the given key in the page or its..." alt="" coords="737,1951,919,2007"/>
<area shape="rect" id="node50" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="755,2031,901,2073"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a222e0d485305f3253b0e1c97720dc0c8_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a222e0d485305f3253b0e1c97720dc0c8_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a222e0d485305f3253b0e1c97720dc0c8_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a222e0d485305f3253b0e1c97720dc0c8_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af64f22f350167426098b6a99c15f864d" title="If you have already computed HashCombo, use this. " alt="" coords="217,13,392,54"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4eff8bc4e42a5973c8553830890d8a24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::get_record_part </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>read_only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a773c773d3720c7781118cbff88618b25" title="Retrieves a part of the given key in this hash storage. ">foedus::storage::hash::HashStorage::get_record_part()</a> </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00210">210</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00086">foedus::storage::hash::RecordLocation::cur_payload_length_</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00109">foedus::storage::hash::RecordLocation::get_aligned_key_length()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00108">foedus::storage::hash::RecordLocation::is_found()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="error__code_8hpp_source.html#l00176">foedus::kErrorCodeStrTooShortPayload</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00842">locate_bin()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00400">locate_record_logical()</a>, and <a class="el" href="hash__record__location_8hpp_source.html#l00093">foedus::storage::hash::RecordLocation::record_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00099">foedus::storage::hash::HashStorage::get_record_part()</a>, and <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00181">get_record_primitive()</a>.</p>
<div class="fragment"><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                  {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  HashDataPage* bin_head;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">locate_bin</a>(context, !read_only, combo, &amp;bin_head));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span> (!bin_head) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;  <span class="comment">// protected by pointer set, so we are done</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  RecordLocation location;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">locate_record_logical</a>(</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    context,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    !read_only,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keyword">false</span>,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    0,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    key,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    key_length,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    combo,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    bin_head,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    &amp;location));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">if</span> (!location.is_found()) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;  <span class="comment">// protected by page version set, so we are done</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  uint16_t payload_length = location.cur_payload_length_;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span> (payload_length &lt; payload_offset + payload_count) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;short record &quot;</span> &lt;&lt; combo;  <span class="comment">// probably this is a rare error. so warn.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">kErrorCodeStrTooShortPayload</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  uint16_t key_offset = location.get_aligned_key_length();</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  std::memcpy(payload, location.record_ + key_offset + payload_offset, payload_count);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">foedus::kErrorCodeStrTooShortPayload</a></div><div class="ttdoc">0x080A : "STORAGE: The record&#39;s payload is smaller than requested" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00176">error_code.hpp:176</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a07025464a0eba08710f6fa92d7c0f32d"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">foedus::storage::hash::HashStoragePimpl::locate_record_logical</a></div><div class="ttdeci">ErrorCode locate_record_logical(thread::Thread *context, bool for_write, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const HashCombo &amp;combo, HashDataPage *bin_head, RecordLocation *result)</div><div class="ttdoc">locate_record()&#39;s logical+physical version. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00400">hash_storage_pimpl.hpp:400</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a0f073a76a5abeac0829ba1e47a40c02c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">foedus::storage::hash::HashStoragePimpl::locate_bin</a></div><div class="ttdeci">ErrorCode locate_bin(thread::Thread *context, bool for_write, const HashCombo &amp;combo, HashDataPage **bin_head)</div><div class="ttdoc">Find a pointer to the bin that contains records for the hash. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00842">hash_storage_pimpl.cpp:842</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4eff8bc4e42a5973c8553830890d8a24_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4eff8bc4e42a5973c8553830890d8a24_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4eff8bc4e42a5973c8553830890d8a24_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4eff8bc4e42a5973c8553830890d8a24_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#abed92a9a4809cce3c1cc33bc4fb07a81" title="foedus::storage::hash\l::RecordLocation::get\l_aligned_key_length" alt="" coords="247,64,393,120"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab29603dc5748833bc006e129a152a4d1" title="foedus::storage::hash\l::RecordLocation::is_found" alt="" coords="232,286,408,327"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="217,351,423,393"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="229,1009,411,1065"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="497,5,657,32"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="495,395,659,451"/>
<area shape="rect" id="node12" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1538,507,1677,549"/>
<area shape="rect" id="node13" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="1537,246,1678,287"/>
<area shape="rect" id="node14" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="1001,1107,1152,1149"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="996,237,1157,293"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="471,554,684,595"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="996,318,1157,359"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="993,1369,1160,1410"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="996,157,1157,213"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="747,923,909,979"/>
<area shape="rect" id="node7" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1001,383,1152,425"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1250,566,1434,607"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1527,1057,1688,1098"/>
<area shape="rect" id="node11" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1503,678,1712,719"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1760,1027,1921,1069"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1247,245,1437,286"/>
<area shape="rect" id="node18" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="972,1303,1181,1345"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="739,712,917,768"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="981,449,1172,490"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="747,843,909,899"/>
<area shape="rect" id="node36" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="737,579,919,635"/>
<area shape="rect" id="node21" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="990,793,1163,834"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#ac8953b86c90ec5ee1730b05397a259da" title="Returns page resolver to convert only local page ID to page pointer. " alt="" coords="995,859,1158,915"/>
<area shape="rect" id="node24" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="1001,1238,1152,1279"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="980,939,1173,981"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#aa72388dc98c566a63c723184449a830f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer_address" alt="" coords="996,565,1157,621"/>
<area shape="rect" id="node28" href="classfoedus_1_1thread_1_1Thread.html#a4e553f5e14ec00d8ba23fbdfa26d687e" title="Returns the private memory repository of this thread. " alt="" coords="1001,646,1152,687"/>
<area shape="rect" id="node29" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="985,712,1169,768"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="995,1566,1159,1607"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="1001,1485,1152,1541"/>
<area shape="rect" id="node33" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="1001,1173,1152,1214"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="487,1669,668,1725"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="737,1637,919,1693"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a490056e5b2e5617cf640ea99d278ac21" title="foedus::storage::hash\l::RecordLocation::clear" alt="" coords="999,2023,1155,2065"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="1229,1783,1455,1825"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="995,1915,1159,1971"/>
<area shape="rect" id="node43" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="1281,2057,1403,2098"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="989,1835,1164,1891"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab1d971d633ca8153c6a7363694e254a0" title="Populates fields other than readset_. " alt="" coords="988,2104,1165,2160"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a5c39383806af101855b26268abbb00e3" title="Populates the result with XID and possibly readset. " alt="" coords="739,2249,917,2305"/>
<area shape="rect" id="node47" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="741,1819,915,1861"/>
<area shape="rect" id="node48" href="structfoedus_1_1storage_1_1PageVersionStatus.html#a8360836cebd9fbeadfeb2a31809270c2" title="foedus::storage::PageVersion\lStatus::has_next_page" alt="" coords="732,1885,924,1926"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34" title="Subroutine of locate_record() to create/migrate a physical record of the given key in the page or its..." alt="" coords="737,1951,919,2007"/>
<area shape="rect" id="node50" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="755,2031,901,2073"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4eff8bc4e42a5973c8553830890d8a24_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4eff8bc4e42a5973c8553830890d8a24_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4eff8bc4e42a5973c8553830890d8a24_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a4eff8bc4e42a5973c8553830890d8a24_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac9ae382b1110aec44a1df2a768c4cee3" title="If you have already computed HashCombo, use this. " alt="" coords="217,5,420,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a660df9f0d685df28fbe19f52cdbdc7e2" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_primitive" alt="" coords="237,71,401,127"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac8f3eb87098b114b9d4f8b151fee17c1" title="If you have already computed HashCombo, use this. " alt="" coords="468,71,643,127"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a660df9f0d685df28fbe19f52cdbdc7e2"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename PAYLOAD &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::get_record_primitive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PAYLOAD *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>read_only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a6a09eacbb9becb0a3ace38fea3cb950b" title="Retrieves a part of the given key in this storage as a primitive value. ">foedus::storage::hash::HashStorage::get_record_primitive()</a> </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00181">181</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00210">get_record_part()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00121">foedus::storage::hash::HashStorage::get_record_primitive()</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// at this point, there isn&#39;t enough benefit to do optimization specific to this case.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// hash-lookup is anyway dominant. memcpy-vs-primitive is not the issue.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24">get_record_part</a>(</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      context,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      key,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      key_length,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      combo,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      payload,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      payload_offset,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keyword">sizeof</span>(PAYLOAD),</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      read_only);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a4eff8bc4e42a5973c8553830890d8a24"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24">foedus::storage::hash::HashStoragePimpl::get_record_part</a></div><div class="ttdeci">ErrorCode get_record_part(thread::Thread *context, const void *key, uint16_t key_length, const HashCombo &amp;combo, void *payload, uint16_t payload_offset, uint16_t payload_count, bool read_only)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00210">hash_storage_pimpl.cpp:210</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a660df9f0d685df28fbe19f52cdbdc7e2_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a660df9f0d685df28fbe19f52cdbdc7e2_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a660df9f0d685df28fbe19f52cdbdc7e2_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a660df9f0d685df28fbe19f52cdbdc7e2_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_part" alt="" coords="217,239,381,295"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#abed92a9a4809cce3c1cc33bc4fb07a81" title="foedus::storage::hash\l::RecordLocation::get\l_aligned_key_length" alt="" coords="459,43,605,99"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab29603dc5748833bc006e129a152a4d1" title="foedus::storage::hash\l::RecordLocation::is_found" alt="" coords="444,213,620,254"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="429,278,635,319"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="441,959,623,1015"/>
<area shape="rect" id="node4" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="709,5,869,32"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="707,676,871,732"/>
<area shape="rect" id="node13" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1750,509,1889,550"/>
<area shape="rect" id="node14" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="1749,246,1890,287"/>
<area shape="rect" id="node15" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="1213,1029,1364,1070"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="1208,157,1369,213"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="683,517,896,558"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="1208,238,1369,279"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="1205,1290,1372,1331"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="1208,304,1369,360"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="959,309,1121,365"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1213,450,1364,491"/>
<area shape="rect" id="node9" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1462,567,1646,609"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1739,978,1900,1019"/>
<area shape="rect" id="node12" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1715,659,1924,701"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1972,949,2133,990"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1459,165,1649,206"/>
<area shape="rect" id="node19" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1184,1225,1393,1266"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="951,803,1129,859"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1193,385,1384,426"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="959,672,1121,728"/>
<area shape="rect" id="node36" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="949,541,1131,597"/>
<area shape="rect" id="node22" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1202,567,1375,609"/>
<area shape="rect" id="node24" href="classfoedus_1_1thread_1_1Thread.html#ac8953b86c90ec5ee1730b05397a259da" title="Returns page resolver to convert only local page ID to page pointer. " alt="" coords="1207,633,1370,689"/>
<area shape="rect" id="node25" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="1213,1094,1364,1135"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="1192,714,1385,755"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#aa72388dc98c566a63c723184449a830f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer_address" alt="" coords="1208,780,1369,836"/>
<area shape="rect" id="node29" href="classfoedus_1_1thread_1_1Thread.html#a4e553f5e14ec00d8ba23fbdfa26d687e" title="Returns the private memory repository of this thread. " alt="" coords="1213,861,1364,902"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="1207,1487,1371,1529"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="1213,1407,1364,1463"/>
<area shape="rect" id="node33" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="1213,1159,1364,1201"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="699,1613,880,1669"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="949,1523,1131,1579"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a490056e5b2e5617cf640ea99d278ac21" title="foedus::storage::hash\l::RecordLocation::clear" alt="" coords="1211,1953,1367,1994"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="1441,1745,1667,1786"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="1207,1836,1371,1892"/>
<area shape="rect" id="node43" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="1493,1985,1615,2026"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="1201,1705,1376,1761"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab1d971d633ca8153c6a7363694e254a0" title="Populates fields other than readset_. " alt="" coords="1200,2037,1377,2093"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a5c39383806af101855b26268abbb00e3" title="Populates the result with XID and possibly readset. " alt="" coords="951,2185,1129,2241"/>
<area shape="rect" id="node47" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="953,1755,1127,1797"/>
<area shape="rect" id="node48" href="structfoedus_1_1storage_1_1PageVersionStatus.html#a8360836cebd9fbeadfeb2a31809270c2" title="foedus::storage::PageVersion\lStatus::has_next_page" alt="" coords="944,1821,1136,1862"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34" title="Subroutine of locate_record() to create/migrate a physical record of the given key in the page or its..." alt="" coords="949,1887,1131,1943"/>
<area shape="rect" id="node50" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="967,1967,1113,2009"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a660df9f0d685df28fbe19f52cdbdc7e2_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a660df9f0d685df28fbe19f52cdbdc7e2_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a660df9f0d685df28fbe19f52cdbdc7e2_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a660df9f0d685df28fbe19f52cdbdc7e2_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac8f3eb87098b114b9d4f8b151fee17c1" title="If you have already computed HashCombo, use this. " alt="" coords="217,5,392,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a579927a24cc690c8d4d6362bcb9e8538"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::get_root_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> **&#160;</td>
          <td class="paramname"><em>root</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the root page of this storage. </p>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00607">607</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00353">foedus::thread::Thread::follow_page_pointer()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, and <a class="el" href="page_8hpp_source.html#l00053">foedus::storage::kHashIntermediatePageType</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00842">locate_bin()</a>.</p>
<div class="fragment"><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                               {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;follow_page_pointer(</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keyword">nullptr</span>,  <span class="comment">// guaranteed to be non-null</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keyword">false</span>,    <span class="comment">// guaranteed to be non-null</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    for_write,</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keyword">false</span>,    <span class="comment">// guaranteed to be non-null</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    &amp;<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    reinterpret_cast&lt;Page**&gt;(root),</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keyword">nullptr</span>,  <span class="comment">// no parent. it&#39;s root.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    0));</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*root)-&gt;header().get_page_type() == <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714">kHashIntermediatePageType</a>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*root)-&gt;get_level() + 1U == <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;levels_);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714"><div class="ttname"><a href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714">foedus::storage::kHashIntermediatePageType</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00053">page.hpp:53</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a579927a24cc690c8d4d6362bcb9e8538_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a579927a24cc690c8d4d6362bcb9e8538_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a579927a24cc690c8d4d6362bcb9e8538_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a579927a24cc690c8d4d6362bcb9e8538_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="217,478,368,519"/>
<area shape="rect" id="node3" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="416,478,600,519"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1162,270,1323,311"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1707,417,1857,458"/>
<area shape="rect" id="node7" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1137,685,1348,726"/>
<area shape="rect" id="node10" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1151,387,1335,443"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1162,619,1323,661"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1440,151,1595,193"/>
<area shape="rect" id="node15" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343" title="Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v..." alt="" coords="891,478,1078,519"/>
<area shape="rect" id="node19" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1141,65,1344,106"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="648,507,832,549"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="880,919,1089,961"/>
<area shape="rect" id="node49" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="671,827,809,869"/>
<area shape="rect" id="node50" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="669,893,811,934"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1701,270,1863,311"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ac661b8baf462a1e969a8a1c7e619858b" title="foedus::memory::PagePool\lOffsetChunk::empty" alt="" coords="1936,823,2115,865"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#af897b38ac1ef4217ff99018436c0112e" title="foedus::memory::PagePool\lOffsetChunk::pop_back" alt="" coords="1693,823,1871,865"/>
<area shape="rect" id="node13" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1705,50,1859,91"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1687,151,1877,193"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a6c9bf7d6b21ac33a61d6f7176023ea3a" title="Returns one free volatile page to local page pool. " alt="" coords="1403,619,1631,661"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ace44cb03e7da84d29f3a02a790c69191" title="foedus::memory::PagePool\lOffsetChunk::full" alt="" coords="1936,630,2115,671"/>
<area shape="rect" id="node18" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#a6f558bb023b2c5c7dd9bf7ab9d054ef0" title="foedus::memory::PagePool\lOffsetChunk::push_back" alt="" coords="1693,630,1871,671"/>
<area shape="rect" id="node20" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1431,86,1604,127"/>
<area shape="rect" id="node21" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1416,5,1619,61"/>
<area shape="rect" id="node48" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="893,595,1077,651"/>
<area shape="rect" id="node24" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="1175,1157,1310,1198"/>
<area shape="rect" id="node25" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="1139,1342,1346,1383"/>
<area shape="rect" id="node35" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8" title="foedus::memory::PagePool\l::get_base" alt="" coords="1428,853,1607,894"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="1151,886,1335,927"/>
<area shape="rect" id="node38" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="1425,983,1609,1025"/>
<area shape="rect" id="node44" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="1139,1091,1346,1133"/>
<area shape="rect" id="node47" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8" title="Get a tentative work memory of the specified size from pre&#45;allocated thread&#45;private memory..." alt="" coords="1161,951,1324,993"/>
<area shape="rect" id="node26" href="classfoedus_1_1cache_1_1CacheHashtable.html#a30b6a0b28cce30d50da7e0419c8cad20" title="Returns a bucket number the given page ID should belong to. " alt="" coords="1414,1245,1621,1286"/>
<area shape="rect" id="node28" href="structfoedus_1_1cache_1_1CacheBucket.html#ab91d1b89c885979b7a6a4ef70b12b54d" title="foedus::cache::CacheBucket\l::get_content_id" alt="" coords="1423,1310,1612,1351"/>
<area shape="rect" id="node29" href="classfoedus_1_1cache_1_1CacheHashtable.html#acea3236385a3b8d05ed1a60186e32ee8" title="foedus::cache::CacheHashtable\l::get_logical_buckets" alt="" coords="1414,1375,1621,1417"/>
<area shape="rect" id="node30" href="structfoedus_1_1cache_1_1HashFunc.html#a9470855bb66d98df48f82fc5ba6655c6" title="Returns another hash value used to differentiate IDs with similar hash values. " alt="" coords="1432,1179,1603,1221"/>
<area shape="rect" id="node31" href="structfoedus_1_1cache_1_1CacheBucket.html#aad7099f48418a335a80260a664bf2f02" title="foedus::cache::CacheBucket\l::get_tag" alt="" coords="1423,1441,1612,1482"/>
<area shape="rect" id="node32" href="structfoedus_1_1cache_1_1CacheRefCount.html#af555d7665e995d8e65f315c708d28daa" title="foedus::cache::CacheRefCount\l::increment" alt="" coords="1417,1506,1618,1547"/>
<area shape="rect" id="node33" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="1431,1571,1603,1613"/>
<area shape="rect" id="node27" href="structfoedus_1_1cache_1_1HashFunc.html#a19737fa3c91676f9c85536f5928b7501" title="Returns a bucket number the given snapshot page ID should belong to. " alt="" coords="1697,1245,1867,1286"/>
<area shape="rect" id="node34" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1696,1571,1868,1613"/>
<area shape="rect" id="node37" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ac3e2f6d24f2b0f5c04d2cde48db11f6a" title="Same, except it&#39;s for snapshot page. " alt="" coords="1405,918,1630,959"/>
<area shape="rect" id="node43" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a7ea5067e450fa872240cb010ddb65464" title="Same, except it&#39;s for snapshot page. " alt="" coords="1396,685,1639,726"/>
<area shape="rect" id="node39" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="1689,983,1875,1025"/>
<area shape="rect" id="node40" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="1925,976,2125,1032"/>
<area shape="rect" id="node41" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="1932,1057,2119,1098"/>
<area shape="rect" id="node42" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="1950,910,2101,951"/>
<area shape="rect" id="node45" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7" title="Equivalent to std::atomic_thread_fence(std::memory_order_release). " alt="" coords="1431,1114,1604,1155"/>
<area shape="rect" id="node46" href="structfoedus_1_1cache_1_1CacheBucket.html#aaa52396996e73a08cace2a2dcef82ffb" title="foedus::cache::CacheBucket\l::reset" alt="" coords="1423,1049,1612,1090"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a579927a24cc690c8d4d6362bcb9e8538_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a579927a24cc690c8d4d6362bcb9e8538_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a579927a24cc690c8d4d6362bcb9e8538_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a579927a24cc690c8d4d6362bcb9e8538_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="217,304,423,345"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a222e0d485305f3253b0e1c97720dc0c8" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record" alt="" coords="490,27,654,83"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_part" alt="" coords="490,137,654,193"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="483,217,661,273"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="481,297,663,353"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="481,377,663,433"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="474,457,670,513"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="471,577,673,633"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af64f22f350167426098b6a99c15f864d" title="If you have already computed HashCombo, use this. " alt="" coords="735,5,910,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac9ae382b1110aec44a1df2a768c4cee3" title="If you have already computed HashCombo, use this. " alt="" coords="721,71,924,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a660df9f0d685df28fbe19f52cdbdc7e2" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_primitive" alt="" coords="741,137,905,193"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac8f3eb87098b114b9d4f8b151fee17c1" title="If you have already computed HashCombo, use this. " alt="" coords="972,137,1147,193"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="749,217,896,273"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="749,297,897,353"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="748,377,897,433"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="725,457,921,513"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="741,537,904,593"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="978,457,1141,513"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="737,617,908,673"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9075ef5e205fc3e6284e56894b1c8c4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::hcc_reset_all_temperature_stat </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For stupid reasons (I'm lazy!) these are defined in _debug.cpp. </p>

<p>Definition at line <a class="el" href="hash__storage__debug_8cpp_source.html#l00213">213</a> of file <a class="el" href="hash__storage__debug_8cpp_source.html">hash_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a>, <a class="el" href="hash__storage__debug_8cpp_source.html#l00231">hcc_reset_all_temperature_stat_intermediate()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00273">foedus::storage::hash::HashStorage::hcc_reset_all_temperature_stat()</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                                            {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;**&quot;</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***************************************************************&quot;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***   Reseting &quot;</span> &lt;&lt; HashStorage(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>, <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>) &lt;&lt; <span class="stringliteral">&quot;&#39;s &quot;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;*** temperature stat for HCC&quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***************************************************************&quot;</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  DualPagePointer pointer = <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span> (pointer.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;No volatile pages.&quot;</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aece3aacb3a8a9fd362fbad83321cacaf">hcc_reset_all_temperature_stat_intermediate</a>(pointer.volatile_pointer_));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Done resettting&quot;</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aece3aacb3a8a9fd362fbad83321cacaf"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aece3aacb3a8a9fd362fbad83321cacaf">foedus::storage::hash::HashStoragePimpl::hcc_reset_all_temperature_stat_intermediate</a></div><div class="ttdeci">ErrorStack hcc_reset_all_temperature_stat_intermediate(VolatilePagePointer intermediate_page_id)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__debug_8cpp_source.html#l00231">hash_storage_debug.cpp:231</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a9075ef5e205fc3e6284e56894b1c8c4b_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a9075ef5e205fc3e6284e56894b1c8c4b_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a9075ef5e205fc3e6284e56894b1c8c4b_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a9075ef5e205fc3e6284e56894b1c8c4b_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aece3aacb3a8a9fd362fbad83321cacaf" title="foedus::storage::hash\l::HashStoragePimpl::hcc\l_reset_all_temperature\l_stat_intermediate" alt="" coords="236,194,403,265"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="690,406,851,447"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="703,103,838,145"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="665,195,876,251"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="453,5,615,61"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="453,136,615,192"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab283888fe4b6038d8885f385a136f40b" title="foedus::storage::hash\l::HashStoragePimpl::hcc\l_reset_all_temperature\l_stat_data" alt="" coords="451,267,617,338"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="675,13,866,54"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="924,406,1085,447"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="689,341,853,382"/>
<area shape="rect" id="node12" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="671,275,870,317"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a9075ef5e205fc3e6284e56894b1c8c4b_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a9075ef5e205fc3e6284e56894b1c8c4b_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a9075ef5e205fc3e6284e56894b1c8c4b_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a9075ef5e205fc3e6284e56894b1c8c4b_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ace67899d434503ffa7b9ca4b35e2f36c" title="Resets all volatile pages&#39; temperature stat to be zero in this storage. " alt="" coords="236,5,407,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab283888fe4b6038d8885f385a136f40b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::hcc_reset_all_temperature_stat_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a>&#160;</td>
          <td class="paramname"><em>head_page_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__debug_8cpp_source.html#l00253">253</a> of file <a class="el" href="hash__storage__debug_8cpp_source.html">hash_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00225">foedus::storage::hash::HashDataPage::header()</a>, <a class="el" href="page_8hpp_source.html#l00268">foedus::storage::PageHeader::hotness_</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, and <a class="el" href="prob__counter_8hpp_source.html#l00049">foedus::assorted::ProbCounter::reset()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__debug_8cpp_source.html#l00231">hcc_reset_all_temperature_stat_intermediate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                                                                                 {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resolver = <a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">get_global_volatile_page_resolver</a>();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  HashDataPage* head = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(resolver.resolve_offset(head_page_id));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">for</span> (HashDataPage* cur = head; cur;) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    cur-&gt;header().hotness_.reset();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    VolatilePagePointer next_id = cur-&gt;next_page().volatile_pointer_;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    cur = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span> (!next_id.is_null()) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      cur = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(resolver.resolve_offset(next_id));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a62b2d4de6a72644e9e31d35a7f9beae0"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">foedus::memory::EngineMemory::get_global_volatile_page_resolver</a></div><div class="ttdeci">const GlobalVolatilePageResolver &amp; get_global_volatile_page_resolver() const </div><div class="ttdoc">Returns the page resolver to convert volatile page ID to page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00090">engine_memory.hpp:90</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab283888fe4b6038d8885f385a136f40b_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab283888fe4b6038d8885f385a136f40b_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab283888fe4b6038d8885f385a136f40b_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab283888fe4b6038d8885f385a136f40b_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="220,5,431,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="258,86,393,127"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="243,151,407,193"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="245,217,406,258"/>
<area shape="rect" id="node7" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="226,282,425,323"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="479,217,640,258"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab283888fe4b6038d8885f385a136f40b_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab283888fe4b6038d8885f385a136f40b_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab283888fe4b6038d8885f385a136f40b_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ab283888fe4b6038d8885f385a136f40b_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aece3aacb3a8a9fd362fbad83321cacaf" title="foedus::storage::hash\l::HashStoragePimpl::hcc\l_reset_all_temperature\l_stat_intermediate" alt="" coords="220,5,387,76"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a9075ef5e205fc3e6284e56894b1c8c4b" title="For stupid reasons (I&#39;m lazy!) these are defined in _debug.cpp. " alt="" coords="435,13,617,69"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ace67899d434503ffa7b9ca4b35e2f36c" title="Resets all volatile pages&#39; temperature stat to be zero in this storage. " alt="" coords="665,13,836,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aece3aacb3a8a9fd362fbad83321cacaf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::hcc_reset_all_temperature_stat_intermediate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a>&#160;</td>
          <td class="paramname"><em>intermediate_page_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__debug_8cpp_source.html#l00231">231</a> of file <a class="el" href="hash__storage__debug_8cpp_source.html">hash_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00105">foedus::storage::hash::HashIntermediatePage::get_level()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00080">foedus::storage::hash::HashIntermediatePage::get_pointer()</a>, <a class="el" href="hash__storage__debug_8cpp_source.html#l00253">hcc_reset_all_temperature_stat_data()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="hash__id_8hpp_source.html#l00049">foedus::storage::hash::kHashIntermediatePageFanout</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__debug_8cpp_source.html#l00213">hcc_reset_all_temperature_stat()</a>.</p>
<div class="fragment"><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                            {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resolver = <a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">get_global_volatile_page_resolver</a>();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  HashIntermediatePage* page</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    = <span class="keyword">reinterpret_cast&lt;</span>HashIntermediatePage*<span class="keyword">&gt;</span>(resolver.resolve_offset(intermediate_page_id));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bottom = page-&gt;get_level() == 0;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code" href="group__HASH.html#ga4398665205e13bd71e8b2c1691ba1ba3">kHashIntermediatePageFanout</a>; ++i) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    DualPagePointer pointer = page-&gt;get_pointer(i);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (pointer.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (bottom) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab283888fe4b6038d8885f385a136f40b">hcc_reset_all_temperature_stat_data</a>(pointer.volatile_pointer_));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aece3aacb3a8a9fd362fbad83321cacaf">hcc_reset_all_temperature_stat_intermediate</a>(pointer.volatile_pointer_));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a62b2d4de6a72644e9e31d35a7f9beae0"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">foedus::memory::EngineMemory::get_global_volatile_page_resolver</a></div><div class="ttdeci">const GlobalVolatilePageResolver &amp; get_global_volatile_page_resolver() const </div><div class="ttdoc">Returns the page resolver to convert volatile page ID to page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00090">engine_memory.hpp:90</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aece3aacb3a8a9fd362fbad83321cacaf"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aece3aacb3a8a9fd362fbad83321cacaf">foedus::storage::hash::HashStoragePimpl::hcc_reset_all_temperature_stat_intermediate</a></div><div class="ttdeci">ErrorStack hcc_reset_all_temperature_stat_intermediate(VolatilePagePointer intermediate_page_id)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__debug_8cpp_source.html#l00231">hash_storage_debug.cpp:231</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_ab283888fe4b6038d8885f385a136f40b"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab283888fe4b6038d8885f385a136f40b">foedus::storage::hash::HashStoragePimpl::hcc_reset_all_temperature_stat_data</a></div><div class="ttdeci">ErrorStack hcc_reset_all_temperature_stat_data(VolatilePagePointer head_page_id)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__debug_8cpp_source.html#l00253">hash_storage_debug.cpp:253</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="group__HASH_html_ga4398665205e13bd71e8b2c1691ba1ba3"><div class="ttname"><a href="group__HASH.html#ga4398665205e13bd71e8b2c1691ba1ba3">foedus::storage::hash::kHashIntermediatePageFanout</a></div><div class="ttdeci">const uint8_t kHashIntermediatePageFanout</div><div class="ttdoc">Number of pointers in an intermediate page of hash storage. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00049">hash_id.hpp:49</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aece3aacb3a8a9fd362fbad83321cacaf_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aece3aacb3a8a9fd362fbad83321cacaf_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aece3aacb3a8a9fd362fbad83321cacaf_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aece3aacb3a8a9fd362fbad83321cacaf_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="435,5,645,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="223,291,384,347"/>
<area shape="rect" id="node5" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="473,86,607,127"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="223,371,384,427"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab283888fe4b6038d8885f385a136f40b" title="foedus::storage::hash\l::HashStoragePimpl::hcc\l_reset_all_temperature\l_stat_data" alt="" coords="220,145,387,215"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="459,282,621,323"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="445,347,635,389"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="458,151,622,193"/>
<area shape="rect" id="node11" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="441,217,639,258"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="693,282,855,323"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aece3aacb3a8a9fd362fbad83321cacaf_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aece3aacb3a8a9fd362fbad83321cacaf_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aece3aacb3a8a9fd362fbad83321cacaf_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aece3aacb3a8a9fd362fbad83321cacaf_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a9075ef5e205fc3e6284e56894b1c8c4b" title="For stupid reasons (I&#39;m lazy!) these are defined in _debug.cpp. " alt="" coords="220,13,403,69"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ace67899d434503ffa7b9ca4b35e2f36c" title="Resets all volatile pages&#39; temperature stat to be zero in this storage. " alt="" coords="451,13,621,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a233fcd7ffd24bd59d2d0943af3d0de03"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename PAYLOAD &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::increment_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PAYLOAD *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#aba50cd0793ff2b271d8846b020795711" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p...">foedus::storage::hash::HashStorage::increment_record()</a> </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00554">554</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00095">foedus::storage::hash::HashCommonLogType::calculate_log_length()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00086">foedus::storage::hash::RecordLocation::cur_payload_length_</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00109">foedus::storage::hash::RecordLocation::get_aligned_key_length()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00166">get_bin_bits()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00161">get_id()</a>, <a class="el" href="thread_8cpp_source.html#l00078">foedus::thread::Thread::get_thread_log_buffer()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00049">foedus::storage::hash::HashCombo::hash_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00108">foedus::storage::hash::RecordLocation::is_found()</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="error__code_8hpp_source.html#l00176">foedus::kErrorCodeStrTooShortPayload</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00842">locate_bin()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00400">locate_record_logical()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00100">foedus::storage::hash::RecordLocation::observed_</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00380">foedus::storage::hash::HashOverwriteLogType::populate()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00093">foedus::storage::hash::RecordLocation::record_</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00260">register_record_write_log()</a>, and <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">foedus::log::ThreadLogBuffer::reserve_new_log()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00230">foedus::storage::hash::HashStorage::increment_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                           {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  HashDataPage* bin_head;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">locate_bin</a>(context, <span class="keyword">true</span>, combo, &amp;bin_head));</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin_head);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  RecordLocation location;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">locate_record_logical</a>(</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    context,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keyword">true</span>,</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keyword">false</span>,</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    0,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    key,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    key_length,</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    combo,</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    bin_head,</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    &amp;location));</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordflow">if</span> (!location.is_found()) {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;  <span class="comment">// protected by page version set, so we are done</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;  <span class="comment">// protected by the read set</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (location.cur_payload_length_ &lt; payload_offset + <span class="keyword">sizeof</span>(PAYLOAD)) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;short record &quot;</span> &lt;&lt; combo;  <span class="comment">// probably this is a rare error. so warn.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">kErrorCodeStrTooShortPayload</a>;  <span class="comment">// protected by the read set</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">// value: (in) addendum, (out) value after addition.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  PAYLOAD* current = <span class="keyword">reinterpret_cast&lt;</span>PAYLOAD*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    location.record_ + location.get_aligned_key_length() + payload_offset);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  *value += *current;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  uint16_t log_length</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">HashOverwriteLogType::calculate_log_length</a>(key_length, <span class="keyword">sizeof</span>(PAYLOAD));</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  HashOverwriteLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>HashOverwriteLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  log_entry-&gt;populate(</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">get_id</a>(),</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    key,</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    key_length,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">get_bin_bits</a>(),</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    combo.hash_,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    value,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    payload_offset,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keyword">sizeof</span>(PAYLOAD));</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">register_record_write_log</a>(context, location, log_entry);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">foedus::kErrorCodeStrTooShortPayload</a></div><div class="ttdoc">0x080A : "STORAGE: The record&#39;s payload is smaller than requested" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00176">error_code.hpp:176</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a07025464a0eba08710f6fa92d7c0f32d"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">foedus::storage::hash::HashStoragePimpl::locate_record_logical</a></div><div class="ttdeci">ErrorCode locate_record_logical(thread::Thread *context, bool for_write, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const HashCombo &amp;combo, HashDataPage *bin_head, RecordLocation *result)</div><div class="ttdoc">locate_record()&#39;s logical+physical version. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00400">hash_storage_pimpl.hpp:400</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_abdd0cbf1f438986888173779270bab4a"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">foedus::storage::hash::HashStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00161">hash_storage_pimpl.hpp:161</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a0f073a76a5abeac0829ba1e47a40c02c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">foedus::storage::hash::HashStoragePimpl::locate_bin</a></div><div class="ttdeci">ErrorCode locate_bin(thread::Thread *context, bool for_write, const HashCombo &amp;combo, HashDataPage **bin_head)</div><div class="ttdoc">Find a pointer to the bin that contains records for the hash. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00842">hash_storage_pimpl.cpp:842</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aff4c87787f9e6ce9c4306b8bcaf36a47"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">foedus::storage::hash::HashStoragePimpl::get_bin_bits</a></div><div class="ttdeci">uint8_t get_bin_bits() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00166">hash_storage_pimpl.hpp:166</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aeea83aff996263bc8e9b3623fbe305a1"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">foedus::storage::hash::HashStoragePimpl::register_record_write_log</a></div><div class="ttdeci">ErrorCode register_record_write_log(thread::Thread *context, const RecordLocation &amp;location, log::RecordLogType *log_entry)</div><div class="ttdoc">Used in the following methods. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00260">hash_storage_pimpl.cpp:260</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType_html_a04238b5b4aec46d0a24b5489553b793a"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">foedus::storage::hash::HashCommonLogType::calculate_log_length</a></div><div class="ttdeci">static uint16_t calculate_log_length(uint16_t key_length, uint16_t payload_count) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="hash__log__types_8hpp_source.html#l00095">hash_log_types.hpp:95</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a233fcd7ffd24bd59d2d0943af3d0de03_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a233fcd7ffd24bd59d2d0943af3d0de03_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a233fcd7ffd24bd59d2d0943af3d0de03_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a233fcd7ffd24bd59d2d0943af3d0de03_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a" title="foedus::storage::hash\l::HashCommonLogType::\lcalculate_log_length" alt="" coords="275,63,443,119"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#abed92a9a4809cce3c1cc33bc4fb07a81" title="foedus::storage::hash\l::RecordLocation::get\l_aligned_key_length" alt="" coords="285,215,432,271"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_bits" alt="" coords="277,437,441,493"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a" title="foedus::storage::hash\l::HashStoragePimpl::get_id" alt="" coords="525,1081,707,1122"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="282,958,435,999"/>
<area shape="rect" id="node9" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="297,1023,420,1065"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab29603dc5748833bc006e129a152a4d1" title="foedus::storage::hash\l::RecordLocation::is_found" alt="" coords="528,1146,704,1187"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="256,803,461,845"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="268,1435,449,1491"/>
<area shape="rect" id="node43" href="structfoedus_1_1storage_1_1hash_1_1HashOverwriteLogType.html#a29bf2faaed91770de679b2e836ffa3b8" title="foedus::storage::hash\l::HashOverwriteLogType\l::populate" alt="" coords="278,1276,439,1332"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1" title="Used in the following methods. " alt="" coords="264,1196,453,1252"/>
<area shape="rect" id="node47" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="265,1989,452,2030"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="536,5,696,32"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="516,57,716,98"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="782,637,946,693"/>
<area shape="rect" id="node14" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="1035,1059,1185,1101"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="1029,275,1191,331"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="509,482,723,523"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="1029,822,1191,863"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="1027,1142,1193,1183"/>
<area shape="rect" id="node22" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1041,905,1179,946"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="1029,195,1191,251"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="783,797,945,853"/>
<area shape="rect" id="node31" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="545,963,687,1005"/>
<area shape="rect" id="node13" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1035,645,1185,686"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1280,282,1471,323"/>
<area shape="rect" id="node18" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1005,725,1215,766"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="775,717,953,773"/>
<area shape="rect" id="node24" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1015,398,1205,439"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="783,507,945,563"/>
<area shape="rect" id="node30" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="773,325,955,381"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="1035,981,1185,1022"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="1028,1239,1192,1281"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="1035,1305,1185,1361"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="525,1484,707,1540"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="773,1451,955,1507"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="1263,1502,1488,1543"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="1028,1617,1192,1673"/>
<area shape="rect" id="node37" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="1314,1693,1437,1734"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="1023,1436,1197,1492"/>
<area shape="rect" id="node39" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab1d971d633ca8153c6a7363694e254a0" title="Populates fields other than readset_. " alt="" coords="1021,1697,1199,1753"/>
<area shape="rect" id="node41" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a5c39383806af101855b26268abbb00e3" title="Populates the result with XID and possibly readset. " alt="" coords="1021,1828,1199,1884"/>
<area shape="rect" id="node42" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="777,1842,951,1883"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="1290,1828,1461,1884"/>
<area shape="rect" id="node45" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="545,1263,687,1305"/>
<area shape="rect" id="node46" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="793,1131,935,1173"/>
<area shape="rect" id="node48" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="523,2077,709,2118"/>
<area shape="rect" id="node49" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="771,1989,957,2030"/>
<area shape="rect" id="node50" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="523,1959,709,2001"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a233fcd7ffd24bd59d2d0943af3d0de03_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a233fcd7ffd24bd59d2d0943af3d0de03_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a233fcd7ffd24bd59d2d0943af3d0de03_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a233fcd7ffd24bd59d2d0943af3d0de03_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="256,5,427,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac9c35890555ddb10d908b77602a1f28c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::insert_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>physical_payload_hint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a10d5a66f64174ea898dea0033f8fe68b" title="Inserts a new record of the given key in this hash storage. ">foedus::storage::hash::HashStorage::insert_record()</a> </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00277">277</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00250">foedus::storage::hash::adjust_payload_hint()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00243">foedus::storage::hash::HashDataPage::bloom_filter()</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00095">foedus::storage::hash::HashCommonLogType::calculate_log_length()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__hashinate_8hpp_source.html#l00152">foedus::storage::hash::DataPageBloomFilter::contains()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00051">foedus::storage::hash::HashCombo::fingerprint_</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00166">get_bin_bits()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00161">get_id()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00110">foedus::storage::hash::RecordLocation::get_max_payload()</a>, <a class="el" href="thread_8cpp_source.html#l00078">foedus::thread::Thread::get_thread_log_buffer()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00049">foedus::storage::hash::HashCombo::hash_</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00225">foedus::storage::hash::HashDataPage::header()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00080">foedus::storage::hash::RecordLocation::index_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00108">foedus::storage::hash::RecordLocation::is_found()</a>, <a class="el" href="error__code_8hpp_source.html#l00177">foedus::kErrorCodeStrKeyAlreadyExists</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00842">locate_bin()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00400">locate_record_logical()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00100">foedus::storage::hash::RecordLocation::observed_</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00078">foedus::storage::hash::RecordLocation::page_</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00212">foedus::storage::hash::HashInsertLogType::populate()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00093">foedus::storage::hash::RecordLocation::record_</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00260">register_record_write_log()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">foedus::log::ThreadLogBuffer::reserve_new_log()</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00952">foedus::thread::Thread::run_nested_sysxct()</a>, and <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00140">foedus::storage::hash::HashStorage::insert_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                  {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  physical_payload_hint = <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a621860b1314f5eecc0e41d3972340bf9">adjust_payload_hint</a>(payload_count, physical_payload_hint);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  HashDataPage* bin_head;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">locate_bin</a>(context, <span class="keyword">true</span>, combo, &amp;bin_head));</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin_head);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {  <span class="comment">// we might retry due to migrate_record. not that often, tho.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    RecordLocation location;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">locate_record_logical</a>(</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      context,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keyword">true</span>,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keyword">true</span>,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      physical_payload_hint,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      key,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      key_length,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      combo,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      bin_head,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      &amp;location));</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// we create if not exists, these are surely non-null</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(location.is_found());</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(location.record_);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// but, that record might be not logically deleted</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> (!location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56adfc9588c95653090f65a029c574bfc9c">kErrorCodeStrKeyAlreadyExists</a>;  <span class="comment">// protected by the read set</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> (payload_count &gt; location.get_max_payload()) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">// The physical record is too short. It will trigger a record expansion, which is a</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">// system transaction (logically does nothing!) to migrate this deleted record.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      HashDataPage* cur_page = location.page_;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!cur_page-&gt;header().snapshot_);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur_page-&gt;bloom_filter().contains(combo.fingerprint_));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">DataPageSlotIndex</a> cur_index = location.index_;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      DVLOG(2) &lt;&lt; <span class="stringliteral">&quot;Record expansion triggered. payload_count=&quot;</span> &lt;&lt; payload_count</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, current max=&quot;</span> &lt;&lt; location.get_max_payload()</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, size hint=&quot;</span> &lt;&lt; physical_payload_hint;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      ReserveRecords functor(</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        context,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        cur_page,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        key,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        key_length,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        combo,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        payload_count,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        physical_payload_hint,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        cur_index);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;functor, 5U));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      DVLOG(2) &lt;&lt; <span class="stringliteral">&quot;Expanded record!&quot;</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="comment">// need to re-locate. also, beacuse the above method is physical-only,</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="comment">// the moved location might be again moved or now deleted. easise to just retry.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">HashInsertLogType::calculate_log_length</a>(key_length, payload_count);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    HashInsertLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>HashInsertLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    log_entry-&gt;populate(</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">get_id</a>(),</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      key,</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      key_length,</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">get_bin_bits</a>(),</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      combo.hash_,</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      payload,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      payload_count);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">register_record_write_log</a>(context, location, log_entry);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a621860b1314f5eecc0e41d3972340bf9"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a621860b1314f5eecc0e41d3972340bf9">foedus::storage::hash::adjust_payload_hint</a></div><div class="ttdeci">uint16_t adjust_payload_hint(uint16_t payload_count, uint16_t physical_payload_hint)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00250">hash_storage_pimpl.cpp:250</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a07025464a0eba08710f6fa92d7c0f32d"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">foedus::storage::hash::HashStoragePimpl::locate_record_logical</a></div><div class="ttdeci">ErrorCode locate_record_logical(thread::Thread *context, bool for_write, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const HashCombo &amp;combo, HashDataPage *bin_head, RecordLocation *result)</div><div class="ttdoc">locate_record()&#39;s logical+physical version. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00400">hash_storage_pimpl.hpp:400</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_abdd0cbf1f438986888173779270bab4a"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">foedus::storage::hash::HashStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00161">hash_storage_pimpl.hpp:161</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a0f073a76a5abeac0829ba1e47a40c02c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">foedus::storage::hash::HashStoragePimpl::locate_bin</a></div><div class="ttdeci">ErrorCode locate_bin(thread::Thread *context, bool for_write, const HashCombo &amp;combo, HashDataPage **bin_head)</div><div class="ttdoc">Find a pointer to the bin that contains records for the hash. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00842">hash_storage_pimpl.cpp:842</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a476dd04e514ebe83142d21135e8b91c7"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">foedus::storage::hash::DataPageSlotIndex</a></div><div class="ttdeci">uint16_t DataPageSlotIndex</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00196">hash_id.hpp:196</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aff4c87787f9e6ce9c4306b8bcaf36a47"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">foedus::storage::hash::HashStoragePimpl::get_bin_bits</a></div><div class="ttdeci">uint8_t get_bin_bits() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00166">hash_storage_pimpl.hpp:166</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aeea83aff996263bc8e9b3623fbe305a1"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">foedus::storage::hash::HashStoragePimpl::register_record_write_log</a></div><div class="ttdeci">ErrorCode register_record_write_log(thread::Thread *context, const RecordLocation &amp;location, log::RecordLogType *log_entry)</div><div class="ttdoc">Used in the following methods. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00260">hash_storage_pimpl.cpp:260</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType_html_a04238b5b4aec46d0a24b5489553b793a"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">foedus::storage::hash::HashCommonLogType::calculate_log_length</a></div><div class="ttdeci">static uint16_t calculate_log_length(uint16_t key_length, uint16_t payload_count) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="hash__log__types_8hpp_source.html#l00095">hash_log_types.hpp:95</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56adfc9588c95653090f65a029c574bfc9c"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56adfc9588c95653090f65a029c574bfc9c">foedus::kErrorCodeStrKeyAlreadyExists</a></div><div class="ttdoc">0x080B : "STORAGE: This key already exists in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00177">error_code.hpp:177</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ac9c35890555ddb10d908b77602a1f28c_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ac9c35890555ddb10d908b77602a1f28c_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ac9c35890555ddb10d908b77602a1f28c_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ac9c35890555ddb10d908b77602a1f28c_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1storage_1_1hash.html#a621860b1314f5eecc0e41d3972340bf9" title="foedus::storage::hash\l::adjust_payload_hint" alt="" coords="261,5,408,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ad2169cfc93933b2b35fea60fe8be9cf8" title="foedus::storage::hash\l::HashDataPage::bloom\l_filter" alt="" coords="255,231,415,287"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a" title="foedus::storage::hash\l::HashCommonLogType::\lcalculate_log_length" alt="" coords="251,71,419,127"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a4e5601b652daaffbcb9fa81aee6746c6" title="foedus::storage::hash\l::DataPageBloomFilter\l::contains" alt="" coords="1275,343,1428,399"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_bits" alt="" coords="253,1114,417,1170"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a" title="foedus::storage::hash\l::HashStoragePimpl::get_id" alt="" coords="501,548,683,589"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#af4125da7e85cd2da82d64b8aa3eb9e81" title="foedus::storage::hash\l::RecordLocation::get\l_max_payload" alt="" coords="261,151,408,207"/>
<area shape="rect" id="node12" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="258,1195,411,1236"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="1004,544,1168,585"/>
<area shape="rect" id="node14" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="273,1260,396,1301"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab29603dc5748833bc006e129a152a4d1" title="foedus::storage::hash\l::RecordLocation::is_found" alt="" coords="504,863,680,904"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="232,1048,437,1089"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="244,471,425,527"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1hash_1_1HashInsertLogType.html#abd3dbdbe4f6d69957367a01e7576882a" title="foedus::storage::hash\l::HashInsertLogType::\lpopulate" alt="" coords="261,1326,409,1382"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1" title="Used in the following methods. " alt="" coords="240,695,429,751"/>
<area shape="rect" id="node45" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="241,2032,428,2073"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="259,2156,410,2197"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="760,86,920,113"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="492,1937,692,1979"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#abed92a9a4809cce3c1cc33bc4fb07a81" title="foedus::storage::hash\l::RecordLocation::get\l_aligned_key_length" alt="" coords="519,143,665,199"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="758,1066,922,1122"/>
<area shape="rect" id="node19" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="1011,923,1161,964"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="1005,1589,1167,1645"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="485,1381,699,1423"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="1005,1493,1167,1535"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="1003,840,1169,881"/>
<area shape="rect" id="node27" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1017,1252,1155,1293"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="1005,1669,1167,1725"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="759,1146,921,1202"/>
<area shape="rect" id="node34" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="521,1872,663,1913"/>
<area shape="rect" id="node18" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1011,1317,1161,1359"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1256,1596,1447,1637"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="981,1121,1191,1163"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="751,1277,929,1333"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="991,1415,1181,1456"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="759,1538,921,1594"/>
<area shape="rect" id="node33" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="749,1407,931,1463"/>
<area shape="rect" id="node28" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="1011,1187,1161,1228"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="501,467,683,523"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="749,565,931,621"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="1239,471,1464,512"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="1004,463,1168,519"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="507,731,677,787"/>
<area shape="rect" id="node43" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="521,665,663,707"/>
<area shape="rect" id="node44" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="769,797,911,839"/>
<area shape="rect" id="node46" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="499,2003,685,2044"/>
<area shape="rect" id="node47" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="747,2091,933,2132"/>
<area shape="rect" id="node48" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="499,2120,685,2161"/>
<area shape="rect" id="node50" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="500,2185,684,2227"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ac9c35890555ddb10d908b77602a1f28c_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ac9c35890555ddb10d908b77602a1f28c_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ac9c35890555ddb10d908b77602a1f28c_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ac9c35890555ddb10d908b77602a1f28c_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="232,5,379,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a44bc6cd5427daadbee9fd6fcc366af09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::load </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1StorageControlBlock.html">StorageControlBlock</a> &amp;&#160;</td>
          <td class="paramname"><em>snapshot_block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00135">135</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="hash__id_8hpp_source.html#l00090">foedus::storage::hash::bins_to_level()</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00166">get_bin_bits()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00162">get_name()</a>, <a class="el" href="initializable_8hpp_source.html#l00169">foedus::DefaultInitializable::initialize()</a>, <a class="el" href="storage__id_8hpp_source.html#l00158">foedus::storage::kExists</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="initializable_8hpp_source.html#l00243">foedus::UninitializeGuard::kWarnIfUninitializeError</a>, <a class="el" href="engine__memory_8cpp_source.html#l00148">foedus::memory::EngineMemory::load_one_volatile_page()</a>, <a class="el" href="storage_8hpp_source.html#l00084">foedus::storage::StorageControlBlock::meta_</a>, <a class="el" href="metadata_8hpp_source.html#l00112">foedus::storage::Metadata::root_snapshot_page_id_</a>, and <a class="el" href="initializable_8hpp_source.html#l00187">foedus::DefaultInitializable::uninitialize()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00069">foedus::storage::hash::HashStorage::load()</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                                           {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_ = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>HashMetadata&amp;<span class="keyword">&gt;</span>(snapshot_block.meta_);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keyword">const</span> HashMetadata&amp; meta = <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;bin_count_ = 1ULL &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">get_bin_bits</a>();</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;levels_ = <a class="code" href="group__HASH.html#gacfc9ccab28ee4ffc1a7317ec51b332f4">bins_to_level</a>(<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;bin_count_);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.snapshot_pointer_ = meta.root_snapshot_page_id_;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_.word = 0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// Root page always has volatile version.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// Construct it from snapshot version.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  cache::SnapshotFileSet fileset(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(fileset.initialize());</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  UninitializeGuard fileset_guard(&amp;fileset, <a class="code" href="classfoedus_1_1UninitializeGuard.html#ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568">UninitializeGuard::kWarnIfUninitializeError</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// load root page</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  VolatilePagePointer volatile_pointer;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  HashIntermediatePage* volatile_root;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a3c3c8902b7000d09878a5a2085f6058c">load_one_volatile_page</a>(</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    &amp;fileset,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    meta.root_snapshot_page_id_,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    &amp;volatile_pointer,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    reinterpret_cast&lt;Page**&gt;(&amp;volatile_root)));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_ = volatile_pointer;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(fileset.uninitialize());</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Loaded a hash-storage &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70">get_name</a>();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;status_ = <a class="code" href="group__STORAGE.html#ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1">kExists</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1UninitializeGuard_html_ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568"><div class="ttname"><a href="classfoedus_1_1UninitializeGuard.html#ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568">foedus::UninitializeGuard::kWarnIfUninitializeError</a></div><div class="ttdoc">Automatically calls if uninitialize() wasn&#39;t called when it gets out of scope, and just complains whe...</div><div class="ttdef"><b>Definition:</b> <a href="initializable_8hpp_source.html#l00243">initializable.hpp:243</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a3c3c8902b7000d09878a5a2085f6058c"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a3c3c8902b7000d09878a5a2085f6058c">foedus::memory::EngineMemory::load_one_volatile_page</a></div><div class="ttdeci">ErrorStack load_one_volatile_page(cache::SnapshotFileSet *fileset, storage::SnapshotPagePointer snapshot_pointer, storage::VolatilePagePointer *pointer, storage::Page **page)</div><div class="ttdoc">Another convenience method that also reads an existing snapshot page to the volatile page...</div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8cpp_source.html#l00148">engine_memory.cpp:148</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="group__STORAGE_html_ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1"><div class="ttname"><a href="group__STORAGE.html#ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1">foedus::storage::kExists</a></div><div class="ttdoc">The storage has been created and ready for use. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00158">storage_id.hpp:158</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_afdf4bd9f7349768099f6aaf621ff3a70"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70">foedus::storage::hash::HashStoragePimpl::get_name</a></div><div class="ttdeci">const StorageName &amp; get_name() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00162">hash_storage_pimpl.hpp:162</a></div></div>
<div class="ttc" id="group__HASH_html_gacfc9ccab28ee4ffc1a7317ec51b332f4"><div class="ttname"><a href="group__HASH.html#gacfc9ccab28ee4ffc1a7317ec51b332f4">foedus::storage::hash::bins_to_level</a></div><div class="ttdeci">uint8_t bins_to_level(uint64_t bins)</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00090">hash_id.hpp:90</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aff4c87787f9e6ce9c4306b8bcaf36a47"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">foedus::storage::hash::HashStoragePimpl::get_bin_bits</a></div><div class="ttdeci">uint8_t get_bin_bits() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00166">hash_storage_pimpl.hpp:166</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a44bc6cd5427daadbee9fd6fcc366af09_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a44bc6cd5427daadbee9fd6fcc366af09_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a44bc6cd5427daadbee9fd6fcc366af09_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a44bc6cd5427daadbee9fd6fcc366af09_cgraph">
<area shape="rect" id="node2" href="group__HASH.html#gacfc9ccab28ee4ffc1a7317ec51b332f4" title="foedus::storage::hash\l::bins_to_level" alt="" coords="256,5,403,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_bits" alt="" coords="247,71,411,127"/>
<area shape="rect" id="node5" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="262,152,397,193"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afdf4bd9f7349768099f6aaf621ff3a70" title="foedus::storage::hash\l::HashStoragePimpl::get_name" alt="" coords="228,217,431,259"/>
<area shape="rect" id="node7" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff" title="Typical implementation of Initializable::initialize() that provides initialize&#45;once semantics..." alt="" coords="243,283,415,324"/>
<area shape="rect" id="node12" href="classfoedus_1_1memory_1_1EngineMemory.html#a3c3c8902b7000d09878a5a2085f6058c" title="Another convenience method that also reads an existing snapshot page to the volatile page..." alt="" coords="224,536,435,577"/>
<area shape="rect" id="node41" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb" title="Typical implementation of Initializable::uninitialize() that provides uninitialize&#45;once semantics..." alt="" coords="243,348,415,389"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="488,79,688,120"/>
<area shape="rect" id="node8" href="classfoedus_1_1DefaultInitializable.html#ab8ae37e5f20f312f8b945fc40d3e0250" title="foedus::DefaultInitializable\l::initialize_once" alt="" coords="502,152,674,193"/>
<area shape="rect" id="node9" href="classfoedus_1_1ErrorStack.html#a9c7b3a8b3806ff623c7fb4a9db5cbeec" title="Returns if this return code is not kErrorCodeOk. " alt="" coords="523,217,653,259"/>
<area shape="rect" id="node10" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="502,348,674,389"/>
<area shape="rect" id="node11" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b" title="foedus::DefaultInitializable\l::uninitialize_once" alt="" coords="502,283,674,324"/>
<area shape="rect" id="node13" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1001,991,1189,1047"/>
<area shape="rect" id="node14" href="classfoedus_1_1memory_1_1EngineMemory.html#ae35d16d716451eaa878ec2888960127d" title="A convenience function to grab one free volatile page from the given node. " alt="" coords="483,413,693,455"/>
<area shape="rect" id="node29" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="495,657,681,699"/>
<area shape="rect" id="node15" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8" title="foedus::memory::EngineMemory\l::get_node_memory" alt="" coords="741,315,952,356"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e" title="Gives an object to resolve an offset in this page pool (thus local) to an actual pointer and vice ver..." alt="" coords="757,511,936,552"/>
<area shape="rect" id="node18" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774" title="foedus::memory::NumaNode\lMemoryRef::get_volatile_pool" alt="" coords="751,380,942,421"/>
<area shape="rect" id="node19" href="classfoedus_1_1memory_1_1PagePool.html#a3e9390381783077a504116988cae05c4" title="Grab only one page. " alt="" coords="757,445,936,487"/>
<area shape="rect" id="node27" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="755,169,939,225"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="766,249,927,291"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#ae901dc06f6b6f4594626ed0b233daec6" title="foedus::memory::PagePool\lPimpl::get_resolver" alt="" coords="1006,511,1185,552"/>
<area shape="rect" id="node20" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a3293a43a76f3720cf5c92c5fbcf2d02f" title="foedus::memory::PagePool\lPimpl::grab_one" alt="" coords="1006,445,1185,487"/>
<area shape="rect" id="node21" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a1a41295b63274fb300e5937a9bb1eca7" title="foedus::memory::PagePool\lPimpl::decrease_free_pool_count" alt="" coords="1239,515,1453,556"/>
<area shape="rect" id="node22" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#aa545fc1cffac905225d3a7c7c457b5a8" title="foedus::memory::PagePool\lPimpl::free_pool_head" alt="" coords="1257,319,1435,360"/>
<area shape="rect" id="node23" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#abd594ac94d8ac0445ebef734b7305fb6" title="foedus::memory::PagePool\lPimpl::get_debug_pool_name" alt="" coords="1249,384,1443,425"/>
<area shape="rect" id="node26" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="1257,449,1435,491"/>
<area shape="rect" id="node24" href="classfoedus_1_1assorted_1_1FixedString.html#a3269f7c68f175a1fd42e78110a57cbf2" title="Test if string is empty. " alt="" coords="1513,355,1705,396"/>
<area shape="rect" id="node25" href="classfoedus_1_1assorted_1_1FixedString.html#a16f6de0859f599127e2d4a51a6537a01" title="Convert to a std::string object. " alt="" coords="1501,421,1716,447"/>
<area shape="rect" id="node30" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="747,577,947,633"/>
<area shape="rect" id="node31" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="753,919,940,960"/>
<area shape="rect" id="node33" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="771,723,922,764"/>
<area shape="rect" id="node40" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="771,657,922,699"/>
<area shape="rect" id="node32" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1000,911,1191,967"/>
<area shape="rect" id="node34" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="1024,649,1167,691"/>
<area shape="rect" id="node35" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="1020,845,1171,887"/>
<area shape="rect" id="node36" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1025,715,1165,756"/>
<area shape="rect" id="node37" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="1020,780,1171,821"/>
<area shape="rect" id="node38" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="1028,584,1163,625"/>
<area shape="rect" id="node39" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="1279,584,1413,625"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a44bc6cd5427daadbee9fd6fcc366af09_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a44bc6cd5427daadbee9fd6fcc366af09_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a44bc6cd5427daadbee9fd6fcc366af09_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a44bc6cd5427daadbee9fd6fcc366af09_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a200dd1b1b2b5bc937cae55120e1befc9" title="foedus::storage::hash\l::HashStorage::load" alt="" coords="224,5,371,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0f073a76a5abeac0829ba1e47a40c02c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::locate_bin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> **&#160;</td>
          <td class="paramname"><em>bin_head</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find a pointer to the bin that contains records for the hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>Thread context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">for_write</td><td>Whether we are reading these pages to modify </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">combo</td><td>Hash values. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bin_head</td><td>Pointer to the first data page of the bin. Might be null.</td></tr>
  </table>
  </dd>
</dl>
<p>If the search is for-write search, we always create a volatile page, even recursively, thus *bin_head!= null.</p>
<p>If the search is a for-read search and also the corresponding data page or its ascendants do not exist yet, *bin_head returns null. In that case, you can just return "not found" as a result. <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. ">locate_bin()</a> internally adds a pointer set to protect the result, too.</p>
<dl class="section note"><dt>Note</dt><dd>Although the above rule is simple, this might be wasteful in some situation. Deletions and updates for non-existing keys do not need to instantiate volatile pages. It can be handled like read access in that case. But, to really achieve it, delete/update have to be 2-path. Search it using snapshot pages, then goes through volatile path when found. Rather, let's always create volatile pages for all writes. It's simple and performs the best except a very unlucky case. If miss-delete/update is really the common path, the user code can manually achieve the same thing by get() first, then delete/update(). </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00842">842</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="xct_8cpp_source.html#l00198">foedus::xct::Xct::add_to_pointer_set()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__combo_8hpp_source.html#l00050">foedus::storage::hash::HashCombo::bin_</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="storage__id_8hpp_source.html#l00211">foedus::storage::VolatilePagePointer::clear()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00625">follow_page()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00412">foedus::storage::hash::HashDataPage::get_bin()</a>, <a class="el" href="thread_8cpp_source.html#l00075">foedus::thread::Thread::get_current_xct()</a>, <a class="el" href="xct_8hpp_source.html#l00149">foedus::xct::Xct::get_isolation_level()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00105">foedus::storage::hash::HashIntermediatePage::get_level()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00080">foedus::storage::hash::HashIntermediatePage::get_pointer()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00607">get_root_page()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00070">foedus::storage::hash::HashIntermediatePage::header()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="xct__id_8hpp_source.html#l00086">foedus::xct::kSerializable</a>, <a class="el" href="hash__hashinate_8hpp_source.html#l00203">foedus::storage::hash::IntermediateRoute::route</a>, <a class="el" href="hash__combo_8hpp_source.html#l00052">foedus::storage::hash::HashCombo::route_</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00356">delete_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00166">get_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00210">get_record_part()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00554">increment_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00277">insert_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00502">overwrite_record()</a>, and <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00390">upsert_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                           {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  HashIntermediatePage* root;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538">get_root_page</a>(context, for_write, &amp;root));</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(root);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  *bin_head = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  xct::Xct&amp; current_xct = context-&gt;get_current_xct();</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  HashIntermediatePage* parent = root;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(parent);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    uint8_t parent_level = parent-&gt;get_level();</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    uint16_t index = combo.route_.route[parent_level];</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    Page* next;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f">follow_page</a>(context, for_write, parent, index, &amp;next));</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">if</span> (!next) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="comment">// if this is a read-access, it is possible that the page even doesn&#39;t exist.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="comment">// it is a valid result (not found). we just have to add a pointer set to protect the result.</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!for_write);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">if</span> (!parent-&gt;header().snapshot_  <span class="comment">// then we already added a pointer set in higher level</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        &amp;&amp; current_xct.get_isolation_level() == <a class="code" href="group__XCT.html#gga9ac5dae4b91a288e9d887f28a7124c13a5e9c22688eea55cea2bf4380b03a8630">xct::kSerializable</a>) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        VolatilePagePointer volatile_null;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        volatile_null.clear();</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;          current_xct.add_to_pointer_set(</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            &amp;parent-&gt;get_pointer(index).volatile_pointer_,</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            volatile_null));</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="keywordflow">if</span> (parent_level == 0) {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        *bin_head = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(next);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        parent = <span class="keyword">reinterpret_cast&lt;</span>HashIntermediatePage*<span class="keyword">&gt;</span>(next);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  }</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(*bin_head != <span class="keyword">nullptr</span> || !for_write);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(*bin_head == <span class="keyword">nullptr</span> || (*bin_head)-&gt;get_bin() == combo.bin_);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a579927a24cc690c8d4d6362bcb9e8538"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538">foedus::storage::hash::HashStoragePimpl::get_root_page</a></div><div class="ttdeci">ErrorCode get_root_page(thread::Thread *context, bool for_write, HashIntermediatePage **root)</div><div class="ttdoc">Retrieves the root page of this storage. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00607">hash_storage_pimpl.cpp:607</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a3d443bf6ef79608f06b5ca1aa4ea7e6f"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f">foedus::storage::hash::HashStoragePimpl::follow_page</a></div><div class="ttdeci">ErrorCode follow_page(thread::Thread *context, bool for_write, HashIntermediatePage *parent, uint16_t index_in_parent, Page **page)</div><div class="ttdoc">for non-root </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00625">hash_storage_pimpl.cpp:625</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__XCT_html_gga9ac5dae4b91a288e9d887f28a7124c13a5e9c22688eea55cea2bf4380b03a8630"><div class="ttname"><a href="group__XCT.html#gga9ac5dae4b91a288e9d887f28a7124c13a5e9c22688eea55cea2bf4380b03a8630">foedus::xct::kSerializable</a></div><div class="ttdoc">Protects against all anomalies in all situations. </div><div class="ttdef"><b>Definition:</b> <a href="xct__id_8hpp_source.html#l00086">xct_id.hpp:86</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a0f073a76a5abeac0829ba1e47a40c02c_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a0f073a76a5abeac0829ba1e47a40c02c_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a0f073a76a5abeac0829ba1e47a40c02c_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a0f073a76a5abeac0829ba1e47a40c02c_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="1300,90,1441,131"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="784,145,945,186"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="259,1377,472,1418"/>
<area shape="rect" id="node24" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1301,261,1440,302"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="1039,639,1205,681"/>
<area shape="rect" id="node26" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="789,1879,940,1921"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="1041,1996,1203,2052"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="784,1748,945,1804"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="531,1879,692,1935"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="283,884,447,940"/>
<area shape="rect" id="node5" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="760,990,969,1031"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="522,917,701,973"/>
<area shape="rect" id="node17" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="789,210,940,251"/>
<area shape="rect" id="node34" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1027,1639,1217,1681"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="1041,1172,1203,1228"/>
<area shape="rect" id="node48" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="520,1748,703,1804"/>
<area shape="rect" id="node6" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1266,982,1475,1023"/>
<area shape="rect" id="node7" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="1560,917,1695,958"/>
<area shape="rect" id="node8" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="1524,982,1731,1023"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8" title="foedus::memory::PagePool\l::get_base" alt="" coords="1781,1054,1960,1095"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1553,1399,1702,1441"/>
<area shape="rect" id="node11" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="1535,1099,1719,1141"/>
<area shape="rect" id="node12" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="1779,1133,1963,1174"/>
<area shape="rect" id="node13" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="1524,786,1731,827"/>
<area shape="rect" id="node14" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8" title="Get a tentative work memory of the specified size from pre&#45;allocated thread&#45;private memory..." alt="" coords="1546,851,1709,893"/>
<area shape="rect" id="node16" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="778,925,951,966"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1290,378,1451,419"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1547,349,1708,390"/>
<area shape="rect" id="node22" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1279,1405,1463,1461"/>
<area shape="rect" id="node29" href="classfoedus_1_1thread_1_1Thread.html#ac8953b86c90ec5ee1730b05397a259da" title="Returns page resolver to convert only local page ID to page pointer. " alt="" coords="783,1252,946,1308"/>
<area shape="rect" id="node30" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="789,1055,940,1097"/>
<area shape="rect" id="node33" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="768,1333,961,1374"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#aa72388dc98c566a63c723184449a830f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer_address" alt="" coords="784,1399,945,1455"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1Thread.html#a4e553f5e14ec00d8ba23fbdfa26d687e" title="Returns the private memory repository of this thread. " alt="" coords="789,1479,940,1521"/>
<area shape="rect" id="node37" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="1030,705,1214,761"/>
<area shape="rect" id="node38" href="group__ARRAY.html#ga8423aae479f4b36ddc54127b07268c8c" title="volatile page initialize callback for HashDataPage. " alt="" coords="791,1172,938,1228"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="783,545,947,586"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac977ed25935d3fa3a8d9651f96349c32" title="foedus::storage::hash\l::HashDataPage::next_page" alt="" coords="772,610,957,651"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="789,727,940,783"/>
<area shape="rect" id="node44" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a6c9bf7d6b21ac33a61d6f7176023ea3a" title="Returns one free volatile page to local page pool. " alt="" coords="751,807,979,849"/>
<area shape="rect" id="node45" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="1047,494,1197,535"/>
<area shape="rect" id="node46" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="789,479,940,521"/>
<area shape="rect" id="node18" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1030,429,1214,470"/>
<area shape="rect" id="node21" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1265,559,1476,601"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1290,654,1451,695"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1275,2003,1466,2045"/>
<area shape="rect" id="node31" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="1033,1041,1211,1082"/>
<area shape="rect" id="node32" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="1047,1106,1197,1147"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#aeb01df00186ad7f69875d7bd1ff0108e" title="Called only when this page is initialized. " alt="" coords="784,1996,945,2052"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a0f073a76a5abeac0829ba1e47a40c02c_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a0f073a76a5abeac0829ba1e47a40c02c_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a0f073a76a5abeac0829ba1e47a40c02c_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a0f073a76a5abeac0829ba1e47a40c02c_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="269,19,451,75"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a222e0d485305f3253b0e1c97720dc0c8" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record" alt="" coords="278,112,442,168"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_part" alt="" coords="278,217,442,273"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="259,297,461,353"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="271,377,449,433"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="262,457,458,513"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="269,577,451,633"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="537,5,685,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af64f22f350167426098b6a99c15f864d" title="If you have already computed HashCombo, use this. " alt="" coords="523,86,698,127"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac9ae382b1110aec44a1df2a768c4cee3" title="If you have already computed HashCombo, use this. " alt="" coords="509,151,712,193"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a660df9f0d685df28fbe19f52cdbdc7e2" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_primitive" alt="" coords="529,217,693,273"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac8f3eb87098b114b9d4f8b151fee17c1" title="If you have already computed HashCombo, use this. " alt="" coords="760,217,935,273"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="525,297,696,353"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="537,377,684,433"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="513,457,709,513"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="529,537,692,593"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="766,457,929,513"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="536,617,685,673"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a86af9aa3326dd20ffdac2a1beffea0b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::locate_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>physical_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>create_if_notfound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>create_payload_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *&#160;</td>
          <td class="paramname"><em>bin_head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html">RecordLocation</a> *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Usually follows locate_bin to locate the exact physical record for the key, or create a new one if not exists (only when for_write). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>Thread context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">for_write</td><td>Whether we are seeking the record to modify </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">physical_only</td><td>If true, we skip observing XID and registering readset in a finalized fashion, see <a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html" title="return value of locate_record(). ">RecordLocation</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">create_if_notfound</td><td>Whether we will create a new physical record if not exists </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">create_payload_length</td><td>If this method creates a physical record, it makes sure the record can accomodate at least this size of payload. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>The searching key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_length</td><td>Byte length of the searching key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">combo</td><td>Hash values. Also the result of this method. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bin_head</td><td>Pointer to the first data page of the bin. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">result</td><td>Information on the found slot. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>bin_head-&gt;get_bin() == combo.bin_ </dd>
<dd>
bin_head != nullptr </dd>
<dd>
bin_head must be volatile page if for_write</dd></dl>
<p>If the exact record is not found, this method protects the result by adding page version set if physical_only is false. If create_if_notfound is true (an insert case), this method creates a new physical record for the key with a deleted-state as a system transaction. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html" title="return value of locate_record(). ">RecordLocation</a> </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00936">936</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="xct_8cpp_source.html#l00242">foedus::xct::Xct::add_to_page_version_set()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__combo_8hpp_source.html#l00050">foedus::storage::hash::HashCombo::bin_</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00114">foedus::storage::hash::RecordLocation::clear()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00396">foedus::storage::hash::HashDataPage::compare_slot_key()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00051">foedus::storage::hash::HashCombo::fingerprint_</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00412">foedus::storage::hash::HashDataPage::get_bin()</a>, <a class="el" href="thread_8cpp_source.html#l00075">foedus::thread::Thread::get_current_xct()</a>, <a class="el" href="thread_8hpp_source.html#l00066">foedus::thread::Thread::get_numa_node()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00246">foedus::storage::hash::HashDataPage::get_record_count()</a>, <a class="el" href="page_8hpp_source.html#l00073">foedus::storage::PageVersionStatus::has_next_page()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00049">foedus::storage::hash::HashCombo::hash_</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00225">foedus::storage::hash::HashDataPage::header()</a>, <a class="el" href="xct__id_8hpp_source.html#l01041">foedus::xct::XctId::is_moved()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="hash__id_8hpp_source.html#l00197">foedus::storage::hash::kSlotNotFound</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00889">locate_record_in_snapshot()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l01074">locate_record_reserve_physical()</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00046">foedus::assorted::memory_fence_acquire()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00240">foedus::storage::hash::HashDataPage::next_page_address()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00100">foedus::storage::hash::RecordLocation::observed_</a>, <a class="el" href="page_8hpp_source.html#l00272">foedus::storage::PageHeader::page_version_</a>, <a class="el" href="hash__record__location_8cpp_source.html#l00027">foedus::storage::hash::RecordLocation::populate_logical()</a>, <a class="el" href="hash__record__location_8cpp_source.html#l00079">foedus::storage::hash::RecordLocation::populate_physical()</a>, <a class="el" href="thread_8hpp_source.html#l00110">foedus::thread::Thread::resolve_cast()</a>, <a class="el" href="hash__page__impl_8cpp_source.html#l00106">foedus::storage::hash::HashDataPage::search_key_physical()</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, <a class="el" href="page_8hpp_source.html#l00251">foedus::storage::PageHeader::stat_last_updater_node_</a>, <a class="el" href="page_8hpp_source.html#l00172">foedus::storage::PageVersion::status_</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00400">locate_record_logical()</a>, and <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00377">locate_record_physical_only()</a>.</p>
<div class="fragment"><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                          {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin_head);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin_head-&gt;get_bin() == combo.bin_);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(for_write || !create_if_notfound);  <span class="comment">// create_if_notfound implies for_write</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">// Snapshot case is way easier. Separtely handle that case.</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="keywordflow">if</span> (bin_head-&gt;header().snapshot_) {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!for_write);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!create_if_notfound);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105">locate_record_in_snapshot</a>(context, key, key_length, combo, bin_head, result);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  xct::Xct* cur_xct = &amp;context-&gt;get_current_xct();</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="comment">// in hash storage, we maintain only bin_head&#39;s stat. it&#39;s enough</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">if</span> (for_write) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    bin_head-&gt;header().stat_last_updater_node_ = context-&gt;get_numa_node();</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  HashDataPage* page = bin_head;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="comment">// Start with a physical-only search. We will re-check our observation below.</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keyword">const</span> uint16_t record_count = page-&gt;get_record_count();</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">DataPageSlotIndex</a> index = page-&gt;search_key_physical(</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      combo.hash_,</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      combo.fingerprint_,</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      key,</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      key_length,</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      record_count);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span> (index != <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a33cdddb3771cf2fdc3e65465792b6c96">kSlotNotFound</a>) {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="comment">// found! but it might be now being logically moved/deleted.</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;compare_slot_key(index, combo.hash_, key, key_length));</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <span class="keywordflow">if</span> (physical_only) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="comment">// we don&#39;t care. the caller is responsible to do logical operation</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        result-&gt;populate_physical(page, index);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(result-&gt;populate_logical(cur_xct, page, index, for_write));</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(result-&gt;observed_.is_moved())) {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;          LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Interesting. The record has been just moved&quot;</span>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">// Apparently not in this page, now on to next page. We have to be a bit careful</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// in this case. Non-null next page means this page is already static, but we</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">// have to make sure we confirmed it in a right order.</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    DualPagePointer* next_page = page-&gt;next_page_address();</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">// we are in volatile page, there might be a race!</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    PageVersionStatus page_status = page-&gt;header().page_version_.status_;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();  <span class="comment">// from now on, page_status is the ground truth here.</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="comment">// check a few things after the fence.</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="comment">// invariant: we never move on to next page without guaranteeing that this page does not</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="comment">// contain a physical non-moved record with the key.</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="comment">// did someone insert a new record at this moment?</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    uint16_t record_count_again = page-&gt;get_record_count();</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(record_count != record_count_again)) {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Interesting. concurrent insertion just happend to the page&quot;</span>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="keywordflow">continue</span>;  <span class="comment">// just retry to make it sure. this is rare.</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="comment">// did someone install a new page at this moment?</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(!page_status.has_next_page() &amp;&amp; !next_page-&gt;volatile_pointer_.is_null())) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Interesting. concurrent next-page installation just happend to the page&quot;</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordflow">continue</span>;  <span class="comment">// just retry to make it sure. this is rare.</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span> (next_page-&gt;volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="comment">// no next page.</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordflow">if</span> (create_if_notfound) {</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="comment">// this is the tail page, so let&#39;s insert it here.</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <span class="comment">// we do that as a system transaction.</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(for_write);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">DataPageSlotIndex</a> new_location;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34">locate_record_reserve_physical</a>(</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;          context,</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;          key,</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;          key_length,</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;          combo,</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;          create_payload_length,</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;          &amp;page,</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          record_count,</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;          &amp;new_location));</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(new_location != <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a33cdddb3771cf2fdc3e65465792b6c96">kSlotNotFound</a>);  <span class="comment">// contract of the above method</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="comment">// The returned location is not logically protected... yet.</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;compare_slot_key(new_location, combo.hash_, key, key_length));</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="keywordflow">if</span> (physical_only) {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;          <span class="comment">// we don&#39;t care. the caller is responsible to do logical operation</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;          result-&gt;populate_physical(page, new_location);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;          <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(result-&gt;populate_logical(cur_xct, page, new_location, for_write));</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(result-&gt;observed_.is_moved())) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Interesting. The record has been just moved after creation!&quot;</span>;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;          }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="comment">// &quot;NotFound&quot; result. To finalize it,</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="comment">// we have to take version set because someone might</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="comment">// insert a new record/next-page later.</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        result-&gt;clear();</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="keywordflow">if</span> (physical_only) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;          <span class="comment">// we don&#39;t care. the caller is responsible to do logical operation</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;          <span class="comment">// [Logical check]: Remember the page_status we observed as of checking record count</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;          <span class="comment">// and verify it at commit time.</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(cur_xct-&gt;add_to_page_version_set(</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            &amp;page-&gt;header().page_version_,</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            page_status));</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      page = context-&gt;resolve_cast&lt;HashDataPage&gt;(next_page-&gt;volatile_pointer_);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!page-&gt;header().snapshot_);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a33cdddb3771cf2fdc3e65465792b6c96"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a33cdddb3771cf2fdc3e65465792b6c96">foedus::storage::hash::kSlotNotFound</a></div><div class="ttdeci">const DataPageSlotIndex kSlotNotFound</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00197">hash_id.hpp:197</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_afa2342b5f0a374e38f0ec00242494a34"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34">foedus::storage::hash::HashStoragePimpl::locate_record_reserve_physical</a></div><div class="ttdeci">ErrorCode locate_record_reserve_physical(thread::Thread *context, const void *key, uint16_t key_length, const HashCombo &amp;combo, uint16_t payload_length, HashDataPage **page_in_out, uint16_t examined_records, DataPageSlotIndex *new_location)</div><div class="ttdoc">Subroutine of locate_record() to create/migrate a physical record of the given key in the page or its...</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l01074">hash_storage_pimpl.cpp:1074</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a476dd04e514ebe83142d21135e8b91c7"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">foedus::storage::hash::DataPageSlotIndex</a></div><div class="ttdeci">uint16_t DataPageSlotIndex</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00196">hash_id.hpp:196</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaf84f9944a16c5848f69beacdfeedf939"><div class="ttname"><a href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">foedus::assorted::memory_fence_acquire</a></div><div class="ttdeci">void memory_fence_acquire()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acquire). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00046">atomic_fences.hpp:46</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_af64ca224598812767abe9631f280b105"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105">foedus::storage::hash::HashStoragePimpl::locate_record_in_snapshot</a></div><div class="ttdeci">ErrorCode locate_record_in_snapshot(thread::Thread *context, const void *key, uint16_t key_length, const HashCombo &amp;combo, HashDataPage *bin_head, RecordLocation *result)</div><div class="ttdoc">Simpler version of locate_record for when we are in snapshot world. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00889">hash_storage_pimpl.cpp:889</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a86af9aa3326dd20ffdac2a1beffea0b4_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a86af9aa3326dd20ffdac2a1beffea0b4_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a86af9aa3326dd20ffdac2a1beffea0b4_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a86af9aa3326dd20ffdac2a1beffea0b4_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="257,5,404,47"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a490056e5b2e5617cf640ea99d278ac21" title="foedus::storage::hash\l::RecordLocation::clear" alt="" coords="501,123,657,164"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="492,239,667,295"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="732,120,957,161"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="496,568,663,609"/>
<area shape="rect" id="node10" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="255,1520,406,1561"/>
<area shape="rect" id="node11" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="255,1585,406,1627"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1PageVersionStatus.html#a8360836cebd9fbeadfeb2a31809270c2" title="foedus::storage::PageVersion\lStatus::has_next_page" alt="" coords="235,1651,427,1692"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="497,633,661,675"/>
<area shape="rect" id="node16" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="783,828,906,869"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="499,780,660,821"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="240,502,421,558"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="497,319,661,375"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab1d971d633ca8153c6a7363694e254a0" title="Populates fields other than readset_. " alt="" coords="491,1049,668,1105"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="504,699,655,755"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34" title="Subroutine of locate_record() to create/migrate a physical record of the given key in the page or its..." alt="" coords="240,1823,421,1879"/>
<area shape="rect" id="node37" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="758,1820,931,1861"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a5c39383806af101855b26268abbb00e3" title="Populates the result with XID and possibly readset. " alt="" coords="242,1114,419,1170"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="255,1455,406,1496"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac2e82163d7348a6c88fecff711025b08" title="foedus::storage::hash\l::HashDataPage::get_slot" alt="" coords="759,251,930,292"/>
<area shape="rect" id="node7" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679" title="Calculates hash value for general input. " alt="" coords="771,185,918,227"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a49863802f2bfb024c928a37ea7abce07" title="foedus::storage::hash\l::HashDataPage::record\l_from_offset" alt="" coords="764,645,925,701"/>
<area shape="rect" id="node12" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="490,1643,669,1684"/>
<area shape="rect" id="node13" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="504,1577,655,1619"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1021,1347,1183,1388"/>
<area shape="rect" id="node31" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="475,400,684,441"/>
<area shape="rect" id="node33" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1027,536,1177,577"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a4e5601b652daaffbcb9fa81aee6746c6" title="foedus::storage::hash\l::DataPageBloomFilter\l::contains" alt="" coords="768,317,921,373"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a28a11a7b04e04d895b21f29709eacd1f" title="foedus::storage::hash\l::DataPageBloomFilter\l::extract_fingerprint" alt="" coords="768,397,921,453"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="759,894,930,950"/>
<area shape="rect" id="node25" href="structfoedus_1_1xct_1_1XctId.html#a5c7082819f333ce0b621c2c34fe91a41" title="Returns a version of this Xid whose being_written flag is off. " alt="" coords="758,1040,931,1081"/>
<area shape="rect" id="node26" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="783,1105,906,1147"/>
<area shape="rect" id="node27" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="783,1171,906,1212"/>
<area shape="rect" id="node28" href="structfoedus_1_1xct_1_1XctId.html#a449da7fea452dd81c194f94b28e7a7e2" title="foedus::xct::XctId\l::is_valid" alt="" coords="783,975,906,1016"/>
<area shape="rect" id="node29" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="1041,975,1163,1016"/>
<area shape="rect" id="node32" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="740,477,949,519"/>
<area shape="rect" id="node35" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="504,1884,655,1925"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="753,1937,937,1979"/>
<area shape="rect" id="node39" href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f" title="Equivalent to std::atomic_thread_fence(std::memory_order_consume). " alt="" coords="493,1281,666,1323"/>
<area shape="rect" id="node40" href="classfoedus_1_1xct_1_1Xct.html#abc3a6688cdf5249c46613a1988b71975" title="The general logic invoked for every record read. " alt="" coords="512,1347,647,1388"/>
<area shape="rect" id="node41" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="762,1769,927,1795"/>
<area shape="rect" id="node42" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="758,1288,931,1329"/>
<area shape="rect" id="node43" href="classfoedus_1_1thread_1_1Thread.html#aa77cde98794b5a55e0d295284acb3e6d" title="Returns the page resolver to convert page ID to page pointer. " alt="" coords="1027,1703,1177,1759"/>
<area shape="rect" id="node44" href="namespacefoedus_1_1storage.html#a263602e0a73eedbe5f32128635106e17" title="foedus::storage::assert\l_within_valid_volatile_page" alt="" coords="1015,1599,1189,1640"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="1005,1512,1199,1553"/>
<area shape="rect" id="node46" href="namespacefoedus_1_1xct.html#a94b21516b530d0be271c6005a72009ad" title="foedus::xct::to_universal\l_lock_id" alt="" coords="763,1471,926,1512"/>
<area shape="rect" id="node47" href="classfoedus_1_1xct_1_1Xct.html#ab43ebf3a25aedb3e6ffeb3d9724bd080" title="subroutine of on_record_read() to take lock(s). " alt="" coords="761,1638,928,1694"/>
<area shape="rect" id="node48" href="classfoedus_1_1xct_1_1Xct.html#a67553e6e570cdc0b371992db058cf7cb" title="Add the given record to the read set of this transaction. " alt="" coords="774,1405,915,1447"/>
<area shape="rect" id="node50" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="504,1480,655,1521"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a86af9aa3326dd20ffdac2a1beffea0b4_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a86af9aa3326dd20ffdac2a1beffea0b4_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a86af9aa3326dd20ffdac2a1beffea0b4_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a86af9aa3326dd20ffdac2a1beffea0b4_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="235,297,416,353"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa8d098fb8e3b997b1dc52ede62b8acb6" title="locate_record()&#39;s physical_only version. " alt="" coords="235,377,416,433"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a222e0d485305f3253b0e1c97720dc0c8" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record" alt="" coords="483,27,647,83"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_part" alt="" coords="483,137,647,193"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="476,217,655,273"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="475,297,656,353"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="474,377,657,433"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="467,457,663,513"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="464,577,667,633"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af64f22f350167426098b6a99c15f864d" title="If you have already computed HashCombo, use this. " alt="" coords="729,5,903,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac9ae382b1110aec44a1df2a768c4cee3" title="If you have already computed HashCombo, use this. " alt="" coords="715,71,917,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a660df9f0d685df28fbe19f52cdbdc7e2" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_primitive" alt="" coords="734,137,898,193"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac8f3eb87098b114b9d4f8b151fee17c1" title="If you have already computed HashCombo, use this. " alt="" coords="965,137,1140,193"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="743,217,889,273"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="742,297,890,353"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="741,377,891,433"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="718,457,914,513"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="735,537,897,593"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="971,457,1134,513"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="731,617,901,673"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af64ca224598812767abe9631f280b105"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::locate_record_in_snapshot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *&#160;</td>
          <td class="paramname"><em>bin_head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html">RecordLocation</a> *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simpler version of locate_record for when we are in snapshot world. </p>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00889">889</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__combo_8hpp_source.html#l00050">foedus::storage::hash::HashCombo::bin_</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00114">foedus::storage::hash::RecordLocation::clear()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00396">foedus::storage::hash::HashDataPage::compare_slot_key()</a>, <a class="el" href="thread_8cpp_source.html#l00095">foedus::thread::Thread::find_or_read_a_snapshot_page()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00051">foedus::storage::hash::HashCombo::fingerprint_</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00412">foedus::storage::hash::HashDataPage::get_bin()</a>, <a class="el" href="page_8hpp_source.html#l00336">foedus::storage::Page::get_header()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00246">foedus::storage::hash::HashDataPage::get_record_count()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00049">foedus::storage::hash::HashCombo::hash_</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00225">foedus::storage::hash::HashDataPage::header()</a>, <a class="el" href="xct__id_8hpp_source.html#l01041">foedus::xct::XctId::is_moved()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="hash__id_8hpp_source.html#l00197">foedus::storage::hash::kSlotNotFound</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00240">foedus::storage::hash::HashDataPage::next_page_address()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00100">foedus::storage::hash::RecordLocation::observed_</a>, <a class="el" href="hash__record__location_8cpp_source.html#l00079">foedus::storage::hash::RecordLocation::populate_physical()</a>, <a class="el" href="hash__page__impl_8cpp_source.html#l00106">foedus::storage::hash::HashDataPage::search_key_physical()</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00936">locate_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                          {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin_head);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin_head-&gt;get_bin() == combo.bin_);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin_head-&gt;header().snapshot_);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  result-&gt;clear();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="comment">// Snapshot version doesn&#39;t need any of the concerns above. Easy!</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="comment">// Just physically search and follow to next page.</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  HashDataPage* page = bin_head;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keyword">const</span> uint16_t record_count = page-&gt;get_record_count();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">DataPageSlotIndex</a> index = page-&gt;search_key_physical(</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      combo.hash_,</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      combo.fingerprint_,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      key,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      key_length,</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      record_count);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">if</span> (index != <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a33cdddb3771cf2fdc3e65465792b6c96">kSlotNotFound</a>) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="comment">// found! this is final in snapshot page, so physical-only suffices (no protection needed).</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;compare_slot_key(index, combo.hash_, key, key_length));</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      result-&gt;populate_physical(page, index);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!result-&gt;observed_.is_moved());</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="comment">// Definitely not in this page, now on to next page.</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    DualPagePointer* next_page = page-&gt;next_page_address();</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">// then we are in snapshot world. no race.</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(next_page-&gt;volatile_pointer_.is_null());</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <a class="code" href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">SnapshotPagePointer</a> pointer = next_page-&gt;snapshot_pointer_;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">if</span> (pointer) {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      Page* next;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;find_or_read_a_snapshot_page(pointer, &amp;next));</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(next-&gt;get_header().snapshot_);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      page = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(next);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <span class="comment">// it&#39;s snapshot world. the result is final, we are done.</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a33cdddb3771cf2fdc3e65465792b6c96"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a33cdddb3771cf2fdc3e65465792b6c96">foedus::storage::hash::kSlotNotFound</a></div><div class="ttdeci">const DataPageSlotIndex kSlotNotFound</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00197">hash_id.hpp:197</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga629d4b8103bfb83ef9c11b842a4fd398"><div class="ttname"><a href="group__STORAGE.html#ga629d4b8103bfb83ef9c11b842a4fd398">foedus::storage::SnapshotPagePointer</a></div><div class="ttdeci">uint64_t SnapshotPagePointer</div><div class="ttdoc">Page ID of a snapshot page. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00079">storage_id.hpp:79</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a476dd04e514ebe83142d21135e8b91c7"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">foedus::storage::hash::DataPageSlotIndex</a></div><div class="ttdeci">uint16_t DataPageSlotIndex</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00196">hash_id.hpp:196</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af64ca224598812767abe9631f280b105_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af64ca224598812767abe9631f280b105_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af64ca224598812767abe9631f280b105_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af64ca224598812767abe9631f280b105_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a490056e5b2e5617cf640ea99d278ac21" title="foedus::storage::hash\l::RecordLocation::clear" alt="" coords="261,557,417,599"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="252,989,427,1045"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="492,897,717,939"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="235,623,444,664"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="794,740,943,781"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="256,857,423,899"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="257,923,421,964"/>
<area shape="rect" id="node37" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="543,1093,666,1135"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="259,740,420,781"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="264,1119,415,1175"/>
<area shape="rect" id="node41" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab1d971d633ca8153c6a7363694e254a0" title="Populates fields other than readset_. " alt="" coords="251,1473,428,1529"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="257,1199,421,1255"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac2e82163d7348a6c88fecff711025b08" title="foedus::storage::hash\l::HashDataPage::get_slot" alt="" coords="519,963,690,1004"/>
<area shape="rect" id="node6" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679" title="Calculates hash value for general input. " alt="" coords="531,1028,678,1069"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a49863802f2bfb024c928a37ea7abce07" title="foedus::storage::hash\l::HashDataPage::record\l_from_offset" alt="" coords="524,1239,685,1295"/>
<area shape="rect" id="node9" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="500,564,709,605"/>
<area shape="rect" id="node10" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="801,364,936,405"/>
<area shape="rect" id="node11" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="765,429,972,471"/>
<area shape="rect" id="node21" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8" title="foedus::memory::PagePool\l::get_base" alt="" coords="1052,593,1231,635"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="777,623,961,664"/>
<area shape="rect" id="node27" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="1049,789,1233,831"/>
<area shape="rect" id="node31" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="765,136,972,177"/>
<area shape="rect" id="node34" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8" title="Get a tentative work memory of the specified size from pre&#45;allocated thread&#45;private memory..." alt="" coords="787,299,950,340"/>
<area shape="rect" id="node12" href="classfoedus_1_1cache_1_1CacheHashtable.html#a30b6a0b28cce30d50da7e0419c8cad20" title="Returns a bucket number the given page ID should belong to. " alt="" coords="1038,201,1245,243"/>
<area shape="rect" id="node14" href="structfoedus_1_1cache_1_1CacheBucket.html#ab91d1b89c885979b7a6a4ef70b12b54d" title="foedus::cache::CacheBucket\l::get_content_id" alt="" coords="1047,528,1236,569"/>
<area shape="rect" id="node15" href="classfoedus_1_1cache_1_1CacheHashtable.html#acea3236385a3b8d05ed1a60186e32ee8" title="foedus::cache::CacheHashtable\l::get_logical_buckets" alt="" coords="1038,267,1245,308"/>
<area shape="rect" id="node16" href="structfoedus_1_1cache_1_1HashFunc.html#a9470855bb66d98df48f82fc5ba6655c6" title="Returns another hash value used to differentiate IDs with similar hash values. " alt="" coords="1056,136,1227,177"/>
<area shape="rect" id="node17" href="structfoedus_1_1cache_1_1CacheBucket.html#aad7099f48418a335a80260a664bf2f02" title="foedus::cache::CacheBucket\l::get_tag" alt="" coords="1047,332,1236,373"/>
<area shape="rect" id="node18" href="structfoedus_1_1cache_1_1CacheRefCount.html#af555d7665e995d8e65f315c708d28daa" title="foedus::cache::CacheRefCount\l::increment" alt="" coords="1041,397,1242,439"/>
<area shape="rect" id="node19" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="1055,463,1227,504"/>
<area shape="rect" id="node13" href="structfoedus_1_1cache_1_1HashFunc.html#a19737fa3c91676f9c85536f5928b7501" title="Returns a bucket number the given snapshot page ID should belong to. " alt="" coords="1319,201,1489,243"/>
<area shape="rect" id="node20" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1318,463,1490,504"/>
<area shape="rect" id="node24" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ac3e2f6d24f2b0f5c04d2cde48db11f6a" title="Same, except it&#39;s for snapshot page. " alt="" coords="1029,724,1254,765"/>
<area shape="rect" id="node29" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a7ea5067e450fa872240cb010ddb65464" title="Same, except it&#39;s for snapshot page. " alt="" coords="1020,659,1263,700"/>
<area shape="rect" id="node25" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ac661b8baf462a1e969a8a1c7e619858b" title="foedus::memory::PagePool\lOffsetChunk::empty" alt="" coords="1545,727,1724,768"/>
<area shape="rect" id="node26" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#af897b38ac1ef4217ff99018436c0112e" title="foedus::memory::PagePool\lOffsetChunk::pop_back" alt="" coords="1315,697,1493,739"/>
<area shape="rect" id="node28" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="1311,815,1497,856"/>
<area shape="rect" id="node30" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ace44cb03e7da84d29f3a02a790c69191" title="foedus::memory::PagePool\lOffsetChunk::full" alt="" coords="1315,632,1493,673"/>
<area shape="rect" id="node32" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7" title="Equivalent to std::atomic_thread_fence(std::memory_order_release). " alt="" coords="1055,71,1228,112"/>
<area shape="rect" id="node33" href="structfoedus_1_1cache_1_1CacheBucket.html#aaa52396996e73a08cace2a2dcef82ffb" title="foedus::cache::CacheBucket\l::reset" alt="" coords="1047,5,1236,47"/>
<area shape="rect" id="node39" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="524,740,685,781"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="519,1399,690,1455"/>
<area shape="rect" id="node43" href="structfoedus_1_1xct_1_1XctId.html#a5c7082819f333ce0b621c2c34fe91a41" title="Returns a version of this Xid whose being_written flag is off. " alt="" coords="518,1480,691,1521"/>
<area shape="rect" id="node44" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="543,1545,666,1587"/>
<area shape="rect" id="node45" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="543,1611,666,1652"/>
<area shape="rect" id="node46" href="structfoedus_1_1xct_1_1XctId.html#a449da7fea452dd81c194f94b28e7a7e2" title="foedus::xct::XctId\l::is_valid" alt="" coords="543,1676,666,1717"/>
<area shape="rect" id="node47" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="807,1676,930,1717"/>
<area shape="rect" id="node49" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a4e5601b652daaffbcb9fa81aee6746c6" title="foedus::storage::hash\l::DataPageBloomFilter\l::contains" alt="" coords="528,1159,681,1215"/>
<area shape="rect" id="node50" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a28a11a7b04e04d895b21f29709eacd1f" title="foedus::storage::hash\l::DataPageBloomFilter\l::extract_fingerprint" alt="" coords="528,1319,681,1375"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af64ca224598812767abe9631f280b105_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af64ca224598812767abe9631f280b105_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af64ca224598812767abe9631f280b105_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af64ca224598812767abe9631f280b105_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="235,337,416,393"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="464,297,645,353"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa8d098fb8e3b997b1dc52ede62b8acb6" title="locate_record()&#39;s physical_only version. " alt="" coords="464,377,645,433"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a222e0d485305f3253b0e1c97720dc0c8" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record" alt="" coords="713,27,877,83"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_part" alt="" coords="713,137,877,193"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="705,217,884,273"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="704,297,885,353"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="703,377,886,433"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="697,457,893,513"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="693,577,896,633"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af64f22f350167426098b6a99c15f864d" title="If you have already computed HashCombo, use this. " alt="" coords="958,5,1133,47"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac9ae382b1110aec44a1df2a768c4cee3" title="If you have already computed HashCombo, use this. " alt="" coords="944,71,1147,112"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a660df9f0d685df28fbe19f52cdbdc7e2" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_primitive" alt="" coords="963,137,1127,193"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac8f3eb87098b114b9d4f8b151fee17c1" title="If you have already computed HashCombo, use this. " alt="" coords="1195,137,1369,193"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="972,217,1119,273"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="971,297,1119,353"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="971,377,1120,433"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="947,457,1143,513"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="964,537,1127,593"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="1201,457,1363,513"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="960,617,1131,673"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a07025464a0eba08710f6fa92d7c0f32d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::locate_record_logical </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>create_if_notfound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>create_payload_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *&#160;</td>
          <td class="paramname"><em>bin_head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html">RecordLocation</a> *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no...">locate_record()</a>'s logical+physical version. </p>
<p>Invoke this rather than locate_record directly </p>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00400">400</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00936">locate_record()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00356">delete_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00166">get_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00210">get_record_part()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00554">increment_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00277">insert_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00502">overwrite_record()</a>, and <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00390">upsert_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                            {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4">locate_record</a>(</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      context,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      for_write,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keyword">false</span>,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      create_if_notfound,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      create_payload_length,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      key,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      key_length,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      combo,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      bin_head,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      result);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a86af9aa3326dd20ffdac2a1beffea0b4"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4">foedus::storage::hash::HashStoragePimpl::locate_record</a></div><div class="ttdeci">ErrorCode locate_record(thread::Thread *context, bool for_write, bool physical_only, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const HashCombo &amp;combo, HashDataPage *bin_head, RecordLocation *result)</div><div class="ttdoc">Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no...</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00936">hash_storage_pimpl.cpp:936</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a07025464a0eba08710f6fa92d7c0f32d_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a07025464a0eba08710f6fa92d7c0f32d_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a07025464a0eba08710f6fa92d7c0f32d_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a07025464a0eba08710f6fa92d7c0f32d_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="235,581,416,637"/>
<area shape="rect" id="node3" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="487,15,633,56"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a490056e5b2e5617cf640ea99d278ac21" title="foedus::storage::hash\l::RecordLocation::clear" alt="" coords="731,136,887,177"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="721,551,896,607"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="961,456,1187,497"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="725,201,892,243"/>
<area shape="rect" id="node11" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="485,321,635,363"/>
<area shape="rect" id="node12" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="485,80,635,121"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1PageVersionStatus.html#a8360836cebd9fbeadfeb2a31809270c2" title="foedus::storage::PageVersion\lStatus::has_next_page" alt="" coords="464,449,656,491"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="727,319,891,360"/>
<area shape="rect" id="node17" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="1013,944,1135,985"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="728,843,889,884"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="469,515,651,571"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="733,762,884,818"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab1d971d633ca8153c6a7363694e254a0" title="Populates fields other than readset_. " alt="" coords="720,1010,897,1066"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="727,631,891,687"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34" title="Subroutine of locate_record() to create/migrate a physical record of the given key in the page or its..." alt="" coords="469,2002,651,2058"/>
<area shape="rect" id="node37" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="987,1936,1161,1977"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a5c39383806af101855b26268abbb00e3" title="Populates the result with XID and possibly readset. " alt="" coords="471,1193,649,1249"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="485,1849,635,1891"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac2e82163d7348a6c88fecff711025b08" title="foedus::storage::hash\l::HashDataPage::get_slot" alt="" coords="989,521,1159,563"/>
<area shape="rect" id="node8" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679" title="Calculates hash value for general input. " alt="" coords="1001,587,1147,628"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a49863802f2bfb024c928a37ea7abce07" title="foedus::storage::hash\l::HashDataPage::record\l_from_offset" alt="" coords="993,813,1155,869"/>
<area shape="rect" id="node13" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="719,71,898,112"/>
<area shape="rect" id="node14" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="733,5,884,47"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1251,1396,1412,1437"/>
<area shape="rect" id="node21" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="704,384,913,425"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1257,397,1406,439"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="969,339,1179,380"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="989,1010,1159,1066"/>
<area shape="rect" id="node27" href="structfoedus_1_1xct_1_1XctId.html#a5c7082819f333ce0b621c2c34fe91a41" title="Returns a version of this Xid whose being_written flag is off. " alt="" coords="987,1156,1161,1197"/>
<area shape="rect" id="node28" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="1013,1287,1135,1328"/>
<area shape="rect" id="node29" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="1013,1221,1135,1263"/>
<area shape="rect" id="node30" href="structfoedus_1_1xct_1_1XctId.html#a449da7fea452dd81c194f94b28e7a7e2" title="foedus::xct::XctId\l::is_valid" alt="" coords="1013,1091,1135,1132"/>
<area shape="rect" id="node32" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a4e5601b652daaffbcb9fa81aee6746c6" title="foedus::storage::hash\l::DataPageBloomFilter\l::contains" alt="" coords="997,733,1151,789"/>
<area shape="rect" id="node33" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a28a11a7b04e04d895b21f29709eacd1f" title="foedus::storage::hash\l::DataPageBloomFilter\l::extract_fingerprint" alt="" coords="997,653,1151,709"/>
<area shape="rect" id="node35" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="733,2031,884,2072"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="982,2053,1166,2095"/>
<area shape="rect" id="node39" href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f" title="Equivalent to std::atomic_thread_fence(std::memory_order_consume). " alt="" coords="722,1091,895,1132"/>
<area shape="rect" id="node40" href="classfoedus_1_1xct_1_1Xct.html#abc3a6688cdf5249c46613a1988b71975" title="The general logic invoked for every record read. " alt="" coords="741,1484,876,1525"/>
<area shape="rect" id="node41" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="991,1819,1157,1846"/>
<area shape="rect" id="node42" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="987,1871,1161,1912"/>
<area shape="rect" id="node43" href="classfoedus_1_1thread_1_1Thread.html#aa77cde98794b5a55e0d295284acb3e6d" title="Returns the page resolver to convert page ID to page pointer. " alt="" coords="1256,1687,1407,1743"/>
<area shape="rect" id="node44" href="namespacefoedus_1_1storage.html#a263602e0a73eedbe5f32128635106e17" title="foedus::storage::assert\l_within_valid_volatile_page" alt="" coords="1244,1583,1419,1624"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="1235,1496,1428,1537"/>
<area shape="rect" id="node46" href="namespacefoedus_1_1xct.html#a94b21516b530d0be271c6005a72009ad" title="foedus::xct::to_universal\l_lock_id" alt="" coords="993,1455,1155,1496"/>
<area shape="rect" id="node47" href="classfoedus_1_1xct_1_1Xct.html#ab43ebf3a25aedb3e6ffeb3d9724bd080" title="subroutine of on_record_read() to take lock(s). " alt="" coords="991,1622,1157,1678"/>
<area shape="rect" id="node48" href="classfoedus_1_1xct_1_1Xct.html#a67553e6e570cdc0b371992db058cf7cb" title="Add the given record to the read set of this transaction. " alt="" coords="1003,1753,1145,1795"/>
<area shape="rect" id="node50" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="733,1853,884,1895"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a07025464a0eba08710f6fa92d7c0f32d_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a07025464a0eba08710f6fa92d7c0f32d_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a07025464a0eba08710f6fa92d7c0f32d_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a07025464a0eba08710f6fa92d7c0f32d_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="245,19,427,75"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a222e0d485305f3253b0e1c97720dc0c8" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record" alt="" coords="254,112,418,168"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_part" alt="" coords="254,217,418,273"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="235,297,437,353"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="247,377,425,433"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="238,457,434,513"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="245,577,427,633"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="513,5,661,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af64f22f350167426098b6a99c15f864d" title="If you have already computed HashCombo, use this. " alt="" coords="499,86,674,127"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac9ae382b1110aec44a1df2a768c4cee3" title="If you have already computed HashCombo, use this. " alt="" coords="485,151,688,193"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a660df9f0d685df28fbe19f52cdbdc7e2" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_primitive" alt="" coords="505,217,669,273"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac8f3eb87098b114b9d4f8b151fee17c1" title="If you have already computed HashCombo, use this. " alt="" coords="736,217,911,273"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="501,297,672,353"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="513,377,660,433"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="489,457,685,513"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="505,537,668,593"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="742,457,905,513"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="512,617,661,673"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa8d098fb8e3b997b1dc52ede62b8acb6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::locate_record_physical_only </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>create_if_notfound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>create_payload_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *&#160;</td>
          <td class="paramname"><em>bin_head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html">RecordLocation</a> *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no...">locate_record()</a>'s physical_only version. </p>
<p>Invoke this rather than locate_record directly </p>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00377">377</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00936">locate_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                            {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4">locate_record</a>(</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      context,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      for_write,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keyword">true</span>,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      create_if_notfound,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      create_payload_length,</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      key,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      key_length,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      combo,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      bin_head,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      result);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a86af9aa3326dd20ffdac2a1beffea0b4"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4">foedus::storage::hash::HashStoragePimpl::locate_record</a></div><div class="ttdeci">ErrorCode locate_record(thread::Thread *context, bool for_write, bool physical_only, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const HashCombo &amp;combo, HashDataPage *bin_head, RecordLocation *result)</div><div class="ttdoc">Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no...</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00936">hash_storage_pimpl.cpp:936</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa8d098fb8e3b997b1dc52ede62b8acb6_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa8d098fb8e3b997b1dc52ede62b8acb6_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa8d098fb8e3b997b1dc52ede62b8acb6_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aa8d098fb8e3b997b1dc52ede62b8acb6_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="235,581,416,637"/>
<area shape="rect" id="node3" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="487,15,633,56"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a490056e5b2e5617cf640ea99d278ac21" title="foedus::storage::hash\l::RecordLocation::clear" alt="" coords="731,136,887,177"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="721,551,896,607"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="961,456,1187,497"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="725,201,892,243"/>
<area shape="rect" id="node11" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="485,321,635,363"/>
<area shape="rect" id="node12" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="485,80,635,121"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1PageVersionStatus.html#a8360836cebd9fbeadfeb2a31809270c2" title="foedus::storage::PageVersion\lStatus::has_next_page" alt="" coords="464,449,656,491"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="727,319,891,360"/>
<area shape="rect" id="node17" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="1013,944,1135,985"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="728,843,889,884"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="469,515,651,571"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="733,762,884,818"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab1d971d633ca8153c6a7363694e254a0" title="Populates fields other than readset_. " alt="" coords="720,1010,897,1066"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="727,631,891,687"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34" title="Subroutine of locate_record() to create/migrate a physical record of the given key in the page or its..." alt="" coords="469,2002,651,2058"/>
<area shape="rect" id="node37" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="987,1936,1161,1977"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a5c39383806af101855b26268abbb00e3" title="Populates the result with XID and possibly readset. " alt="" coords="471,1193,649,1249"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="485,1849,635,1891"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac2e82163d7348a6c88fecff711025b08" title="foedus::storage::hash\l::HashDataPage::get_slot" alt="" coords="989,521,1159,563"/>
<area shape="rect" id="node8" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679" title="Calculates hash value for general input. " alt="" coords="1001,587,1147,628"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a49863802f2bfb024c928a37ea7abce07" title="foedus::storage::hash\l::HashDataPage::record\l_from_offset" alt="" coords="993,813,1155,869"/>
<area shape="rect" id="node13" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="719,71,898,112"/>
<area shape="rect" id="node14" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="733,5,884,47"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1251,1396,1412,1437"/>
<area shape="rect" id="node21" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="704,384,913,425"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1257,397,1406,439"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="969,339,1179,380"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="989,1010,1159,1066"/>
<area shape="rect" id="node27" href="structfoedus_1_1xct_1_1XctId.html#a5c7082819f333ce0b621c2c34fe91a41" title="Returns a version of this Xid whose being_written flag is off. " alt="" coords="987,1156,1161,1197"/>
<area shape="rect" id="node28" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="1013,1287,1135,1328"/>
<area shape="rect" id="node29" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="1013,1221,1135,1263"/>
<area shape="rect" id="node30" href="structfoedus_1_1xct_1_1XctId.html#a449da7fea452dd81c194f94b28e7a7e2" title="foedus::xct::XctId\l::is_valid" alt="" coords="1013,1091,1135,1132"/>
<area shape="rect" id="node32" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a4e5601b652daaffbcb9fa81aee6746c6" title="foedus::storage::hash\l::DataPageBloomFilter\l::contains" alt="" coords="997,733,1151,789"/>
<area shape="rect" id="node33" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a28a11a7b04e04d895b21f29709eacd1f" title="foedus::storage::hash\l::DataPageBloomFilter\l::extract_fingerprint" alt="" coords="997,653,1151,709"/>
<area shape="rect" id="node35" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="733,2031,884,2072"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="982,2053,1166,2095"/>
<area shape="rect" id="node39" href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f" title="Equivalent to std::atomic_thread_fence(std::memory_order_consume). " alt="" coords="722,1091,895,1132"/>
<area shape="rect" id="node40" href="classfoedus_1_1xct_1_1Xct.html#abc3a6688cdf5249c46613a1988b71975" title="The general logic invoked for every record read. " alt="" coords="741,1484,876,1525"/>
<area shape="rect" id="node41" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="991,1819,1157,1846"/>
<area shape="rect" id="node42" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="987,1871,1161,1912"/>
<area shape="rect" id="node43" href="classfoedus_1_1thread_1_1Thread.html#aa77cde98794b5a55e0d295284acb3e6d" title="Returns the page resolver to convert page ID to page pointer. " alt="" coords="1256,1687,1407,1743"/>
<area shape="rect" id="node44" href="namespacefoedus_1_1storage.html#a263602e0a73eedbe5f32128635106e17" title="foedus::storage::assert\l_within_valid_volatile_page" alt="" coords="1244,1583,1419,1624"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="1235,1496,1428,1537"/>
<area shape="rect" id="node46" href="namespacefoedus_1_1xct.html#a94b21516b530d0be271c6005a72009ad" title="foedus::xct::to_universal\l_lock_id" alt="" coords="993,1455,1155,1496"/>
<area shape="rect" id="node47" href="classfoedus_1_1xct_1_1Xct.html#ab43ebf3a25aedb3e6ffeb3d9724bd080" title="subroutine of on_record_read() to take lock(s). " alt="" coords="991,1622,1157,1678"/>
<area shape="rect" id="node48" href="classfoedus_1_1xct_1_1Xct.html#a67553e6e570cdc0b371992db058cf7cb" title="Add the given record to the read set of this transaction. " alt="" coords="1003,1753,1145,1795"/>
<area shape="rect" id="node50" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="733,1853,884,1895"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afa2342b5f0a374e38f0ec00242494a34"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::locate_record_reserve_physical </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> **&#160;</td>
          <td class="paramname"><em>page_in_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>examined_records</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">DataPageSlotIndex</a> *&#160;</td>
          <td class="paramname"><em>new_location</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine of <a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no...">locate_record()</a> to create/migrate a physical record of the given key in the page or its next pages. </p>
<p>This method has the following possible outcomes: </p><ul>
<li>Created a new physical record of the key in the given page or its next pages. </li>
<li>Did nothing because we found an existing record of the key in the given page or its next pages.</li>
</ul>
<p>In either case, new_location returns the index of the record, thus it's never a kSlotNotFound.</p>
<p>This method is <em>physical-only</em>. It doesn't add any read-set or take logical record locks. Thus, even <em>seemingly</em> right after calling this method, you might find the new_location points to a moved record. It might happen. The caller is responsible to do a logical lock/readset etc and retries if necessary. But, this method does guarantee that the new_location points to a record of the given key that was at least at some point valid. </p>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l01074">1074</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="hash__reserve__impl_8hpp_source.html#l00140">foedus::storage::hash::ReserveRecords::out_page_</a>, <a class="el" href="hash__reserve__impl_8hpp_source.html#l00133">foedus::storage::hash::ReserveRecords::out_slot_</a>, and <a class="el" href="thread__pimpl_8cpp_source.html#l00952">foedus::thread::Thread::run_nested_sysxct()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00936">locate_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                                   {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(new_location);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  ReserveRecords functor(</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    context,</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    *page_in_out,</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    key,</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    key_length,</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    combo,</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    payload_length,</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    payload_length,</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    examined_records);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;functor, 5U));</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  *page_in_out = functor.out_page_;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  *new_location = functor.out_slot_;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afa2342b5f0a374e38f0ec00242494a34_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afa2342b5f0a374e38f0ec00242494a34_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afa2342b5f0a374e38f0ec00242494a34_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afa2342b5f0a374e38f0ec00242494a34_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="235,104,385,145"/>
<area shape="rect" id="node3" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="433,104,617,145"/>
<area shape="rect" id="node4" href="classfoedus_1_1xct_1_1Xct.html#aca66ae9959651b7c6fa86a75db287f54" title="foedus::xct::Xct::get\l_sysxct_workspace" alt="" coords="688,5,827,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761" title="foedus::thread::ThreadPimpl\l::cll_get_max_locked_id" alt="" coords="665,71,849,112"/>
<area shape="rect" id="node10" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4" title="foedus::thread::ThreadPimpl\l::is_simple_mcs_rw" alt="" coords="665,136,849,177"/>
<area shape="rect" id="node11" href="group__SYSXCT.html#gaf49955c6d4efe3d92e6e09b4ff890618" title="Runs a system transaction nested in a user transaction. " alt="" coords="678,201,837,243"/>
<area shape="rect" id="node6" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8" title="foedus::xct::Xct::get\l_current_lock_list" alt="" coords="931,39,1069,80"/>
<area shape="rect" id="node7" href="classfoedus_1_1xct_1_1CurrentLockList.html#a398ec264786992d102b8edd74d5767b3" title="foedus::xct::CurrentLock\lList::get_max_locked_id" alt="" coords="918,104,1082,145"/>
<area shape="rect" id="node8" href="classfoedus_1_1xct_1_1CurrentLockList.html#ab360f7fc3d8c0880b394084d45e492e9" title="foedus::xct::CurrentLock\lList::get_entry" alt="" coords="1151,104,1315,145"/>
<area shape="rect" id="node9" href="classfoedus_1_1xct_1_1CurrentLockList.html#a78b6d1612fda232b7e8c52dd3f6c2504" title="foedus::xct::CurrentLock\lList::is_valid_entry" alt="" coords="1363,104,1527,145"/>
<area shape="rect" id="node12" href="structfoedus_1_1xct_1_1SysxctFunctor.html#a383a9cfd5d8fa5caf45c7ffb6dc05535" title="Execute the system transaction. " alt="" coords="897,209,1103,235"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afa2342b5f0a374e38f0ec00242494a34_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afa2342b5f0a374e38f0ec00242494a34_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afa2342b5f0a374e38f0ec00242494a34_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afa2342b5f0a374e38f0ec00242494a34_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="235,337,416,393"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="464,297,645,353"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aa8d098fb8e3b997b1dc52ede62b8acb6" title="locate_record()&#39;s physical_only version. " alt="" coords="464,377,645,433"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="704,19,885,75"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a222e0d485305f3253b0e1c97720dc0c8" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record" alt="" coords="713,112,877,168"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a4eff8bc4e42a5973c8553830890d8a24" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_part" alt="" coords="713,217,877,273"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="693,297,896,353"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="705,377,884,433"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="697,457,893,513"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="703,577,886,633"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="971,5,1119,61"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af64f22f350167426098b6a99c15f864d" title="If you have already computed HashCombo, use this. " alt="" coords="958,86,1133,127"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac9ae382b1110aec44a1df2a768c4cee3" title="If you have already computed HashCombo, use this. " alt="" coords="944,151,1147,193"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a660df9f0d685df28fbe19f52cdbdc7e2" title="foedus::storage::hash\l::HashStoragePimpl::get\l_record_primitive" alt="" coords="963,217,1127,273"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ac8f3eb87098b114b9d4f8b151fee17c1" title="If you have already computed HashCombo, use this. " alt="" coords="1195,217,1369,273"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="960,297,1131,353"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="972,377,1119,433"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="947,457,1143,513"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="964,537,1127,593"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="1201,457,1363,513"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="971,617,1120,673"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="add8aafbb32713dc6be20804da789f43d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::overwrite_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a766f21f5ad81dd98d90be0fef31a1b64" title="Overwrites a part of one record of the given key in this hash storage. ">foedus::storage::hash::HashStorage::overwrite_record()</a> </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00502">502</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00095">foedus::storage::hash::HashCommonLogType::calculate_log_length()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00086">foedus::storage::hash::RecordLocation::cur_payload_length_</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00166">get_bin_bits()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00161">get_id()</a>, <a class="el" href="thread_8cpp_source.html#l00078">foedus::thread::Thread::get_thread_log_buffer()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00049">foedus::storage::hash::HashCombo::hash_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00108">foedus::storage::hash::RecordLocation::is_found()</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="error__code_8hpp_source.html#l00176">foedus::kErrorCodeStrTooShortPayload</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00842">locate_bin()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00400">locate_record_logical()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00100">foedus::storage::hash::RecordLocation::observed_</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00380">foedus::storage::hash::HashOverwriteLogType::populate()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00260">register_record_write_log()</a>, and <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">foedus::log::ThreadLogBuffer::reserve_new_log()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00192">foedus::storage::hash::HashStorage::overwrite_record()</a>, and <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00259">overwrite_record_primitive()</a>.</p>
<div class="fragment"><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                          {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  HashDataPage* bin_head;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">locate_bin</a>(context, <span class="keyword">true</span>, combo, &amp;bin_head));</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin_head);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  RecordLocation location;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">locate_record_logical</a>(</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    context,</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keyword">true</span>,</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keyword">false</span>,</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    0,</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    key,</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    key_length,</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    combo,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    bin_head,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    &amp;location));</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">if</span> (!location.is_found()) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;  <span class="comment">// protected by page version set, so we are done</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;  <span class="comment">// protected by the read set</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (location.cur_payload_length_ &lt; payload_offset + payload_count) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;short record &quot;</span> &lt;&lt; combo;  <span class="comment">// probably this is a rare error. so warn.</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">kErrorCodeStrTooShortPayload</a>;  <span class="comment">// protected by the read set</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">HashOverwriteLogType::calculate_log_length</a>(key_length, payload_count);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  HashOverwriteLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>HashOverwriteLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  log_entry-&gt;populate(</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">get_id</a>(),</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    key,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    key_length,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">get_bin_bits</a>(),</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    combo.hash_,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    payload,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    payload_offset,</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    payload_count);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">// overwrite_record is apparently a blind-write, but actually it&#39;s not.</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">// we depend on the fact that the record was not deleted/moved! so,</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">// this still has a related/dependent read-set</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">register_record_write_log</a>(context, location, log_entry);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">foedus::kErrorCodeStrTooShortPayload</a></div><div class="ttdoc">0x080A : "STORAGE: The record&#39;s payload is smaller than requested" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00176">error_code.hpp:176</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a07025464a0eba08710f6fa92d7c0f32d"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">foedus::storage::hash::HashStoragePimpl::locate_record_logical</a></div><div class="ttdeci">ErrorCode locate_record_logical(thread::Thread *context, bool for_write, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const HashCombo &amp;combo, HashDataPage *bin_head, RecordLocation *result)</div><div class="ttdoc">locate_record()&#39;s logical+physical version. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00400">hash_storage_pimpl.hpp:400</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_abdd0cbf1f438986888173779270bab4a"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">foedus::storage::hash::HashStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00161">hash_storage_pimpl.hpp:161</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a0f073a76a5abeac0829ba1e47a40c02c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">foedus::storage::hash::HashStoragePimpl::locate_bin</a></div><div class="ttdeci">ErrorCode locate_bin(thread::Thread *context, bool for_write, const HashCombo &amp;combo, HashDataPage **bin_head)</div><div class="ttdoc">Find a pointer to the bin that contains records for the hash. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00842">hash_storage_pimpl.cpp:842</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aff4c87787f9e6ce9c4306b8bcaf36a47"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">foedus::storage::hash::HashStoragePimpl::get_bin_bits</a></div><div class="ttdeci">uint8_t get_bin_bits() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00166">hash_storage_pimpl.hpp:166</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aeea83aff996263bc8e9b3623fbe305a1"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">foedus::storage::hash::HashStoragePimpl::register_record_write_log</a></div><div class="ttdeci">ErrorCode register_record_write_log(thread::Thread *context, const RecordLocation &amp;location, log::RecordLogType *log_entry)</div><div class="ttdoc">Used in the following methods. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00260">hash_storage_pimpl.cpp:260</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType_html_a04238b5b4aec46d0a24b5489553b793a"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">foedus::storage::hash::HashCommonLogType::calculate_log_length</a></div><div class="ttdeci">static uint16_t calculate_log_length(uint16_t key_length, uint16_t payload_count) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="hash__log__types_8hpp_source.html#l00095">hash_log_types.hpp:95</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_add8aafbb32713dc6be20804da789f43d_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_add8aafbb32713dc6be20804da789f43d_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_add8aafbb32713dc6be20804da789f43d_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_add8aafbb32713dc6be20804da789f43d_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a" title="foedus::storage::hash\l::HashCommonLogType::\lcalculate_log_length" alt="" coords="268,86,436,142"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_bits" alt="" coords="270,169,434,225"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a" title="foedus::storage::hash\l::HashStoragePimpl::get_id" alt="" coords="519,213,700,255"/>
<area shape="rect" id="node7" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="275,1252,429,1293"/>
<area shape="rect" id="node8" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="291,1317,413,1359"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab29603dc5748833bc006e129a152a4d1" title="foedus::storage::hash\l::RecordLocation::is_found" alt="" coords="521,279,697,320"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="249,1121,455,1163"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="261,541,443,597"/>
<area shape="rect" id="node42" href="structfoedus_1_1storage_1_1hash_1_1HashOverwriteLogType.html#a29bf2faaed91770de679b2e836ffa3b8" title="foedus::storage::hash\l::HashOverwriteLogType\l::populate" alt="" coords="271,1383,433,1439"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1" title="Used in the following methods. " alt="" coords="257,395,447,451"/>
<area shape="rect" id="node47" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="259,1187,445,1228"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="529,97,689,123"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="509,148,709,189"/>
<area shape="rect" id="node11" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="539,1364,680,1405"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="1028,1096,1189,1137"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="503,1299,716,1340"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="1025,755,1192,796"/>
<area shape="rect" id="node18" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="1033,823,1184,864"/>
<area shape="rect" id="node19" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1039,965,1178,1007"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="1028,1162,1189,1218"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="1028,1631,1189,1687"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="779,1685,941,1741"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="778,1765,942,1821"/>
<area shape="rect" id="node14" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1004,1031,1213,1072"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="771,1023,949,1079"/>
<area shape="rect" id="node16" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1033,1565,1184,1607"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1013,1393,1204,1435"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="779,1306,941,1362"/>
<area shape="rect" id="node29" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="769,1386,951,1442"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="1033,900,1184,941"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="1027,464,1191,505"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1028,340,1189,381"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1279,1169,1469,1211"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="519,541,700,597"/>
<area shape="rect" id="node33" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="787,653,933,695"/>
<area shape="rect" id="node34" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a490056e5b2e5617cf640ea99d278ac21" title="foedus::storage::hash\l::RecordLocation::clear" alt="" coords="1031,272,1187,313"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="1021,190,1196,246"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="1261,197,1487,239"/>
<area shape="rect" id="node37" href="structfoedus_1_1storage_1_1PageVersionStatus.html#a8360836cebd9fbeadfeb2a31809270c2" title="foedus::storage::PageVersion\lStatus::has_next_page" alt="" coords="764,325,956,367"/>
<area shape="rect" id="node38" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="1047,123,1170,164"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="769,391,951,447"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34" title="Subroutine of locate_record() to create/migrate a physical record of the given key in the page or its..." alt="" coords="769,573,951,629"/>
<area shape="rect" id="node41" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="773,1517,947,1559"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="524,461,695,517"/>
<area shape="rect" id="node45" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="539,344,680,385"/>
<area shape="rect" id="node46" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="789,5,931,47"/>
<area shape="rect" id="node48" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="516,1963,703,2004"/>
<area shape="rect" id="node49" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="767,1845,953,1887"/>
<area shape="rect" id="node50" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="516,1532,703,1573"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_add8aafbb32713dc6be20804da789f43d_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_add8aafbb32713dc6be20804da789f43d_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_add8aafbb32713dc6be20804da789f43d_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_add8aafbb32713dc6be20804da789f43d_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="266,5,429,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="249,85,445,141"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="493,85,656,141"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a26fdac44f55a502f17cb82e98966dd84"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename PAYLOAD &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::overwrite_record_primitive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PAYLOAD&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7a42d14c4073108d38f86a0c99838d0a" title="Overwrites a part of one record of the given key in this storage as a primitive value. ">foedus::storage::hash::HashStorage::overwrite_record_primitive()</a> </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00259">259</a> of file <a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00502">overwrite_record()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00212">foedus::storage::hash::HashStorage::overwrite_record_primitive()</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                             {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// same above. still handy as an API, though.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d">overwrite_record</a>(</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      context,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      key,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      key_length,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      combo,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      &amp;payload,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      payload_offset,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keyword">sizeof</span>(payload));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_add8aafbb32713dc6be20804da789f43d"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d">foedus::storage::hash::HashStoragePimpl::overwrite_record</a></div><div class="ttdeci">ErrorCode overwrite_record(thread::Thread *context, const void *key, uint16_t key_length, const HashCombo &amp;combo, const void *payload, uint16_t payload_offset, uint16_t payload_count)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00502">hash_storage_pimpl.cpp:502</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a26fdac44f55a502f17cb82e98966dd84_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a26fdac44f55a502f17cb82e98966dd84_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a26fdac44f55a502f17cb82e98966dd84_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a26fdac44f55a502f17cb82e98966dd84_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="249,507,445,563"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a" title="foedus::storage::hash\l::HashCommonLogType::\lcalculate_log_length" alt="" coords="512,53,680,109"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_bits" alt="" coords="514,137,678,193"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a" title="foedus::storage::hash\l::HashStoragePimpl::get_id" alt="" coords="763,179,944,220"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="519,1056,673,1097"/>
<area shape="rect" id="node9" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="535,1121,657,1163"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab29603dc5748833bc006e129a152a4d1" title="foedus::storage::hash\l::RecordLocation::is_found" alt="" coords="765,244,941,285"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="493,991,699,1032"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="505,507,687,563"/>
<area shape="rect" id="node42" href="structfoedus_1_1storage_1_1hash_1_1HashOverwriteLogType.html#a29bf2faaed91770de679b2e836ffa3b8" title="foedus::storage::hash\l::HashOverwriteLogType\l::populate" alt="" coords="515,1187,677,1243"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1" title="Used in the following methods. " alt="" coords="501,375,691,431"/>
<area shape="rect" id="node47" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="503,1851,689,1892"/>
<area shape="rect" id="node4" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="773,62,933,89"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="753,113,953,155"/>
<area shape="rect" id="node12" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="783,1075,924,1116"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="1272,1189,1433,1231"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="747,1365,960,1407"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="1269,737,1436,779"/>
<area shape="rect" id="node19" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="1277,851,1428,892"/>
<area shape="rect" id="node20" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1283,1019,1422,1060"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="1272,1643,1433,1699"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="1272,1270,1433,1326"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="1023,1023,1185,1079"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="1022,1698,1186,1754"/>
<area shape="rect" id="node15" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1248,1111,1457,1152"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="1015,1103,1193,1159"/>
<area shape="rect" id="node17" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1277,1577,1428,1619"/>
<area shape="rect" id="node24" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1257,1473,1448,1515"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="1023,1386,1185,1442"/>
<area shape="rect" id="node30" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="1013,1466,1195,1522"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="1277,928,1428,969"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="1271,409,1435,451"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1272,475,1433,516"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1523,1651,1713,1692"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="763,507,944,563"/>
<area shape="rect" id="node34" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="1031,275,1177,316"/>
<area shape="rect" id="node35" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a490056e5b2e5617cf640ea99d278ac21" title="foedus::storage::hash\l::RecordLocation::clear" alt="" coords="1275,277,1431,319"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a33c82d9bc3661456265ee9991cba1f98" title="returns whether the slot contains the exact key specified " alt="" coords="1265,123,1440,179"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="1505,131,1731,172"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1PageVersionStatus.html#a8360836cebd9fbeadfeb2a31809270c2" title="foedus::storage::PageVersion\lStatus::has_next_page" alt="" coords="1008,573,1200,615"/>
<area shape="rect" id="node39" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="1291,207,1414,248"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af64ca224598812767abe9631f280b105" title="Simpler version of locate_record for when we are in snapshot world. " alt="" coords="1013,341,1195,397"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afa2342b5f0a374e38f0ec00242494a34" title="Subroutine of locate_record() to create/migrate a physical record of the given key in the page or its..." alt="" coords="1013,639,1195,695"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="768,310,939,366"/>
<area shape="rect" id="node45" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="783,441,924,483"/>
<area shape="rect" id="node46" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="1033,5,1175,47"/>
<area shape="rect" id="node48" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="760,1945,947,1987"/>
<area shape="rect" id="node49" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="1011,1855,1197,1896"/>
<area shape="rect" id="node50" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="760,1880,947,1921"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a26fdac44f55a502f17cb82e98966dd84_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a26fdac44f55a502f17cb82e98966dd84_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a26fdac44f55a502f17cb82e98966dd84_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a26fdac44f55a502f17cb82e98966dd84_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="249,5,412,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeea83aff996263bc8e9b3623fbe305a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::register_record_write_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html">RecordLocation</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1log_1_1RecordLogType.html">log::RecordLogType</a> *&#160;</td>
          <td class="paramname"><em>log_entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used in the following methods. </p>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00260">260</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="xct_8cpp_source.html#l00506">foedus::xct::Xct::add_related_write_set()</a>, <a class="el" href="xct_8cpp_source.html#l00444">foedus::xct::Xct::add_to_write_set()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="thread_8cpp_source.html#l00075">foedus::thread::Thread::get_current_xct()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00161">get_id()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00259">foedus::storage::hash::HashDataPage::get_slot_address()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00080">foedus::storage::hash::RecordLocation::index_</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00108">foedus::storage::hash::RecordLocation::is_found()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00078">foedus::storage::hash::RecordLocation::page_</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00106">foedus::storage::hash::RecordLocation::readset_</a>, and <a class="el" href="hash__record__location_8hpp_source.html#l00093">foedus::storage::hash::RecordLocation::record_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00356">delete_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00554">increment_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00277">insert_record()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00502">overwrite_record()</a>, and <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00390">upsert_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                               {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">// If we have taken readset in locate_record, add as a related write set</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(location.is_found());</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keyword">auto</span>* slot = location.page_-&gt;get_slot_address(location.index_);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordtype">char</span>* record = location.record_;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  xct::Xct* cur_xct = &amp;context-&gt;get_current_xct();</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">if</span> (location.readset_) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">return</span> cur_xct-&gt;add_related_write_set(location.readset_, &amp;slot-&gt;tid_, record, log_entry);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">return</span> cur_xct-&gt;add_to_write_set(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">get_id</a>(), &amp;slot-&gt;tid_, record, log_entry);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_abdd0cbf1f438986888173779270bab4a"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">foedus::storage::hash::HashStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00161">hash_storage_pimpl.hpp:161</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aeea83aff996263bc8e9b3623fbe305a1_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aeea83aff996263bc8e9b3623fbe305a1_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aeea83aff996263bc8e9b3623fbe305a1_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aeea83aff996263bc8e9b3623fbe305a1_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="263,27,404,68"/>
<area shape="rect" id="node5" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="472,85,613,127"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="258,144,409,185"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a" title="foedus::storage::hash\l::HashStoragePimpl::get_id" alt="" coords="243,209,424,251"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="248,275,419,331"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab29603dc5748833bc006e129a152a4d1" title="foedus::storage::hash\l::RecordLocation::is_found" alt="" coords="245,356,421,397"/>
<area shape="rect" id="node3" href="group__LOGTYPE.html#gad2d33090f44d00949a05c245e5ff1046" title="Invokes the assertion logic of each log type. " alt="" coords="697,20,827,61"/>
<area shape="rect" id="node4" href="structfoedus_1_1log_1_1LogHeader.html#a6ebe3b99442f2a58a4adeeb60f9a37e0" title="Convenience method to cast into LogCode. " alt="" coords="932,5,1087,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a1ff8ccbccdede750fb5a18b4da505ad9" title="foedus::xct::Retrospective\lLockList::get_volatile\l_page_resolver" alt="" coords="676,151,848,207"/>
<area shape="rect" id="node7" href="namespacefoedus_1_1storage.html#a263602e0a73eedbe5f32128635106e17" title="foedus::storage::assert\l_within_valid_volatile_page" alt="" coords="675,236,849,277"/>
<area shape="rect" id="node18" href="structfoedus_1_1xct_1_1RecordXctAccess.html#ace820ba89437e4d3a59fdb47a47525ba" title="Calculate owner_lock_id using the resolver. " alt="" coords="661,85,863,127"/>
<area shape="rect" id="node8" href="namespacefoedus_1_1storage.html#ad38ebb5eb992249a7b42001fe464ec48" title="foedus::storage::assert\l_within_valid_volatile\l_page_impl" alt="" coords="932,258,1087,314"/>
<area shape="rect" id="node9" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1421,123,1595,164"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1678,333,1827,375"/>
<area shape="rect" id="node11" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1156,265,1359,307"/>
<area shape="rect" id="node17" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="1175,437,1340,463"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1431,269,1585,311"/>
<area shape="rect" id="node16" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1407,189,1609,245"/>
<area shape="rect" id="node13" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1675,199,1830,240"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1672,99,1833,140"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1657,268,1848,309"/>
<area shape="rect" id="node19" href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748" title="foedus::xct::xct_id\l_to_universal_lock_id" alt="" coords="937,71,1082,112"/>
<area shape="rect" id="node22" href="structfoedus_1_1xct_1_1RecordXctAccess.html#adf2e2a9d414bf5cfe86f33198ebdf434" title="Setter for owner_id_address_/owner_lock_id_. " alt="" coords="911,136,1108,177"/>
<area shape="rect" id="node20" href="namespacefoedus_1_1xct.html#a94b21516b530d0be271c6005a72009ad" title="foedus::xct::to_universal\l_lock_id" alt="" coords="1176,64,1339,105"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="1411,5,1605,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aeea83aff996263bc8e9b3623fbe305a1_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aeea83aff996263bc8e9b3623fbe305a1_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aeea83aff996263bc8e9b3623fbe305a1_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_aeea83aff996263bc8e9b3623fbe305a1_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a357386c8e5be667334520a33aff51725" title="foedus::storage::hash\l::HashStoragePimpl::delete\l_record" alt="" coords="253,5,435,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a233fcd7ffd24bd59d2d0943af3d0de03" title="foedus::storage::hash\l::HashStoragePimpl::increment\l_record" alt="" coords="243,85,445,141"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ac9c35890555ddb10d908b77602a1f28c" title="foedus::storage::hash\l::HashStoragePimpl::insert\l_record" alt="" coords="255,165,433,221"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#add8aafbb32713dc6be20804da789f43d" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record" alt="" coords="246,245,442,301"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a49df48b50c0c645d3a047e8b153c4015" title="foedus::storage::hash\l::HashStoragePimpl::upsert\l_record" alt="" coords="253,365,435,421"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a4ce8eaf2bf2674b777888c812ca5f269" title="If you have already computed HashCombo, use this. " alt="" coords="517,5,665,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a7ba3b8d1b3f0242f53b46c8a9b2ebaca" title="If you have already computed HashCombo, use this. " alt="" coords="506,85,677,141"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a3617930288b1cfa90723b56916044a10" title="If you have already computed HashCombo, use this. " alt="" coords="518,165,665,221"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#affd9e7a6674a1a8daced6ad1ef603857" title="If you have already computed HashCombo, use this. " alt="" coords="510,245,673,301"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a26fdac44f55a502f17cb82e98966dd84" title="foedus::storage::hash\l::HashStoragePimpl::overwrite\l_record_primitive" alt="" coords="493,325,689,381"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a04310f074b93b1bd110b69954595170d" title="If you have already computed HashCombo, use this. " alt="" coords="737,325,900,381"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="517,405,666,461"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad03735f87f525d0919a2d10b955409e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::hash::HashStoragePimpl::release_pages_recursive_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1memory_1_1PageReleaseBatch.html">memory::PageReleaseBatch</a> *&#160;</td>
          <td class="paramname"><em>batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *&#160;</td>
          <td class="paramname"><em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a>&#160;</td>
          <td class="paramname"><em>volatile_page_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4a4ac4693aa40798617e4cbadc13c5d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::hash::HashStoragePimpl::release_pages_recursive_intermediate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1memory_1_1PageReleaseBatch.html">memory::PageReleaseBatch</a> *&#160;</td>
          <td class="paramname"><em>batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *&#160;</td>
          <td class="paramname"><em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a>&#160;</td>
          <td class="paramname"><em>volatile_page_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac9438b8e6a0c0c582ede319a25b20fe2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::hash::HashStoragePimpl::release_pages_recursive_root </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1memory_1_1PageReleaseBatch.html">memory::PageReleaseBatch</a> *&#160;</td>
          <td class="paramname"><em>batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *&#160;</td>
          <td class="paramname"><em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a>&#160;</td>
          <td class="paramname"><em>volatile_page_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used only from uninitialize() </p>

</div>
</div>
<a class="anchor" id="af3a7066a8881f653e759362cf39e01c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1xct_1_1TrackMovedRecordResult.html">xct::TrackMovedRecordResult</a> foedus::storage::hash::HashStoragePimpl::track_moved_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1xct_1_1RwLockableXctId.html">xct::RwLockableXctId</a> *&#160;</td>
          <td class="paramname"><em>old_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1xct_1_1WriteXctAccess.html">xct::WriteXctAccess</a> *&#160;</td>
          <td class="paramname"><em>write_set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l01099">1099</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00142">foedus::storage::hash::HashCommonLogType::assert_record_and_log_keys()</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>, <a class="el" href="xct__id_8hpp_source.html#l01142">foedus::xct::RwLockableXctId::is_moved()</a>, <a class="el" href="page_8hpp_source.html#l00054">foedus::storage::kHashDataPageType</a>, <a class="el" href="xct__access_8hpp_source.html#l00175">foedus::xct::WriteXctAccess::log_entry_</a>, <a class="el" href="xct__access_8hpp_source.html#l00172">foedus::xct::WriteXctAccess::payload_address_</a>, <a class="el" href="xct__access_8hpp_source.html#l00085">foedus::xct::RecordXctAccess::storage_id_</a>, <a class="el" href="page_8hpp_source.html#l00395">foedus::storage::to_page()</a>, and <a class="el" href="hash__storage__pimpl_8cpp_source.html#l01135">track_moved_record_search()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00256">foedus::storage::hash::HashStorage::track_moved_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                                {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(old_address);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(old_address-&gt;is_moved());</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="comment">// We use moved bit only for volatile data pages</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  HashDataPage* page = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(<a class="code" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25">to_page</a>(old_address));</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!page-&gt;header().snapshot_);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;header().get_page_type() == <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba6c1740f811f2524fac6cd76aa2a31c6c">kHashDataPageType</a>);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="comment">// TID is the first member in slot, so this ugly cast works.</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  HashDataPage::Slot* old_slot = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage::Slot*<span class="keyword">&gt;</span>(old_address);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(&amp;old_slot-&gt;tid_ == old_address);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="comment">// for tracking, we need the full key and hash. let&#39;s extract them.</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* key = page-&gt;record_from_offset(old_slot-&gt;offset_);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  uint16_t key_length = old_slot-&gt;key_length_;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  HashCombo combo(key, key_length, <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="comment">// we need write_set only for sanity check. It&#39;s easier in hash storage!</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="keywordflow">if</span> (write_set) {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(write_set-&gt;storage_id_ == page-&gt;header().storage_id_);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(write_set-&gt;payload_address_ == page-&gt;record_from_offset(old_slot-&gt;offset_));</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    HashCommonLogType* the_log = <span class="keyword">reinterpret_cast&lt;</span>HashCommonLogType*<span class="keyword">&gt;</span>(write_set-&gt;log_entry_);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    the_log-&gt;assert_record_and_log_keys(old_address, page-&gt;record_from_offset(old_slot-&gt;offset_));</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="preprocessor">#endif  // NDEBUG</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  HashDataPage::Slot* slot_origin = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage::Slot*<span class="keyword">&gt;</span>(page + 1);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(slot_origin &gt; old_slot);  <span class="comment">// because origin corresponds to &quot;-1&quot;.</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">DataPageSlotIndex</a> old_index = slot_origin - old_slot - 1;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;get_slot_address(old_index) == old_slot);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a144ddbe7819e7b3576611d456aa46c77">track_moved_record_search</a>(page, key, key_length, combo);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gaa114fc1859c2d4cb8b9e2021cb11cb25"><div class="ttname"><a href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25">foedus::storage::to_page</a></div><div class="ttdeci">Page * to_page(const void *address)</div><div class="ttdoc">super-dirty way to obtain Page the address belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00395">page.hpp:395</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a476dd04e514ebe83142d21135e8b91c7"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">foedus::storage::hash::DataPageSlotIndex</a></div><div class="ttdeci">uint16_t DataPageSlotIndex</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00196">hash_id.hpp:196</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga14e35f7fbe4bc18276fde8e8ba460f5ba6c1740f811f2524fac6cd76aa2a31c6c"><div class="ttname"><a href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba6c1740f811f2524fac6cd76aa2a31c6c">foedus::storage::kHashDataPageType</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00054">page.hpp:54</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a144ddbe7819e7b3576611d456aa46c77"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a144ddbe7819e7b3576611d456aa46c77">foedus::storage::hash::HashStoragePimpl::track_moved_record_search</a></div><div class="ttdeci">xct::TrackMovedRecordResult track_moved_record_search(HashDataPage *page, const void *key, uint16_t key_length, const HashCombo &amp;combo)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l01135">hash_storage_pimpl.cpp:1135</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af3a7066a8881f653e759362cf39e01c4_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af3a7066a8881f653e759362cf39e01c4_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af3a7066a8881f653e759362cf39e01c4_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af3a7066a8881f653e759362cf39e01c4_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#ad66913658c856c60c06500b1179db779" title="used only for sanity check. " alt="" coords="228,41,416,97"/>
<area shape="rect" id="node5" href="structfoedus_1_1xct_1_1RwLockableXctId.html#a03782134d5ef0ebb8e187ddbd89f3c36" title="foedus::xct::RwLockableXct\lId::is_moved" alt="" coords="231,249,413,290"/>
<area shape="rect" id="node7" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="239,557,405,584"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a144ddbe7819e7b3576611d456aa46c77" title="foedus::storage::hash\l::HashStoragePimpl::track\l_moved_record_search" alt="" coords="235,477,409,533"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="489,5,649,32"/>
<area shape="rect" id="node4" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679" title="Calculates hash value for general input. " alt="" coords="762,39,909,81"/>
<area shape="rect" id="node6" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="774,105,897,146"/>
<area shape="rect" id="node9" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="502,302,637,343"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="464,368,675,424"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="487,449,651,490"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="494,515,645,571"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="723,397,948,438"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="487,171,651,227"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a49863802f2bfb024c928a37ea7abce07" title="foedus::storage::hash\l::HashDataPage::record\l_from_offset" alt="" coords="755,521,916,577"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="484,645,655,701"/>
<area shape="rect" id="node20" href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f" title="Equivalent to std::atomic_thread_fence(std::memory_order_consume). " alt="" coords="483,726,656,767"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="755,705,916,746"/>
<area shape="rect" id="node23" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="483,909,656,950"/>
<area shape="rect" id="node24" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="468,843,671,885"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a4e5601b652daaffbcb9fa81aee6746c6" title="foedus::storage::hash\l::DataPageBloomFilter\l::contains" alt="" coords="759,171,912,227"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a28a11a7b04e04d895b21f29709eacd1f" title="foedus::storage::hash\l::DataPageBloomFilter\l::extract_fingerprint" alt="" coords="759,251,912,307"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac2e82163d7348a6c88fecff711025b08" title="foedus::storage::hash\l::HashDataPage::get_slot" alt="" coords="750,331,921,373"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1011,705,1172,746"/>
<area shape="rect" id="node25" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="758,770,913,811"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1017,906,1166,947"/>
<area shape="rect" id="node29" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="749,967,922,1009"/>
<area shape="rect" id="node30" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="734,836,937,892"/>
<area shape="rect" id="node26" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1014,839,1169,881"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="996,770,1187,811"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af3a7066a8881f653e759362cf39e01c4_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af3a7066a8881f653e759362cf39e01c4_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af3a7066a8881f653e759362cf39e01c4_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_af3a7066a8881f653e759362cf39e01c4_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ab763d5d37f053808257f662611f2e603" title="Resolves a &quot;moved&quot; record. " alt="" coords="228,31,375,87"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1StorageManagerPimpl.html#a3248d8440d805f772ad7b6122a4d309b" title="foedus::storage::Storage\lManagerPimpl::track_moved\l_record" alt="" coords="423,31,609,87"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1StorageManager.html#a02513539acf9d7cd9805d34154281076" title="Resolves a &quot;moved&quot; record. " alt="" coords="657,39,853,80"/>
<area shape="rect" id="node5" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a9090dd1fa81513f61620b44a9a8bbd1d" title="used from verification methods to track moved record " alt="" coords="901,39,1121,80"/>
<area shape="rect" id="node6" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a2c3befa16f448a004d548a2b4675a13b" title="Phase 2 of precommit_xct() for read&#45;only case. " alt="" coords="1171,5,1379,47"/>
<area shape="rect" id="node10" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a9534e63f498a012d9fa401a10e2b4e0b" title="Phase 2 of precommit_xct() for read&#45;write case. " alt="" coords="1169,71,1380,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#add42c2f0d559eafa1f67fd9c048a4855" title="precommit_xct() if the transaction is read&#45;only " alt="" coords="1428,5,1623,47"/>
<area shape="rect" id="node8" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a014506b605e14b3df1b1b7522e8a23b2" title="This is the gut of commit protocol. " alt="" coords="1671,39,1865,80"/>
<area shape="rect" id="node9" href="classfoedus_1_1xct_1_1XctManager.html#a486c653445cb64cc9514af3f1031bdf0" title="Prepares the currently running transaction on the thread for commit. " alt="" coords="1913,39,2076,80"/>
<area shape="rect" id="node11" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a777caaecec0e7bb19b1cd2841771f755" title="precommit_xct() if the transaction is read&#45;write " alt="" coords="1428,71,1623,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a144ddbe7819e7b3576611d456aa46c77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1xct_1_1TrackMovedRecordResult.html">xct::TrackMovedRecordResult</a> foedus::storage::hash::HashStoragePimpl::track_moved_record_search </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *&#160;</td>
          <td class="paramname"><em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l01135">1135</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a>, <a class="el" href="hash__combo_8hpp_source.html#l00051">foedus::storage::hash::HashCombo::fingerprint_</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00246">foedus::storage::hash::HashDataPage::get_record_count()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00259">foedus::storage::hash::HashDataPage::get_slot_address()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00049">foedus::storage::hash::HashCombo::hash_</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00225">foedus::storage::hash::HashDataPage::header()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="hash__id_8hpp_source.html#l00197">foedus::storage::hash::kSlotNotFound</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00046">foedus::assorted::memory_fence_acquire()</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00081">foedus::assorted::memory_fence_consume()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00240">foedus::storage::hash::HashDataPage::next_page_address()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00171">foedus::storage::hash::HashDataPage::Slot::offset_</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00275">foedus::storage::hash::HashDataPage::record_from_offset()</a>, <a class="el" href="page__resolver_8hpp_source.html#l00120">foedus::memory::GlobalVolatilePageResolver::resolve_offset()</a>, <a class="el" href="hash__page__impl_8cpp_source.html#l00106">foedus::storage::hash::HashDataPage::search_key_physical()</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00165">foedus::storage::hash::HashDataPage::Slot::tid_</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__pimpl_8cpp_source.html#l01099">track_moved_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                          {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keyword">const</span> memory::GlobalVolatilePageResolver&amp; resolver</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    = <a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">get_global_volatile_page_resolver</a>();</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  RecordLocation result;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!page-&gt;header().snapshot_);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;next_page_address()-&gt;snapshot_pointer_ == 0);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keyword">const</span> uint16_t record_count = page-&gt;get_record_count();</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="comment">// Tracking happens in commit phase, so we don&#39;t need further logical readset/lock things.</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="comment">// This is just to locate the new address. So, physical_only search.</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">// (which might miss a new record being inserted, but it&#39;s just a bit conservative abort)</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">DataPageSlotIndex</a> index = page-&gt;search_key_physical(</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      combo.hash_,</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      combo.fingerprint_,</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      key,</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      key_length,</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      record_count);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">if</span> (index != <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a33cdddb3771cf2fdc3e65465792b6c96">kSlotNotFound</a>) {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      HashDataPage::Slot* slot = page-&gt;get_slot_address(index);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="keywordtype">char</span>* payload = page-&gt;record_from_offset(slot-&gt;offset_);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="keywordflow">return</span> xct::TrackMovedRecordResult(&amp;slot-&gt;tid_, payload);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="comment">// we must meet the same invariant as usual case. a bit simpler, though</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f">assorted::memory_fence_consume</a>();</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    DualPagePointer* next_page = page-&gt;next_page_address();</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <a class="code" href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f">assorted::memory_fence_consume</a>();</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    uint16_t record_count_again = page-&gt;get_record_count();</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(record_count != record_count_again)) {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Interesting. concurrent insertion just happend to the page&quot;</span>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <a class="code" href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f">assorted::memory_fence_consume</a>();</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">if</span> (next_page-&gt;volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="comment">// This shouldn&#39;t happen as far as we flip moved bit after installing the new record</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;no next page?? but we didn&#39;t find the moved record in this page&quot;</span>;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordflow">if</span> (next_page-&gt;volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;Unexpected error, failed to track moved record in hash storage.&quot;</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; This should not happen. hash combo=&quot;</span> &lt;&lt; combo;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">return</span> xct::TrackMovedRecordResult();</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      }</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    }</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    page = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(resolver.resolve_offset(next_page-&gt;volatile_pointer_));</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  }</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a62b2d4de6a72644e9e31d35a7f9beae0"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">foedus::memory::EngineMemory::get_global_volatile_page_resolver</a></div><div class="ttdeci">const GlobalVolatilePageResolver &amp; get_global_volatile_page_resolver() const </div><div class="ttdoc">Returns the page resolver to convert volatile page ID to page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00090">engine_memory.hpp:90</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a33cdddb3771cf2fdc3e65465792b6c96"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a33cdddb3771cf2fdc3e65465792b6c96">foedus::storage::hash::kSlotNotFound</a></div><div class="ttdeci">const DataPageSlotIndex kSlotNotFound</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00197">hash_id.hpp:197</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; HashStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a476dd04e514ebe83142d21135e8b91c7"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">foedus::storage::hash::DataPageSlotIndex</a></div><div class="ttdeci">uint16_t DataPageSlotIndex</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00196">hash_id.hpp:196</a></div></div>
<div class="ttc" id="group__ASSORTED_html_ga641117f56315b0f239d72948cf5aa56f"><div class="ttname"><a href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f">foedus::assorted::memory_fence_consume</a></div><div class="ttdeci">void memory_fence_consume()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_consume). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00081">atomic_fences.hpp:81</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaf84f9944a16c5848f69beacdfeedf939"><div class="ttname"><a href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">foedus::assorted::memory_fence_acquire</a></div><div class="ttdeci">void memory_fence_acquire()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acquire). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00046">atomic_fences.hpp:46</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a144ddbe7819e7b3576611d456aa46c77_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a144ddbe7819e7b3576611d456aa46c77_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a144ddbe7819e7b3576611d456aa46c77_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a144ddbe7819e7b3576611d456aa46c77_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="228,29,439,85"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="266,109,401,151"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac6b4a13e6f057be1874f637fb9f87c51" title="foedus::storage::hash\l::HashDataPage::get_record_count" alt="" coords="487,5,712,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="248,357,419,413"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="251,437,415,479"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="253,503,414,544"/>
<area shape="rect" id="node9" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="247,633,420,675"/>
<area shape="rect" id="node10" href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f" title="Equivalent to std::atomic_thread_fence(std::memory_order_consume). " alt="" coords="247,699,420,740"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a6286d91dcdb8b6455e20bc770155a0be" title="foedus::storage::hash\l::HashDataPage::next\l_page_address" alt="" coords="258,765,409,821"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#a49863802f2bfb024c928a37ea7abce07" title="foedus::storage::hash\l::HashDataPage::record\l_from_offset" alt="" coords="519,71,680,127"/>
<area shape="rect" id="node13" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="232,568,435,609"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#aa03f1438dc159688f49de6e73c851d6e" title="Search for a physical slot that exactly contains the given key. " alt="" coords="251,277,415,333"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="775,504,936,545"/>
<area shape="rect" id="node14" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="522,641,677,683"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="781,700,930,741"/>
<area shape="rect" id="node18" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="513,759,686,800"/>
<area shape="rect" id="node19" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="498,561,701,617"/>
<area shape="rect" id="node15" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="778,569,933,611"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="760,635,951,676"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a4e5601b652daaffbcb9fa81aee6746c6" title="foedus::storage::hash\l::DataPageBloomFilter\l::contains" alt="" coords="523,218,676,274"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a28a11a7b04e04d895b21f29709eacd1f" title="foedus::storage::hash\l::DataPageBloomFilter\l::extract_fingerprint" alt="" coords="523,298,676,354"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac2e82163d7348a6c88fecff711025b08" title="foedus::storage::hash\l::HashDataPage::get_slot" alt="" coords="514,379,685,420"/>
<area shape="rect" id="node24" href="group__HASH.html#ga8c4ca78e36b2188f1feac100ce7df679" title="Calculates hash value for general input. " alt="" coords="526,444,673,485"/>
<area shape="rect" id="node25" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="538,152,661,193"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a144ddbe7819e7b3576611d456aa46c77_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a144ddbe7819e7b3576611d456aa46c77_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a144ddbe7819e7b3576611d456aa46c77_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a144ddbe7819e7b3576611d456aa46c77_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#af3a7066a8881f653e759362cf39e01c4" title="foedus::storage::hash\l::HashStoragePimpl::track\l_moved_record" alt="" coords="228,31,403,87"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#ab763d5d37f053808257f662611f2e603" title="Resolves a &quot;moved&quot; record. " alt="" coords="451,31,597,87"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1StorageManagerPimpl.html#a3248d8440d805f772ad7b6122a4d309b" title="foedus::storage::Storage\lManagerPimpl::track_moved\l_record" alt="" coords="645,31,832,87"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1StorageManager.html#a02513539acf9d7cd9805d34154281076" title="Resolves a &quot;moved&quot; record. " alt="" coords="880,39,1076,80"/>
<area shape="rect" id="node6" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a9090dd1fa81513f61620b44a9a8bbd1d" title="used from verification methods to track moved record " alt="" coords="1124,39,1344,80"/>
<area shape="rect" id="node7" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a2c3befa16f448a004d548a2b4675a13b" title="Phase 2 of precommit_xct() for read&#45;only case. " alt="" coords="1393,5,1601,47"/>
<area shape="rect" id="node11" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a9534e63f498a012d9fa401a10e2b4e0b" title="Phase 2 of precommit_xct() for read&#45;write case. " alt="" coords="1392,71,1603,112"/>
<area shape="rect" id="node8" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#add42c2f0d559eafa1f67fd9c048a4855" title="precommit_xct() if the transaction is read&#45;only " alt="" coords="1651,5,1845,47"/>
<area shape="rect" id="node9" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a014506b605e14b3df1b1b7522e8a23b2" title="This is the gut of commit protocol. " alt="" coords="1893,39,2088,80"/>
<area shape="rect" id="node10" href="classfoedus_1_1xct_1_1XctManager.html#a486c653445cb64cc9514af3f1031bdf0" title="Prepares the currently running transaction on the thread for commit. " alt="" coords="2136,39,2299,80"/>
<area shape="rect" id="node12" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a777caaecec0e7bb19b1cd2841771f755" title="precommit_xct() if the transaction is read&#45;write " alt="" coords="1651,71,1845,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a49df48b50c0c645d3a047e8b153c4015"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::hash::HashStoragePimpl::upsert_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1hash_1_1HashCombo.html">HashCombo</a> &amp;&#160;</td>
          <td class="paramname"><em>combo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>physical_payload_hint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#adc9dd22b27c2d19c8c2a2c3b8011a819" title="Inserts a new record of the given key or replaces the existing one in this hash storage, or so-called upsert. ">foedus::storage::hash::HashStorage::upsert_record()</a> </dd></dl>

<p>Definition at line <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00390">390</a> of file <a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00250">foedus::storage::hash::adjust_payload_hint()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00243">foedus::storage::hash::HashDataPage::bloom_filter()</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00095">foedus::storage::hash::HashCommonLogType::calculate_log_length()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="hash__hashinate_8hpp_source.html#l00152">foedus::storage::hash::DataPageBloomFilter::contains()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00086">foedus::storage::hash::RecordLocation::cur_payload_length_</a>, <a class="el" href="hash__combo_8hpp_source.html#l00051">foedus::storage::hash::HashCombo::fingerprint_</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00166">get_bin_bits()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00161">get_id()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00110">foedus::storage::hash::RecordLocation::get_max_payload()</a>, <a class="el" href="thread_8cpp_source.html#l00078">foedus::thread::Thread::get_thread_log_buffer()</a>, <a class="el" href="hash__combo_8hpp_source.html#l00049">foedus::storage::hash::HashCombo::hash_</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00225">foedus::storage::hash::HashDataPage::header()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00080">foedus::storage::hash::RecordLocation::index_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00108">foedus::storage::hash::RecordLocation::is_found()</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00842">locate_bin()</a>, <a class="el" href="hash__storage__pimpl_8hpp_source.html#l00400">locate_record_logical()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00100">foedus::storage::hash::RecordLocation::observed_</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00078">foedus::storage::hash::RecordLocation::page_</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00212">foedus::storage::hash::HashInsertLogType::populate()</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00318">foedus::storage::hash::HashUpdateLogType::populate()</a>, <a class="el" href="hash__log__types_8hpp_source.html#l00380">foedus::storage::hash::HashOverwriteLogType::populate()</a>, <a class="el" href="hash__record__location_8hpp_source.html#l00093">foedus::storage::hash::RecordLocation::record_</a>, <a class="el" href="hash__storage__pimpl_8cpp_source.html#l00260">register_record_write_log()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">foedus::log::ThreadLogBuffer::reserve_new_log()</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00952">foedus::thread::Thread::run_nested_sysxct()</a>, and <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00159">foedus::storage::hash::HashStorage::upsert_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                  {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  physical_payload_hint = <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a621860b1314f5eecc0e41d3972340bf9">adjust_payload_hint</a>(payload_count, physical_payload_hint);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// Upsert is a combination of what insert does and what delete does.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// If there isn&#39;t an existing physical record, it&#39;s exactly same as insert.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">// If there is, it&#39;s _basically_ a delete followed by an insert.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// There are a few complications, depending on the status of the record.</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  HashDataPage* bin_head;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">locate_bin</a>(context, <span class="keyword">true</span>, combo, &amp;bin_head));</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(bin_head);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {  <span class="comment">// we might retry due to migrate_record. not that often, tho.</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    RecordLocation location;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">locate_record_logical</a>(</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      context,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keyword">true</span>,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keyword">true</span>,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      physical_payload_hint,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      key,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      key_length,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      combo,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      bin_head,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      &amp;location));</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// we create if not exists, these are surely non-null</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(location.is_found());</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(location.record_);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Whether currently deleted or not, migrate it to make sure the record is long enough.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (payload_count &gt; location.get_max_payload()) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      HashDataPage* cur_page = location.page_;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!cur_page-&gt;header().snapshot_);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur_page-&gt;bloom_filter().contains(combo.fingerprint_));</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">DataPageSlotIndex</a> cur_index = location.index_;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      DVLOG(2) &lt;&lt; <span class="stringliteral">&quot;Record expansion triggered. payload_count=&quot;</span> &lt;&lt; payload_count</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, current max=&quot;</span> &lt;&lt; location.get_max_payload()</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, size hint=&quot;</span> &lt;&lt; physical_payload_hint;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      ReserveRecords functor(</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        context,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        cur_page,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        key,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        key_length,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        combo,</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        payload_count,</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        physical_payload_hint,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        cur_index);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;functor, 5U));</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      DVLOG(2) &lt;&lt; <span class="stringliteral">&quot;Expanded record!&quot;</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keywordflow">continue</span>;  <span class="comment">// need to re-locate the record. retry.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(payload_count &lt;= location.get_max_payload());</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    HashCommonLogType* log_common;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> (location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="comment">// If it&#39;s a deleted record, this turns to be a plain insert.</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">HashInsertLogType::calculate_log_length</a>(key_length, payload_count);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      HashInsertLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>HashInsertLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      log_entry-&gt;populate(</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">get_id</a>(),</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        key,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        key_length,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">get_bin_bits</a>(),</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        combo.hash_,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        payload,</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        payload_count);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      log_common = log_entry;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (location.cur_payload_length_ == payload_count) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="comment">// If it&#39;s not changing payload size of existing record, we can conver it to an overwrite,</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="comment">// which is more efficient</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">HashUpdateLogType::calculate_log_length</a>(key_length, payload_count);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      HashOverwriteLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>HashOverwriteLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      log_entry-&gt;populate(</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">get_id</a>(),</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        key,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        key_length,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">get_bin_bits</a>(),</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        combo.hash_,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        payload,</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        0,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        payload_count);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      log_common = log_entry;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="comment">// If not, this is an update operation.</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">HashUpdateLogType::calculate_log_length</a>(key_length, payload_count);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      HashUpdateLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>HashUpdateLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      log_entry-&gt;populate(</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">get_id</a>(),</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        key,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        key_length,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">get_bin_bits</a>(),</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        combo.hash_,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        payload,</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        payload_count);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      log_common = log_entry;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">register_record_write_log</a>(context, location, log_common);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a621860b1314f5eecc0e41d3972340bf9"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a621860b1314f5eecc0e41d3972340bf9">foedus::storage::hash::adjust_payload_hint</a></div><div class="ttdeci">uint16_t adjust_payload_hint(uint16_t payload_count, uint16_t physical_payload_hint)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00250">hash_storage_pimpl.cpp:250</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a07025464a0eba08710f6fa92d7c0f32d"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d">foedus::storage::hash::HashStoragePimpl::locate_record_logical</a></div><div class="ttdeci">ErrorCode locate_record_logical(thread::Thread *context, bool for_write, bool create_if_notfound, uint16_t create_payload_length, const void *key, uint16_t key_length, const HashCombo &amp;combo, HashDataPage *bin_head, RecordLocation *result)</div><div class="ttdoc">locate_record()&#39;s logical+physical version. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00400">hash_storage_pimpl.hpp:400</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_abdd0cbf1f438986888173779270bab4a"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a">foedus::storage::hash::HashStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00161">hash_storage_pimpl.hpp:161</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_a0f073a76a5abeac0829ba1e47a40c02c"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c">foedus::storage::hash::HashStoragePimpl::locate_bin</a></div><div class="ttdeci">ErrorCode locate_bin(thread::Thread *context, bool for_write, const HashCombo &amp;combo, HashDataPage **bin_head)</div><div class="ttdoc">Find a pointer to the bin that contains records for the hash. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00842">hash_storage_pimpl.cpp:842</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a476dd04e514ebe83142d21135e8b91c7"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">foedus::storage::hash::DataPageSlotIndex</a></div><div class="ttdeci">uint16_t DataPageSlotIndex</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00196">hash_id.hpp:196</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aff4c87787f9e6ce9c4306b8bcaf36a47"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47">foedus::storage::hash::HashStoragePimpl::get_bin_bits</a></div><div class="ttdeci">uint8_t get_bin_bits() const </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8hpp_source.html#l00166">hash_storage_pimpl.hpp:166</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_aeea83aff996263bc8e9b3623fbe305a1"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1">foedus::storage::hash::HashStoragePimpl::register_record_write_log</a></div><div class="ttdeci">ErrorCode register_record_write_log(thread::Thread *context, const RecordLocation &amp;location, log::RecordLogType *log_entry)</div><div class="ttdoc">Used in the following methods. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__pimpl_8cpp_source.html#l00260">hash_storage_pimpl.cpp:260</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType_html_a04238b5b4aec46d0a24b5489553b793a"><div class="ttname"><a href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a">foedus::storage::hash::HashCommonLogType::calculate_log_length</a></div><div class="ttdeci">static uint16_t calculate_log_length(uint16_t key_length, uint16_t payload_count) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="hash__log__types_8hpp_source.html#l00095">hash_log_types.hpp:95</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a49df48b50c0c645d3a047e8b153c4015_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a49df48b50c0c645d3a047e8b153c4015_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a49df48b50c0c645d3a047e8b153c4015_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a49df48b50c0c645d3a047e8b153c4015_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1storage_1_1hash.html#a621860b1314f5eecc0e41d3972340bf9" title="foedus::storage::hash\l::adjust_payload_hint" alt="" coords="523,16,669,58"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ad2169cfc93933b2b35fea60fe8be9cf8" title="foedus::storage::hash\l::HashDataPage::bloom\l_filter" alt="" coords="259,230,419,286"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1hash_1_1HashCommonLogType.html#a04238b5b4aec46d0a24b5489553b793a" title="foedus::storage::hash\l::HashCommonLogType::\lcalculate_log_length" alt="" coords="255,70,423,126"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1hash_1_1DataPageBloomFilter.html#a4e5601b652daaffbcb9fa81aee6746c6" title="foedus::storage::hash\l::DataPageBloomFilter\l::contains" alt="" coords="262,310,415,366"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aff4c87787f9e6ce9c4306b8bcaf36a47" title="foedus::storage::hash\l::HashStoragePimpl::get\l_bin_bits" alt="" coords="257,390,421,446"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#abdd0cbf1f438986888173779270bab4a" title="foedus::storage::hash\l::HashStoragePimpl::get_id" alt="" coords="505,302,687,343"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#af4125da7e85cd2da82d64b8aa3eb9e81" title="foedus::storage::hash\l::RecordLocation::get\l_max_payload" alt="" coords="265,150,412,206"/>
<area shape="rect" id="node12" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="262,916,415,958"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ac653a03fd75011048550f8e9f5dd198d" title="foedus::storage::hash\l::HashDataPage::header" alt="" coords="1008,783,1172,824"/>
<area shape="rect" id="node14" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="277,982,400,1023"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#ab29603dc5748833bc006e129a152a4d1" title="foedus::storage::hash\l::RecordLocation::is_found" alt="" coords="508,367,684,408"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a0f073a76a5abeac0829ba1e47a40c02c" title="Find a pointer to the bin that contains records for the hash. " alt="" coords="236,851,441,892"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a07025464a0eba08710f6fa92d7c0f32d" title="locate_record()&#39;s logical+physical version. " alt="" coords="248,652,429,708"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1hash_1_1HashInsertLogType.html#abd3dbdbe4f6d69957367a01e7576882a" title="foedus::storage::hash\l::HashInsertLogType::\lpopulate" alt="" coords="265,1048,413,1104"/>
<area shape="rect" id="node39" href="structfoedus_1_1storage_1_1hash_1_1HashUpdateLogType.html#af538b6dfae547586f1bd65cf8a879c15" title="foedus::storage::hash\l::HashUpdateLogType::\lpopulate" alt="" coords="260,1128,417,1184"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1hash_1_1HashOverwriteLogType.html#a29bf2faaed91770de679b2e836ffa3b8" title="foedus::storage::hash\l::HashOverwriteLogType\l::populate" alt="" coords="258,1208,419,1264"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#aeea83aff996263bc8e9b3623fbe305a1" title="Used in the following methods. " alt="" coords="244,572,433,628"/>
<area shape="rect" id="node45" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="245,1770,432,1811"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="263,1864,414,1906"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="764,85,924,112"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ab4578ade774f828985930b8e36269e8e" title="foedus::storage::hash\l::HashStoragePimpl::get_meta" alt="" coords="496,236,696,278"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#abed92a9a4809cce3c1cc33bc4fb07a81" title="foedus::storage::hash\l::RecordLocation::get\l_aligned_key_length" alt="" coords="523,142,669,198"/>
<area shape="rect" id="node17" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="525,1138,667,1179"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="1009,930,1171,971"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3d443bf6ef79608f06b5ca1aa4ea7e6f" title="for non&#45;root " alt="" coords="489,1366,703,1407"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="1007,848,1173,890"/>
<area shape="rect" id="node24" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="1015,718,1165,759"/>
<area shape="rect" id="node25" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1021,1027,1159,1068"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="1009,1624,1171,1680"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="1009,1116,1171,1172"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="763,1036,925,1092"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a579927a24cc690c8d4d6362bcb9e8538" title="Retrieves the root page of this storage. " alt="" coords="762,1246,926,1302"/>
<area shape="rect" id="node20" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="985,1384,1195,1426"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a21ed664fcd1889aa4dab0f150fd06c02" title="subroutine to follow a pointer to head of bin from a volatile parent " alt="" coords="755,1116,933,1172"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1015,1254,1165,1295"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="995,1515,1185,1556"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="763,1326,925,1382"/>
<area shape="rect" id="node32" href="group__ARRAY.html#ga2823bcd484e4e7cb47ceca880584000a" title="volatile page initialize callback for HashIntermediatePage. " alt="" coords="753,1508,935,1564"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="1243,1631,1433,1672"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a86af9aa3326dd20ffdac2a1beffea0b4" title="Usually follows locate_bin to locate the exact physical record for the key, or create a new one if no..." alt="" coords="753,652,935,708"/>
<area shape="rect" id="node36" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="1017,587,1163,628"/>
<area shape="rect" id="node37" href="structfoedus_1_1storage_1_1hash_1_1RecordLocation.html#a490056e5b2e5617cf640ea99d278ac21" title="foedus::storage::hash\l::RecordLocation::clear" alt="" coords="1012,652,1168,694"/>
<area shape="rect" id="node42" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="525,564,667,606"/>
<area shape="rect" id="node43" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="773,520,915,562"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#ab696a16e6a995a515736ff0a28b47885" title="same as &amp;get_slot(), but this is more explicit and easier to understand/maintain " alt="" coords="511,433,681,489"/>
<area shape="rect" id="node46" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="503,1740,689,1782"/>
<area shape="rect" id="node47" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="751,1828,937,1870"/>
<area shape="rect" id="node48" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="503,1858,689,1899"/>
<area shape="rect" id="node50" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="504,1923,688,1964"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a49df48b50c0c645d3a047e8b153c4015_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a49df48b50c0c645d3a047e8b153c4015_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a49df48b50c0c645d3a047e8b153c4015_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a49df48b50c0c645d3a047e8b153c4015_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#af75f511796795cd4ffe731fdae173325" title="If you have already computed HashCombo, use this. " alt="" coords="236,5,385,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae1d255af4c59e5d9eb4696da85b77121"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::verify_single_thread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>These are defined in <a class="el" href="hash__storage__verify_8cpp.html">hash_storage_verify.cpp</a>. </p>

<p>Definition at line <a class="el" href="hash__storage__verify_8cpp_source.html#l00042">42</a> of file <a class="el" href="hash__storage__verify_8cpp_source.html">hash_storage_verify.cpp</a>.</p>

<p>References <a class="el" href="hash__storage__verify_8cpp_source.html#l00035">CHECK_AND_ASSERT</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00105">foedus::storage::hash::HashIntermediatePage::get_level()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="page__resolver_8hpp_source.html#l00120">foedus::memory::GlobalVolatilePageResolver::resolve_offset()</a>, and <a class="el" href="hash__storage__verify_8cpp_source.html#l00055">verify_single_thread_intermediate()</a>.</p>

<p>Referenced by <a class="el" href="hash__storage_8cpp_source.html#l00263">foedus::storage::hash::HashStorage::verify_single_thread()</a>, and <a class="el" href="hash__storage__verify_8cpp_source.html#l00039">verify_single_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                                                {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  VolatilePagePointer pointer = <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">if</span> (!pointer.is_null()) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// TASK(Hideaki) probably two versions: always follow volatile vs snapshot</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// so far check volatile only</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    HashIntermediatePage* root = <span class="keyword">reinterpret_cast&lt;</span>HashIntermediatePage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      engine-&gt;get_memory_manager()-&gt;get_global_volatile_page_resolver().resolve_offset(pointer));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(root-&gt;get_level() + 1U == <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;levels_);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afc1a73e49f6386098d3fff98bc1baf78">verify_single_thread_intermediate</a>(engine, root));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; HashStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">HashStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_afc1a73e49f6386098d3fff98bc1baf78"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afc1a73e49f6386098d3fff98bc1baf78">foedus::storage::hash::HashStoragePimpl::verify_single_thread_intermediate</a></div><div class="ttdeci">ErrorStack verify_single_thread_intermediate(Engine *engine, HashIntermediatePage *page)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__verify_8cpp_source.html#l00055">hash_storage_verify.cpp:55</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="hash__storage__verify_8cpp_html_aa0227b94f2abc9a7a5ac155db59cb2d3"><div class="ttname"><a href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a></div><div class="ttdeci">#define CHECK_AND_ASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__verify_8cpp_source.html#l00035">hash_storage_verify.cpp:35</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae1d255af4c59e5d9eb4696da85b77121_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae1d255af4c59e5d9eb4696da85b77121_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae1d255af4c59e5d9eb4696da85b77121_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae1d255af4c59e5d9eb4696da85b77121_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="729,849,940,905"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="499,307,661,363"/>
<area shape="rect" id="node5" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="767,929,902,971"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="754,425,915,467"/>
<area shape="rect" id="node8" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="228,125,431,167"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afc1a73e49f6386098d3fff98bc1baf78" title="foedus::storage::hash\l::HashStoragePimpl::verify\l_single_thread_intermediate" alt="" coords="237,667,421,723"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="739,315,930,356"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1008,297,1169,339"/>
<area shape="rect" id="node9" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="503,125,657,167"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="760,5,909,47"/>
<area shape="rect" id="node13" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="493,191,667,232"/>
<area shape="rect" id="node14" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="479,45,681,101"/>
<area shape="rect" id="node10" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="757,107,912,148"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="739,239,930,280"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="499,569,661,625"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1PageVersion.html#a301cba19b01cf82d7b576a04180b56e2" title="foedus::storage::PageVersion\l::is_locked" alt="" coords="484,1012,676,1053"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="484,1077,676,1119"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1PageVersion.html#a61318d7aab5c4ca7334ec05f8de168ca" title="foedus::storage::PageVersion\l::is_retired" alt="" coords="484,1195,676,1236"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="499,830,661,886"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="499,438,661,494"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="751,535,918,576"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad137d51b31782b8e525481bb69816848" title="foedus::storage::hash\l::HashStoragePimpl::verify\l_single_thread_data" alt="" coords="493,699,667,755"/>
<area shape="rect" id="node18" href="structfoedus_1_1xct_1_1McsWwLock.html#abe15a0d250a2186ac534fc5d2d0b7f8e" title="This is a &quot;relaxed&quot; check. " alt="" coords="750,1012,919,1053"/>
<area shape="rect" id="node19" href="structfoedus_1_1xct_1_1McsWwBlockData.html#aa6a3e9b495bb234bf4c840a0e43d082e" title="foedus::xct::McsWwBlockData\l::is_valid_relaxed" alt="" coords="988,1012,1189,1053"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="739,1077,931,1119"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ab07c3c3d030fab04f79b59dee83ecd2e" title="foedus::storage::PageVersion\lStatus::is_retired" alt="" coords="739,1195,931,1236"/>
<area shape="rect" id="node28" href="structfoedus_1_1xct_1_1RwLockableXctId.html#a610d8c1bfd1d86dcde181c3fb0020f0c" title="foedus::xct::RwLockableXct\lId::is_keylocked" alt="" coords="743,665,926,707"/>
<area shape="rect" id="node30" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="773,600,896,641"/>
<area shape="rect" id="node31" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="773,783,896,824"/>
<area shape="rect" id="node33" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="757,731,912,758"/>
<area shape="rect" id="node29" href="structfoedus_1_1xct_1_1McsRwLock.html#adc5e6612e3cecf3d2f15d02237b4ef8f" title="foedus::xct::McsRwLock\l::is_locked" alt="" coords="1006,665,1171,707"/>
<area shape="rect" id="node32" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="1027,783,1150,824"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae1d255af4c59e5d9eb4696da85b77121_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae1d255af4c59e5d9eb4696da85b77121_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae1d255af4c59e5d9eb4696da85b77121_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ae1d255af4c59e5d9eb4696da85b77121_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a29cf082a85cdc7074a748e151e34807d" title="foedus::storage::hash\l::HashStorage::verify\l_single_thread" alt="" coords="242,5,389,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3e66818c84450f40fdb3d84a945cc36c" title="foedus::storage::hash\l::HashStoragePimpl::verify\l_single_thread" alt="" coords="228,85,403,141"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3e66818c84450f40fdb3d84a945cc36c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::verify_single_thread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__verify_8cpp_source.html#l00039">39</a> of file <a class="el" href="hash__storage__verify_8cpp_source.html">hash_storage_verify.cpp</a>.</p>

<p>References <a class="el" href="thread_8cpp_source.html#l00052">foedus::thread::Thread::get_engine()</a>, and <a class="el" href="hash__storage__verify_8cpp_source.html#l00042">verify_single_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                                                       {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae1d255af4c59e5d9eb4696da85b77121">verify_single_thread</a>(context-&gt;get_engine());</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_ae1d255af4c59e5d9eb4696da85b77121"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae1d255af4c59e5d9eb4696da85b77121">foedus::storage::hash::HashStoragePimpl::verify_single_thread</a></div><div class="ttdeci">ErrorStack verify_single_thread(Engine *engine)</div><div class="ttdoc">These are defined in hash_storage_verify.cpp. </div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__verify_8cpp_source.html#l00042">hash_storage_verify.cpp:42</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3e66818c84450f40fdb3d84a945cc36c_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3e66818c84450f40fdb3d84a945cc36c_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3e66818c84450f40fdb3d84a945cc36c_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_a3e66818c84450f40fdb3d84a945cc36c_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1thread_1_1Thread.html#a64fa1150b812810a2697bd6293aaac9a" title="foedus::thread::Thread\l::get_engine" alt="" coords="240,455,391,496"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae1d255af4c59e5d9eb4696da85b77121" title="These are defined in hash_storage_verify.cpp. " alt="" coords="228,521,403,577"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="952,849,1163,905"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="722,307,883,363"/>
<area shape="rect" id="node7" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="990,929,1125,971"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="977,425,1138,467"/>
<area shape="rect" id="node10" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="451,125,653,167"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afc1a73e49f6386098d3fff98bc1baf78" title="foedus::storage::hash\l::HashStoragePimpl::verify\l_single_thread_intermediate" alt="" coords="460,667,644,723"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="962,315,1153,356"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1231,297,1392,339"/>
<area shape="rect" id="node11" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="725,125,880,167"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="983,5,1132,47"/>
<area shape="rect" id="node15" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="716,191,889,232"/>
<area shape="rect" id="node16" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="701,45,904,101"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="980,107,1135,148"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="962,239,1153,280"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="722,569,883,625"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1PageVersion.html#a301cba19b01cf82d7b576a04180b56e2" title="foedus::storage::PageVersion\l::is_locked" alt="" coords="707,1012,899,1053"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="707,1077,899,1119"/>
<area shape="rect" id="node24" href="structfoedus_1_1storage_1_1PageVersion.html#a61318d7aab5c4ca7334ec05f8de168ca" title="foedus::storage::PageVersion\l::is_retired" alt="" coords="707,1195,899,1236"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="722,830,883,886"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="722,438,883,494"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="974,535,1141,576"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad137d51b31782b8e525481bb69816848" title="foedus::storage::hash\l::HashStoragePimpl::verify\l_single_thread_data" alt="" coords="715,699,890,755"/>
<area shape="rect" id="node20" href="structfoedus_1_1xct_1_1McsWwLock.html#abe15a0d250a2186ac534fc5d2d0b7f8e" title="This is a &quot;relaxed&quot; check. " alt="" coords="973,1012,1142,1053"/>
<area shape="rect" id="node21" href="structfoedus_1_1xct_1_1McsWwBlockData.html#aa6a3e9b495bb234bf4c840a0e43d082e" title="foedus::xct::McsWwBlockData\l::is_valid_relaxed" alt="" coords="1211,1012,1412,1053"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="961,1077,1153,1119"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ab07c3c3d030fab04f79b59dee83ecd2e" title="foedus::storage::PageVersion\lStatus::is_retired" alt="" coords="961,1195,1153,1236"/>
<area shape="rect" id="node30" href="structfoedus_1_1xct_1_1RwLockableXctId.html#a610d8c1bfd1d86dcde181c3fb0020f0c" title="foedus::xct::RwLockableXct\lId::is_keylocked" alt="" coords="966,665,1149,707"/>
<area shape="rect" id="node32" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="996,600,1119,641"/>
<area shape="rect" id="node33" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="996,783,1119,824"/>
<area shape="rect" id="node35" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="980,731,1135,758"/>
<area shape="rect" id="node31" href="structfoedus_1_1xct_1_1McsRwLock.html#adc5e6612e3cecf3d2f15d02237b4ef8f" title="foedus::xct::McsRwLock\l::is_locked" alt="" coords="1229,665,1394,707"/>
<area shape="rect" id="node34" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="1250,783,1373,824"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad137d51b31782b8e525481bb69816848"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::verify_single_thread_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html">HashDataPage</a> *&#160;</td>
          <td class="paramname"><em>head</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__verify_8cpp_source.html#l00087">87</a> of file <a class="el" href="hash__storage__verify_8cpp_source.html">hash_storage_verify.cpp</a>.</p>

<p>References <a class="el" href="hash__storage__verify_8cpp_source.html#l00035">CHECK_AND_ASSERT</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00412">foedus::storage::hash::HashDataPage::get_bin()</a>, <a class="el" href="xct__id_8hpp_source.html#l00964">foedus::xct::XctId::get_epoch()</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="xct__id_8hpp_source.html#l01038">foedus::xct::XctId::is_being_written()</a>, <a class="el" href="xct__id_8hpp_source.html#l01140">foedus::xct::RwLockableXctId::is_keylocked()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="epoch_8hpp_source.html#l00096">foedus::Epoch::is_valid()</a>, <a class="el" href="page_8hpp_source.html#l00054">foedus::storage::kHashDataPageType</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00165">foedus::storage::hash::HashDataPage::Slot::tid_</a>, and <a class="el" href="xct__id_8hpp_source.html#l01137">foedus::xct::RwLockableXctId::xct_id_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__verify_8cpp_source.html#l00055">verify_single_thread_intermediate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                      {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resolver = engine-&gt;get_memory_manager()-&gt;get_global_volatile_page_resolver();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a> bin = head-&gt;get_bin();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">for</span> (HashDataPage* page = head; page;) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;header().get_page_type() == <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba6c1740f811f2524fac6cd76aa2a31c6c">kHashDataPageType</a>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;header().page_version_.is_locked());</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;header().page_version_.is_moved());</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;header().page_version_.is_retired());</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;header().masstree_in_layer_level_ == 0);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;get_bin() == bin);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    page-&gt;assert_entries_impl();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    uint16_t records = page-&gt;get_record_count();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">DataPageSlotIndex</a> i = 0; i &lt; records; ++i) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      HashDataPage::Slot* slot = page-&gt;get_slot_address(i);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!slot-&gt;tid_.is_keylocked());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!slot-&gt;tid_.xct_id_.is_being_written());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(slot-&gt;tid_.xct_id_.get_epoch().is_valid());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    VolatilePagePointer next = page-&gt;next_page().volatile_pointer_;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    page = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (!next.is_null()) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      page = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(resolver.resolve_offset(next));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1hash_html_a476dd04e514ebe83142d21135e8b91c7"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1hash.html#a476dd04e514ebe83142d21135e8b91c7">foedus::storage::hash::DataPageSlotIndex</a></div><div class="ttdeci">uint16_t DataPageSlotIndex</div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00196">hash_id.hpp:196</a></div></div>
<div class="ttc" id="group__HASH_html_gacb9a1ea596bf0db3f6ded1710ab3b3d6"><div class="ttname"><a href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">foedus::storage::hash::HashBin</a></div><div class="ttdeci">uint64_t HashBin</div><div class="ttdoc">Represents a bin of a hash value. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00142">hash_id.hpp:142</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="hash__storage__verify_8cpp_html_aa0227b94f2abc9a7a5ac155db59cb2d3"><div class="ttname"><a href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a></div><div class="ttdeci">#define CHECK_AND_ASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__verify_8cpp_source.html#l00035">hash_storage_verify.cpp:35</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga14e35f7fbe4bc18276fde8e8ba460f5ba6c1740f811f2524fac6cd76aa2a31c6c"><div class="ttname"><a href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba6c1740f811f2524fac6cd76aa2a31c6c">foedus::storage::kHashDataPageType</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00054">page.hpp:54</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad137d51b31782b8e525481bb69816848_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad137d51b31782b8e525481bb69816848_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad137d51b31782b8e525481bb69816848_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad137d51b31782b8e525481bb69816848_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="250,5,417,47"/>
<area shape="rect" id="node3" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="272,71,395,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="228,137,439,193"/>
<area shape="rect" id="node6" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="266,217,401,259"/>
<area shape="rect" id="node7" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="272,283,395,324"/>
<area shape="rect" id="node8" href="structfoedus_1_1xct_1_1RwLockableXctId.html#a610d8c1bfd1d86dcde181c3fb0020f0c" title="foedus::xct::RwLockableXct\lId::is_keylocked" alt="" coords="242,348,425,389"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="253,413,414,455"/>
<area shape="rect" id="node12" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="256,479,411,506"/>
<area shape="rect" id="node4" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="508,71,631,112"/>
<area shape="rect" id="node9" href="structfoedus_1_1xct_1_1McsRwLock.html#adc5e6612e3cecf3d2f15d02237b4ef8f" title="foedus::xct::McsRwLock\l::is_locked" alt="" coords="487,348,652,389"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="489,413,650,455"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad137d51b31782b8e525481bb69816848_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad137d51b31782b8e525481bb69816848_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad137d51b31782b8e525481bb69816848_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_ad137d51b31782b8e525481bb69816848_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afc1a73e49f6386098d3fff98bc1baf78" title="foedus::storage::hash\l::HashStoragePimpl::verify\l_single_thread_intermediate" alt="" coords="228,45,412,101"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae1d255af4c59e5d9eb4696da85b77121" title="These are defined in hash_storage_verify.cpp. " alt="" coords="460,45,635,101"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a29cf082a85cdc7074a748e151e34807d" title="foedus::storage::hash\l::HashStorage::verify\l_single_thread" alt="" coords="697,5,843,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3e66818c84450f40fdb3d84a945cc36c" title="foedus::storage::hash\l::HashStoragePimpl::verify\l_single_thread" alt="" coords="683,85,857,141"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afc1a73e49f6386098d3fff98bc1baf78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::hash::HashStoragePimpl::verify_single_thread_intermediate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html">HashIntermediatePage</a> *&#160;</td>
          <td class="paramname"><em>page</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hash__storage__verify_8cpp_source.html#l00055">55</a> of file <a class="el" href="hash__storage__verify_8cpp_source.html">hash_storage_verify.cpp</a>.</p>

<p>References <a class="el" href="hash__id_8hpp_source.html#l00191">foedus::storage::hash::HashBinRange::begin_</a>, <a class="el" href="hash__storage__verify_8cpp_source.html#l00035">CHECK_AND_ASSERT</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="hash__id_8hpp_source.html#l00193">foedus::storage::hash::HashBinRange::end_</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00412">foedus::storage::hash::HashDataPage::get_bin()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00104">foedus::storage::hash::HashIntermediatePage::get_bin_range()</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00105">foedus::storage::hash::HashIntermediatePage::get_level()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="page_8hpp_source.html#l00280">foedus::storage::PageHeader::get_page_type()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00080">foedus::storage::hash::HashIntermediatePage::get_pointer()</a>, <a class="el" href="hash__page__impl_8hpp_source.html#l00070">foedus::storage::hash::HashIntermediatePage::header()</a>, <a class="el" href="page_8hpp_source.html#l00138">foedus::storage::PageVersion::is_locked()</a>, <a class="el" href="page_8hpp_source.html#l00139">foedus::storage::PageVersion::is_moved()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="page_8hpp_source.html#l00140">foedus::storage::PageVersion::is_retired()</a>, <a class="el" href="hash__id_8hpp_source.html#l00049">foedus::storage::hash::kHashIntermediatePageFanout</a>, <a class="el" href="page_8hpp_source.html#l00053">foedus::storage::kHashIntermediatePageType</a>, <a class="el" href="hash__id_8hpp_source.html#l00074">foedus::storage::hash::kHashMaxBins</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="page_8hpp_source.html#l00272">foedus::storage::PageHeader::page_version_</a>, <a class="el" href="hash__storage__verify_8cpp_source.html#l00087">verify_single_thread_data()</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="hash__storage__verify_8cpp_source.html#l00042">verify_single_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                              {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;header().get_page_type() == <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714">kHashIntermediatePageType</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;header().page_version_.is_locked());</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;header().page_version_.is_moved());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;header().page_version_.is_retired());</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  uint8_t level = page-&gt;get_level();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a> begin = page-&gt;get_bin_range().begin_;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">HashBin</a> interval = <a class="code" href="group__HASH.html#ga0083e0d73570a990b862bb330f8d5831">kHashMaxBins</a>[level];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;get_bin_range().end_ == begin + interval * <a class="code" href="group__HASH.html#ga4398665205e13bd71e8b2c1691ba1ba3">kHashIntermediatePageFanout</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; resolver = engine-&gt;get_memory_manager()-&gt;get_global_volatile_page_resolver();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code" href="group__HASH.html#ga4398665205e13bd71e8b2c1691ba1ba3">kHashIntermediatePageFanout</a>; ++i) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    DualPagePointer pointer = page-&gt;get_pointer(i);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span> (!pointer.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">if</span> (level == 0) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        HashDataPage* child = <span class="keyword">reinterpret_cast&lt;</span>HashDataPage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          resolver.resolve_offset(pointer.volatile_pointer_));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(child-&gt;get_bin() == begin + i);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad137d51b31782b8e525481bb69816848">verify_single_thread_data</a>(engine, child));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        HashIntermediatePage* child = <span class="keyword">reinterpret_cast&lt;</span>HashIntermediatePage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;          resolver.resolve_offset(pointer.volatile_pointer_));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(child-&gt;get_level() + 1U == level);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(child-&gt;get_bin_range().begin_ == begin + i * interval);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afc1a73e49f6386098d3fff98bc1baf78">verify_single_thread_intermediate</a>(engine, child));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714"><div class="ttname"><a href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5baa295f358dce197aac9c593ba56d89714">foedus::storage::kHashIntermediatePageType</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00053">page.hpp:53</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_ad137d51b31782b8e525481bb69816848"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad137d51b31782b8e525481bb69816848">foedus::storage::hash::HashStoragePimpl::verify_single_thread_data</a></div><div class="ttdeci">ErrorStack verify_single_thread_data(Engine *engine, HashDataPage *head)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__verify_8cpp_source.html#l00087">hash_storage_verify.cpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_html_afc1a73e49f6386098d3fff98bc1baf78"><div class="ttname"><a href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#afc1a73e49f6386098d3fff98bc1baf78">foedus::storage::hash::HashStoragePimpl::verify_single_thread_intermediate</a></div><div class="ttdeci">ErrorStack verify_single_thread_intermediate(Engine *engine, HashIntermediatePage *page)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__verify_8cpp_source.html#l00055">hash_storage_verify.cpp:55</a></div></div>
<div class="ttc" id="group__HASH_html_gacb9a1ea596bf0db3f6ded1710ab3b3d6"><div class="ttname"><a href="group__HASH.html#gacb9a1ea596bf0db3f6ded1710ab3b3d6">foedus::storage::hash::HashBin</a></div><div class="ttdeci">uint64_t HashBin</div><div class="ttdoc">Represents a bin of a hash value. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00142">hash_id.hpp:142</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="group__HASH_html_ga4398665205e13bd71e8b2c1691ba1ba3"><div class="ttname"><a href="group__HASH.html#ga4398665205e13bd71e8b2c1691ba1ba3">foedus::storage::hash::kHashIntermediatePageFanout</a></div><div class="ttdeci">const uint8_t kHashIntermediatePageFanout</div><div class="ttdoc">Number of pointers in an intermediate page of hash storage. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00049">hash_id.hpp:49</a></div></div>
<div class="ttc" id="group__HASH_html_ga0083e0d73570a990b862bb330f8d5831"><div class="ttname"><a href="group__HASH.html#ga0083e0d73570a990b862bb330f8d5831">foedus::storage::hash::kHashMaxBins</a></div><div class="ttdeci">const uint64_t kHashMaxBins[]</div><div class="ttdoc">kHashTotalBins[n] gives the maximum number of hash bins n-level hash can hold. </div><div class="ttdef"><b>Definition:</b> <a href="hash__id_8hpp_source.html#l00074">hash_id.hpp:74</a></div></div>
<div class="ttc" id="hash__storage__verify_8cpp_html_aa0227b94f2abc9a7a5ac155db59cb2d3"><div class="ttname"><a href="hash__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a></div><div class="ttdeci">#define CHECK_AND_ASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="hash__storage__verify_8cpp_source.html#l00035">hash_storage_verify.cpp:35</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afc1a73e49f6386098d3fff98bc1baf78_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afc1a73e49f6386098d3fff98bc1baf78_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afc1a73e49f6386098d3fff98bc1baf78_cgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afc1a73e49f6386098d3fff98bc1baf78_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashDataPage.html#acfa062e1acf64b882f466cca8e190fdd" title="foedus::storage::hash\l::HashDataPage::get_bin" alt="" coords="499,5,666,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#ac5e2de81d5e512b5a0f735a9fc413629" title="foedus::storage::hash\l::HashIntermediatePage\l::get_bin_range" alt="" coords="253,341,414,397"/>
<area shape="rect" id="node4" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="477,71,688,127"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="253,421,414,477"/>
<area shape="rect" id="node7" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="515,152,650,193"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="238,501,429,543"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="253,567,414,623"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="253,647,414,703"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1PageVersion.html#a301cba19b01cf82d7b576a04180b56e2" title="foedus::storage::PageVersion\l::is_locked" alt="" coords="237,728,429,769"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="237,793,429,835"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="502,217,663,259"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1PageVersion.html#a61318d7aab5c4ca7334ec05f8de168ca" title="foedus::storage::PageVersion\l::is_retired" alt="" coords="237,859,429,900"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ad137d51b31782b8e525481bb69816848" title="foedus::storage::hash\l::HashStoragePimpl::verify\l_single_thread_data" alt="" coords="246,261,421,317"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="487,531,678,572"/>
<area shape="rect" id="node12" href="structfoedus_1_1xct_1_1McsWwLock.html#abe15a0d250a2186ac534fc5d2d0b7f8e" title="This is a &quot;relaxed&quot; check. " alt="" coords="498,728,667,769"/>
<area shape="rect" id="node13" href="structfoedus_1_1xct_1_1McsWwBlockData.html#aa6a3e9b495bb234bf4c840a0e43d082e" title="foedus::xct::McsWwBlockData\l::is_valid_relaxed" alt="" coords="736,728,937,769"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="487,793,679,835"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="756,217,917,259"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ab07c3c3d030fab04f79b59dee83ecd2e" title="foedus::storage::PageVersion\lStatus::is_retired" alt="" coords="487,859,679,900"/>
<area shape="rect" id="node21" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="521,283,644,324"/>
<area shape="rect" id="node23" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="521,348,644,389"/>
<area shape="rect" id="node24" href="structfoedus_1_1xct_1_1RwLockableXctId.html#a610d8c1bfd1d86dcde181c3fb0020f0c" title="foedus::xct::RwLockableXct\lId::is_keylocked" alt="" coords="491,413,674,455"/>
<area shape="rect" id="node26" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="505,479,660,506"/>
<area shape="rect" id="node22" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="775,283,898,324"/>
<area shape="rect" id="node25" href="structfoedus_1_1xct_1_1McsRwLock.html#adc5e6612e3cecf3d2f15d02237b4ef8f" title="foedus::xct::McsRwLock\l::is_locked" alt="" coords="754,413,919,455"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afc1a73e49f6386098d3fff98bc1baf78_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afc1a73e49f6386098d3fff98bc1baf78_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afc1a73e49f6386098d3fff98bc1baf78_icgraph" id="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl_afc1a73e49f6386098d3fff98bc1baf78_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#ae1d255af4c59e5d9eb4696da85b77121" title="These are defined in hash_storage_verify.cpp. " alt="" coords="237,45,412,101"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a29cf082a85cdc7074a748e151e34807d" title="foedus::storage::hash\l::HashStorage::verify\l_single_thread" alt="" coords="474,5,621,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html#a3e66818c84450f40fdb3d84a945cc36c" title="foedus::storage::hash\l::HashStoragePimpl::verify\l_single_thread" alt="" coords="460,85,635,141"/>
</map>
</div>
</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/storage/hash/<a class="el" href="hash__storage__pimpl_8hpp_source.html">hash_storage_pimpl.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/hash/<a class="el" href="hash__storage__debug_8cpp_source.html">hash_storage_debug.cpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/hash/<a class="el" href="hash__storage__pimpl_8cpp_source.html">hash_storage_pimpl.cpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/hash/<a class="el" href="hash__storage__verify_8cpp_source.html">hash_storage_verify.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1storage.html">storage</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1storage_1_1hash.html">hash</a></li><li class="navelem"><a class="el" href="classfoedus_1_1storage_1_1hash_1_1HashStoragePimpl.html">HashStoragePimpl</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

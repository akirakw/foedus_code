<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::storage::PartitionerMetadata Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('structfoedus_1_1storage_1_1PartitionerMetadata.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="structfoedus_1_1storage_1_1PartitionerMetadata-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::storage::PartitionerMetadata Struct Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__STORAGE.html">Storage Manager</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Tiny metadata of partitioner for every storage used while log gleaning.  
 <a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Tiny metadata of partitioner for every storage used while log gleaning. </p>
<p>The metadata is tiny because it just points to a data block in a separate partitioner data block, which is variable-sized. Think of Masstree's partitioning information for example. we have to store keys, so we can't statically determine the size. We allocate an array of this object on shared memory so that all mappers/reducers can access the partitioner information.</p>
<dl class="section user"><dt>Index-0 Entry</dt><dd>As storage-id 0 doesn't exist, we use the first entry as metadata of the data block. data_offset_ is the end of already-taken regions while data_size_ is the . When we initialize a new partitioner, we lock mutex_ and increment data_offset_. </dd></dl>

<p>Definition at line <a class="el" href="partitioner_8hpp_source.html#l00209">209</a> of file <a class="el" href="partitioner_8hpp_source.html">partitioner.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="partitioner_8hpp_source.html">partitioner.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for foedus::storage::PartitionerMetadata:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata__coll__graph.png" border="0" usemap="#foedus_1_1storage_1_1PartitionerMetadata_coll__map" alt="Collaboration graph"/></div>
<map name="foedus_1_1storage_1_1PartitionerMetadata_coll__map" id="foedus_1_1storage_1_1PartitionerMetadata_coll__map">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMutex.html" title="A mutex that can be placed in shared memory and used from multiple processes. " alt="" coords="7,5,182,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0e49f49136df84e68e2ec4abdb7b6c46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a0e49f49136df84e68e2ec4abdb7b6c46">PartitionerMetadata</a> ()=delete</td></tr>
<tr class="separator:a0e49f49136df84e68e2ec4abdb7b6c46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a269fd89abc251e1da2ee888d520daabd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a269fd89abc251e1da2ee888d520daabd">~PartitionerMetadata</a> ()=delete</td></tr>
<tr class="separator:a269fd89abc251e1da2ee888d520daabd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf6f2b1d87dea8f45cd14632fc1c752c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#adf6f2b1d87dea8f45cd14632fc1c752c">initialize</a> ()</td></tr>
<tr class="separator:adf6f2b1d87dea8f45cd14632fc1c752c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a2b866bb37a79a612da1bc3bc67fd23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a4a2b866bb37a79a612da1bc3bc67fd23">uninitialize</a> ()</td></tr>
<tr class="separator:a4a2b866bb37a79a612da1bc3bc67fd23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7586439779bf7e56b33ee636c62efdb0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a7586439779bf7e56b33ee636c62efdb0">clear_counts</a> ()</td></tr>
<tr class="separator:a7586439779bf7e56b33ee636c62efdb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0534520d3f4fb059afdf7b9db375907e"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a0534520d3f4fb059afdf7b9db375907e">locate_data</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine)</td></tr>
<tr class="memdesc:a0534520d3f4fb059afdf7b9db375907e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the partitioner data pointed from this metadata.  <a href="#a0534520d3f4fb059afdf7b9db375907e">More...</a><br /></td></tr>
<tr class="separator:a0534520d3f4fb059afdf7b9db375907e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b5c729829a30ca3848d8254d616459a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a3b5c729829a30ca3848d8254d616459a">allocate_data</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, <a class="el" href="classfoedus_1_1soc_1_1SharedMutexScope.html">soc::SharedMutexScope</a> *locked, uint32_t data_size)</td></tr>
<tr class="memdesc:a3b5c729829a30ca3848d8254d616459a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a patitioner data in shared memory of the given size.  <a href="#a3b5c729829a30ca3848d8254d616459a">More...</a><br /></td></tr>
<tr class="separator:a3b5c729829a30ca3848d8254d616459a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aa6e48ddb92bb1c1b572cc3b90e19daf9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html">PartitionerMetadata</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aa6e48ddb92bb1c1b572cc3b90e19daf9">get_metadata</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, <a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a> id)</td></tr>
<tr class="memdesc:aa6e48ddb92bb1c1b572cc3b90e19daf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the shared memory for the given storage ID.  <a href="#aa6e48ddb92bb1c1b572cc3b90e19daf9">More...</a><br /></td></tr>
<tr class="separator:aa6e48ddb92bb1c1b572cc3b90e19daf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a889951c15caacc4d60b446f6c6c56cde"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html">PartitionerMetadata</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a889951c15caacc4d60b446f6c6c56cde">get_index0_metadata</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine)</td></tr>
<tr class="memdesc:a889951c15caacc4d60b446f6c6c56cde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the special index-0 entry that manages data block allocation for partitioners.  <a href="#a889951c15caacc4d60b446f6c6c56cde">More...</a><br /></td></tr>
<tr class="separator:a889951c15caacc4d60b446f6c6c56cde"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a1b5e5a68b2cde0cd42300642f3b538a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1soc_1_1SharedMutex.html">soc::SharedMutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a1b5e5a68b2cde0cd42300642f3b538a3">mutex_</a></td></tr>
<tr class="memdesc:a1b5e5a68b2cde0cd42300642f3b538a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize concurrent initialization of this partitioner.  <a href="#a1b5e5a68b2cde0cd42300642f3b538a3">More...</a><br /></td></tr>
<tr class="separator:a1b5e5a68b2cde0cd42300642f3b538a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63a799f43dfcc06d8c14d471fd0ebfcd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a63a799f43dfcc06d8c14d471fd0ebfcd">valid_</a></td></tr>
<tr class="memdesc:a63a799f43dfcc06d8c14d471fd0ebfcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether this partitioner information (metadata+data) has been constructed.  <a href="#a63a799f43dfcc06d8c14d471fd0ebfcd">More...</a><br /></td></tr>
<tr class="separator:a63a799f43dfcc06d8c14d471fd0ebfcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94eae7ada6920800d5fa7ba348fcfd24"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a94eae7ada6920800d5fa7ba348fcfd24">data_offset_</a></td></tr>
<tr class="memdesc:a94eae7ada6920800d5fa7ba348fcfd24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Relative offset from the beginning of partitioner data block that points to variable-sized partitioner data.  <a href="#a94eae7ada6920800d5fa7ba348fcfd24">More...</a><br /></td></tr>
<tr class="separator:a94eae7ada6920800d5fa7ba348fcfd24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea48393cb437072c5ad9323f70ad8c73"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aea48393cb437072c5ad9323f70ad8c73">data_size_</a></td></tr>
<tr class="memdesc:aea48393cb437072c5ad9323f70ad8c73"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size of the partitioner data.  <a href="#aea48393cb437072c5ad9323f70ad8c73">More...</a><br /></td></tr>
<tr class="separator:aea48393cb437072c5ad9323f70ad8c73"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a961d9a4b17cfe05b49fc396de9e9738a"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a961d9a4b17cfe05b49fc396de9e9738a">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html">PartitionerMetadata</a> &amp;v)</td></tr>
<tr class="separator:a961d9a4b17cfe05b49fc396de9e9738a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a0e49f49136df84e68e2ec4abdb7b6c46"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::storage::PartitionerMetadata::PartitionerMetadata </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a269fd89abc251e1da2ee888d520daabd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::storage::PartitionerMetadata::~PartitionerMetadata </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a3b5c729829a30ca3848d8254d616459a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::PartitionerMetadata::allocate_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1soc_1_1SharedMutexScope.html">soc::SharedMutexScope</a> *&#160;</td>
          <td class="paramname"><em>locked</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>data_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a patitioner data in shared memory of the given size. </p>
<dl class="section pre"><dt>Precondition</dt><dd>!valid_ (if it's already constructed, why are we allocating again?) </dd>
<dd>
locked-&gt;is_locked_by_me(), locked-&gt;get_mutex() == &amp;mutex_ (the caller must own the mutex) </dd>
<dd>
data_size &gt; 0 </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>data_offset_ is set and index0-entry's data_offset_ is incremented. </dd>
<dd>
data_size_ == data_size The only possible error is memory running out (kErrorCodeStrPartitionerDataMemoryTooSmall). </dd></dl>

<p>Definition at line <a class="el" href="partitioner_8cpp_source.html#l00061">61</a> of file <a class="el" href="partitioner_8cpp_source.html">partitioner.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="partitioner_8hpp_source.html#l00242">data_offset_</a>, <a class="el" href="partitioner_8hpp_source.html#l00246">data_size_</a>, <a class="el" href="partitioner_8cpp_source.html#l00045">get_index0_metadata()</a>, <a class="el" href="shared__mutex_8hpp_source.html#l00115">foedus::soc::SharedMutexScope::get_mutex()</a>, <a class="el" href="shared__mutex_8hpp_source.html#l00114">foedus::soc::SharedMutexScope::is_locked_by_me()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00188">foedus::kErrorCodeStrPartitionerDataMemoryTooSmall</a>, <a class="el" href="partitioner_8hpp_source.html#l00232">mutex_</a>, and <a class="el" href="partitioner_8hpp_source.html#l00237">valid_</a>.</p>

<p>Referenced by <a class="el" href="hash__partitioner__impl_8cpp_source.html#l00068">foedus::storage::hash::HashPartitioner::design_partition()</a>, <a class="el" href="array__partitioner__impl_8cpp_source.html#l00073">foedus::storage::array::ArrayPartitioner::design_partition()</a>, and <a class="el" href="masstree__partitioner__impl_8cpp_source.html#l00064">foedus::storage::masstree::MasstreePartitioner::design_partition()</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                      {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!<a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a63a799f43dfcc06d8c14d471fd0ebfcd">valid_</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(data_size &gt; 0);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aea48393cb437072c5ad9323f70ad8c73">data_size_</a> == 0);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a94eae7ada6920800d5fa7ba348fcfd24">data_offset_</a> == 0);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(locked-&gt;get_mutex() == &amp;<a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a1b5e5a68b2cde0cd42300642f3b538a3">mutex_</a>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(locked-&gt;is_locked_by_me());</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a0e49f49136df84e68e2ec4abdb7b6c46">PartitionerMetadata</a>* index0 = <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a889951c15caacc4d60b446f6c6c56cde">get_index0_metadata</a>(engine);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(index0-&gt;data_offset_ &lt;= index0-&gt;data_size_);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  soc::SharedMutexScope index0_scope(&amp;index0-&gt;mutex_);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">if</span> (index0-&gt;data_offset_ + data_size &gt; index0-&gt;data_size_) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a935065063b9103d955ca08fbad233746">kErrorCodeStrPartitionerDataMemoryTooSmall</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a94eae7ada6920800d5fa7ba348fcfd24">data_offset_</a> = index0-&gt;data_offset_;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aea48393cb437072c5ad9323f70ad8c73">data_size_</a> = data_size;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  index0-&gt;data_offset_ += data_size;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a63a799f43dfcc06d8c14d471fd0ebfcd"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a63a799f43dfcc06d8c14d471fd0ebfcd">foedus::storage::PartitionerMetadata::valid_</a></div><div class="ttdeci">bool valid_</div><div class="ttdoc">Whether this partitioner information (metadata+data) has been constructed. </div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00237">partitioner.hpp:237</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a0e49f49136df84e68e2ec4abdb7b6c46"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a0e49f49136df84e68e2ec4abdb7b6c46">foedus::storage::PartitionerMetadata::PartitionerMetadata</a></div><div class="ttdeci">PartitionerMetadata()=delete</div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a935065063b9103d955ca08fbad233746"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a935065063b9103d955ca08fbad233746">foedus::kErrorCodeStrPartitionerDataMemoryTooSmall</a></div><div class="ttdoc">0x0825 : "STORAGE: Memory for Partitioners ran out during snapshot. Increase StorageOptions::partitio...</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00188">error_code.hpp:188</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a889951c15caacc4d60b446f6c6c56cde"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a889951c15caacc4d60b446f6c6c56cde">foedus::storage::PartitionerMetadata::get_index0_metadata</a></div><div class="ttdeci">static PartitionerMetadata * get_index0_metadata(Engine *engine)</div><div class="ttdoc">Returns the special index-0 entry that manages data block allocation for partitioners. </div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8cpp_source.html#l00045">partitioner.cpp:45</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_aea48393cb437072c5ad9323f70ad8c73"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aea48393cb437072c5ad9323f70ad8c73">foedus::storage::PartitionerMetadata::data_size_</a></div><div class="ttdeci">uint32_t data_size_</div><div class="ttdoc">The size of the partitioner data. </div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00246">partitioner.hpp:246</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a1b5e5a68b2cde0cd42300642f3b538a3"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a1b5e5a68b2cde0cd42300642f3b538a3">foedus::storage::PartitionerMetadata::mutex_</a></div><div class="ttdeci">soc::SharedMutex mutex_</div><div class="ttdoc">Serialize concurrent initialization of this partitioner. </div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00232">partitioner.hpp:232</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a94eae7ada6920800d5fa7ba348fcfd24"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a94eae7ada6920800d5fa7ba348fcfd24">foedus::storage::PartitionerMetadata::data_offset_</a></div><div class="ttdeci">uint32_t data_offset_</div><div class="ttdoc">Relative offset from the beginning of partitioner data block that points to variable-sized partitione...</div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00242">partitioner.hpp:242</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_a3b5c729829a30ca3848d8254d616459a_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_a3b5c729829a30ca3848d8254d616459a_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_a3b5c729829a30ca3848d8254d616459a_cgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_a3b5c729829a30ca3848d8254d616459a_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a889951c15caacc4d60b446f6c6c56cde" title="Returns the special index&#45;0 entry that manages data block allocation for partitioners. " alt="" coords="232,71,440,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1soc_1_1SharedMutexScope.html#a51a27729ac214786ce97d32ae80dd6f7" title="foedus::soc::SharedMutex\lScope::get_mutex" alt="" coords="249,136,423,177"/>
<area shape="rect" id="node7" href="classfoedus_1_1soc_1_1SharedMutexScope.html#a9576d709cf25478f4fe81a8362ba7636" title="foedus::soc::SharedMutex\lScope::is_locked_by_me" alt="" coords="249,201,423,243"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="513,5,648,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="491,71,671,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb" title="foedus::soc::SharedMemory\lRepo::get_global_memory\l_anchors" alt="" coords="488,137,673,193"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_a3b5c729829a30ca3848d8254d616459a_icgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_a3b5c729829a30ca3848d8254d616459a_icgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_a3b5c729829a30ca3848d8254d616459a_icgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_a3b5c729829a30ca3848d8254d616459a_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1hash_1_1HashPartitioner.html#a9def1e9584cd2af4bae4d2b0c0ca10e4" title="foedus::storage::hash\l::HashPartitioner::design\l_partition" alt="" coords="236,5,401,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayPartitioner.html#a7002637fe43ab0917bead1d4636805ad" title="foedus::storage::array\l::ArrayPartitioner::design\l_partition" alt="" coords="235,85,402,141"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePartitioner.html#a1aedc45cc5621bd3889f1bf2d47ab79c" title="foedus::storage::masstree\l::MasstreePartitioner::\ldesign_partition" alt="" coords="232,165,405,221"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1Partitioner.html#a31a7e393bf1f87a9a039c60b291ac9d1" title="Determines partitioning scheme for this storage. " alt="" coords="453,93,632,134"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7586439779bf7e56b33ee636c62efdb0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::PartitionerMetadata::clear_counts </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="partitioner_8hpp_source.html#l00221">221</a> of file <a class="el" href="partitioner_8hpp_source.html">partitioner.hpp</a>.</p>

<p>References <a class="el" href="partitioner_8hpp_source.html#l00242">data_offset_</a>, <a class="el" href="partitioner_8hpp_source.html#l00246">data_size_</a>, and <a class="el" href="partitioner_8hpp_source.html#l00237">valid_</a>.</p>

<p>Referenced by <a class="el" href="partitioner_8hpp_source.html#l00214">initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                      {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a63a799f43dfcc06d8c14d471fd0ebfcd">valid_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a94eae7ada6920800d5fa7ba348fcfd24">data_offset_</a> = 0;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aea48393cb437072c5ad9323f70ad8c73">data_size_</a> = 0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  }</div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a63a799f43dfcc06d8c14d471fd0ebfcd"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a63a799f43dfcc06d8c14d471fd0ebfcd">foedus::storage::PartitionerMetadata::valid_</a></div><div class="ttdeci">bool valid_</div><div class="ttdoc">Whether this partitioner information (metadata+data) has been constructed. </div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00237">partitioner.hpp:237</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_aea48393cb437072c5ad9323f70ad8c73"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aea48393cb437072c5ad9323f70ad8c73">foedus::storage::PartitionerMetadata::data_size_</a></div><div class="ttdeci">uint32_t data_size_</div><div class="ttdoc">The size of the partitioner data. </div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00246">partitioner.hpp:246</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a94eae7ada6920800d5fa7ba348fcfd24"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a94eae7ada6920800d5fa7ba348fcfd24">foedus::storage::PartitionerMetadata::data_offset_</a></div><div class="ttdeci">uint32_t data_offset_</div><div class="ttdoc">Relative offset from the beginning of partitioner data block that points to variable-sized partitione...</div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00242">partitioner.hpp:242</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_a7586439779bf7e56b33ee636c62efdb0_icgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_a7586439779bf7e56b33ee636c62efdb0_icgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_a7586439779bf7e56b33ee636c62efdb0_icgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_a7586439779bf7e56b33ee636c62efdb0_icgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#adf6f2b1d87dea8f45cd14632fc1c752c" title="foedus::storage::Partitioner\lMetadata::initialize" alt="" coords="232,5,411,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a632a4da7b3c67dd687f7eba4f6ec1d76" title="foedus::snapshot::Snapshot\lManagerPimpl::initialize_once" alt="" coords="459,5,653,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a889951c15caacc4d60b446f6c6c56cde"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html">PartitionerMetadata</a> * foedus::storage::PartitionerMetadata::get_index0_metadata </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the special index-0 entry that manages data block allocation for partitioners. </p>

<p>Definition at line <a class="el" href="partitioner_8cpp_source.html#l00045">45</a> of file <a class="el" href="partitioner_8cpp_source.html">partitioner.cpp</a>.</p>

<p>References <a class="el" href="shared__memory__repo_8hpp_source.html#l00514">foedus::soc::SharedMemoryRepo::get_global_memory_anchors()</a>, <a class="el" href="soc__manager_8cpp_source.html#l00038">foedus::soc::SocManager::get_shared_memory_repo()</a>, <a class="el" href="engine_8cpp_source.html#l00059">foedus::Engine::get_soc_manager()</a>, and <a class="el" href="shared__memory__repo_8hpp_source.html#l00271">foedus::soc::GlobalMemoryAnchors::partitioner_metadata_</a>.</p>

<p>Referenced by <a class="el" href="partitioner_8cpp_source.html#l00061">allocate_data()</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                                                            {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  soc::GlobalMemoryAnchors* anchors</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    = engine-&gt;get_soc_manager()-&gt;get_shared_memory_repo()-&gt;get_global_memory_anchors();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">return</span> anchors-&gt;partitioner_metadata_;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_a889951c15caacc4d60b446f6c6c56cde_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_a889951c15caacc4d60b446f6c6c56cde_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_a889951c15caacc4d60b446f6c6c56cde_cgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_a889951c15caacc4d60b446f6c6c56cde_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb" title="foedus::soc::SharedMemory\lRepo::get_global_memory\l_anchors" alt="" coords="261,5,447,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="264,86,444,127"/>
<area shape="rect" id="node4" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="287,151,421,193"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_a889951c15caacc4d60b446f6c6c56cde_icgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_a889951c15caacc4d60b446f6c6c56cde_icgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_a889951c15caacc4d60b446f6c6c56cde_icgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_a889951c15caacc4d60b446f6c6c56cde_icgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a3b5c729829a30ca3848d8254d616459a" title="Allocates a patitioner data in shared memory of the given size. " alt="" coords="261,93,440,134"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1hash_1_1HashPartitioner.html#a9def1e9584cd2af4bae4d2b0c0ca10e4" title="foedus::storage::hash\l::HashPartitioner::design\l_partition" alt="" coords="492,5,657,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1array_1_1ArrayPartitioner.html#a7002637fe43ab0917bead1d4636805ad" title="foedus::storage::array\l::ArrayPartitioner::design\l_partition" alt="" coords="491,85,658,141"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePartitioner.html#a1aedc45cc5621bd3889f1bf2d47ab79c" title="foedus::storage::masstree\l::MasstreePartitioner::\ldesign_partition" alt="" coords="488,165,661,221"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1Partitioner.html#a31a7e393bf1f87a9a039c60b291ac9d1" title="Determines partitioning scheme for this storage. " alt="" coords="709,93,888,134"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa6e48ddb92bb1c1b572cc3b90e19daf9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html">PartitionerMetadata</a> * foedus::storage::PartitionerMetadata::get_metadata </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a>&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the shared memory for the given storage ID. </p>
<dl class="section pre"><dt>Precondition</dt><dd>id &gt; 0 </dd></dl>

<p>Definition at line <a class="el" href="partitioner_8cpp_source.html#l00038">38</a> of file <a class="el" href="partitioner_8cpp_source.html">partitioner.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00514">foedus::soc::SharedMemoryRepo::get_global_memory_anchors()</a>, <a class="el" href="soc__manager_8cpp_source.html#l00038">foedus::soc::SocManager::get_shared_memory_repo()</a>, <a class="el" href="engine_8cpp_source.html#l00059">foedus::Engine::get_soc_manager()</a>, and <a class="el" href="shared__memory__repo_8hpp_source.html#l00271">foedus::soc::GlobalMemoryAnchors::partitioner_metadata_</a>.</p>

<p>Referenced by <a class="el" href="array__composer__impl_8cpp_source.html#l00191">foedus::storage::array::ArrayComposeContext::ArrayComposeContext()</a>, and <a class="el" href="masstree__composer__impl_8cpp_source.html#l02558">foedus::storage::masstree::MasstreeComposer::drop_volatiles()</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                                                                   {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<span class="keywordtype">id</span> &gt; 0);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  soc::GlobalMemoryAnchors* anchors</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    = engine-&gt;get_soc_manager()-&gt;get_shared_memory_repo()-&gt;get_global_memory_anchors();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">return</span> anchors-&gt;partitioner_metadata_ + id;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_aa6e48ddb92bb1c1b572cc3b90e19daf9_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_aa6e48ddb92bb1c1b572cc3b90e19daf9_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_aa6e48ddb92bb1c1b572cc3b90e19daf9_cgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_aa6e48ddb92bb1c1b572cc3b90e19daf9_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb" title="foedus::soc::SharedMemory\lRepo::get_global_memory\l_anchors" alt="" coords="232,5,417,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="235,86,415,127"/>
<area shape="rect" id="node4" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="257,151,392,193"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_aa6e48ddb92bb1c1b572cc3b90e19daf9_icgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_aa6e48ddb92bb1c1b572cc3b90e19daf9_icgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_aa6e48ddb92bb1c1b572cc3b90e19daf9_icgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_aa6e48ddb92bb1c1b572cc3b90e19daf9_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposeContext.html#ae70f8ca9a8540b78619ac770e2bbbec9" title="ArrayComposeContext methods. " alt="" coords="239,5,401,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#ad25781d742feeced13ed8b047b485a3e" title="drop_volatiles and related methods " alt="" coords="232,85,408,141"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1Composer.html#a0995635b97031b208127004382947acd" title="Drops volatile pages that have not been modified since the snapshotted epoch. " alt="" coords="456,93,635,134"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a26c51902174b692c91aedd15218f01b7" title="subroutine invoked by one thread for one node. " alt="" coords="683,85,867,141"/>
<area shape="rect" id="node6" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a5d474e7a6b4de127153103f2295cb0fa" title="Sub&#45;routine of handle_snapshot_triggered(). " alt="" coords="915,93,1141,134"/>
<area shape="rect" id="node7" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a905ccf76fe0e076980dc1965f038fe10" title="handle_snapshot() calls this when it should start snapshotting. " alt="" coords="1189,85,1400,141"/>
<area shape="rect" id="node8" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a64e3c7594b7d7d0d5f8a144bd802d910" title="Main routine for snapshot_thread_ in master engine. " alt="" coords="1448,59,1659,101"/>
<area shape="rect" id="node10" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="1476,125,1631,166"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a632a4da7b3c67dd687f7eba4f6ec1d76" title="foedus::snapshot::Snapshot\lManagerPimpl::initialize_once" alt="" coords="1707,59,1901,101"/>
<area shape="rect" id="node11" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a868dca9015af77e04202ead68fd7a136" title="foedus::restart::Restart\lManagerPimpl::initialize_once" alt="" coords="1707,125,1901,166"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adf6f2b1d87dea8f45cd14632fc1c752c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::PartitionerMetadata::initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="partitioner_8hpp_source.html#l00214">214</a> of file <a class="el" href="partitioner_8hpp_source.html">partitioner.hpp</a>.</p>

<p>References <a class="el" href="partitioner_8hpp_source.html#l00221">clear_counts()</a>, <a class="el" href="shared__mutex_8cpp_source.html#l00029">foedus::soc::SharedMutex::initialize()</a>, and <a class="el" href="partitioner_8hpp_source.html#l00232">mutex_</a>.</p>

<p>Referenced by <a class="el" href="snapshot__manager__pimpl_8cpp_source.html#l00061">foedus::snapshot::SnapshotManagerPimpl::initialize_once()</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a1b5e5a68b2cde0cd42300642f3b538a3">mutex_</a>.<a class="code" href="classfoedus_1_1soc_1_1SharedMutex.html#a752dda273486899f5a58171c2ede01fb">initialize</a>();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a7586439779bf7e56b33ee636c62efdb0">clear_counts</a>();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMutex_html_a752dda273486899f5a58171c2ede01fb"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMutex.html#a752dda273486899f5a58171c2ede01fb">foedus::soc::SharedMutex::initialize</a></div><div class="ttdeci">void initialize(bool recursive=false)</div><div class="ttdef"><b>Definition:</b> <a href="shared__mutex_8cpp_source.html#l00029">shared_mutex.cpp:29</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a7586439779bf7e56b33ee636c62efdb0"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a7586439779bf7e56b33ee636c62efdb0">foedus::storage::PartitionerMetadata::clear_counts</a></div><div class="ttdeci">void clear_counts()</div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00221">partitioner.hpp:221</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a1b5e5a68b2cde0cd42300642f3b538a3"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a1b5e5a68b2cde0cd42300642f3b538a3">foedus::storage::PartitionerMetadata::mutex_</a></div><div class="ttdeci">soc::SharedMutex mutex_</div><div class="ttdoc">Serialize concurrent initialization of this partitioner. </div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00232">partitioner.hpp:232</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_adf6f2b1d87dea8f45cd14632fc1c752c_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_adf6f2b1d87dea8f45cd14632fc1c752c_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_adf6f2b1d87dea8f45cd14632fc1c752c_cgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_adf6f2b1d87dea8f45cd14632fc1c752c_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a7586439779bf7e56b33ee636c62efdb0" title="foedus::storage::Partitioner\lMetadata::clear_counts" alt="" coords="232,5,411,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1soc_1_1SharedMutex.html#a752dda273486899f5a58171c2ede01fb" title="foedus::soc::SharedMutex\l::initialize" alt="" coords="234,71,409,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SharedMutex.html#a8631c8500a5ab03940e1358f23b654c4" title="foedus::soc::SharedMutex\l::uninitialize" alt="" coords="459,71,633,112"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_adf6f2b1d87dea8f45cd14632fc1c752c_icgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_adf6f2b1d87dea8f45cd14632fc1c752c_icgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_adf6f2b1d87dea8f45cd14632fc1c752c_icgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_adf6f2b1d87dea8f45cd14632fc1c752c_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a632a4da7b3c67dd687f7eba4f6ec1d76" title="foedus::snapshot::Snapshot\lManagerPimpl::initialize_once" alt="" coords="232,5,427,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0534520d3f4fb059afdf7b9db375907e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * foedus::storage::PartitionerMetadata::locate_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the partitioner data pointed from this metadata. </p>
<dl class="section pre"><dt>Precondition</dt><dd>valid_ </dd>
<dd>
data_size_ &gt; 0 </dd></dl>

<p>Definition at line <a class="el" href="partitioner_8cpp_source.html#l00051">51</a> of file <a class="el" href="partitioner_8cpp_source.html">partitioner.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="partitioner_8hpp_source.html#l00242">data_offset_</a>, <a class="el" href="partitioner_8hpp_source.html#l00246">data_size_</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00514">foedus::soc::SharedMemoryRepo::get_global_memory_anchors()</a>, <a class="el" href="engine_8cpp_source.html#l00039">foedus::Engine::get_options()</a>, <a class="el" href="soc__manager_8cpp_source.html#l00038">foedus::soc::SocManager::get_shared_memory_repo()</a>, <a class="el" href="engine_8cpp_source.html#l00059">foedus::Engine::get_soc_manager()</a>, <a class="el" href="shared__memory__repo_8hpp_source.html#l00276">foedus::soc::GlobalMemoryAnchors::partitioner_data_</a>, <a class="el" href="storage__options_8hpp_source.html#l00051">foedus::storage::StorageOptions::partitioner_data_memory_mb_</a>, and <a class="el" href="engine__options_8hpp_source.html#l00145">foedus::EngineOptions::storage_</a>.</p>

<p>Referenced by <a class="el" href="array__composer__impl_8cpp_source.html#l00191">foedus::storage::array::ArrayComposeContext::ArrayComposeContext()</a>, <a class="el" href="array__partitioner__impl_8cpp_source.html#l00043">foedus::storage::array::ArrayPartitioner::ArrayPartitioner()</a>, <a class="el" href="hash__partitioner__impl_8cpp_source.html#l00068">foedus::storage::hash::HashPartitioner::design_partition()</a>, <a class="el" href="array__partitioner__impl_8cpp_source.html#l00073">foedus::storage::array::ArrayPartitioner::design_partition()</a>, <a class="el" href="masstree__partitioner__impl_8cpp_source.html#l00064">foedus::storage::masstree::MasstreePartitioner::design_partition()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l02558">foedus::storage::masstree::MasstreeComposer::drop_volatiles()</a>, <a class="el" href="hash__partitioner__impl_8cpp_source.html#l00043">foedus::storage::hash::HashPartitioner::HashPartitioner()</a>, and <a class="el" href="masstree__partitioner__impl_8cpp_source.html#l00053">foedus::storage::masstree::MasstreePartitioner::MasstreePartitioner()</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                                     {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aea48393cb437072c5ad9323f70ad8c73">data_size_</a> &gt; 0);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(<a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a94eae7ada6920800d5fa7ba348fcfd24">data_offset_</a> + <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aea48393cb437072c5ad9323f70ad8c73">data_size_</a></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    &lt;= engine-&gt;get_options().storage_.partitioner_data_memory_mb_ * (1ULL &lt;&lt; 20));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  soc::GlobalMemoryAnchors* anchors</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    = engine-&gt;get_soc_manager()-&gt;get_shared_memory_repo()-&gt;get_global_memory_anchors();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">char</span>* buffer = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(anchors-&gt;partitioner_data_);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">return</span> buffer + <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a94eae7ada6920800d5fa7ba348fcfd24">data_offset_</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_aea48393cb437072c5ad9323f70ad8c73"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aea48393cb437072c5ad9323f70ad8c73">foedus::storage::PartitionerMetadata::data_size_</a></div><div class="ttdeci">uint32_t data_size_</div><div class="ttdoc">The size of the partitioner data. </div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00246">partitioner.hpp:246</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a94eae7ada6920800d5fa7ba348fcfd24"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a94eae7ada6920800d5fa7ba348fcfd24">foedus::storage::PartitionerMetadata::data_offset_</a></div><div class="ttdeci">uint32_t data_offset_</div><div class="ttdoc">Relative offset from the beginning of partitioner data block that points to variable-sized partitione...</div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00242">partitioner.hpp:242</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_a0534520d3f4fb059afdf7b9db375907e_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_a0534520d3f4fb059afdf7b9db375907e_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_a0534520d3f4fb059afdf7b9db375907e_cgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_a0534520d3f4fb059afdf7b9db375907e_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb" title="foedus::soc::SharedMemory\lRepo::get_global_memory\l_anchors" alt="" coords="232,5,417,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="257,86,392,127"/>
<area shape="rect" id="node4" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="235,151,415,193"/>
<area shape="rect" id="node5" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="257,217,392,258"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_a0534520d3f4fb059afdf7b9db375907e_icgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_a0534520d3f4fb059afdf7b9db375907e_icgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_a0534520d3f4fb059afdf7b9db375907e_icgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_a0534520d3f4fb059afdf7b9db375907e_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposeContext.html#ae70f8ca9a8540b78619ac770e2bbbec9" title="ArrayComposeContext methods. " alt="" coords="261,5,422,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1array_1_1ArrayPartitioner.html#ac0e40ecaf673b0ba0c5ffa38ff093532" title="foedus::storage::array\l::ArrayPartitioner::ArrayPartitioner" alt="" coords="232,86,451,127"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1hash_1_1HashPartitioner.html#a9def1e9584cd2af4bae4d2b0c0ca10e4" title="foedus::storage::hash\l::HashPartitioner::design\l_partition" alt="" coords="259,152,424,208"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1array_1_1ArrayPartitioner.html#a7002637fe43ab0917bead1d4636805ad" title="foedus::storage::array\l::ArrayPartitioner::design\l_partition" alt="" coords="258,232,425,288"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePartitioner.html#a1aedc45cc5621bd3889f1bf2d47ab79c" title="foedus::storage::masstree\l::MasstreePartitioner::\ldesign_partition" alt="" coords="255,312,428,368"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#ad25781d742feeced13ed8b047b485a3e" title="drop_volatiles and related methods " alt="" coords="253,392,429,448"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashPartitioner.html#afe8984187e16a5366b95bef1bc824b6e" title="foedus::storage::hash\l::HashPartitioner::HashPartitioner" alt="" coords="233,473,449,514"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePartitioner.html#a9cbd3bf85a0f48ca30e2e2228361de90" title="MasstreePartitioner methods. " alt="" coords="255,539,428,595"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1Partitioner.html#a31a7e393bf1f87a9a039c60b291ac9d1" title="Determines partitioning scheme for this storage. " alt="" coords="499,239,677,281"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1Composer.html#a0995635b97031b208127004382947acd" title="Drops volatile pages that have not been modified since the snapshotted epoch. " alt="" coords="499,399,677,441"/>
<area shape="rect" id="node10" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a26c51902174b692c91aedd15218f01b7" title="subroutine invoked by one thread for one node. " alt="" coords="725,392,909,448"/>
<area shape="rect" id="node11" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a5d474e7a6b4de127153103f2295cb0fa" title="Sub&#45;routine of handle_snapshot_triggered(). " alt="" coords="957,399,1184,441"/>
<area shape="rect" id="node12" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a905ccf76fe0e076980dc1965f038fe10" title="handle_snapshot() calls this when it should start snapshotting. " alt="" coords="1232,392,1443,448"/>
<area shape="rect" id="node13" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a64e3c7594b7d7d0d5f8a144bd802d910" title="Main routine for snapshot_thread_ in master engine. " alt="" coords="1491,366,1701,407"/>
<area shape="rect" id="node15" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="1519,431,1673,473"/>
<area shape="rect" id="node14" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a632a4da7b3c67dd687f7eba4f6ec1d76" title="foedus::snapshot::Snapshot\lManagerPimpl::initialize_once" alt="" coords="1749,366,1944,407"/>
<area shape="rect" id="node16" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a868dca9015af77e04202ead68fd7a136" title="foedus::restart::Restart\lManagerPimpl::initialize_once" alt="" coords="1749,431,1944,473"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4a2b866bb37a79a612da1bc3bc67fd23"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::PartitionerMetadata::uninitialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="partitioner_8hpp_source.html#l00218">218</a> of file <a class="el" href="partitioner_8hpp_source.html">partitioner.hpp</a>.</p>

<p>References <a class="el" href="partitioner_8hpp_source.html#l00232">mutex_</a>, and <a class="el" href="shared__mutex_8cpp_source.html#l00049">foedus::soc::SharedMutex::uninitialize()</a>.</p>

<p>Referenced by <a class="el" href="snapshot__manager__pimpl_8cpp_source.html#l00125">foedus::snapshot::SnapshotManagerPimpl::uninitialize_once()</a>.</p>
<div class="fragment"><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                      {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a1b5e5a68b2cde0cd42300642f3b538a3">mutex_</a>.<a class="code" href="classfoedus_1_1soc_1_1SharedMutex.html#a8631c8500a5ab03940e1358f23b654c4">uninitialize</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1soc_1_1SharedMutex_html_a8631c8500a5ab03940e1358f23b654c4"><div class="ttname"><a href="classfoedus_1_1soc_1_1SharedMutex.html#a8631c8500a5ab03940e1358f23b654c4">foedus::soc::SharedMutex::uninitialize</a></div><div class="ttdeci">void uninitialize()</div><div class="ttdef"><b>Definition:</b> <a href="shared__mutex_8cpp_source.html#l00049">shared_mutex.cpp:49</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1PartitionerMetadata_html_a1b5e5a68b2cde0cd42300642f3b538a3"><div class="ttname"><a href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a1b5e5a68b2cde0cd42300642f3b538a3">foedus::storage::PartitionerMetadata::mutex_</a></div><div class="ttdeci">soc::SharedMutex mutex_</div><div class="ttdoc">Serialize concurrent initialization of this partitioner. </div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8hpp_source.html#l00232">partitioner.hpp:232</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_a4a2b866bb37a79a612da1bc3bc67fd23_cgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_a4a2b866bb37a79a612da1bc3bc67fd23_cgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_a4a2b866bb37a79a612da1bc3bc67fd23_cgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_a4a2b866bb37a79a612da1bc3bc67fd23_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1soc_1_1SharedMutex.html#a8631c8500a5ab03940e1358f23b654c4" title="foedus::soc::SharedMutex\l::uninitialize" alt="" coords="232,5,407,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structfoedus_1_1storage_1_1PartitionerMetadata_a4a2b866bb37a79a612da1bc3bc67fd23_icgraph.png" border="0" usemap="#structfoedus_1_1storage_1_1PartitionerMetadata_a4a2b866bb37a79a612da1bc3bc67fd23_icgraph" alt=""/></div>
<map name="structfoedus_1_1storage_1_1PartitionerMetadata_a4a2b866bb37a79a612da1bc3bc67fd23_icgraph" id="structfoedus_1_1storage_1_1PartitionerMetadata_a4a2b866bb37a79a612da1bc3bc67fd23_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a4fd4f82797b7ce89da73feca6570f581" title="foedus::snapshot::Snapshot\lManagerPimpl::uninitialize_once" alt="" coords="232,5,441,47"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a961d9a4b17cfe05b49fc396de9e9738a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html">PartitionerMetadata</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="partitioner_8cpp_source.html#l00148">148</a> of file <a class="el" href="partitioner_8cpp_source.html">partitioner.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                                                    {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;PartitionerMetadata&gt;&quot;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;valid&gt;&quot;</span> &lt;&lt; v.valid_ &lt;&lt; <span class="stringliteral">&quot;&lt;/valid&gt;&quot;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;data_offset_&gt;&quot;</span> &lt;&lt; assorted::Hex(v.data_offset_) &lt;&lt; <span class="stringliteral">&quot;&lt;/data_offset_&gt;&quot;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;data_size_&gt;&quot;</span> &lt;&lt; assorted::Hex(v.data_size_) &lt;&lt; <span class="stringliteral">&quot;&lt;/data_size_&gt;&quot;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;/PartitionerMetadata&gt;&quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a94eae7ada6920800d5fa7ba348fcfd24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::storage::PartitionerMetadata::data_offset_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Relative offset from the beginning of partitioner data block that points to variable-sized partitioner data. </p>

<p>Definition at line <a class="el" href="partitioner_8hpp_source.html#l00242">242</a> of file <a class="el" href="partitioner_8hpp_source.html">partitioner.hpp</a>.</p>

<p>Referenced by <a class="el" href="partitioner_8cpp_source.html#l00061">allocate_data()</a>, <a class="el" href="partitioner_8hpp_source.html#l00221">clear_counts()</a>, <a class="el" href="sequential__partitioner__impl_8cpp_source.html#l00033">foedus::storage::sequential::SequentialPartitioner::design_partition()</a>, <a class="el" href="partitioner_8cpp_source.html#l00051">locate_data()</a>, and <a class="el" href="partitioner_8cpp_source.html#l00148">foedus::storage::operator&lt;&lt;()</a>.</p>

</div>
</div>
<a class="anchor" id="aea48393cb437072c5ad9323f70ad8c73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t foedus::storage::PartitionerMetadata::data_size_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The size of the partitioner data. </p>

<p>Definition at line <a class="el" href="partitioner_8hpp_source.html#l00246">246</a> of file <a class="el" href="partitioner_8hpp_source.html">partitioner.hpp</a>.</p>

<p>Referenced by <a class="el" href="partitioner_8cpp_source.html#l00061">allocate_data()</a>, <a class="el" href="partitioner_8hpp_source.html#l00221">clear_counts()</a>, <a class="el" href="sequential__partitioner__impl_8cpp_source.html#l00033">foedus::storage::sequential::SequentialPartitioner::design_partition()</a>, <a class="el" href="snapshot__manager__pimpl_8cpp_source.html#l00061">foedus::snapshot::SnapshotManagerPimpl::initialize_once()</a>, <a class="el" href="partitioner_8cpp_source.html#l00051">locate_data()</a>, and <a class="el" href="partitioner_8cpp_source.html#l00148">foedus::storage::operator&lt;&lt;()</a>.</p>

</div>
</div>
<a class="anchor" id="a1b5e5a68b2cde0cd42300642f3b538a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1soc_1_1SharedMutex.html">soc::SharedMutex</a> foedus::storage::PartitionerMetadata::mutex_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serialize concurrent initialization of this partitioner. </p>
<p>This is taken only when valid_ is false or might be false. As far as one observes valid_==true, he doesn't have to take mutex. </p>

<p>Definition at line <a class="el" href="partitioner_8hpp_source.html#l00232">232</a> of file <a class="el" href="partitioner_8hpp_source.html">partitioner.hpp</a>.</p>

<p>Referenced by <a class="el" href="partitioner_8cpp_source.html#l00061">allocate_data()</a>, <a class="el" href="array__partitioner__impl_8cpp_source.html#l00043">foedus::storage::array::ArrayPartitioner::ArrayPartitioner()</a>, <a class="el" href="hash__partitioner__impl_8cpp_source.html#l00068">foedus::storage::hash::HashPartitioner::design_partition()</a>, <a class="el" href="array__partitioner__impl_8cpp_source.html#l00073">foedus::storage::array::ArrayPartitioner::design_partition()</a>, <a class="el" href="masstree__partitioner__impl_8cpp_source.html#l00064">foedus::storage::masstree::MasstreePartitioner::design_partition()</a>, <a class="el" href="hash__partitioner__impl_8cpp_source.html#l00043">foedus::storage::hash::HashPartitioner::HashPartitioner()</a>, <a class="el" href="partitioner_8hpp_source.html#l00214">initialize()</a>, <a class="el" href="snapshot__manager__pimpl_8cpp_source.html#l00061">foedus::snapshot::SnapshotManagerPimpl::initialize_once()</a>, <a class="el" href="partitioner_8hpp_source.html#l00218">uninitialize()</a>, and <a class="el" href="snapshot__manager__pimpl_8cpp_source.html#l00125">foedus::snapshot::SnapshotManagerPimpl::uninitialize_once()</a>.</p>

</div>
</div>
<a class="anchor" id="a63a799f43dfcc06d8c14d471fd0ebfcd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::storage::PartitionerMetadata::valid_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Whether this partitioner information (metadata+data) has been constructed. </p>
<p>When this is false, only valid_ and mutex_ can be safely accessed. </p>

<p>Definition at line <a class="el" href="partitioner_8hpp_source.html#l00237">237</a> of file <a class="el" href="partitioner_8hpp_source.html">partitioner.hpp</a>.</p>

<p>Referenced by <a class="el" href="partitioner_8cpp_source.html#l00061">allocate_data()</a>, <a class="el" href="array__composer__impl_8cpp_source.html#l00191">foedus::storage::array::ArrayComposeContext::ArrayComposeContext()</a>, <a class="el" href="array__partitioner__impl_8cpp_source.html#l00043">foedus::storage::array::ArrayPartitioner::ArrayPartitioner()</a>, <a class="el" href="partitioner_8hpp_source.html#l00221">clear_counts()</a>, <a class="el" href="sequential__partitioner__impl_8cpp_source.html#l00033">foedus::storage::sequential::SequentialPartitioner::design_partition()</a>, <a class="el" href="hash__partitioner__impl_8cpp_source.html#l00068">foedus::storage::hash::HashPartitioner::design_partition()</a>, <a class="el" href="array__partitioner__impl_8cpp_source.html#l00073">foedus::storage::array::ArrayPartitioner::design_partition()</a>, <a class="el" href="masstree__partitioner__impl_8cpp_source.html#l00064">foedus::storage::masstree::MasstreePartitioner::design_partition()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l02558">foedus::storage::masstree::MasstreeComposer::drop_volatiles()</a>, <a class="el" href="hash__partitioner__impl_8cpp_source.html#l00043">foedus::storage::hash::HashPartitioner::HashPartitioner()</a>, <a class="el" href="masstree__partitioner__impl_8cpp_source.html#l00053">foedus::storage::masstree::MasstreePartitioner::MasstreePartitioner()</a>, and <a class="el" href="partitioner_8cpp_source.html#l00148">foedus::storage::operator&lt;&lt;()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/storage/<a class="el" href="partitioner_8hpp_source.html">partitioner.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/<a class="el" href="partitioner_8cpp_source.html">partitioner.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1storage.html">storage</a></li><li class="navelem"><a class="el" href="structfoedus_1_1storage_1_1PartitionerMetadata.html">PartitionerMetadata</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

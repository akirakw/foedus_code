<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::storage::Composer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1storage_1_1Composer.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfoedus_1_1storage_1_1Composer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::storage::Composer Class Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__STORAGE.html">Storage Manager</a><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo;  &#124; <a class="el" href="group__SNAPSHOT.html">Snapshot Manager</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Represents a logic to compose a new version of data pages for one storage.  
 <a href="classfoedus_1_1storage_1_1Composer.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Represents a logic to compose a new version of data pages for one storage. </p>
<h1><a class="anchor" id="COMPOSER_OVERVIEW"></a>
Overview</h1>
<p>This object is one of the liaisons between <a class="el" href="group__SNAPSHOT.html">Snapshot Manager</a> module and <a class="el" href="group__STORAGE.html">Storage Manager</a> module. It receives previous snapshot files and pre-sorted log entries from snapshot module, then applies a storage-specific implementation to convert them into a new version of data pages. Every interface is batched and completely separated from the normal transactional processing part. In fact, this object is not part of <a class="el" href="classfoedus_1_1storage_1_1Storage.html" title="Represents one key-value store. ">foedus::storage::Storage</a> at all.</p>
<h1><a class="anchor" id="COMPOSER_SCOPE"></a>
Composer's scope</h1>
<p>One composer object is in charge of data pages that meet <b>all</b> of following criteria: </p><ul>
<li>In one storage </li>
<li>In one partition (in one NUMA node) </li>
<li>In one snapshot</li>
</ul>
<p>None of these responsibilities is overlapping, so the job of composer is totally independent from other composers <b>except</b> the root page of the storage.</p>
<h1><a class="anchor" id="COMPOSER_INPUTS"></a>
Inputs</h1>
<p>Every composer receives the following when constructed. </p><ul>
<li>Corresponding <a class="el" href="classfoedus_1_1storage_1_1Partitioner.html" title="Partitioning and sorting logic for one storage. ">Partitioner</a> object that tells what pages this composer is responsible for. </li>
<li>Pre-allocated and reused working memory (assured to be on the same NUMA node). </li>
<li>Pre-sorted stream(s) of log entries (<a class="el" href="classfoedus_1_1snapshot_1_1SortedBuffer.html" title="Represents one input stream of sorted log entries. ">foedus::snapshot::SortedBuffer</a>). </li>
<li>Snapshot writer to allocate pages and write them out to a snapshot file. </li>
<li>Most recent snapshot files.</li>
</ul>
<h1><a class="anchor" id="COMPOSER_OUTPUTS"></a>
Outputs</h1>
<p>Composers emit the following data when it's done. </p><ul>
<li>Composed data pages, which are written to the snapshot file by the snapshot writer. </li>
<li>For each storage and for each second-level page that is pointed from the root page, the snapshot pointer and relevant pointer information (eg key range). We call this information as <em>root-info</em> and store them in a tentative page. This is required to construct the root page at the end of snapshotting.</li>
</ul>
<h1><a class="anchor" id="COMPOSER_INSTALL"></a>
Installing Composed Pages</h1>
<p>At the end of snapshotting, composers install pointers to the snapshot pages they composed. These are written to the snapshot pointer part of <a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html" title="Represents a pointer to another page (usually a child page). ">DualPagePointer</a> so that transactions can start using the snapshot pages. Composers also drop volatile pointers if possible, reducing pressures to volatile page pool. This volatile-drop is carefully done after pausing all transactions because we have to make sure no transactions are newly installing a volatile page while we are dropping its parent.</p>
<dl class="section user"><dt>Shared memory, No virtual methods</dt><dd>Like <a class="el" href="classfoedus_1_1storage_1_1Partitioner.html" title="Partitioning and sorting logic for one storage. ">Partitioner</a>, no virtual methods allowed. We just do switch-case. </dd></dl>

<p>Definition at line <a class="el" href="composer_8hpp_source.html#l00086">86</a> of file <a class="el" href="composer_8hpp_source.html">composer.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="composer_8hpp_source.html">composer.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:structfoedus_1_1storage_1_1Composer_1_1ComposeArguments"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__STORAGE.html#structfoedus_1_1storage_1_1Composer_1_1ComposeArguments">ComposeArguments</a></td></tr>
<tr class="memdesc:structfoedus_1_1storage_1_1Composer_1_1ComposeArguments"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arguments for <a class="el" href="classfoedus_1_1storage_1_1Composer.html#a28c752ec784b85418c0bfafab7ee60c0" title="Construct snapshot pages from sorted run files of one storage. ">compose()</a>  <a href="group__STORAGE.html#structfoedus_1_1storage_1_1Composer_1_1ComposeArguments">More...</a><br /></td></tr>
<tr class="separator:structfoedus_1_1storage_1_1Composer_1_1ComposeArguments"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structfoedus_1_1storage_1_1Composer_1_1ConstructRootArguments"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__STORAGE.html#structfoedus_1_1storage_1_1Composer_1_1ConstructRootArguments">ConstructRootArguments</a></td></tr>
<tr class="memdesc:structfoedus_1_1storage_1_1Composer_1_1ConstructRootArguments"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arguments for <a class="el" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c" title="Construct root page(s) for one storage based on the ouputs of compose(). ">construct_root()</a>  <a href="group__STORAGE.html#structfoedus_1_1storage_1_1Composer_1_1ConstructRootArguments">More...</a><br /></td></tr>
<tr class="separator:structfoedus_1_1storage_1_1Composer_1_1ConstructRootArguments"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1Composer_1_1DropResult.html">DropResult</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrun value of <a class="el" href="classfoedus_1_1storage_1_1Composer.html#a0995635b97031b208127004382947acd" title="Drops volatile pages that have not been modified since the snapshotted epoch. ">drop_volatiles()</a>  <a href="structfoedus_1_1storage_1_1Composer_1_1DropResult.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfoedus_1_1storage_1_1Composer_1_1DropVolatilesArguments.html">DropVolatilesArguments</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arguments for <a class="el" href="classfoedus_1_1storage_1_1Composer.html#a0995635b97031b208127004382947acd" title="Drops volatile pages that have not been modified since the snapshotted epoch. ">drop_volatiles()</a>  <a href="structfoedus_1_1storage_1_1Composer_1_1DropVolatilesArguments.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac30261175a11876966bc45c11a459a25"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1Composer.html#ac30261175a11876966bc45c11a459a25">Composer</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, <a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a> storage_id)</td></tr>
<tr class="separator:ac30261175a11876966bc45c11a459a25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e89ea3a0bea2d29b3e527f19cc53b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1Composer.html#a58e89ea3a0bea2d29b3e527f19cc53b1">get_engine</a> ()</td></tr>
<tr class="separator:a58e89ea3a0bea2d29b3e527f19cc53b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404a0456e5a112f840c23f692c950f78"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1Composer.html#a404a0456e5a112f840c23f692c950f78">get_storage_id</a> () const </td></tr>
<tr class="separator:a404a0456e5a112f840c23f692c950f78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac18da0f8b065673b0615ec35f9b714"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__STORAGE.html#ga016025043f5ef9c02be03f2f2a17a0de">StorageType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1Composer.html#aeac18da0f8b065673b0615ec35f9b714">get_storage_type</a> () const </td></tr>
<tr class="separator:aeac18da0f8b065673b0615ec35f9b714"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c752ec784b85418c0bfafab7ee60c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1Composer.html#a28c752ec784b85418c0bfafab7ee60c0">compose</a> (const <a class="el" href="group__STORAGE.html#structfoedus_1_1storage_1_1Composer_1_1ComposeArguments">ComposeArguments</a> &amp;args)</td></tr>
<tr class="memdesc:a28c752ec784b85418c0bfafab7ee60c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct snapshot pages from sorted run files of one storage.  <a href="#a28c752ec784b85418c0bfafab7ee60c0">More...</a><br /></td></tr>
<tr class="separator:a28c752ec784b85418c0bfafab7ee60c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf148cbea7c8146dec88d23d2218452c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1Composer.html#adf148cbea7c8146dec88d23d2218452c">construct_root</a> (const <a class="el" href="group__STORAGE.html#structfoedus_1_1storage_1_1Composer_1_1ConstructRootArguments">ConstructRootArguments</a> &amp;args)</td></tr>
<tr class="memdesc:adf148cbea7c8146dec88d23d2218452c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct root page(s) for one storage based on the ouputs of <a class="el" href="classfoedus_1_1storage_1_1Composer.html#a28c752ec784b85418c0bfafab7ee60c0" title="Construct snapshot pages from sorted run files of one storage. ">compose()</a>.  <a href="#adf148cbea7c8146dec88d23d2218452c">More...</a><br /></td></tr>
<tr class="separator:adf148cbea7c8146dec88d23d2218452c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0995635b97031b208127004382947acd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1storage_1_1Composer_1_1DropResult.html">DropResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1Composer.html#a0995635b97031b208127004382947acd">drop_volatiles</a> (const <a class="el" href="structfoedus_1_1storage_1_1Composer_1_1DropVolatilesArguments.html">DropVolatilesArguments</a> &amp;args)</td></tr>
<tr class="memdesc:a0995635b97031b208127004382947acd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drops volatile pages that have not been modified since the snapshotted epoch.  <a href="#a0995635b97031b208127004382947acd">More...</a><br /></td></tr>
<tr class="separator:a0995635b97031b208127004382947acd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6d90399f471e1461fd4e59b0f3b923f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1Composer.html#af6d90399f471e1461fd4e59b0f3b923f">drop_root_volatile</a> (const <a class="el" href="structfoedus_1_1storage_1_1Composer_1_1DropVolatilesArguments.html">DropVolatilesArguments</a> &amp;args)</td></tr>
<tr class="memdesc:af6d90399f471e1461fd4e59b0f3b923f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is additionally called when no partitions observed any new modifications.  <a href="#af6d90399f471e1461fd4e59b0f3b923f">More...</a><br /></td></tr>
<tr class="separator:af6d90399f471e1461fd4e59b0f3b923f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:adbcfff625fb0251f101370749588799c"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1Composer.html#adbcfff625fb0251f101370749588799c">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="classfoedus_1_1storage_1_1Composer.html">Composer</a> &amp;v)</td></tr>
<tr class="separator:adbcfff625fb0251f101370749588799c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ac30261175a11876966bc45c11a459a25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">foedus::storage::Composer::Composer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a>&#160;</td>
          <td class="paramname"><em>storage_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="composer_8cpp_source.html#l00055">55</a> of file <a class="el" href="composer_8cpp_source.html">composer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  : engine_(engine),</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    storage_id_(storage_id),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    storage_type_(engine_-&gt;<a class="code" href="classfoedus_1_1Engine.html#ac27d3734638fe8d18fbdc9b4ee4666b2">get_storage_manager</a>()-&gt;<a class="code" href="classfoedus_1_1storage_1_1StorageManager.html#a62a5d09952fe340dc03da8460f200523">get_storage</a>(storage_id_)-&gt;<a class="code" href="structfoedus_1_1storage_1_1StorageControlBlock.html#ae20f48002ac04f92b32085ee52a56ed0">meta_</a>.<a class="code" href="structfoedus_1_1storage_1_1Metadata.html#a396f771fdd6dd3af6ac9d8fca1cb4839">type_</a>) {}</div>
<div class="ttc" id="structfoedus_1_1storage_1_1StorageControlBlock_html_ae20f48002ac04f92b32085ee52a56ed0"><div class="ttname"><a href="structfoedus_1_1storage_1_1StorageControlBlock.html#ae20f48002ac04f92b32085ee52a56ed0">foedus::storage::StorageControlBlock::meta_</a></div><div class="ttdeci">Metadata meta_</div><div class="ttdoc">common part of the metadata. </div><div class="ttdef"><b>Definition:</b> <a href="storage_8hpp_source.html#l00084">storage.hpp:84</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_ac27d3734638fe8d18fbdc9b4ee4666b2"><div class="ttname"><a href="classfoedus_1_1Engine.html#ac27d3734638fe8d18fbdc9b4ee4666b2">foedus::Engine::get_storage_manager</a></div><div class="ttdeci">storage::StorageManager * get_storage_manager() const </div><div class="ttdoc">See Storage Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00060">engine.cpp:60</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1Metadata_html_a396f771fdd6dd3af6ac9d8fca1cb4839"><div class="ttname"><a href="structfoedus_1_1storage_1_1Metadata.html#a396f771fdd6dd3af6ac9d8fca1cb4839">foedus::storage::Metadata::type_</a></div><div class="ttdeci">StorageType type_</div><div class="ttdoc">type of the storage. </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8hpp_source.html#l00105">metadata.hpp:105</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1StorageManager_html_a62a5d09952fe340dc03da8460f200523"><div class="ttname"><a href="classfoedus_1_1storage_1_1StorageManager.html#a62a5d09952fe340dc03da8460f200523">foedus::storage::StorageManager::get_storage</a></div><div class="ttdeci">StorageControlBlock * get_storage(StorageId id)</div><div class="ttdoc">Returns the storage of given ID. </div><div class="ttdef"><b>Definition:</b> <a href="storage__manager_8cpp_source.html#l00047">storage_manager.cpp:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a28c752ec784b85418c0bfafab7ee60c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::Composer::compose </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__STORAGE.html#structfoedus_1_1storage_1_1Composer_1_1ComposeArguments">ComposeArguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct snapshot pages from sorted run files of one storage. </p>

<p>Definition at line <a class="el" href="composer_8cpp_source.html#l00061">61</a> of file <a class="el" href="composer_8cpp_source.html">composer.cpp</a>.</p>

<p>References <a class="el" href="array__composer__impl_8cpp_source.html#l00066">foedus::storage::array::ArrayComposer::compose()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l00097">foedus::storage::hash::HashComposer::compose()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l00078">foedus::storage::masstree::MasstreeComposer::compose()</a>, <a class="el" href="sequential__composer__impl_8cpp_source.html#l00154">foedus::storage::sequential::SequentialComposer::compose()</a>, <a class="el" href="storage__id_8hpp_source.html#l00126">foedus::storage::kArrayStorage</a>, <a class="el" href="storage__id_8hpp_source.html#l00128">foedus::storage::kHashStorage</a>, <a class="el" href="storage__id_8hpp_source.html#l00130">foedus::storage::kMasstreeStorage</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, and <a class="el" href="storage__id_8hpp_source.html#l00132">foedus::storage::kSequentialStorage</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                                         {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">switch</span> (storage_type_) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff">kArrayStorage</a>: <span class="keywordflow">return</span> array::ArrayComposer(<span class="keyword">this</span>).compose(args);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc">kHashStorage</a>: <span class="keywordflow">return</span> hash::HashComposer(<span class="keyword">this</span>).compose(args);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6">kSequentialStorage</a>: <span class="keywordflow">return</span> sequential::SequentialComposer(<span class="keyword">this</span>).compose(args);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e">kMasstreeStorage</a>: <span class="keywordflow">return</span> masstree::MasstreeComposer(<span class="keyword">this</span>).compose(args);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e">foedus::storage::kMasstreeStorage</a></div><div class="ttdoc">Masstree Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00130">storage_id.hpp:130</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc">foedus::storage::kHashStorage</a></div><div class="ttdoc">Hashtable Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00128">storage_id.hpp:128</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6">foedus::storage::kSequentialStorage</a></div><div class="ttdoc">Sequential Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00132">storage_id.hpp:132</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff">foedus::storage::kArrayStorage</a></div><div class="ttdoc">Array Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00126">storage_id.hpp:126</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1Composer_a28c752ec784b85418c0bfafab7ee60c0_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1Composer_a28c752ec784b85418c0bfafab7ee60c0_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1Composer_a28c752ec784b85418c0bfafab7ee60c0_cgraph" id="classfoedus_1_1storage_1_1Composer_a28c752ec784b85418c0bfafab7ee60c0_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#ab768c873a7e2b4a9ce2b4b1df39676ff" title="foedus::storage::array\l::ArrayComposer::compose" alt="" coords="247,169,428,211"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#a31399ce4cdbe6c2e84fe02ac7f4f5a5e" title="foedus::storage::hash\l::HashComposer::compose" alt="" coords="247,300,427,341"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#a05590cc1eeeb3aedd917276d19639fd1" title="foedus::storage::masstree\l::MasstreeComposer::compose" alt="" coords="235,235,439,276"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a3e005713f9a1c12bb2a4771a192b47a5" title="foedus::storage::sequential\l::SequentialComposer::compose" alt="" coords="232,945,443,987"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#ae9bd9d37f8a9c300dd188c5a23b938cd" title="foedus::storage::array\l::ArrayComposer::to_string" alt="" coords="517,5,696,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff" title="Typical implementation of Initializable::initialize() that provides initialize&#45;once semantics..." alt="" coords="521,136,693,177"/>
<area shape="rect" id="node9" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb" title="Typical implementation of Initializable::uninitialize() that provides uninitialize&#45;once semantics..." alt="" coords="521,201,693,243"/>
<area shape="rect" id="node10" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="539,267,674,308"/>
<area shape="rect" id="node13" href="classfoedus_1_1debugging_1_1StopWatch.html#ac8a42ba406ab38b098e27a19e6803638" title="foedus::debugging::\lStopWatch::elapsed_ms" alt="" coords="524,332,689,373"/>
<area shape="rect" id="node5" href="classfoedus_1_1DefaultInitializable.html#ab8ae37e5f20f312f8b945fc40d3e0250" title="foedus::DefaultInitializable\l::initialize_once" alt="" coords="791,71,963,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1ErrorStack.html#a9c7b3a8b3806ff623c7fb4a9db5cbeec" title="Returns if this return code is not kErrorCodeOk. " alt="" coords="812,5,943,47"/>
<area shape="rect" id="node7" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="791,136,963,177"/>
<area shape="rect" id="node8" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b" title="foedus::DefaultInitializable\l::uninitialize_once" alt="" coords="791,201,963,243"/>
<area shape="rect" id="node11" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="797,332,958,373"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="810,267,945,308"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#a641bbfa48a79b406ae30d8574184f0fd" title="foedus::storage::hash\l::HashComposer::to_string" alt="" coords="518,397,695,439"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#ab1264661a1f24383dcda1568f59425fe" title="foedus::storage::masstree\l::MasstreeComposer::to_string" alt="" coords="506,71,707,112"/>
<area shape="rect" id="node19" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720" title="foedus::snapshot::Snapshot\lWriter::get_page_base" alt="" coords="515,1011,699,1052"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1sequential_1_1SequentialPage.html#a3d20c83f668324cbd7894c35cbbac629" title="foedus::storage::sequential\l::SequentialPage::header" alt="" coords="517,580,696,621"/>
<area shape="rect" id="node22" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ab547f0a3936d5cb0c0ee827ea77edd09" title="foedus::snapshot::Snapshot\lWriter::get_page_size" alt="" coords="515,515,699,556"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a63f8c78241f6fec475322fd836a9429b" title="foedus::storage::sequential\l::SequentialComposer::to_string" alt="" coords="503,697,711,739"/>
<area shape="rect" id="node25" href="group__FILESYSTEM.html#gaaa833e3af93824a2485400b32dab7bcd" title="Returns the status of the file. " alt="" coords="545,763,668,790"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1sequential_1_1StreamStatus.html#abc4add6d276ba5433d09fbf27a352ad2" title="foedus::storage::sequential\l::StreamStatus::init" alt="" coords="517,880,696,921"/>
<area shape="rect" id="node35" href="structfoedus_1_1storage_1_1sequential_1_1StreamStatus.html#a0d3e3b39cecf0bd37f36cd040d67ad3a" title="foedus::storage::sequential\l::StreamStatus::get_entry" alt="" coords="1032,727,1211,768"/>
<area shape="rect" id="node37" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="545,945,668,987"/>
<area shape="rect" id="node39" href="classfoedus_1_1Epoch.html#ae113d98c40171e4b80526cd7f7502c03" title="Kind of std::min(this, other). " alt="" coords="521,1077,692,1103"/>
<area shape="rect" id="node40" href="classfoedus_1_1Epoch.html#adf886b8b219538b7dac2da820fbec68c" title="Kind of std::max(this, other). " alt="" coords="519,1127,694,1154"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1sequential_1_1SequentialPage.html#ac3f12983b3c02d8a6e3cae2867f9d4a2" title="Returns if this page has enough room to insert a record with the given payload length. " alt="" coords="491,1179,723,1220"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1sequential_1_1SequentialPage.html#a24c813069071a3026f40d4a4b3644314" title="foedus::storage::sequential\l::SequentialPage::initialize\l_snapshot_page" alt="" coords="517,1245,696,1301"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1sequential_1_1SequentialPage.html#a7ed4fd4e290f1e49a0b187d43b83674e" title="foedus::storage::sequential\l::SequentialPage::next_page" alt="" coords="512,1325,701,1367"/>
<area shape="rect" id="node44" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="513,1391,701,1447"/>
<area shape="rect" id="node45" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a31e0233463f813ec7a645e970bbe499c" title="foedus::snapshot::Snapshot\lWriter::get_numa_node" alt="" coords="515,1472,699,1513"/>
<area shape="rect" id="node46" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="511,1538,702,1594"/>
<area shape="rect" id="node47" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ad4209f06409d52c010aac8bf98660dbe" title="foedus::snapshot::Snapshot\lWriter::get_snapshot_id" alt="" coords="515,1619,699,1660"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1sequential_1_1SequentialPage.html#aec915d81c404fca9de77c9eed625afa9" title="Appends a record to this page. " alt="" coords="517,1685,696,1741"/>
<area shape="rect" id="node49" href="structfoedus_1_1storage_1_1sequential_1_1StreamStatus.html#ad8e7bc2200436df2a00cce3f3ae64ba2" title="foedus::storage::sequential\l::StreamStatus::next" alt="" coords="517,815,696,856"/>
<area shape="rect" id="node50" href="classfoedus_1_1Epoch.html#a786afd92afdc87b54dfa11ef093f06f3" title="foedus::Epoch::one_more" alt="" coords="521,463,692,490"/>
<area shape="rect" id="node20" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="771,1368,984,1409"/>
<area shape="rect" id="node23" href="classfoedus_1_1memory_1_1AlignedMemory.html#a8db2e188293eaeebdf36cf39920efedd" title="Returns the byte size of the memory block. " alt="" coords="771,515,984,556"/>
<area shape="rect" id="node26" href="classfoedus_1_1fs_1_1Path.html#a821cee2f2cec808d90e187513064f40f" title="foedus::fs::Path::c_str" alt="" coords="802,697,953,723"/>
<area shape="rect" id="node28" href="classfoedus_1_1snapshot_1_1SortedBuffer.html#afb3c42518538c584ac9640c7c1313c3f" title="foedus::snapshot::Sorted\lBuffer::assert_checks" alt="" coords="794,1237,961,1279"/>
<area shape="rect" id="node29" href="classfoedus_1_1snapshot_1_1SortedBuffer.html#a1ca9a4662628831cb0c4f8719e7cc2eb" title="Returns the buffer memory. " alt="" coords="794,879,961,920"/>
<area shape="rect" id="node30" href="classfoedus_1_1snapshot_1_1SortedBuffer.html#a977e4eef74c89091bd9695fd174bc7ed" title="Returns the size of buffer memory. " alt="" coords="794,944,961,985"/>
<area shape="rect" id="node31" href="classfoedus_1_1snapshot_1_1SortedBuffer.html#a23b9b4a784eabc6bb7eb2e16c64dbac2" title="Current storage block&#39;s beginning in absolute byte position in the file. " alt="" coords="794,1010,961,1066"/>
<area shape="rect" id="node32" href="classfoedus_1_1snapshot_1_1SortedBuffer.html#aebdd5322ae2e5998f974796dab56454d" title="Returns the absolute byte position of the buffer&#39;s beginning in the entire file. " alt="" coords="794,1091,961,1132"/>
<area shape="rect" id="node33" href="classfoedus_1_1snapshot_1_1SortedBuffer.html#a7994e9e8b0cfe799f3746d22a29bf236" title="Current storage block&#39;s end in absolute byte position in the file. " alt="" coords="794,1157,961,1213"/>
<area shape="rect" id="node34" href="structfoedus_1_1storage_1_1sequential_1_1StreamStatus.html#ade7d0b1dfef946154fa988ec1ac42453" title="foedus::storage::sequential\l::StreamStatus::read_entry" alt="" coords="788,813,967,855"/>
<area shape="rect" id="node36" href="structfoedus_1_1storage_1_1sequential_1_1StreamStatus.html#a628f2a2b7aa3140cf4bcf2f5a17c4040" title="foedus::storage::sequential\l::StreamStatus::wind_stream" alt="" coords="782,748,973,789"/>
<area shape="rect" id="node38" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="816,1303,939,1344"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adf148cbea7c8146dec88d23d2218452c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::Composer::construct_root </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__STORAGE.html#structfoedus_1_1storage_1_1Composer_1_1ConstructRootArguments">ConstructRootArguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct root page(s) for one storage based on the ouputs of <a class="el" href="classfoedus_1_1storage_1_1Composer.html#a28c752ec784b85418c0bfafab7ee60c0" title="Construct snapshot pages from sorted run files of one storage. ">compose()</a>. </p>
<p>When all reducers complete, the gleaner invokes this method to construct new root page(s) for the storage. This </p>

<p>Definition at line <a class="el" href="composer_8cpp_source.html#l00072">72</a> of file <a class="el" href="composer_8cpp_source.html">composer.cpp</a>.</p>

<p>References <a class="el" href="array__composer__impl_8cpp_source.html#l00095">foedus::storage::array::ArrayComposer::construct_root()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l00126">foedus::storage::hash::HashComposer::construct_root()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l00111">foedus::storage::masstree::MasstreeComposer::construct_root()</a>, <a class="el" href="sequential__composer__impl_8cpp_source.html#l00230">foedus::storage::sequential::SequentialComposer::construct_root()</a>, <a class="el" href="storage__id_8hpp_source.html#l00126">foedus::storage::kArrayStorage</a>, <a class="el" href="storage__id_8hpp_source.html#l00128">foedus::storage::kHashStorage</a>, <a class="el" href="storage__id_8hpp_source.html#l00130">foedus::storage::kMasstreeStorage</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, and <a class="el" href="storage__id_8hpp_source.html#l00132">foedus::storage::kSequentialStorage</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                                                      {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">switch</span> (storage_type_) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff">kArrayStorage</a>: <span class="keywordflow">return</span> array::ArrayComposer(<span class="keyword">this</span>).construct_root(args);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc">kHashStorage</a>: <span class="keywordflow">return</span> hash::HashComposer(<span class="keyword">this</span>).construct_root(args);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6">kSequentialStorage</a>: <span class="keywordflow">return</span> sequential::SequentialComposer(<span class="keyword">this</span>).construct_root(args);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e">kMasstreeStorage</a>: <span class="keywordflow">return</span> masstree::MasstreeComposer(<span class="keyword">this</span>).construct_root(args);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e">foedus::storage::kMasstreeStorage</a></div><div class="ttdoc">Masstree Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00130">storage_id.hpp:130</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc">foedus::storage::kHashStorage</a></div><div class="ttdoc">Hashtable Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00128">storage_id.hpp:128</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6">foedus::storage::kSequentialStorage</a></div><div class="ttdoc">Sequential Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00132">storage_id.hpp:132</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff">foedus::storage::kArrayStorage</a></div><div class="ttdoc">Array Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00126">storage_id.hpp:126</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1Composer_adf148cbea7c8146dec88d23d2218452c_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1Composer_adf148cbea7c8146dec88d23d2218452c_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1Composer_adf148cbea7c8146dec88d23d2218452c_cgraph" id="classfoedus_1_1storage_1_1Composer_adf148cbea7c8146dec88d23d2218452c_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#a2c812e46a7502abe6f506ecda0edf9ab" title="foedus::storage::array\l::ArrayComposer::construct_root" alt="" coords="247,2481,458,2523"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#ac5ad2e7fa792d58965a05be6bd43e43c" title="foedus::storage::hash\l::HashComposer::construct_root" alt="" coords="247,1813,458,1855"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#a45eb1cba6ccf8f51c973030848a47a9d" title="foedus::storage::masstree\l::MasstreeComposer::construct_root" alt="" coords="235,575,470,616"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a91db842a6ef8780d3fe4ba2f0f625da7" title="foedus::storage::sequential\l::SequentialComposer::construct_root" alt="" coords="232,1325,473,1367"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a3a535c4b81884868a2a5ead00428dd77" title="Returns the number of levels. " alt="" coords="554,2939,725,2980"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#acc05e0b608094e78fa9a7025c08524b5" title="Returns byte size of one record in this array storage without internal overheads. ..." alt="" coords="532,3004,747,3045"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#ad4209f06409d52c010aac8bf98660dbe" title="foedus::snapshot::Snapshot\lWriter::get_snapshot_id" alt="" coords="820,917,1004,959"/>
<area shape="rect" id="node6" href="classfoedus_1_1Engine.html#a4f168d41ea00249fefe905def87e80c8" title="See Savepoint Manager. " alt="" coords="569,2873,709,2915"/>
<area shape="rect" id="node7" href="classfoedus_1_1savepoint_1_1SavepointManager.html#a7fc7a7f62d25e8114ab15a340256f71a" title="foedus::savepoint::\lSavepointManager::get\l_initial_durable_epoch" alt="" coords="562,3070,717,3126"/>
<area shape="rect" id="node8" href="classfoedus_1_1Attachable.html#a5b324e3abf302a59801aa73419bb4fad" title="foedus::Attachable\l::get_control_block" alt="" coords="573,1384,705,1425"/>
<area shape="rect" id="node9" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a4f72263ae71f34fad0130151328d6720" title="foedus::snapshot::Snapshot\lWriter::get_page_base" alt="" coords="547,1580,731,1621"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1Storage.html#ae3cca5dd58aa9bbf419cc07986bbc668" title="Returns the metadata of this storage. " alt="" coords="557,2216,721,2257"/>
<area shape="rect" id="node12" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#af9bcb8a605aecbbc3eabdc6664f6b163" title="foedus::snapshot::Snapshot\lWriter::get_next_page_id" alt="" coords="547,1449,731,1491"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1array_1_1LookupRouteFinder.html#a2d19d9785d226e4c7f9b2f0f549fdd19" title="foedus::storage::array\l::LookupRouteFinder::get\l_records_in_leaf" alt="" coords="555,3150,723,3206"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a2e5043394d70ac6f151fb06508a038ca" title="Returns the size of this array. " alt="" coords="540,2449,739,2491"/>
<area shape="rect" id="node15" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="546,2281,733,2323"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1array_1_1ArrayPage.html#ad27a14c20dc341c655820def2e0dd1ee" title="foedus::storage::array\l::ArrayPage::header" alt="" coords="565,2515,713,2556"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1array_1_1ArrayPage.html#af7bf48c6785865302f1d67bc59ab1392" title="foedus::storage::array\l::ArrayPage::get_array_range" alt="" coords="543,2580,735,2621"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1array_1_1ArrayPage.html#a4f3a748fa4e795bd86e0b2a2ed7e6630" title="Called only when this page is initialized. " alt="" coords="565,2646,713,2702"/>
<area shape="rect" id="node19" href="group__ASSORTED.html#gae2beea4717aef7ca9d43b91e48cf5824" title="Efficient ceil(dividee/dividor) for integer. " alt="" coords="569,2727,709,2768"/>
<area shape="rect" id="node20" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="817,1267,1007,1323"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1array_1_1ArrayPage.html#a53643894d607ee034359b2a4f77f0d89" title="foedus::storage::array\l::ArrayPage::get_interior\l_record" alt="" coords="558,2793,721,2849"/>
<area shape="rect" id="node22" href="classfoedus_1_1snapshot_1_1SnapshotWriter.html#a55ba9fc4a87f71b3991bba1c39948cc9" title="Write out pages that are contiguous in the main page pool. " alt="" coords="547,1515,731,1556"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="805,1580,1019,1621"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a37d93cdda67dd88454e0237f8a511995" title="foedus::storage::hash\l::HashStorage::get_levels" alt="" coords="554,2099,725,2140"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a134e444d2b945700fe14d0d6d3dd11f0" title="foedus::storage::hash\l::HashIntermediatePage\l::header" alt="" coords="559,1646,720,1702"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="559,1726,720,1782"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6b20dce9484c09666d6cf1df866d00d3" title="foedus::storage::hash\l::HashIntermediatePage\l::initialize_snapshot_page" alt="" coords="553,1806,725,1862"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#a641bbfa48a79b406ae30d8574184f0fd" title="foedus::storage::hash\l::HashComposer::to_string" alt="" coords="551,1887,728,1928"/>
<area shape="rect" id="node29" href="classfoedus_1_1Engine.html#af0ac9dbae9481b295a8492c6d9f6c1d5" title="Shorthand for get_options().thread_.group_count_. " alt="" coords="572,1952,707,1993"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#a02f8d5682a453898cbae7ca4a4517094" title="launched on its own thread. " alt="" coords="550,2018,729,2074"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#ab1264661a1f24383dcda1568f59425fe" title="foedus::storage::masstree\l::MasstreeComposer::to_string" alt="" coords="539,123,740,164"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="552,188,727,229"/>
<area shape="rect" id="node34" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="817,148,1007,189"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab55e48873dcf5700871a035c65bfa588" title="used only in masstree. " alt="" coords="535,305,743,347"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="553,371,726,412"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="809,288,1015,329"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="819,469,1005,525"/>
<area shape="rect" id="node39" href="namespacefoedus_1_1storage_1_1masstree.html#ad5bde8a81bd922e388c91d1aaeac1411" title="foedus::storage::masstree\l::from_this_snapshot" alt="" coords="553,793,726,835"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="521,437,757,493"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#aa64c68858f06b2665809772e26e385c1" title="Retrieves separators defining the index, used only by snapshot composer, thus no race. " alt="" coords="540,567,739,623"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2f1e35c48bba8f7c8319d5739487768d" title="foedus::storage::masstree\l::MasstreeBorderPage::initialize\l_snapshot_page" alt="" coords="536,647,743,703"/>
<area shape="rect" id="node43" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="565,728,714,769"/>
<area shape="rect" id="node44" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="572,859,707,900"/>
<area shape="rect" id="node45" href="classfoedus_1_1debugging_1_1StopWatch.html#ac8a42ba406ab38b098e27a19e6803638" title="foedus::debugging::\lStopWatch::elapsed_ms" alt="" coords="557,5,722,47"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1sequential_1_1SequentialRootPage.html#afef545b729883a0c1e3e52823bd0b892" title="foedus::storage::sequential\l::SequentialRootPage::header" alt="" coords="542,1056,737,1097"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1sequential_1_1SequentialRootPage.html#a9fea3cf7e25845006b607b7f93630484" title="Returns How many pointers to head pages exist in this page. " alt="" coords="550,1122,729,1178"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1sequential_1_1SequentialRootPage.html#a6e0e46c921857d48718b7546e23c4b02" title="foedus::storage::sequential\l::SequentialRootPage::get\l_pointers" alt="" coords="550,1202,729,1258"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1sequential_1_1SequentialRootPage.html#ac02ba584e0201edf862d363a0b1b6b9c" title="foedus::storage::sequential\l::SequentialRootPage::get\l_next_page" alt="" coords="550,975,729,1031"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af6d90399f471e1461fd4e59b0f3b923f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foedus::storage::Composer::drop_root_volatile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1Composer_1_1DropVolatilesArguments.html">DropVolatilesArguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is additionally called when no partitions observed any new modifications. </p>
<p>Only in this case, we can drop the root volatile page. Further, we can also drop all the descendent volatile pages safely in this case. Remember these methods are called within xct pausing. </p>

<p>Definition at line <a class="el" href="composer_8cpp_source.html#l00094">94</a> of file <a class="el" href="composer_8cpp_source.html">composer.cpp</a>.</p>

<p>References <a class="el" href="array__composer__impl_8cpp_source.html#l00971">foedus::storage::array::ArrayComposer::drop_root_volatile()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l01223">foedus::storage::hash::HashComposer::drop_root_volatile()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l02622">foedus::storage::masstree::MasstreeComposer::drop_root_volatile()</a>, <a class="el" href="storage__id_8hpp_source.html#l00126">foedus::storage::kArrayStorage</a>, <a class="el" href="storage__id_8hpp_source.html#l00128">foedus::storage::kHashStorage</a>, <a class="el" href="storage__id_8hpp_source.html#l00130">foedus::storage::kMasstreeStorage</a>, and <a class="el" href="storage__id_8hpp_source.html#l00132">foedus::storage::kSequentialStorage</a>.</p>

<p>Referenced by <a class="el" href="snapshot__manager__pimpl_8cpp_source.html#l00488">foedus::snapshot::SnapshotManagerPimpl::drop_volatile_pages()</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                                                            {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">switch</span> (storage_type_) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff">kArrayStorage</a>:</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      array::ArrayComposer(<span class="keyword">this</span>).drop_root_volatile(args);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc">kHashStorage</a>:</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      hash::HashComposer(<span class="keyword">this</span>).drop_root_volatile(args);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6">kSequentialStorage</a>:</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="comment">// Sequential storage already dropped it. Nothing to do.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e">kMasstreeStorage</a>:</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      masstree::MasstreeComposer(<span class="keyword">this</span>).drop_root_volatile(args);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e">foedus::storage::kMasstreeStorage</a></div><div class="ttdoc">Masstree Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00130">storage_id.hpp:130</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc">foedus::storage::kHashStorage</a></div><div class="ttdoc">Hashtable Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00128">storage_id.hpp:128</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6">foedus::storage::kSequentialStorage</a></div><div class="ttdoc">Sequential Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00132">storage_id.hpp:132</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff">foedus::storage::kArrayStorage</a></div><div class="ttdoc">Array Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00126">storage_id.hpp:126</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1Composer_af6d90399f471e1461fd4e59b0f3b923f_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1Composer_af6d90399f471e1461fd4e59b0f3b923f_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1Composer_af6d90399f471e1461fd4e59b0f3b923f_cgraph" id="classfoedus_1_1storage_1_1Composer_af6d90399f471e1461fd4e59b0f3b923f_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#a9ee9788f623a51584b4fd7f8ded6103a" title="foedus::storage::array\l::ArrayComposer::drop\l_root_volatile" alt="" coords="243,663,397,719"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#a4a9dc98b699194503e37e0e6609872ec" title="foedus::storage::hash\l::HashComposer::drop\l_root_volatile" alt="" coords="244,348,396,404"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#aa0cb9d19afa32166a7c128697f291ea2" title="foedus::storage::masstree\l::MasstreeComposer::drop\l_root_volatile" alt="" coords="232,209,408,265"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a145759e5113dca6d01be034ea5725f58" title="foedus::storage::array\l::ArrayStorage::get_array\l_metadata" alt="" coords="479,560,647,616"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1Metadata.html#a675df0db1a3c909581db949c10fd192b" title="foedus::storage::Metadata\l::keeps_all_volatile_pages" alt="" coords="477,494,650,535"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1Storage.html#ac1b54d4e7f3ad9f7f7c17598911abb01" title="Returns the unique name of this storage. " alt="" coords="481,217,645,258"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a3a535c4b81884868a2a5ead00428dd77" title="Returns the number of levels. " alt="" coords="478,641,649,682"/>
<area shape="rect" id="node7" href="classfoedus_1_1Attachable.html#a5b324e3abf302a59801aa73419bb4fad" title="foedus::Attachable\l::get_control_block" alt="" coords="497,282,629,323"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1array_1_1ArrayPage.html#a9c7bc21358a340d36f3c43a49f774b93" title="foedus::storage::array\l::ArrayPage::is_leaf" alt="" coords="725,703,873,745"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a2e5043394d70ac6f151fb06508a038ca" title="Returns the size of this array. " alt="" coords="464,838,663,879"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1array_1_1ArrayPage.html#ae6032f608834a39808e26c59aa0e42e2" title="foedus::storage::array\l::ArrayPage::get_leaf\l_record" alt="" coords="489,757,637,813"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#acc05e0b608094e78fa9a7025c08524b5" title="Returns byte size of one record in this array storage without internal overheads. ..." alt="" coords="456,903,671,945"/>
<area shape="rect" id="node13" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="502,969,625,1010"/>
<area shape="rect" id="node15" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="486,1035,641,1061"/>
<area shape="rect" id="node11" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="719,772,879,799"/>
<area shape="rect" id="node14" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="737,969,860,1010"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a47a258c2edd9e4d3b3b4a5b472a07d62" title="foedus::storage::hash\l::HashStorage::get_hash\l_metadata" alt="" coords="480,348,647,404"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a37d93cdda67dd88454e0237f8a511995" title="foedus::storage::hash\l::HashStorage::get_levels" alt="" coords="478,429,649,470"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a94bc2a1ae36c0a1ce1de99715072c59d" title="foedus::storage::masstree\l::MasstreeStorage::get\l_masstree_metadata" alt="" coords="477,5,650,61"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab55e48873dcf5700871a035c65bfa588" title="used only in masstree. " alt="" coords="459,86,667,127"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#aa8c59b8e2944d4a6a68d5fed840a7a29" title="foedus::storage::Volatile\lPagePointer::clear" alt="" coords="483,151,644,193"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1Composer_af6d90399f471e1461fd4e59b0f3b923f_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1Composer_af6d90399f471e1461fd4e59b0f3b923f_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1Composer_af6d90399f471e1461fd4e59b0f3b923f_icgraph" id="classfoedus_1_1storage_1_1Composer_af6d90399f471e1461fd4e59b0f3b923f_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a5d474e7a6b4de127153103f2295cb0fa" title="Sub&#45;routine of handle_snapshot_triggered(). " alt="" coords="232,39,459,80"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a905ccf76fe0e076980dc1965f038fe10" title="handle_snapshot() calls this when it should start snapshotting. " alt="" coords="507,31,717,87"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a64e3c7594b7d7d0d5f8a144bd802d910" title="Main routine for snapshot_thread_ in master engine. " alt="" coords="765,5,976,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="793,71,948,112"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a632a4da7b3c67dd687f7eba4f6ec1d76" title="foedus::snapshot::Snapshot\lManagerPimpl::initialize_once" alt="" coords="1024,5,1219,47"/>
<area shape="rect" id="node7" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a868dca9015af77e04202ead68fd7a136" title="foedus::restart::Restart\lManagerPimpl::initialize_once" alt="" coords="1024,71,1219,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0995635b97031b208127004382947acd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1Composer_1_1DropResult.html">Composer::DropResult</a> foedus::storage::Composer::drop_volatiles </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1Composer_1_1DropVolatilesArguments.html">DropVolatilesArguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Drops volatile pages that have not been modified since the snapshotted epoch. </p>
<p>This is called after pausing transaction executions, so this method does not worry about concurrent reads/writes while running this. Otherwise this method becomes very complex and/or expensive. It's just milliseconds for each several minutes, so should be fine to pause transactions. Also, this method is best-effort in many aspects. It might not drop some volatile pages that were not logically modified. In long run, it will be done at next snapshot, so it's okay to be opportunistic. </p>

<p>Definition at line <a class="el" href="composer_8cpp_source.html#l00083">83</a> of file <a class="el" href="composer_8cpp_source.html">composer.cpp</a>.</p>

<p>References <a class="el" href="array__composer__impl_8cpp_source.html#l00929">foedus::storage::array::ArrayComposer::drop_volatiles()</a>, <a class="el" href="hash__composer__impl_8cpp_source.html#l01165">foedus::storage::hash::HashComposer::drop_volatiles()</a>, <a class="el" href="masstree__composer__impl_8cpp_source.html#l02558">foedus::storage::masstree::MasstreeComposer::drop_volatiles()</a>, <a class="el" href="sequential__composer__impl_8cpp_source.html#l00309">foedus::storage::sequential::SequentialComposer::drop_volatiles()</a>, <a class="el" href="storage__id_8hpp_source.html#l00126">foedus::storage::kArrayStorage</a>, <a class="el" href="storage__id_8hpp_source.html#l00128">foedus::storage::kHashStorage</a>, <a class="el" href="storage__id_8hpp_source.html#l00130">foedus::storage::kMasstreeStorage</a>, and <a class="el" href="storage__id_8hpp_source.html#l00132">foedus::storage::kSequentialStorage</a>.</p>

<p>Referenced by <a class="el" href="snapshot__manager__pimpl_8cpp_source.html#l00595">foedus::snapshot::SnapshotManagerPimpl::drop_volatile_pages_parallel()</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                                                              {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">switch</span> (storage_type_) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff">kArrayStorage</a>:  <span class="keywordflow">return</span> array::ArrayComposer(<span class="keyword">this</span>).drop_volatiles(args);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc">kHashStorage</a>:  <span class="keywordflow">return</span> hash::HashComposer(<span class="keyword">this</span>).drop_volatiles(args);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6">kSequentialStorage</a>: <span class="keywordflow">return</span> sequential::SequentialComposer(<span class="keyword">this</span>).drop_volatiles(args);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e">kMasstreeStorage</a>: <span class="keywordflow">return</span> masstree::MasstreeComposer(<span class="keyword">this</span>).drop_volatiles(args);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">return</span> DropResult(args);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea132b35d3a56bd101207d58348d70bf9e">foedus::storage::kMasstreeStorage</a></div><div class="ttdoc">Masstree Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00130">storage_id.hpp:130</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea993bf93d3a4a03a67253fb2da12e3bdc">foedus::storage::kHashStorage</a></div><div class="ttdoc">Hashtable Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00128">storage_id.hpp:128</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0dea0d282d3546345301294188204cff05a6">foedus::storage::kSequentialStorage</a></div><div class="ttdoc">Sequential Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00132">storage_id.hpp:132</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff"><div class="ttname"><a href="group__STORAGE.html#gga016025043f5ef9c02be03f2f2a17a0deaeee5e98ab1c99fca614ecba38b2871ff">foedus::storage::kArrayStorage</a></div><div class="ttdoc">Array Storage </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00126">storage_id.hpp:126</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1Composer_a0995635b97031b208127004382947acd_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1Composer_a0995635b97031b208127004382947acd_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1Composer_a0995635b97031b208127004382947acd_cgraph" id="classfoedus_1_1storage_1_1Composer_a0995635b97031b208127004382947acd_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1array_1_1ArrayComposer.html#abea76692cff38e66aa4328401422488a" title="drop_volatiles and related methods " alt="" coords="247,360,400,416"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1hash_1_1HashComposer.html#a86416af851cf44112fbc0ea9c519c9b9" title="drop_volatiles and related methods " alt="" coords="247,735,399,791"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeComposer.html#ad25781d742feeced13ed8b047b485a3e" title="drop_volatiles and related methods " alt="" coords="235,1020,411,1076"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1sequential_1_1SequentialComposer.html#a93883e6731ee4a8f2efc4cf7cec2560f" title="foedus::storage::sequential\l::SequentialComposer::drop\l_volatiles" alt="" coords="232,1735,415,1791"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1array_1_1ArrayStorage.html#a145759e5113dca6d01be034ea5725f58" title="foedus::storage::array\l::ArrayStorage::get_array\l_metadata" alt="" coords="497,85,665,141"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1Metadata.html#a675df0db1a3c909581db949c10fd192b" title="foedus::storage::Metadata\l::keeps_all_volatile_pages" alt="" coords="494,881,667,922"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1Storage.html#ac1b54d4e7f3ad9f7f7c17598911abb01" title="Returns the unique name of this storage. " alt="" coords="499,815,663,857"/>
<area shape="rect" id="node6" href="classfoedus_1_1Attachable.html#a5b324e3abf302a59801aa73419bb4fad" title="foedus::Attachable\l::get_control_block" alt="" coords="515,998,647,1039"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1array_1_1ArrayPage.html#a9c7bc21358a340d36f3c43a49f774b93" title="foedus::storage::array\l::ArrayPage::is_leaf" alt="" coords="507,166,655,207"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1array_1_1ArrayPage.html#a53643894d607ee034359b2a4f77f0d89" title="foedus::storage::array\l::ArrayPage::get_interior\l_record" alt="" coords="499,5,662,61"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="781,953,942,994"/>
<area shape="rect" id="node11" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="487,283,675,339"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1Composer_1_1DropResult.html#a0cac5a92e42765bafd1fd54ca3200080" title="foedus::storage::Composer\l::DropResult::combine" alt="" coords="491,443,670,485"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1024,1582,1185,1623"/>
<area shape="rect" id="node13" href="classfoedus_1_1Epoch.html#adf886b8b219538b7dac2da820fbec68c" title="Kind of std::max(this, other). " alt="" coords="774,451,949,477"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a47a258c2edd9e4d3b3b4a5b472a07d62" title="foedus::storage::hash\l::HashStorage::get_hash\l_metadata" alt="" coords="497,735,664,791"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a0f94a4a418776e5ac253b6dcccda8cc6" title="foedus::storage::hash\l::HashStorage::get_root\l_children" alt="" coords="501,363,661,419"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a6ddc93fb5df01249140895435819da2f" title="foedus::storage::hash\l::HashIntermediatePage\l::get_level" alt="" coords="500,575,661,631"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1hash_1_1HashStorage.html#a37d93cdda67dd88454e0237f8a511995" title="foedus::storage::hash\l::HashStorage::get_levels" alt="" coords="495,509,666,550"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1hash_1_1HashIntermediatePage.html#a9027ebbc2ee535519916906978347be9" title="foedus::storage::hash\l::HashIntermediatePage\l::get_pointer" alt="" coords="500,655,661,711"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1PageHeader.html#ac40b3dad0a38d9a142bd14ea5000b669" title="foedus::storage::PageHeader\l::get_in_layer_level" alt="" coords="766,582,957,623"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a94bc2a1ae36c0a1ce1de99715072c59d" title="foedus::storage::masstree\l::MasstreeStorage::get\l_masstree_metadata" alt="" coords="494,1327,667,1383"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#aa6e48ddb92bb1c1b572cc3b90e19daf9" title="Returns the shared memory for the given storage ID. " alt="" coords="491,1195,670,1237"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1PartitionerMetadata.html#a0534520d3f4fb059afdf7b9db375907e" title="Returns the partitioner data pointed from this metadata. " alt="" coords="491,1261,670,1302"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="463,1115,699,1171"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="769,1033,954,1089"/>
<area shape="rect" id="node24" href="classfoedus_1_1Engine.html#ae9ad7ab6a3df52b0e9f0e50ede6faa2e" title="See SOC and IPC. " alt="" coords="794,1261,929,1302"/>
<area shape="rect" id="node25" href="classfoedus_1_1soc_1_1SocManager.html#a627cf434892c441c90c2de7c20637e9c" title="Returns the shared memories maintained across SOCs. " alt="" coords="771,1326,951,1367"/>
<area shape="rect" id="node26" href="classfoedus_1_1soc_1_1SharedMemoryRepo.html#a1c21cc6a27cabaf4a8c9dc26985aacfb" title="foedus::soc::SharedMemory\lRepo::get_global_memory\l_anchors" alt="" coords="769,1180,954,1236"/>
<area shape="rect" id="node28" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="794,1391,929,1433"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="758,1114,965,1155"/>
<area shape="rect" id="node33" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="794,1509,929,1550"/>
<area shape="rect" id="node34" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8" title="foedus::memory::EngineMemory\l::get_node_memory" alt="" coords="756,1574,967,1615"/>
<area shape="rect" id="node35" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774" title="foedus::memory::NumaNode\lMemoryRef::get_volatile_pool" alt="" coords="766,1771,957,1813"/>
<area shape="rect" id="node36" href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e" title="Gives an object to resolve an offset in this page pool (thus local) to an actual pointer and vice ver..." alt="" coords="491,1946,670,1987"/>
<area shape="rect" id="node38" href="group__THREAD.html#ga3cfa4441e96554e775ec6013c180e192" title="Returns a globally unique ID of Thread (core) for the given node and ordinal in the node..." alt="" coords="498,1713,663,1754"/>
<area shape="rect" id="node39" href="structfoedus_1_1memory_1_1LocalPageResolver.html#a389ef2027f0d0dc27d35856733e2f9be" title="Resolves offset in this pool to storage::Page*. " alt="" coords="489,1881,673,1922"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1sequential_1_1SequentialPage.html#adfc56f09f9e4e09466c4f102b9283076" title="Returns how many records in this page placed so far. " alt="" coords="747,2114,976,2155"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1sequential_1_1SequentialPage.html#aebcdc0447e1317476fe28d4303680112" title="Returns the epoch of the fist record in this page (undefined behavior if no record). " alt="" coords="491,2128,670,2184"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1sequential_1_1SequentialPage.html#a7ed4fd4e290f1e49a0b187d43b83674e" title="foedus::storage::sequential\l::SequentialPage::next_page" alt="" coords="486,2011,675,2053"/>
<area shape="rect" id="node47" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="765,1837,958,1878"/>
<area shape="rect" id="node48" href="structfoedus_1_1storage_1_1Composer_1_1DropVolatilesArguments.html#aa29872b9c654848dde2e5c0ca1409da0" title="Returns (might cache) the given pointer to volatile pool. " alt="" coords="479,1647,682,1689"/>
<area shape="rect" id="node50" href="namespacefoedus_1_1storage.html#a0197f5be4c85213e8accd9748e68b6e4" title="foedus::storage::combine\l_volatile_page_pointer" alt="" coords="497,2209,665,2250"/>
<area shape="rect" id="node37" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#ae901dc06f6b6f4594626ed0b233daec6" title="foedus::memory::PagePool\lPimpl::get_resolver" alt="" coords="772,2049,951,2090"/>
<area shape="rect" id="node40" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="784,1902,939,1943"/>
<area shape="rect" id="node41" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="769,1968,953,2024"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1sequential_1_1SequentialPage.html#a2f8f9a8460228df5790ad3181be49e3b" title="foedus::storage::sequential\l::SequentialPage::owner\l_id_from_offset" alt="" coords="772,2245,951,2301"/>
<area shape="rect" id="node45" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="800,2179,923,2221"/>
<area shape="rect" id="node49" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="756,1640,967,1696"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1Composer_a0995635b97031b208127004382947acd_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1Composer_a0995635b97031b208127004382947acd_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1Composer_a0995635b97031b208127004382947acd_icgraph" id="classfoedus_1_1storage_1_1Composer_a0995635b97031b208127004382947acd_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a26c51902174b692c91aedd15218f01b7" title="subroutine invoked by one thread for one node. " alt="" coords="232,31,416,87"/>
<area shape="rect" id="node3" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a5d474e7a6b4de127153103f2295cb0fa" title="Sub&#45;routine of handle_snapshot_triggered(). " alt="" coords="464,39,691,80"/>
<area shape="rect" id="node4" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a905ccf76fe0e076980dc1965f038fe10" title="handle_snapshot() calls this when it should start snapshotting. " alt="" coords="739,31,949,87"/>
<area shape="rect" id="node5" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a64e3c7594b7d7d0d5f8a144bd802d910" title="Main routine for snapshot_thread_ in master engine. " alt="" coords="997,5,1208,47"/>
<area shape="rect" id="node7" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a8c5418a3e6d3558aa3920a605834df08" title="Recover the state of database from recent snapshot files and transaction logs. " alt="" coords="1025,71,1180,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1snapshot_1_1SnapshotManagerPimpl.html#a632a4da7b3c67dd687f7eba4f6ec1d76" title="foedus::snapshot::Snapshot\lManagerPimpl::initialize_once" alt="" coords="1256,5,1451,47"/>
<area shape="rect" id="node8" href="classfoedus_1_1restart_1_1RestartManagerPimpl.html#a868dca9015af77e04202ead68fd7a136" title="foedus::restart::Restart\lManagerPimpl::initialize_once" alt="" coords="1256,71,1451,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a58e89ea3a0bea2d29b3e527f19cc53b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1Engine.html">Engine</a>* foedus::storage::Composer::get_engine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="composer_8hpp_source.html#l00090">90</a> of file <a class="el" href="composer_8hpp_source.html">composer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{ <span class="keywordflow">return</span> engine_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a404a0456e5a112f840c23f692c950f78"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a> foedus::storage::Composer::get_storage_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="composer_8hpp_source.html#l00091">91</a> of file <a class="el" href="composer_8hpp_source.html">composer.hpp</a>.</p>

<p>Referenced by <a class="el" href="composer_8cpp_source.html#l00039">foedus::storage::operator&lt;&lt;()</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{ <span class="keywordflow">return</span> storage_id_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1Composer_a404a0456e5a112f840c23f692c950f78_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1Composer_a404a0456e5a112f840c23f692c950f78_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1Composer_a404a0456e5a112f840c23f692c950f78_icgraph" id="classfoedus_1_1storage_1_1Composer_a404a0456e5a112f840c23f692c950f78_icgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1storage.html#abbd6e6acadf026d93acf4bd901900579" title="foedus::storage::operator\&lt;\&lt;" alt="" coords="232,13,415,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeac18da0f8b065673b0615ec35f9b714"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__STORAGE.html#ga016025043f5ef9c02be03f2f2a17a0de">StorageType</a> foedus::storage::Composer::get_storage_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="composer_8hpp_source.html#l00092">92</a> of file <a class="el" href="composer_8hpp_source.html">composer.hpp</a>.</p>

<p>Referenced by <a class="el" href="composer_8cpp_source.html#l00039">foedus::storage::operator&lt;&lt;()</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{ <span class="keywordflow">return</span> storage_type_; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1Composer_aeac18da0f8b065673b0615ec35f9b714_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1Composer_aeac18da0f8b065673b0615ec35f9b714_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1Composer_aeac18da0f8b065673b0615ec35f9b714_icgraph" id="classfoedus_1_1storage_1_1Composer_aeac18da0f8b065673b0615ec35f9b714_icgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1storage.html#abbd6e6acadf026d93acf4bd901900579" title="foedus::storage::operator\&lt;\&lt;" alt="" coords="232,13,415,39"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="adbcfff625fb0251f101370749588799c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1storage_1_1Composer.html">Composer</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="composer_8cpp_source.html#l00039">39</a> of file <a class="el" href="composer_8cpp_source.html">composer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                                         {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  o &lt;&lt; <span class="stringliteral">&quot;&lt;Composer&gt;&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;storage_id_&gt;&quot;</span> &lt;&lt; v.get_storage_id() &lt;&lt; <span class="stringliteral">&quot;&lt;/storage_id_&gt;&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;storage_type&gt;&quot;</span> &lt;&lt; <a class="code" href="group__STORAGE.html#ga4449085638502d211183762cf81fa580">to_storage_type_name</a>(v.get_storage_type()) &lt;&lt; <span class="stringliteral">&quot;&lt;/storage_type&gt;&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;&lt;/Composer&gt;&quot;</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_ga4449085638502d211183762cf81fa580"><div class="ttname"><a href="group__STORAGE.html#ga4449085638502d211183762cf81fa580">foedus::storage::to_storage_type_name</a></div><div class="ttdeci">const char * to_storage_type_name(StorageType type)</div><div class="ttdoc">Gives a string representation of StorageType. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00139">storage_id.hpp:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/storage/<a class="el" href="composer_8hpp_source.html">composer.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/<a class="el" href="composer_8cpp_source.html">composer.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1storage.html">storage</a></li><li class="navelem"><a class="el" href="classfoedus_1_1storage_1_1Composer.html">Composer</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

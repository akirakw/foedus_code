<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libfoedus-core: foedus::storage::masstree::MasstreeStoragePimpl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libfoedus-core
   </div>
   <div id="projectbrief">FOEDUS Core Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/centos7/"><span>Jenkins&#160;(x86_64&#160;Fedora)</span></a></li>
      <li><a href="http://cihead.labs.hpe.com/ub1404/"><span>Jenkins&#160;(x86_64&#160;Ubuntu)</span></a></li>
      <li><a href="http://ms01915-003.hpl.hp.com:8080/"><span>Jenkins&#160;(aarch64&#160;Ubuntu)</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/tree/master"><span>Github</span></a></li>
      <li><a href="http://github.com/hkimura/foedus_code/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">foedus::storage::masstree::MasstreeStoragePimpl Class Reference<span class="mlabels"><span class="mlabel">final</span></span><div class="ingroups"><a class="el" href="group__COMPONENTS.html">FOEDUS Components</a> &raquo; <a class="el" href="group__STORAGE.html">Storage Manager</a> &raquo; <a class="el" href="group__MASSTREE.html">Masstree Storage</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Pimpl object of <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html" title="Represents a Masstree storage. ">MasstreeStorage</a>.  
 <a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Pimpl object of <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html" title="Represents a Masstree storage. ">MasstreeStorage</a>. </p>
<p>A private pimpl object for <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html" title="Represents a Masstree storage. ">MasstreeStorage</a>. Do not include this header from a client program unless you know what you are doing. </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00098">98</a> of file <a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for foedus::storage::masstree::MasstreeStoragePimpl:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl__inherit__graph.png" border="0" usemap="#foedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_inherit__map" alt="Inheritance graph"/></div>
<map name="foedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_inherit__map" id="foedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_inherit__map">
<area shape="rect" id="node2" href="classfoedus_1_1Attachable.html" title="foedus::Attachable\l\&lt; MasstreeStorageControlBlock \&gt;" alt="" coords="5,5,224,47"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for foedus::storage::masstree::MasstreeStoragePimpl:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl__coll__graph.png" border="0" usemap="#foedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_coll__map" alt="Collaboration graph"/></div>
<map name="foedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_coll__map" id="foedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_coll__map">
<area shape="rect" id="node2" href="classfoedus_1_1Attachable.html" title="foedus::Attachable\l\&lt; MasstreeStorageControlBlock \&gt;" alt="" coords="1373,53,1592,94"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html" title="Database engine object that holds all resources and provides APIs. " alt="" coords="1081,21,1189,48"/>
<area shape="rect" id="node4" href="classfoedus_1_1Initializable.html" title="The pure&#45;virtual interface to initialize/uninitialize non&#45;trivial resources. " alt="" coords="717,5,849,32"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeStorageControlBlock.html" title="Shared data of this storage type. " alt="" coords="1033,102,1236,143"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeMetadata.html" title="Metadata of a masstree storage. " alt="" coords="697,57,870,98"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1Metadata.html" title="Metadata of one storage. " alt="" coords="377,64,551,91"/>
<area shape="rect" id="node8" href="classfoedus_1_1assorted_1_1FixedString.html" title="foedus::assorted::FixedString\l\&lt; 60 \&gt;" alt="" coords="5,23,197,65"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1Metadata_1_1SnapshotThresholds.html" title="Tuning parameters related to snapshotting. " alt="" coords="15,89,188,130"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1DualPagePointer.html" title="Represents a pointer to another page (usually a child page). " alt="" coords="696,122,871,163"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1VolatilePagePointer.html" title="Represents a pointer to a volatile page with modification count for preventing ABA. " alt="" coords="383,122,545,163"/>
<area shape="rect" id="node12" href="classfoedus_1_1soc_1_1SharedMutex.html" title="A mutex that can be placed in shared memory and used from multiple processes. " alt="" coords="696,188,871,215"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6f09fabd46975ec14b505d490c482031"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6f09fabd46975ec14b505d490c482031">MasstreeStoragePimpl</a> ()</td></tr>
<tr class="separator:a6f09fabd46975ec14b505d490c482031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d3f0df49cb2be38472c10a794ba0d58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3d3f0df49cb2be38472c10a794ba0d58">MasstreeStoragePimpl</a> (<a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html">MasstreeStorage</a> *storage)</td></tr>
<tr class="separator:a3d3f0df49cb2be38472c10a794ba0d58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a192a4976aa71f457b356bf536d9f5fc2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a192a4976aa71f457b356bf536d9f5fc2">create</a> (const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeMetadata.html">MasstreeMetadata</a> &amp;metadata)</td></tr>
<tr class="separator:a192a4976aa71f457b356bf536d9f5fc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d4ac5a88e7ce112f83b67597719fa82"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a8d4ac5a88e7ce112f83b67597719fa82">load</a> (const <a class="el" href="structfoedus_1_1storage_1_1StorageControlBlock.html">StorageControlBlock</a> &amp;snapshot_block)</td></tr>
<tr class="separator:a8d4ac5a88e7ce112f83b67597719fa82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c2b2febfce356451e8183f66f71dcc3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a9c2b2febfce356451e8183f66f71dcc3">load_empty</a> ()</td></tr>
<tr class="separator:a9c2b2febfce356451e8183f66f71dcc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ab7c42dbfd788773d6293ffdb64d52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a67ab7c42dbfd788773d6293ffdb64d52">drop</a> ()</td></tr>
<tr class="memdesc:a67ab7c42dbfd788773d6293ffdb64d52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage-wide operations, such as drop, create, etc.  <a href="#a67ab7c42dbfd788773d6293ffdb64d52">More...</a><br /></td></tr>
<tr class="separator:a67ab7c42dbfd788773d6293ffdb64d52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a025ff60e7c0717967a091f2c1e01fb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4a025ff60e7c0717967a091f2c1e01fb">exists</a> () const </td></tr>
<tr class="separator:a4a025ff60e7c0717967a091f2c1e01fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6d912133fd8b46eacb660b840bada0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a> () const </td></tr>
<tr class="separator:aca6d912133fd8b46eacb660b840bada0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94e2b69404cabddbead1d1fb0ef1dc42"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespacefoedus_1_1storage.html#a0c15c034d49af969335271617a73a846">StorageName</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">get_name</a> () const </td></tr>
<tr class="separator:a94e2b69404cabddbead1d1fb0ef1dc42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a950d071732ec8bd3251c03181d42692f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeMetadata.html">MasstreeMetadata</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a950d071732ec8bd3251c03181d42692f">get_meta</a> () const </td></tr>
<tr class="separator:a950d071732ec8bd3251c03181d42692f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa23487ce62cb84213dedb7917cbf2602"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html">DualPagePointer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa23487ce62cb84213dedb7917cbf2602">get_first_root_pointer</a> () const </td></tr>
<tr class="separator:aa23487ce62cb84213dedb7917cbf2602"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36d78c30d1b07389c3c0e7180e301008"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html">DualPagePointer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008">get_first_root_pointer_address</a> ()</td></tr>
<tr class="separator:a36d78c30d1b07389c3c0e7180e301008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc32aaf6f4537fcc1ada207e1d6902ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">get_first_root</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool for_write, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html">MasstreeIntermediatePage</a> **root)</td></tr>
<tr class="memdesc:adc32aaf6f4537fcc1ada207e1d6902ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Root-node related, such as a method to retrieve 1st-root, to grow, etc.  <a href="#adc32aaf6f4537fcc1ada207e1d6902ec">More...</a><br /></td></tr>
<tr class="separator:adc32aaf6f4537fcc1ada207e1d6902ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a738313356f0e54e8e2d732c2017797c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0">find_border_physical</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *layer_root, uint8_t current_layer, bool for_writes, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> slice, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html">MasstreeBorderPage</a> **border) __attribute__((always_inline))</td></tr>
<tr class="memdesc:a738313356f0e54e8e2d732c2017797c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a border node in the layer that corresponds to the given key slice.  <a href="#a738313356f0e54e8e2d732c2017797c0">More...</a><br /></td></tr>
<tr class="separator:a738313356f0e54e8e2d732c2017797c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91dac48625f8f7d2906fcfba5908cbc1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1">locate_record</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, <a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> key_length, bool for_writes, <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> *result)</td></tr>
<tr class="memdesc:a91dac48625f8f7d2906fcfba5908cbc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifies page and record for the key.  <a href="#a91dac48625f8f7d2906fcfba5908cbc1">More...</a><br /></td></tr>
<tr class="separator:a91dac48625f8f7d2906fcfba5908cbc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce23624d660da08cb1ee04ac2297171"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a0ce23624d660da08cb1ee04ac2297171">locate_record_normalized</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> key, bool for_writes, <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> *result)</td></tr>
<tr class="memdesc:a0ce23624d660da08cb1ee04ac2297171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifies page and record for the normalized key.  <a href="#a0ce23624d660da08cb1ee04ac2297171">More...</a><br /></td></tr>
<tr class="separator:a0ce23624d660da08cb1ee04ac2297171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52a1bce48d9230ad2ce3f52c4da51b8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a52a1bce48d9230ad2ce3f52c4da51b8e">reserve_record</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const void *key, <a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> key_length, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> payload_count, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> physical_payload_hint, <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> *result)</td></tr>
<tr class="memdesc:a52a1bce48d9230ad2ce3f52c4da51b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Like <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. ">locate_record()</a>, this is also a logical operation.  <a href="#a52a1bce48d9230ad2ce3f52c4da51b8e">More...</a><br /></td></tr>
<tr class="separator:a52a1bce48d9230ad2ce3f52c4da51b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac5f9308b4aed46777d34f6fa171c8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#acac5f9308b4aed46777d34f6fa171c8e">reserve_record_normalized</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> key, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> payload_count, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> physical_payload_hint, <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> *result)</td></tr>
<tr class="separator:acac5f9308b4aed46777d34f6fa171c8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e24325e4b203cb3e2008283c6ef0c89"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a8e24325e4b203cb3e2008283c6ef0c89">retrieve_general</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;location, void *payload, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> *payload_capacity)</td></tr>
<tr class="memdesc:a8e24325e4b203cb3e2008283c6ef0c89"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of get_record family.  <a href="#a8e24325e4b203cb3e2008283c6ef0c89">More...</a><br /></td></tr>
<tr class="separator:a8e24325e4b203cb3e2008283c6ef0c89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae301e3aa587aa907eed1f6ae1ec5edb0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ae301e3aa587aa907eed1f6ae1ec5edb0">retrieve_part_general</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;location, void *payload, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> payload_offset, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> payload_count)</td></tr>
<tr class="separator:ae301e3aa587aa907eed1f6ae1ec5edb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3036d6662c0bd89e330ca19cbca1f549"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">register_record_write_log</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;location, <a class="el" href="structfoedus_1_1log_1_1RecordLogType.html">log::RecordLogType</a> *log_entry)</td></tr>
<tr class="memdesc:a3036d6662c0bd89e330ca19cbca1f549"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used in the following methods.  <a href="#a3036d6662c0bd89e330ca19cbca1f549">More...</a><br /></td></tr>
<tr class="separator:a3036d6662c0bd89e330ca19cbca1f549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0b96482a874777c4871a152ad733da3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#af0b96482a874777c4871a152ad733da3">insert_general</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;location, const void *be_key, <a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> key_length, const void *payload, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> payload_count)</td></tr>
<tr class="memdesc:af0b96482a874777c4871a152ad733da3"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of insert_record family.  <a href="#af0b96482a874777c4871a152ad733da3">More...</a><br /></td></tr>
<tr class="separator:af0b96482a874777c4871a152ad733da3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45396b70b246f330355397b447af55f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a45396b70b246f330355397b447af55f3">delete_general</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;location, const void *be_key, <a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> key_length)</td></tr>
<tr class="memdesc:a45396b70b246f330355397b447af55f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of delete_record family.  <a href="#a45396b70b246f330355397b447af55f3">More...</a><br /></td></tr>
<tr class="separator:a45396b70b246f330355397b447af55f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeeccc272d2f9a4d895f4d117f6b96b27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aeeccc272d2f9a4d895f4d117f6b96b27">upsert_general</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;location, const void *be_key, <a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> key_length, const void *payload, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> payload_count)</td></tr>
<tr class="memdesc:aeeccc272d2f9a4d895f4d117f6b96b27"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of upsert_record family.  <a href="#aeeccc272d2f9a4d895f4d117f6b96b27">More...</a><br /></td></tr>
<tr class="separator:aeeccc272d2f9a4d895f4d117f6b96b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9cc59cbbef3fd23a62cbd25cbd00abb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ab9cc59cbbef3fd23a62cbd25cbd00abb">overwrite_general</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;location, const void *be_key, <a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> key_length, const void *payload, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> payload_offset, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> payload_count)</td></tr>
<tr class="memdesc:ab9cc59cbbef3fd23a62cbd25cbd00abb"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of overwrite_record family.  <a href="#ab9cc59cbbef3fd23a62cbd25cbd00abb">More...</a><br /></td></tr>
<tr class="separator:ab9cc59cbbef3fd23a62cbd25cbd00abb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa71566d3a4d56ded35df567784b13525"><td class="memTemplParams" colspan="2">template&lt;typename PAYLOAD &gt; </td></tr>
<tr class="memitem:aa71566d3a4d56ded35df567784b13525"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa71566d3a4d56ded35df567784b13525">increment_general</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;location, const void *be_key, <a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> key_length, PAYLOAD *value, <a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> payload_offset)</td></tr>
<tr class="memdesc:aa71566d3a4d56ded35df567784b13525"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of increment_record family.  <a href="#aa71566d3a4d56ded35df567784b13525">More...</a><br /></td></tr>
<tr class="separator:aa71566d3a4d56ded35df567784b13525"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a4e90569074d49ab538041caedacf6a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a2a4e90569074d49ab538041caedacf6a">verify_single_thread</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context)</td></tr>
<tr class="memdesc:a2a4e90569074d49ab538041caedacf6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">These are defined in <a class="el" href="masstree__storage__verify_8cpp.html">masstree_storage_verify.cpp</a>.  <a href="#a2a4e90569074d49ab538041caedacf6a">More...</a><br /></td></tr>
<tr class="separator:a2a4e90569074d49ab538041caedacf6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09d587cc38996109b753a7704fa33736"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736">verify_single_thread_layer</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, uint8_t layer, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *layer_root)</td></tr>
<tr class="separator:a09d587cc38996109b753a7704fa33736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a351ca64071b130468a9ba9f200ccd417"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417">verify_single_thread_intermediate</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> low_fence, <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1HighFence.html">HighFence</a> high_fence, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html">MasstreeIntermediatePage</a> *page)</td></tr>
<tr class="separator:a351ca64071b130468a9ba9f200ccd417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a688e9af62605f137637cc239f161c84f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f">verify_single_thread_border</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> low_fence, <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1HighFence.html">HighFence</a> high_fence, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html">MasstreeBorderPage</a> *page)</td></tr>
<tr class="separator:a688e9af62605f137637cc239f161c84f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41e664c7035f1b89121ef06678a71386"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a41e664c7035f1b89121ef06678a71386">debugout_single_thread</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, bool volatile_only, uint32_t max_pages)</td></tr>
<tr class="memdesc:a41e664c7035f1b89121ef06678a71386"><td class="mdescLeft">&#160;</td><td class="mdescRight">These are defined in <a class="el" href="masstree__storage__debug_8cpp.html">masstree_storage_debug.cpp</a>.  <a href="#a41e664c7035f1b89121ef06678a71386">More...</a><br /></td></tr>
<tr class="separator:a41e664c7035f1b89121ef06678a71386"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6358da556d81e06726320b30c78755f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7">debugout_single_thread_recurse</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, <a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *fileset, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *parent, bool follow_volatile, uint32_t *remaining_pages)</td></tr>
<tr class="separator:a6358da556d81e06726320b30c78755f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb503d118f53a417bf11f9e486bd3cf7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7">debugout_single_thread_follow</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, <a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *fileset, const <a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html">DualPagePointer</a> &amp;pointer, bool follow_volatile, uint32_t *remaining_pages)</td></tr>
<tr class="separator:adb503d118f53a417bf11f9e486bd3cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fe6a82d90f30d4b9724009ba2fc40ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a0fe6a82d90f30d4b9724009ba2fc40ae">hcc_reset_all_temperature_stat</a> ()</td></tr>
<tr class="memdesc:a0fe6a82d90f30d4b9724009ba2fc40ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">For stupid reasons (I'm lazy!) these are defined in _debug.cpp.  <a href="#a0fe6a82d90f30d4b9724009ba2fc40ae">More...</a><br /></td></tr>
<tr class="separator:a0fe6a82d90f30d4b9724009ba2fc40ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e4b647b3c95a74b4de7fd18931cafb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a7e4b647b3c95a74b4de7fd18931cafb3">hcc_reset_all_temperature_stat_recurse</a> (<a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *parent)</td></tr>
<tr class="separator:a7e4b647b3c95a74b4de7fd18931cafb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89828c1df02cadd8a38824f24e2adef9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a89828c1df02cadd8a38824f24e2adef9">hcc_reset_all_temperature_stat_follow</a> (<a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a> page_id)</td></tr>
<tr class="separator:a89828c1df02cadd8a38824f24e2adef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff31f521523d7a7b81ff5b750e081dac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">follow_page</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool for_writes, <a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a> *pointer, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> **page)</td></tr>
<tr class="memdesc:aff31f521523d7a7b81ff5b750e081dac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread::follow_page_pointer() for masstree.  <a href="#aff31f521523d7a7b81ff5b750e081dac">More...</a><br /></td></tr>
<tr class="separator:aff31f521523d7a7b81ff5b750e081dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6188e676e564b4ebecaa556178cdb81e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6188e676e564b4ebecaa556178cdb81e">follow_layer</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool for_writes, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html">MasstreeBorderPage</a> *parent, <a class="el" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a> record_index, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> **page) __attribute__((always_inline))</td></tr>
<tr class="memdesc:a6188e676e564b4ebecaa556178cdb81e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Follows to next layer's root page.  <a href="#a6188e676e564b4ebecaa556178cdb81e">More...</a><br /></td></tr>
<tr class="separator:a6188e676e564b4ebecaa556178cdb81e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99bb085d9e427fc36182b13bb20371e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a99bb085d9e427fc36182b13bb20371e9">prefetch_pages_normalized</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool install_volatile, bool cache_snapshot, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> from, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> to)</td></tr>
<tr class="memdesc:a99bb085d9e427fc36182b13bb20371e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">defined in <a class="el" href="masstree__storage__prefetch_8cpp.html">masstree_storage_prefetch.cpp</a>  <a href="#a99bb085d9e427fc36182b13bb20371e9">More...</a><br /></td></tr>
<tr class="separator:a99bb085d9e427fc36182b13bb20371e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c4630d85af99ceafad404bc5c5c7eef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef">prefetch_pages_normalized_recurse</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool install_volatile, bool cache_snapshot, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> from, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> to, <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *page)</td></tr>
<tr class="separator:a4c4630d85af99ceafad404bc5c5c7eef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe8cbf3d8edfb47a32d460029707aace"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#abe8cbf3d8edfb47a32d460029707aace">prefetch_pages_follow</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, <a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html">DualPagePointer</a> *pointer, bool vol_on, bool snp_on, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> from, <a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> to)</td></tr>
<tr class="separator:abe8cbf3d8edfb47a32d460029707aace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff57df4d2b237e63e459d5fefe9d4cfb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfoedus_1_1xct_1_1TrackMovedRecordResult.html">xct::TrackMovedRecordResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff57df4d2b237e63e459d5fefe9d4cfb">track_moved_record</a> (<a class="el" href="structfoedus_1_1xct_1_1RwLockableXctId.html">xct::RwLockableXctId</a> *old_address, <a class="el" href="structfoedus_1_1xct_1_1WriteXctAccess.html">xct::WriteXctAccess</a> *write_set) __attribute__((always_inline))</td></tr>
<tr class="separator:aff57df4d2b237e63e459d5fefe9d4cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67482433dfc680921b443bdb8a1ea78e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a67482433dfc680921b443bdb8a1ea78e">peek_volatile_page_boundaries</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, const <a class="el" href="group__MASSTREE.html#structfoedus_1_1storage_1_1masstree_1_1MasstreeStorage_1_1PeekBoundariesArguments">MasstreeStorage::PeekBoundariesArguments</a> &amp;args)</td></tr>
<tr class="memdesc:a67482433dfc680921b443bdb8a1ea78e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defined in <a class="el" href="masstree__storage__peek_8cpp.html">masstree_storage_peek.cpp</a>.  <a href="#a67482433dfc680921b443bdb8a1ea78e">More...</a><br /></td></tr>
<tr class="separator:a67482433dfc680921b443bdb8a1ea78e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14fb0ae2a643a45c3f32ab6395285d8d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a14fb0ae2a643a45c3f32ab6395285d8d">peek_volatile_page_boundaries_next_layer</a> (const <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *layer_root, const <a class="el" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html">memory::GlobalVolatilePageResolver</a> &amp;resolver, const <a class="el" href="group__MASSTREE.html#structfoedus_1_1storage_1_1masstree_1_1MasstreeStorage_1_1PeekBoundariesArguments">MasstreeStorage::PeekBoundariesArguments</a> &amp;args)</td></tr>
<tr class="separator:a14fb0ae2a643a45c3f32ab6395285d8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96688f523312e356ea1a03adfbfba7b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a96688f523312e356ea1a03adfbfba7b2">peek_volatile_page_boundaries_this_layer</a> (const <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *layer_root, const <a class="el" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html">memory::GlobalVolatilePageResolver</a> &amp;resolver, const <a class="el" href="group__MASSTREE.html#structfoedus_1_1storage_1_1masstree_1_1MasstreeStorage_1_1PeekBoundariesArguments">MasstreeStorage::PeekBoundariesArguments</a> &amp;args)</td></tr>
<tr class="separator:a96688f523312e356ea1a03adfbfba7b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a139bb707048331de71c3abe8c0282d7d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a139bb707048331de71c3abe8c0282d7d">peek_volatile_page_boundaries_this_layer_recurse</a> (const <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html">MasstreeIntermediatePage</a> *cur, const <a class="el" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html">memory::GlobalVolatilePageResolver</a> &amp;resolver, const <a class="el" href="group__MASSTREE.html#structfoedus_1_1storage_1_1masstree_1_1MasstreeStorage_1_1PeekBoundariesArguments">MasstreeStorage::PeekBoundariesArguments</a> &amp;args)</td></tr>
<tr class="separator:a139bb707048331de71c3abe8c0282d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3b15bb4f888327ba49050f62d020f52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ac3b15bb4f888327ba49050f62d020f52">fatify_first_root</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, uint32_t desired_count, bool disable_no_record_split)</td></tr>
<tr class="memdesc:ac3b15bb4f888327ba49050f62d020f52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defined in <a class="el" href="masstree__storage__fatify_8cpp.html">masstree_storage_fatify.cpp</a>.  <a href="#ac3b15bb4f888327ba49050f62d020f52">More...</a><br /></td></tr>
<tr class="separator:ac3b15bb4f888327ba49050f62d020f52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32332060560b864a857a839bb0adb4fd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a32332060560b864a857a839bb0adb4fd">fatify_first_root_double</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, bool disable_no_record_split)</td></tr>
<tr class="separator:a32332060560b864a857a839bb0adb4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6c9eb02ad32cc1bffe9daac3521ad24"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24">approximate_count_root_children</a> (<a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *context, uint32_t *out)</td></tr>
<tr class="memdesc:ad6c9eb02ad32cc1bffe9daac3521ad24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the count of direct children in the first-root node.  <a href="#ad6c9eb02ad32cc1bffe9daac3521ad24">More...</a><br /></td></tr>
<tr class="separator:ad6c9eb02ad32cc1bffe9daac3521ad24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfoedus_1_1Attachable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfoedus_1_1Attachable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfoedus_1_1Attachable.html">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;</a></td></tr>
<tr class="memitem:ab3209bc9bd57c99f0ad601f33ec77d1e inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#ab3209bc9bd57c99f0ad601f33ec77d1e">Attachable</a> ()</td></tr>
<tr class="separator:ab3209bc9bd57c99f0ad601f33ec77d1e inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad91af21656ffcf7eeb56a5f7d0f5f661 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#ad91af21656ffcf7eeb56a5f7d0f5f661">Attachable</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine)</td></tr>
<tr class="separator:ad91af21656ffcf7eeb56a5f7d0f5f661 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac28be42953c806e4c4e0ad8f99201dae inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#ac28be42953c806e4c4e0ad8f99201dae">Attachable</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine, MasstreeStorageControlBlock *control_block)</td></tr>
<tr class="separator:ac28be42953c806e4c4e0ad8f99201dae inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1182f6bd28f64e3c48bf5ee36d54cce inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#ad1182f6bd28f64e3c48bf5ee36d54cce">Attachable</a> (MasstreeStorageControlBlock *control_block)</td></tr>
<tr class="separator:ad1182f6bd28f64e3c48bf5ee36d54cce inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7892c78e38fb5f025ea73939a25c9d2e inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a7892c78e38fb5f025ea73939a25c9d2e">Attachable</a> (const <a class="el" href="classfoedus_1_1Attachable.html">Attachable</a> &amp;other)</td></tr>
<tr class="separator:a7892c78e38fb5f025ea73939a25c9d2e inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed95388e1a77a81a5d7d04cf28ef3577 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#aed95388e1a77a81a5d7d04cf28ef3577">~Attachable</a> ()</td></tr>
<tr class="separator:aed95388e1a77a81a5d7d04cf28ef3577 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0666676a4eaed1c0fdf94a2e1b00c099 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Attachable.html">Attachable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a0666676a4eaed1c0fdf94a2e1b00c099">operator=</a> (const <a class="el" href="classfoedus_1_1Attachable.html">Attachable</a> &amp;other)</td></tr>
<tr class="separator:a0666676a4eaed1c0fdf94a2e1b00c099 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a484796b2fffa361b9a6ed2f1b7f61a35 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a484796b2fffa361b9a6ed2f1b7f61a35">attach</a> (MasstreeStorageControlBlock *control_block)</td></tr>
<tr class="memdesc:a484796b2fffa361b9a6ed2f1b7f61a35 inherit pub_methods_classfoedus_1_1Attachable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attaches to the given shared memory.  <a href="#a484796b2fffa361b9a6ed2f1b7f61a35">More...</a><br /></td></tr>
<tr class="separator:a484796b2fffa361b9a6ed2f1b7f61a35 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebf4adece08c298864ce05ddd9461a0c inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#aebf4adece08c298864ce05ddd9461a0c">is_attached</a> () const</td></tr>
<tr class="memdesc:aebf4adece08c298864ce05ddd9461a0c inherit pub_methods_classfoedus_1_1Attachable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the object has been already attached to some shared memory.  <a href="#aebf4adece08c298864ce05ddd9461a0c">More...</a><br /></td></tr>
<tr class="separator:aebf4adece08c298864ce05ddd9461a0c inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b324e3abf302a59801aa73419bb4fad inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">MasstreeStorageControlBlock *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a5b324e3abf302a59801aa73419bb4fad">get_control_block</a> () const</td></tr>
<tr class="separator:a5b324e3abf302a59801aa73419bb4fad inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44f07b6dbb803d41d16b40182e8ff583 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a44f07b6dbb803d41d16b40182e8ff583">get_engine</a> () const</td></tr>
<tr class="separator:a44f07b6dbb803d41d16b40182e8ff583 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd701f80820c2ef1f665bda157346021 inherit pub_methods_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#acd701f80820c2ef1f665bda157346021">set_engine</a> (<a class="el" href="classfoedus_1_1Engine.html">Engine</a> *engine)</td></tr>
<tr class="separator:acd701f80820c2ef1f665bda157346021 inherit pub_methods_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">check_next_layer_bit</a> (<a class="el" href="structfoedus_1_1xct_1_1XctId.html">xct::XctId</a> observed) __attribute__((always_inline))</td></tr>
<tr class="separator:ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classfoedus_1_1Attachable"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classfoedus_1_1Attachable')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classfoedus_1_1Attachable.html">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;</a></td></tr>
<tr class="memitem:a5f84f871a1d36f9ee990f3175661cd99 inherit pro_attribs_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a></td></tr>
<tr class="memdesc:a5f84f871a1d36f9ee990f3175661cd99 inherit pro_attribs_classfoedus_1_1Attachable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Most attachable object stores an engine pointer (local engine), so we define it here.  <a href="#a5f84f871a1d36f9ee990f3175661cd99">More...</a><br /></td></tr>
<tr class="separator:a5f84f871a1d36f9ee990f3175661cd99 inherit pro_attribs_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f87c691e2df0b04322e6df8d7c0d81 inherit pro_attribs_classfoedus_1_1Attachable"><td class="memItemLeft" align="right" valign="top">MasstreeStorageControlBlock *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a></td></tr>
<tr class="memdesc:af9f87c691e2df0b04322e6df8d7c0d81 inherit pro_attribs_classfoedus_1_1Attachable"><td class="mdescLeft">&#160;</td><td class="mdescRight">The shared data on shared memory that has been initialized in some SOC or master engine.  <a href="#af9f87c691e2df0b04322e6df8d7c0d81">More...</a><br /></td></tr>
<tr class="separator:af9f87c691e2df0b04322e6df8d7c0d81 inherit pro_attribs_classfoedus_1_1Attachable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a6f09fabd46975ec14b505d490c482031"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::storage::masstree::MasstreeStoragePimpl::MasstreeStoragePimpl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00100">100</a> of file <a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;: Attachable&lt;MasstreeStorageControlBlock&gt;() {}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3d3f0df49cb2be38472c10a794ba0d58"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">foedus::storage::masstree::MasstreeStoragePimpl::MasstreeStoragePimpl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html">MasstreeStorage</a> *&#160;</td>
          <td class="paramname"><em>storage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00101">101</a> of file <a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    : Attachable&lt;MasstreeStorageControlBlock&gt;(</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      storage-&gt;get_engine(),</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      storage-&gt;get_control_block()) {}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ad6c9eb02ad32cc1bffe9daac3521ad24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::approximate_count_root_children </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the count of direct children in the first-root node. </p>
<p>This is without lock, so it might not be accurate. </p>

<p>Definition at line <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00042">42</a> of file <a class="el" href="masstree__storage__fatify_8cpp_source.html">masstree_storage_fatify.cpp</a>.</p>

<p>References <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00032">foedus::storage::masstree::count_children_approximate()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">get_first_root()</a>, and <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00054">fatify_first_root()</a>, and <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00094">fatify_first_root_double()</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                 {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  *out = 0;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  MasstreeIntermediatePage* root;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">get_first_root</a>(context, <span class="keyword">true</span>, &amp;root));</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  *out = <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#aa275c1ef79668cf8c173ee51f0753dc3">count_children_approximate</a>(root);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_aa275c1ef79668cf8c173ee51f0753dc3"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#aa275c1ef79668cf8c173ee51f0753dc3">foedus::storage::masstree::count_children_approximate</a></div><div class="ttdeci">uint32_t count_children_approximate(const MasstreeIntermediatePage *page)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__fatify_8cpp_source.html#l00032">masstree_storage_fatify.cpp:32</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_adc32aaf6f4537fcc1ada207e1d6902ec"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">foedus::storage::masstree::MasstreeStoragePimpl::get_first_root</a></div><div class="ttdeci">ErrorCode get_first_root(thread::Thread *context, bool for_write, MasstreeIntermediatePage **root)</div><div class="ttdoc">Root-node related, such as a method to retrieve 1st-root, to grow, etc. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00058">masstree_storage_pimpl.cpp:58</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6c9eb02ad32cc1bffe9daac3521ad24_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6c9eb02ad32cc1bffe9daac3521ad24_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6c9eb02ad32cc1bffe9daac3521ad24_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6c9eb02ad32cc1bffe9daac3521ad24_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1storage_1_1masstree.html#aa275c1ef79668cf8c173ee51f0753dc3" title="foedus::storage::masstree\l::count_children_approximate" alt="" coords="227,79,419,120"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="236,437,409,493"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="471,5,678,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="482,71,667,127"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer\l_address" alt="" coords="488,297,661,368"/>
<area shape="rect" id="node7" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="499,444,650,485"/>
<area shape="rect" id="node18" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="2013,476,2167,517"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="487,509,662,551"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="473,575,677,616"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="470,640,679,681"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="488,705,661,747"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="467,1055,683,1096"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="488,151,661,207"/>
<area shape="rect" id="node45" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="499,232,650,273"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="735,729,919,771"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1501,925,1663,967"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="2015,796,2165,837"/>
<area shape="rect" id="node12" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1477,1159,1687,1200"/>
<area shape="rect" id="node15" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1490,727,1674,783"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1501,991,1663,1032"/>
<area shape="rect" id="node17" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1768,549,1923,591"/>
<area shape="rect" id="node20" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343" title="Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v..." alt="" coords="1222,839,1409,880"/>
<area shape="rect" id="node22" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1481,611,1683,652"/>
<area shape="rect" id="node25" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="975,1028,1159,1069"/>
<area shape="rect" id="node26" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1211,1375,1420,1416"/>
<area shape="rect" id="node35" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="997,444,1136,485"/>
<area shape="rect" id="node36" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="996,509,1137,551"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="2009,1049,2171,1091"/>
<area shape="rect" id="node13" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ac661b8baf462a1e969a8a1c7e619858b" title="foedus::memory::PagePool\lOffsetChunk::empty" alt="" coords="2001,1305,2179,1347"/>
<area shape="rect" id="node14" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#af897b38ac1ef4217ff99018436c0112e" title="foedus::memory::PagePool\lOffsetChunk::pop_back" alt="" coords="1756,1276,1935,1317"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1995,549,2185,591"/>
<area shape="rect" id="node21" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a6c9bf7d6b21ac33a61d6f7176023ea3a" title="Returns one free volatile page to local page pool. " alt="" coords="1468,808,1696,849"/>
<area shape="rect" id="node23" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1759,615,1932,656"/>
<area shape="rect" id="node24" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1744,469,1947,525"/>
<area shape="rect" id="node34" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="1223,1158,1407,1214"/>
<area shape="rect" id="node27" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="1515,1407,1649,1448"/>
<area shape="rect" id="node28" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="1479,1472,1685,1513"/>
<area shape="rect" id="node29" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8" title="foedus::memory::PagePool\l::get_base" alt="" coords="1756,1556,1935,1597"/>
<area shape="rect" id="node30" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="1490,1589,1674,1631"/>
<area shape="rect" id="node31" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="1753,1635,1937,1676"/>
<area shape="rect" id="node32" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="1479,1276,1685,1317"/>
<area shape="rect" id="node33" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8" title="Get a tentative work memory of the specified size from pre&#45;allocated thread&#45;private memory..." alt="" coords="1501,1341,1663,1383"/>
<area shape="rect" id="node42" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="731,1197,923,1239"/>
<area shape="rect" id="node43" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="971,1340,1163,1381"/>
<area shape="rect" id="node46" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="735,232,919,273"/>
<area shape="rect" id="node47" href="classfoedus_1_1xct_1_1Xct.html#aca66ae9959651b7c6fa86a75db287f54" title="foedus::xct::Xct::get\l_sysxct_workspace" alt="" coords="997,247,1136,288"/>
<area shape="rect" id="node48" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761" title="foedus::thread::ThreadPimpl\l::cll_get_max_locked_id" alt="" coords="975,312,1159,353"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4" title="foedus::thread::ThreadPimpl\l::is_simple_mcs_rw" alt="" coords="975,116,1159,157"/>
<area shape="rect" id="node50" href="group__SYSXCT.html#gaf49955c6d4efe3d92e6e09b4ff890618" title="Runs a system transaction nested in a user transaction. " alt="" coords="987,181,1146,223"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6c9eb02ad32cc1bffe9daac3521ad24_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6c9eb02ad32cc1bffe9daac3521ad24_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6c9eb02ad32cc1bffe9daac3521ad24_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6c9eb02ad32cc1bffe9daac3521ad24_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ac3b15bb4f888327ba49050f62d020f52" title="Defined in masstree_storage_fatify.cpp. " alt="" coords="448,13,621,69"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a32332060560b864a857a839bb0adb4fd" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::fatify_first_root_double" alt="" coords="227,45,400,101"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a70b1c5e023fa0aac150e7b607e37727c" title="Deliberately causes splits under the volatile root of first layer, or &quot;fatify&quot; it. " alt="" coords="669,13,843,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::check_next_layer_bit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1xct_1_1XctId.html">xct::XctId</a>&#160;</td>
          <td class="paramname"><em>observed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00589">589</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="xct__id_8hpp_source.html#l01042">foedus::xct::XctId::is_next_layer()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00200">foedus::kErrorCodeXctRaceAbort</a>, and <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00691">delete_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00806">increment_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00661">insert_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00772">overwrite_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00599">retrieve_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00625">retrieve_part_general()</a>, and <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00711">upsert_general()</a>.</p>
<div class="fragment"><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                                                             {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(observed.is_next_layer())) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">// this should have been checked before this method and resolved as abort or retry,</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">// but if it reaches here for some reason, we treat it as usual contention abort.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    DLOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Probably this should be caught beforehand. next_layer bit is on&quot;</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56aa5f11dac739aec74f9a79d67faa13596">kErrorCodeXctRaceAbort</a>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56aa5f11dac739aec74f9a79d67faa13596"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56aa5f11dac739aec74f9a79d67faa13596">foedus::kErrorCodeXctRaceAbort</a></div><div class="ttdoc">0x0A05 : "XCTION : Aborted a transaction because of a race condition. This is an expected error in hi...</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00200">error_code.hpp:200</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="227,13,349,54"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a45396b70b246f330355397b447af55f3" title="implementation of delete_record family. " alt="" coords="227,90,400,146"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa71566d3a4d56ded35df567784b13525" title="implementation of increment_record family. " alt="" coords="227,298,400,354"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#af0b96482a874777c4871a152ad733da3" title="implementation of insert_record family. " alt="" coords="227,481,400,537"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ab9cc59cbbef3fd23a62cbd25cbd00abb" title="implementation of overwrite_record family. " alt="" coords="227,726,400,782"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a8e24325e4b203cb3e2008283c6ef0c89" title="implementation of get_record family. " alt="" coords="227,983,400,1039"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ae301e3aa587aa907eed1f6ae1ec5edb0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::retrieve_part_general" alt="" coords="227,1179,400,1235"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aeeccc272d2f9a4d895f4d117f6b96b27" title="implementation of upsert_record family. " alt="" coords="227,1413,400,1469"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#af263fb1494c7ac6a5dbfd28b926ede3b" title="foedus::storage::masstree\l::MasstreeCursor::delete_record" alt="" coords="463,5,671,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="741,97,956,139"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="480,122,653,178"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a81ce493961aa7dedc518ca4230d01868" title="foedus::storage::masstree\l::MasstreeCursor::increment_record" alt="" coords="451,203,682,244"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="448,268,685,309"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="469,334,664,390"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="461,415,673,456"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="480,481,653,537"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#ab8b1919cb195dd063be409f772b36630" title="foedus::storage::masstree\l::MasstreeCursor::overwrite_record" alt="" coords="455,561,678,603"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a496370a645284f8578875529c6eacb0f" title="foedus::storage::masstree\l::MasstreeCursor::overwrite\l_record_primitive" alt="" coords="477,627,657,683"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="733,773,964,815"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="473,758,660,814"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="473,838,660,894"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="472,918,661,974"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#acdf38eea62d1432e3715a661d0790caf" title="Retrieves an entire record of the given key in this Masstree. " alt="" coords="749,1024,948,1065"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a4f2492b6a04c2db18cdf2a4a2d7fecc0" title="Retrieves an entire record of the given primitive key in this Masstree. " alt="" coords="480,1049,653,1105"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a01a2996a1ee370611b72c88f33fe2753" title="Retrieves a part of the given key in this Masstree. " alt="" coords="762,1158,935,1214"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a3be736c76c38dd23444cbd78947a63fd" title="Retrieves a part of the given key in this Masstree as a primitive value. " alt="" coords="480,1179,653,1235"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adda60c43db1237644270e90f2a255d35" title="Retrieves a part of the given primitive key in this Masstree. " alt="" coords="480,1259,653,1315"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae4bf2da94babc15bf43bd50b17ffb562" title="Retrieves a part of the given primitive key in this Masstree as a primitive value. " alt="" coords="472,1339,661,1395"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="459,1420,675,1461"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="480,1486,653,1542"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a192a4976aa71f457b356bf536d9f5fc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::create </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeMetadata.html">MasstreeMetadata</a> &amp;&#160;</td>
          <td class="paramname"><em>metadata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00164">164</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>, <a class="el" href="error__stack_8hpp_source.html#l00480">ERROR_STACK</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00111">exists()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00113">get_name()</a>, <a class="el" href="error__code_8hpp_source.html#l00168">foedus::kErrorCodeStrAlreadyExists</a>, <a class="el" href="storage__id_8hpp_source.html#l00158">foedus::storage::kExists</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, and <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00122">load_empty()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00063">foedus::storage::masstree::MasstreeStorage::create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                                                        {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4a025ff60e7c0717967a091f2c1e01fb">exists</a>()) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;This masstree-storage already exists: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">get_name</a>();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#gaa598b0ca7f0de626ecfa17f2cd58d5b4">ERROR_STACK</a>(<a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a0a03edf7d6ab7385275f50b23173dce8">kErrorCodeStrAlreadyExists</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_ = metadata;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a9c2b2febfce356451e8183f66f71dcc3">load_empty</a>());</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;status_ = <a class="code" href="group__STORAGE.html#ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1">kExists</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Newly created an masstree-storage &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">get_name</a>();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a94e2b69404cabddbead1d1fb0ef1dc42"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">foedus::storage::masstree::MasstreeStoragePimpl::get_name</a></div><div class="ttdeci">const StorageName &amp; get_name() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00113">masstree_storage_pimpl.hpp:113</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa598b0ca7f0de626ecfa17f2cd58d5b4"><div class="ttname"><a href="group__ERRORCODES.html#gaa598b0ca7f0de626ecfa17f2cd58d5b4">ERROR_STACK</a></div><div class="ttdeci">#define ERROR_STACK(e)        </div><div class="ttdoc">Instantiates ErrorStack with the given foedus::error_code, creating an error stack with the current f...</div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00480">error_stack.hpp:480</a></div></div>
<div class="ttc" id="group__STORAGE_html_ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1"><div class="ttname"><a href="group__STORAGE.html#ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1">foedus::storage::kExists</a></div><div class="ttdoc">The storage has been created and ready for use. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00158">storage_id.hpp:158</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a4a025ff60e7c0717967a091f2c1e01fb"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4a025ff60e7c0717967a091f2c1e01fb">foedus::storage::masstree::MasstreeStoragePimpl::exists</a></div><div class="ttdeci">bool exists() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00111">masstree_storage_pimpl.hpp:111</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a0a03edf7d6ab7385275f50b23173dce8"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a0a03edf7d6ab7385275f50b23173dce8">foedus::kErrorCodeStrAlreadyExists</a></div><div class="ttdoc">0x0802 : "STORAGE: This storage already exists" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00168">error_code.hpp:168</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a9c2b2febfce356451e8183f66f71dcc3"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a9c2b2febfce356451e8183f66f71dcc3">foedus::storage::masstree::MasstreeStoragePimpl::load_empty</a></div><div class="ttdeci">ErrorStack load_empty()</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00122">masstree_storage_pimpl.cpp:122</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a192a4976aa71f457b356bf536d9f5fc2_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a192a4976aa71f457b356bf536d9f5fc2_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a192a4976aa71f457b356bf536d9f5fc2_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a192a4976aa71f457b356bf536d9f5fc2_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4a025ff60e7c0717967a091f2c1e01fb" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::exists" alt="" coords="227,173,400,229"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_name" alt="" coords="227,253,400,309"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a9c2b2febfce356451e8183f66f71dcc3" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::load_empty" alt="" coords="227,333,400,389"/>
<area shape="rect" id="node5" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="486,5,621,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8" title="foedus::memory::EngineMemory\l::get_node_memory" alt="" coords="448,71,659,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774" title="foedus::memory::NumaNode\lMemoryRef::get_volatile_pool" alt="" coords="458,136,649,177"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e" title="Gives an object to resolve an offset in this page pool (thus local) to an actual pointer and vice ver..." alt="" coords="464,201,643,243"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1PagePool.html#a3e9390381783077a504116988cae05c4" title="Grab only one page. " alt="" coords="464,267,643,308"/>
<area shape="rect" id="node18" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="461,333,645,389"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ab25cb34a8304c744bf309cc02b515e72" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::initialize_volatile_page" alt="" coords="461,463,646,519"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="707,433,892,489"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="467,543,640,599"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="473,624,634,665"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a5ab741ff207d274efcb4a5664880600f" title="foedus::storage::masstree\l::MasstreeBorderPage::initialize\l_volatile_page" alt="" coords="450,690,657,746"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#ae901dc06f6b6f4594626ed0b233daec6" title="foedus::memory::PagePool\lPimpl::get_resolver" alt="" coords="710,201,889,243"/>
<area shape="rect" id="node11" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a3293a43a76f3720cf5c92c5fbcf2d02f" title="foedus::memory::PagePool\lPimpl::grab_one" alt="" coords="710,267,889,308"/>
<area shape="rect" id="node12" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a1a41295b63274fb300e5937a9bb1eca7" title="foedus::memory::PagePool\lPimpl::decrease_free_pool_count" alt="" coords="940,191,1155,232"/>
<area shape="rect" id="node13" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#aa545fc1cffac905225d3a7c7c457b5a8" title="foedus::memory::PagePool\lPimpl::free_pool_head" alt="" coords="958,256,1137,297"/>
<area shape="rect" id="node14" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#abd594ac94d8ac0445ebef734b7305fb6" title="foedus::memory::PagePool\lPimpl::get_debug_pool_name" alt="" coords="951,321,1144,363"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="958,387,1137,428"/>
<area shape="rect" id="node15" href="classfoedus_1_1assorted_1_1FixedString.html#a3269f7c68f175a1fd42e78110a57cbf2" title="Test if string is empty. " alt="" coords="1214,292,1406,333"/>
<area shape="rect" id="node16" href="classfoedus_1_1assorted_1_1FixedString.html#a16f6de0859f599127e2d4a51a6537a01" title="Convert to a std::string object. " alt="" coords="1203,358,1417,385"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa95b56b38e523e345e5fb0283e43d65e" title="foedus::storage::masstree\l::MasstreePage::initialize\l_volatile_common" alt="" coords="713,534,886,590"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="944,481,1151,523"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1PageHeader.html#a5a84eed10b8675e5df2f35f791991eb5" title="foedus::storage::PageHeader\l::init_volatile" alt="" coords="952,547,1143,588"/>
<area shape="rect" id="node24" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="1211,513,1409,555"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1PageVersion.html#ae40168c82f16645e85bb66f9019e53cf" title="used only while page initialization " alt="" coords="1214,579,1406,620"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1PageVersionStatus.html#af49ef4f3320148130f46f494f1c845aa" title="foedus::storage::PageVersion\lStatus::reset" alt="" coords="1465,545,1657,587"/>
<area shape="rect" id="node27" href="structfoedus_1_1xct_1_1McsWwLock.html#a4114c2dec151ad650a294dedac4f239d" title="used only while page initialization " alt="" coords="1477,611,1646,652"/>
<area shape="rect" id="node28" href="structfoedus_1_1xct_1_1McsWwBlockData.html#a3161e47c41388e9c1b50929f585e366b" title="foedus::xct::McsWwBlockData\l::clear" alt="" coords="1705,611,1907,652"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a192a4976aa71f457b356bf536d9f5fc2_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a192a4976aa71f457b356bf536d9f5fc2_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a192a4976aa71f457b356bf536d9f5fc2_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a192a4976aa71f457b356bf536d9f5fc2_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a92ad35031262ae95e767c53746de2e29" title="foedus::storage::masstree\l::MasstreeStorage::create" alt="" coords="227,13,400,54"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a41e664c7035f1b89121ef06678a71386"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::debugout_single_thread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>volatile_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>max_pages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>These are defined in <a class="el" href="masstree__storage__debug_8cpp.html">masstree_storage_debug.cpp</a>. </p>

<p>Definition at line <a class="el" href="masstree__storage__debug_8cpp_source.html#l00036">36</a> of file <a class="el" href="masstree__storage__debug_8cpp_source.html">masstree_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>, <a class="el" href="masstree__storage__debug_8cpp_source.html#l00122">debugout_single_thread_follow()</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a>, <a class="el" href="initializable_8hpp_source.html#l00169">foedus::DefaultInitializable::initialize()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="initializable_8hpp_source.html#l00243">foedus::UninitializeGuard::kWarnIfUninitializeError</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, <a class="el" href="initializable_8hpp_source.html#l00187">foedus::DefaultInitializable::uninitialize()</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00579">foedus::storage::masstree::MasstreeStorage::debugout_single_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                      {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;**&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***************************************************************&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***   Dumping &quot;</span> &lt;&lt; MasstreeStorage(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>, <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>) &lt;&lt; <span class="stringliteral">&quot; in details. &quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;*** volatile_only=&quot;</span> &lt;&lt; volatile_only &lt;&lt; <span class="stringliteral">&quot;, max_pages=&quot;</span> &lt;&lt; max_pages</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***************************************************************&quot;</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  cache::SnapshotFileSet files(engine);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(files.initialize());</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  UninitializeGuard files_guard(&amp;files, <a class="code" href="classfoedus_1_1UninitializeGuard.html#ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568">UninitializeGuard::kWarnIfUninitializeError</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;First, dumping volatile pages...&quot;</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  DualPagePointer pointer = <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">if</span> (pointer.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;No volatile pages.&quot;</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    uint32_t remaining = max_pages;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7">debugout_single_thread_follow</a>(engine, &amp;files, pointer, <span class="keyword">true</span>, &amp;remaining));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Dumped volatile pages.&quot;</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (!volatile_only) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Now dumping snapshot pages...&quot;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">if</span> (pointer.snapshot_pointer_ == 0) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;No snapshot pages.&quot;</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      uint32_t remaining = max_pages;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7">debugout_single_thread_follow</a>(engine, &amp;files, pointer, <span class="keyword">false</span>, &amp;remaining));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Dumped snapshot pages.&quot;</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(files.uninitialize());</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1UninitializeGuard_html_ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568"><div class="ttname"><a href="classfoedus_1_1UninitializeGuard.html#ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568">foedus::UninitializeGuard::kWarnIfUninitializeError</a></div><div class="ttdoc">Automatically calls if uninitialize() wasn&#39;t called when it gets out of scope, and just complains whe...</div><div class="ttdef"><b>Definition:</b> <a href="initializable_8hpp_source.html#l00243">initializable.hpp:243</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_adb503d118f53a417bf11f9e486bd3cf7"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7">foedus::storage::masstree::MasstreeStoragePimpl::debugout_single_thread_follow</a></div><div class="ttdeci">ErrorStack debugout_single_thread_follow(Engine *engine, cache::SnapshotFileSet *fileset, const DualPagePointer &amp;pointer, bool follow_volatile, uint32_t *remaining_pages)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__debug_8cpp_source.html#l00122">masstree_storage_debug.cpp:122</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a41e664c7035f1b89121ef06678a71386_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a41e664c7035f1b89121ef06678a71386_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a41e664c7035f1b89121ef06678a71386_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a41e664c7035f1b89121ef06678a71386_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread_follow" alt="" coords="227,809,433,865"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="507,149,669,191"/>
<area shape="rect" id="node45" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff" title="Typical implementation of Initializable::initialize() that provides initialize&#45;once semantics..." alt="" coords="244,1177,416,1219"/>
<area shape="rect" id="node50" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb" title="Typical implementation of Initializable::uninitialize() that provides uninitialize&#45;once semantics..." alt="" coords="244,1243,416,1284"/>
<area shape="rect" id="node5" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="521,965,655,1007"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="483,1031,693,1087"/>
<area shape="rect" id="node7" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="487,215,689,256"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread\l_recurse" alt="" coords="501,543,675,613"/>
<area shape="rect" id="node24" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e" title="Allocate a memory, releasing the current memory if exists. " alt="" coords="481,783,695,824"/>
<area shape="rect" id="node37" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="481,848,695,889"/>
<area shape="rect" id="node38" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="767,1257,954,1299"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1049,5,1211,47"/>
<area shape="rect" id="node8" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="783,112,938,153"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1055,72,1205,113"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="774,177,947,219"/>
<area shape="rect" id="node13" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="759,243,962,299"/>
<area shape="rect" id="node9" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1053,140,1207,181"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1035,211,1225,252"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1281,492,1488,533"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="773,324,948,365"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="767,390,955,446"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="771,470,950,526"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="743,550,979,606"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1027,288,1233,329"/>
<area shape="rect" id="node19" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="1069,353,1191,395"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="1041,419,1219,475"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="1037,550,1223,606"/>
<area shape="rect" id="node25" href="namespacefoedus_1_1memory.html#ac2422aa4fe378da8a9594901762e17df" title="foedus::memory::alloc_mmap" alt="" coords="1033,790,1227,817"/>
<area shape="rect" id="node27" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1315,1155,1455,1196"/>
<area shape="rect" id="node28" href="namespacefoedus_1_1memory.html#ae51e4a90f52316ba9dce8ff783f30d84" title="foedus::memory::alloc\l_mmap_1gb_pages" alt="" coords="785,783,936,824"/>
<area shape="rect" id="node29" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="1049,907,1211,948"/>
<area shape="rect" id="node30" href="group__ASSORTED.html#gab3d1892edaa7db4b02029567b7993f37" title="In order to run even on a non&#45;numa machine or a machine with fewer sockets, we allow specifying arbit..." alt="" coords="785,1016,936,1057"/>
<area shape="rect" id="node31" href="numa_8h.html#a413cadd87796fff247c83d9ad817cc7e" title="numa_available" alt="" coords="1075,973,1185,999"/>
<area shape="rect" id="node33" href="numa_8h.html#aba49c14c68d23dc05d046db02766b928" title="numa_preferred" alt="" coords="805,1082,916,1109"/>
<area shape="rect" id="node34" href="numa_8h.html#a56f33968932f6550e5e5eb4d1acc67b3" title="numa_set_preferred" alt="" coords="793,681,929,707"/>
<area shape="rect" id="node35" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="793,848,928,889"/>
<area shape="rect" id="node26" href="namespacefoedus_1_1memory.html#af6145d9296231995c84badafb6a2a0a9" title="Returns if 1GB hugepages were enabled. " alt="" coords="1302,783,1467,824"/>
<area shape="rect" id="node32" href="numa_8h.html#a22585176d6e08c221de8377637bd72a7" title="numa_num_configured\l_nodes" alt="" coords="1054,1024,1206,1065"/>
<area shape="rect" id="node36" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="1063,841,1197,883"/>
<area shape="rect" id="node39" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="1030,1250,1230,1306"/>
<area shape="rect" id="node40" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="1037,1396,1223,1437"/>
<area shape="rect" id="node43" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="1055,1184,1205,1225"/>
<area shape="rect" id="node44" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="1055,1331,1205,1372"/>
<area shape="rect" id="node41" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1291,1429,1479,1485"/>
<area shape="rect" id="node42" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1289,1349,1480,1405"/>
<area shape="rect" id="node46" href="classfoedus_1_1DefaultInitializable.html#ab8ae37e5f20f312f8b945fc40d3e0250" title="foedus::DefaultInitializable\l::initialize_once" alt="" coords="502,1112,674,1153"/>
<area shape="rect" id="node47" href="classfoedus_1_1ErrorStack.html#a9c7b3a8b3806ff623c7fb4a9db5cbeec" title="Returns if this return code is not kErrorCodeOk. " alt="" coords="523,1177,653,1219"/>
<area shape="rect" id="node48" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="502,1243,674,1284"/>
<area shape="rect" id="node49" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b" title="foedus::DefaultInitializable\l::uninitialize_once" alt="" coords="502,1308,674,1349"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a41e664c7035f1b89121ef06678a71386_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a41e664c7035f1b89121ef06678a71386_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a41e664c7035f1b89121ef06678a71386_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a41e664c7035f1b89121ef06678a71386_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a9d2f5eb65777d851bee6809acf6fe153" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="227,5,417,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adb503d118f53a417bf11f9e486bd3cf7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::debugout_single_thread_follow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *&#160;</td>
          <td class="paramname"><em>fileset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html">DualPagePointer</a> &amp;&#160;</td>
          <td class="paramname"><em>pointer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>follow_volatile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>remaining_pages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__debug_8cpp_source.html#l00122">122</a> of file <a class="el" href="masstree__storage__debug_8cpp_source.html">masstree_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="aligned__memory_8cpp_source.html#l00113">foedus::memory::AlignedMemory::alloc()</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="masstree__storage__debug_8cpp_source.html#l00075">debugout_single_thread_recurse()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00168">foedus::memory::AlignedMemory::get_block()</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="aligned__memory_8hpp_source.html#l00083">foedus::memory::AlignedMemory::kNumaAllocOnnode</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="snapshot__file__set_8cpp_source.html#l00095">foedus::cache::SnapshotFileSet::read_page()</a>, <a class="el" href="page__resolver_8hpp_source.html#l00120">foedus::memory::GlobalVolatilePageResolver::resolve_offset()</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>, and <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__debug_8cpp_source.html#l00036">debugout_single_thread()</a>, and <a class="el" href="masstree__storage__debug_8cpp_source.html#l00075">debugout_single_thread_recurse()</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                             {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">if</span> ((*remaining_pages) == 0) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">if</span> (follow_volatile) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (!pointer.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;     MasstreePage* page = <span class="keyword">reinterpret_cast&lt;</span>MasstreePage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;       engine-&gt;get_memory_manager()-&gt;get_global_volatile_page_resolver().resolve_offset(</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        pointer.volatile_pointer_));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7">debugout_single_thread_recurse</a>(engine, files, page, <span class="keyword">true</span>, remaining_pages));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">if</span> (pointer.snapshot_pointer_ != 0) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      memory::AlignedMemory buf;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      buf.alloc(1 &lt;&lt; 12U, 1 &lt;&lt; 12U, <a class="code" href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">memory::AlignedMemory::kNumaAllocOnnode</a>, 0);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      MasstreePage* page = <span class="keyword">reinterpret_cast&lt;</span>MasstreePage*<span class="keyword">&gt;</span>(buf.get_block());</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(files-&gt;read_page(pointer.snapshot_pointer_, page));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7">debugout_single_thread_recurse</a>(engine, files, page, <span class="keyword">false</span>, remaining_pages));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1memory_1_1AlignedMemory_html_a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225"><div class="ttname"><a href="classfoedus_1_1memory_1_1AlignedMemory.html#a57abf88bfdff732d23c00b6738567a43a104f4cb2cd45d6529e9b3096c552c225">foedus::memory::AlignedMemory::kNumaAllocOnnode</a></div><div class="ttdoc">numa_alloc_onnode() and numa_free(). </div><div class="ttdef"><b>Definition:</b> <a href="aligned__memory_8hpp_source.html#l00083">aligned_memory.hpp:83</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a6358da556d81e06726320b30c78755f7"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7">foedus::storage::masstree::MasstreeStoragePimpl::debugout_single_thread_recurse</a></div><div class="ttdeci">ErrorStack debugout_single_thread_recurse(Engine *engine, cache::SnapshotFileSet *fileset, MasstreePage *parent, bool follow_volatile, uint32_t *remaining_pages)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__debug_8cpp_source.html#l00075">masstree_storage_debug.cpp:75</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adb503d118f53a417bf11f9e486bd3cf7_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adb503d118f53a417bf11f9e486bd3cf7_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adb503d118f53a417bf11f9e486bd3cf7_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adb503d118f53a417bf11f9e486bd3cf7_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e" title="Allocate a memory, releasing the current memory if exists. " alt="" coords="260,548,473,589"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread\l_recurse" alt="" coords="280,1053,453,1124"/>
<area shape="rect" id="node28" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="260,1324,473,1365"/>
<area shape="rect" id="node29" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="261,1390,472,1446"/>
<area shape="rect" id="node30" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="299,1471,434,1512"/>
<area shape="rect" id="node31" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="286,1193,447,1235"/>
<area shape="rect" id="node33" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="546,209,733,251"/>
<area shape="rect" id="node45" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="265,1259,468,1300"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1memory.html#ac2422aa4fe378da8a9594901762e17df" title="foedus::memory::alloc_mmap" alt="" coords="812,530,1005,557"/>
<area shape="rect" id="node5" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1101,267,1241,308"/>
<area shape="rect" id="node6" href="namespacefoedus_1_1memory.html#ae51e4a90f52316ba9dce8ff783f30d84" title="foedus::memory::alloc\l_mmap_1gb_pages" alt="" coords="564,464,715,505"/>
<area shape="rect" id="node7" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="828,399,989,440"/>
<area shape="rect" id="node8" href="group__ASSORTED.html#gab3d1892edaa7db4b02029567b7993f37" title="In order to run even on a non&#45;numa machine or a machine with fewer sockets, we allow specifying arbit..." alt="" coords="564,683,715,724"/>
<area shape="rect" id="node9" href="numa_8h.html#a413cadd87796fff247c83d9ad817cc7e" title="numa_available" alt="" coords="853,631,964,658"/>
<area shape="rect" id="node11" href="numa_8h.html#aba49c14c68d23dc05d046db02766b928" title="numa_preferred" alt="" coords="584,530,695,557"/>
<area shape="rect" id="node12" href="numa_8h.html#a56f33968932f6550e5e5eb4d1acc67b3" title="numa_set_preferred" alt="" coords="571,749,707,775"/>
<area shape="rect" id="node13" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="572,399,707,440"/>
<area shape="rect" id="node4" href="namespacefoedus_1_1memory.html#af6145d9296231995c84badafb6a2a0a9" title="Returns if 1GB hugepages were enabled. " alt="" coords="1088,523,1253,564"/>
<area shape="rect" id="node10" href="numa_8h.html#a22585176d6e08c221de8377637bd72a7" title="numa_num_configured\l_nodes" alt="" coords="833,683,985,724"/>
<area shape="rect" id="node14" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="841,464,976,505"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1067,851,1274,892"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="552,1141,727,1183"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="545,901,733,957"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="550,1061,729,1117"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="521,981,757,1037"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="813,1193,1004,1235"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="805,851,1012,892"/>
<area shape="rect" id="node21" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="847,916,970,957"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="819,1113,998,1169"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="1060,1156,1281,1197"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="1081,1075,1260,1131"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="816,982,1001,1038"/>
<area shape="rect" id="node32" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="828,1259,989,1300"/>
<area shape="rect" id="node34" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="809,202,1009,258"/>
<area shape="rect" id="node35" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="815,333,1002,375"/>
<area shape="rect" id="node38" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="833,136,984,177"/>
<area shape="rect" id="node44" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="833,71,984,112"/>
<area shape="rect" id="node36" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1077,413,1265,469"/>
<area shape="rect" id="node37" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1075,333,1266,389"/>
<area shape="rect" id="node39" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="1099,5,1242,47"/>
<area shape="rect" id="node40" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="1095,201,1246,243"/>
<area shape="rect" id="node41" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="1095,136,1246,177"/>
<area shape="rect" id="node42" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="1103,71,1238,112"/>
<area shape="rect" id="node43" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="1329,71,1464,112"/>
<area shape="rect" id="node46" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="562,1259,717,1300"/>
<area shape="rect" id="node48" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="834,1431,983,1472"/>
<area shape="rect" id="node49" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="553,1405,726,1447"/>
<area shape="rect" id="node50" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="538,1325,741,1381"/>
<area shape="rect" id="node47" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="831,1328,986,1369"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adb503d118f53a417bf11f9e486bd3cf7_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adb503d118f53a417bf11f9e486bd3cf7_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adb503d118f53a417bf11f9e486bd3cf7_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adb503d118f53a417bf11f9e486bd3cf7_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a41e664c7035f1b89121ef06678a71386" title="These are defined in masstree_storage_debug.cpp. " alt="" coords="260,5,433,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6358da556d81e06726320b30c78755f7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread\l_recurse" alt="" coords="260,86,433,157"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a9d2f5eb65777d851bee6809acf6fe153" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="481,5,672,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6358da556d81e06726320b30c78755f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::debugout_single_thread_recurse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1cache_1_1SnapshotFileSet.html">cache::SnapshotFileSet</a> *&#160;</td>
          <td class="paramname"><em>fileset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>follow_volatile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>remaining_pages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__debug_8cpp_source.html#l00075">75</a> of file <a class="el" href="masstree__storage__debug_8cpp_source.html">masstree_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="masstree__storage__debug_8cpp_source.html#l00122">debugout_single_thread_follow()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00796">foedus::storage::masstree::MasstreeBorderPage::does_point_to_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00148">foedus::storage::masstree::MasstreePage::get_key_count()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00750">foedus::storage::masstree::MasstreeBorderPage::get_next_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00084">foedus::storage::masstree::MasstreePage::is_border()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01067">foedus::storage::masstree::MasstreeIntermediatePointerIterator::is_valid()</a>, and <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__debug_8cpp_source.html#l00122">debugout_single_thread_follow()</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                             {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">if</span> (((*remaining_pages) == 0) || --(*remaining_pages) == 0) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Reached write-out max. skip the following&quot;</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">// Implementation note:</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// So far we don&#39;t follow foster-twins in debugout_xxx, so this is irrelevant.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">// However, if we change it later to follow foster-twins,</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// do not forget about empty-range intermediate pages that only appear as foster twins.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// Empty-range border pages are fine. We just see zero records.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// Foster-twins are sooner or later adopted, and Master-Tree invariant for intermediate page</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// guarantees that we can just read the old page. no need to follow foster-twins.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  LOG(INFO) &lt;&lt; *parent;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  uint16_t key_count = parent-&gt;get_key_count();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (parent-&gt;is_border()) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    MasstreeBorderPage* casted = <span class="keyword">reinterpret_cast&lt;</span>MasstreeBorderPage*<span class="keyword">&gt;</span>(parent);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">for</span> (uint16_t i = 0; i &lt; key_count; ++i) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">if</span> (casted-&gt;does_point_to_layer(i)) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7">debugout_single_thread_follow</a>(</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          engine,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          files,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          *casted-&gt;get_next_layer(i),</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          follow_volatile,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          remaining_pages));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    MasstreeIntermediatePage* casted = <span class="keyword">reinterpret_cast&lt;</span>MasstreeIntermediatePage*<span class="keyword">&gt;</span>(parent);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">for</span> (MasstreeIntermediatePointerIterator it(casted); it.is_valid(); it.next()) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7">debugout_single_thread_follow</a>(</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        engine,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        files,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        it.get_pointer(),</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        follow_volatile,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        remaining_pages));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_adb503d118f53a417bf11f9e486bd3cf7"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7">foedus::storage::masstree::MasstreeStoragePimpl::debugout_single_thread_follow</a></div><div class="ttdeci">ErrorStack debugout_single_thread_follow(Engine *engine, cache::SnapshotFileSet *fileset, const DualPagePointer &amp;pointer, bool follow_volatile, uint32_t *remaining_pages)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__debug_8cpp_source.html#l00122">masstree_storage_debug.cpp:122</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6358da556d81e06726320b30c78755f7_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6358da556d81e06726320b30c78755f7_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6358da556d81e06726320b30c78755f7_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6358da556d81e06726320b30c78755f7_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread_follow" alt="" coords="241,775,448,831"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="251,1172,439,1228"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1544,1346,1751,1387"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="255,1259,434,1315"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="257,1102,432,1143"/>
<area shape="rect" id="node49" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="227,1404,463,1460"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1AlignedMemory.html#a5166bae2fdad9ffa0d5c279edfd3307e" title="Allocate a memory, releasing the current memory if exists. " alt="" coords="511,529,724,570"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1AlignedMemory.html#af306ba60622e2a87f75ae93dc6c597b1" title="Returns the memory block. " alt="" coords="511,635,724,677"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="512,701,723,757"/>
<area shape="rect" id="node18" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="550,782,685,823"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="537,847,698,889"/>
<area shape="rect" id="node21" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="789,166,976,207"/>
<area shape="rect" id="node32" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="516,923,719,965"/>
<area shape="rect" id="node4" href="namespacefoedus_1_1memory.html#ac2422aa4fe378da8a9594901762e17df" title="foedus::memory::alloc_mmap" alt="" coords="1045,639,1238,665"/>
<area shape="rect" id="node6" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1323,442,1463,483"/>
<area shape="rect" id="node7" href="namespacefoedus_1_1memory.html#ae51e4a90f52316ba9dce8ff783f30d84" title="foedus::memory::alloc\l_mmap_1gb_pages" alt="" coords="807,726,958,767"/>
<area shape="rect" id="node8" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="1061,507,1222,549"/>
<area shape="rect" id="node9" href="group__ASSORTED.html#gab3d1892edaa7db4b02029567b7993f37" title="In order to run even on a non&#45;numa machine or a machine with fewer sockets, we allow specifying arbit..." alt="" coords="807,289,958,330"/>
<area shape="rect" id="node10" href="numa_8h.html#a413cadd87796fff247c83d9ad817cc7e" title="numa_available" alt="" coords="1086,363,1197,389"/>
<area shape="rect" id="node12" href="numa_8h.html#aba49c14c68d23dc05d046db02766b928" title="numa_preferred" alt="" coords="827,675,938,701"/>
<area shape="rect" id="node13" href="numa_8h.html#a56f33968932f6550e5e5eb4d1acc67b3" title="numa_set_preferred" alt="" coords="815,405,951,432"/>
<area shape="rect" id="node14" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="815,558,950,599"/>
<area shape="rect" id="node5" href="namespacefoedus_1_1memory.html#af6145d9296231995c84badafb6a2a0a9" title="Returns if 1GB hugepages were enabled. " alt="" coords="1310,631,1475,673"/>
<area shape="rect" id="node11" href="numa_8h.html#a22585176d6e08c221de8377637bd72a7" title="numa_num_configured\l_nodes" alt="" coords="1065,297,1217,338"/>
<area shape="rect" id="node15" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="1074,573,1209,614"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1061,821,1222,862"/>
<area shape="rect" id="node22" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="1041,16,1241,72"/>
<area shape="rect" id="node23" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="1048,97,1235,138"/>
<area shape="rect" id="node26" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="1066,231,1217,273"/>
<area shape="rect" id="node31" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="1066,166,1217,207"/>
<area shape="rect" id="node24" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1299,85,1487,141"/>
<area shape="rect" id="node25" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1297,5,1488,61"/>
<area shape="rect" id="node27" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="1321,166,1464,207"/>
<area shape="rect" id="node28" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="1317,362,1468,403"/>
<area shape="rect" id="node29" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="1317,297,1468,338"/>
<area shape="rect" id="node30" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="1325,231,1460,273"/>
<area shape="rect" id="node33" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="805,923,960,965"/>
<area shape="rect" id="node35" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1067,979,1216,1021"/>
<area shape="rect" id="node37" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="796,989,969,1030"/>
<area shape="rect" id="node38" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="781,843,984,899"/>
<area shape="rect" id="node34" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1064,905,1219,946"/>
<area shape="rect" id="node36" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1046,1073,1237,1114"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1289,1214,1496,1255"/>
<area shape="rect" id="node42" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="556,1207,679,1249"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="528,1273,707,1329"/>
<area shape="rect" id="node45" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="772,1207,993,1249"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="793,1273,972,1329"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="1052,1207,1231,1263"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="525,1455,710,1511"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6358da556d81e06726320b30c78755f7_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6358da556d81e06726320b30c78755f7_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6358da556d81e06726320b30c78755f7_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6358da556d81e06726320b30c78755f7_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adb503d118f53a417bf11f9e486bd3cf7" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::debugout_single_thread_follow" alt="" coords="227,13,433,69"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a41e664c7035f1b89121ef06678a71386" title="These are defined in masstree_storage_debug.cpp. " alt="" coords="481,13,655,69"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a9d2f5eb65777d851bee6809acf6fe153" title="A super&#45;expensive and single&#45;thread only debugging feature to write out gigantic human&#45;readable texts..." alt="" coords="703,13,893,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a45396b70b246f330355397b447af55f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::delete_general </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>be_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a>&#160;</td>
          <td class="paramname"><em>key_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of delete_record family. </p>
<p>use with <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. ">locate_record()</a> </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00691">691</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="masstree__log__types_8hpp_source.html#l00354">foedus::storage::masstree::MasstreeDeleteLogType::calculate_log_length()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00589">check_next_layer_bit()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00112">get_id()</a>, <a class="el" href="thread_8hpp_source.html#l00066">foedus::thread::Thread::get_numa_node()</a>, <a class="el" href="thread_8cpp_source.html#l00078">foedus::thread::Thread::get_thread_log_buffer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00048">foedus::storage::masstree::RecordLocation::observed_</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00041">foedus::storage::masstree::RecordLocation::page_</a>, <a class="el" href="masstree__log__types_8hpp_source.html#l00358">foedus::storage::masstree::MasstreeDeleteLogType::populate()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00645">register_record_write_log()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">foedus::log::ThreadLogBuffer::reserve_new_log()</a>, and <a class="el" href="page_8hpp_source.html#l00251">foedus::storage::PageHeader::stat_last_updater_node_</a>.</p>

<p>Referenced by <a class="el" href="masstree__cursor_8cpp_source.html#l01305">foedus::storage::masstree::MasstreeCursor::delete_record()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00312">foedus::storage::masstree::MasstreeStorage::delete_record()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00333">foedus::storage::masstree::MasstreeStorage::delete_record_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">if</span> (location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">// in this case, we don&#39;t need a page-version set. the physical record is surely there.</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">check_next_layer_bit</a>(location.observed_));</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  MasstreeBorderPage* border = location.page_;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeDeleteLogType.html#a66a9832bd3efbb872578200928a219b9">MasstreeDeleteLogType::calculate_log_length</a>(key_length);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  MasstreeDeleteLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>MasstreeDeleteLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  log_entry-&gt;populate(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>(), be_key, key_length);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  border-&gt;header().stat_last_updater_node_ = context-&gt;get_numa_node();</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">register_record_write_log</a>(context, location, log_entry);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1masstree_1_1MasstreeDeleteLogType_html_a66a9832bd3efbb872578200928a219b9"><div class="ttname"><a href="structfoedus_1_1storage_1_1masstree_1_1MasstreeDeleteLogType.html#a66a9832bd3efbb872578200928a219b9">foedus::storage::masstree::MasstreeDeleteLogType::calculate_log_length</a></div><div class="ttdeci">static uint16_t calculate_log_length(KeyLength key_length) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__log__types_8hpp_source.html#l00354">masstree_log_types.hpp:354</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a3036d6662c0bd89e330ca19cbca1f549"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">foedus::storage::masstree::MasstreeStoragePimpl::register_record_write_log</a></div><div class="ttdeci">ErrorCode register_record_write_log(thread::Thread *context, const RecordLocation &amp;location, log::RecordLogType *log_entry)</div><div class="ttdoc">Used in the following methods. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00645">masstree_storage_pimpl.cpp:645</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aca6d912133fd8b46eacb660b840bada0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">foedus::storage::masstree::MasstreeStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00112">masstree_storage_pimpl.hpp:112</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">foedus::storage::masstree::MasstreeStoragePimpl::check_next_layer_bit</a></div><div class="ttdeci">static ErrorCode check_next_layer_bit(xct::XctId observed) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00589">masstree_storage_pimpl.cpp:589</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a45396b70b246f330355397b447af55f3_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a45396b70b246f330355397b447af55f3_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a45396b70b246f330355397b447af55f3_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a45396b70b246f330355397b447af55f3_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeDeleteLogType.html#a66a9832bd3efbb872578200928a219b9" title="foedus::storage::masstree\l::MasstreeDeleteLogType\l::calculate_log_length" alt="" coords="233,5,407,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::check_next_layer_bit" alt="" coords="233,85,407,141"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="485,295,659,351"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="245,166,395,207"/>
<area shape="rect" id="node11" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="243,283,397,325"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="233,349,407,390"/>
<area shape="rect" id="node13" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="259,414,381,455"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeDeleteLogType.html#a8f2fd3207f8a7a2f67668c4cc293e24f" title="foedus::storage::masstree\l::MasstreeDeleteLogType\l::populate" alt="" coords="233,480,407,536"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549" title="Used in the following methods. " alt="" coords="233,560,407,616"/>
<area shape="rect" id="node38" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="227,1046,413,1087"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3" title="foedus::storage::masstree\l::MasstreeCommonLogType\l::calculate_log_length" alt="" coords="480,5,664,61"/>
<area shape="rect" id="node4" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="744,20,904,47"/>
<area shape="rect" id="node6" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="511,93,633,134"/>
<area shape="rect" id="node9" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="483,225,661,266"/>
<area shape="rect" id="node10" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="497,159,647,201"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="483,592,661,648"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="461,673,683,714"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="497,410,647,451"/>
<area shape="rect" id="node23" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="501,475,643,517"/>
<area shape="rect" id="node26" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="753,533,895,574"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="965,745,1172,786"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1220,745,1427,786"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="735,737,913,793"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="735,657,913,713"/>
<area shape="rect" id="node24" href="group__LOGTYPE.html#gad2d33090f44d00949a05c245e5ff1046" title="Invokes the assertion logic of each log type. " alt="" coords="1004,467,1133,509"/>
<area shape="rect" id="node25" href="structfoedus_1_1log_1_1LogHeader.html#a6ebe3b99442f2a58a4adeeb60f9a37e0" title="Convenience method to cast into LogCode. " alt="" coords="1246,455,1401,497"/>
<area shape="rect" id="node27" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a1ff8ccbccdede750fb5a18b4da505ad9" title="foedus::xct::Retrospective\lLockList::get_volatile\l_page_resolver" alt="" coords="983,664,1155,720"/>
<area shape="rect" id="node28" href="namespacefoedus_1_1storage.html#a263602e0a73eedbe5f32128635106e17" title="foedus::storage::assert\l_within_valid_volatile_page" alt="" coords="981,533,1156,574"/>
<area shape="rect" id="node34" href="structfoedus_1_1xct_1_1RecordXctAccess.html#ace820ba89437e4d3a59fdb47a47525ba" title="Calculate owner_lock_id using the resolver. " alt="" coords="968,598,1169,639"/>
<area shape="rect" id="node29" href="namespacefoedus_1_1storage.html#ad38ebb5eb992249a7b42001fe464ec48" title="foedus::storage::assert\l_within_valid_volatile\l_page_impl" alt="" coords="1246,521,1401,577"/>
<area shape="rect" id="node30" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1725,494,1899,535"/>
<area shape="rect" id="node31" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1737,573,1887,614"/>
<area shape="rect" id="node32" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1475,539,1677,581"/>
<area shape="rect" id="node33" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="1493,437,1659,464"/>
<area shape="rect" id="node35" href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748" title="foedus::xct::xct_id\l_to_universal_lock_id" alt="" coords="1251,667,1396,709"/>
<area shape="rect" id="node37" href="structfoedus_1_1xct_1_1RecordXctAccess.html#adf2e2a9d414bf5cfe86f33198ebdf434" title="Setter for owner_id_address_/owner_lock_id_. " alt="" coords="1225,602,1422,643"/>
<area shape="rect" id="node36" href="namespacefoedus_1_1xct.html#a94b21516b530d0be271c6005a72009ad" title="foedus::xct::to_universal\l_lock_id" alt="" coords="1495,667,1657,709"/>
<area shape="rect" id="node39" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="479,1079,665,1121"/>
<area shape="rect" id="node40" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="731,1210,917,1251"/>
<area shape="rect" id="node42" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="479,1014,665,1055"/>
<area shape="rect" id="node41" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5" title="Subtract operator, considering wrapping around. " alt="" coords="975,1210,1162,1251"/>
<area shape="rect" id="node43" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6" title="Only for Debug&#45;assertion. " alt="" coords="731,883,917,925"/>
<area shape="rect" id="node45" href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc" title="See Log Manager. " alt="" coords="757,949,891,990"/>
<area shape="rect" id="node46" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="757,1014,891,1055"/>
<area shape="rect" id="node47" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="737,1079,911,1121"/>
<area shape="rect" id="node48" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7" title="Equivalent to std::atomic_thread_fence(std::memory_order_release). " alt="" coords="737,1145,911,1186"/>
<area shape="rect" id="node49" href="classfoedus_1_1log_1_1LogManager.html#a5c844c3bc8d71ce709999fd286a5e7b8" title="Wake up loggers if they are sleeping. " alt="" coords="742,818,906,859"/>
<area shape="rect" id="node44" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a05db4e7c61f07d2320aa7b2c3c76d520" title="Only for Debug&#45;assertion. " alt="" coords="975,883,1162,925"/>
<area shape="rect" id="node50" href="classfoedus_1_1log_1_1LogManagerPimpl.html#ae0a0fc275f36ad22a57786bc7d17413e" title="foedus::log::LogManagerPimpl\l::wakeup_loggers" alt="" coords="970,818,1167,859"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a45396b70b246f330355397b447af55f3_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a45396b70b246f330355397b447af55f3_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a45396b70b246f330355397b447af55f3_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a45396b70b246f330355397b447af55f3_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#af263fb1494c7ac6a5dbfd28b926ede3b" title="foedus::storage::masstree\l::MasstreeCursor::delete_record" alt="" coords="227,5,435,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="483,97,697,139"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="244,122,417,178"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a67ab7c42dbfd788773d6293ffdb64d52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::drop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Storage-wide operations, such as drop, create, etc. </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00105">105</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00113">get_name()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="masstree__page__impl_8cpp_source.html#l00188">foedus::storage::masstree::MasstreeIntermediatePage::release_pages_recursive_parallel()</a>, and <a class="el" href="page__resolver_8hpp_source.html#l00120">foedus::memory::GlobalVolatilePageResolver::resolve_offset()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00069">foedus::storage::masstree::MasstreeStorage::drop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                      {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Uninitializing a masstree-storage &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">get_name</a>();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// release volatile pages</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">const</span> memory::GlobalVolatilePageResolver&amp; page_resolver</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      = <a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">get_global_volatile_page_resolver</a>();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// first root is guaranteed to be an intermediate page</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    MasstreeIntermediatePage* first_root = <span class="keyword">reinterpret_cast&lt;</span>MasstreeIntermediatePage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      page_resolver.resolve_offset(<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    first_root-&gt;release_pages_recursive_parallel(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_.word = 0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a94e2b69404cabddbead1d1fb0ef1dc42"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">foedus::storage::masstree::MasstreeStoragePimpl::get_name</a></div><div class="ttdeci">const StorageName &amp; get_name() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00113">masstree_storage_pimpl.hpp:113</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a62b2d4de6a72644e9e31d35a7f9beae0"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">foedus::memory::EngineMemory::get_global_volatile_page_resolver</a></div><div class="ttdeci">const GlobalVolatilePageResolver &amp; get_global_volatile_page_resolver() const </div><div class="ttdoc">Returns the page resolver to convert volatile page ID to page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00090">engine_memory.hpp:90</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67ab7c42dbfd788773d6293ffdb64d52_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67ab7c42dbfd788773d6293ffdb64d52_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67ab7c42dbfd788773d6293ffdb64d52_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67ab7c42dbfd788773d6293ffdb64d52_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="723,364,933,420"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="1280,221,1415,262"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_name" alt="" coords="254,359,427,415"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a854ff4750eb7aad99b3cff474882ec5c" title="This method is used when we release a large number of volatile pages, most likely when we drop a stor..." alt="" coords="248,629,433,699"/>
<area shape="rect" id="node36" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1246,1391,1449,1433"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="2504,1059,2711,1101"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="1255,1311,1440,1367"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8" title="foedus::memory::EngineMemory\l::get_node_memory" alt="" coords="1242,501,1453,542"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="481,1235,675,1277"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1783,1435,1945,1477"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="1261,669,1434,710"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="1508,789,1700,830"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1267,1245,1428,1286"/>
<area shape="rect" id="node15" href="classfoedus_1_1memory_1_1PagePool.html#aa7220391af1f368d1fd36b48cc1e2995" title="Returns only one page. " alt="" coords="489,365,667,406"/>
<area shape="rect" id="node24" href="namespacefoedus_1_1storage_1_1masstree.html#a744edfba3574c4c7dd041519321ed5b3" title="foedus::storage::masstree\l::release_parallel" alt="" coords="491,509,665,550"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="1768,789,1960,830"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a741d98bc9dd15581c1316ae5eaf492d5" title="foedus::memory::PagePool\lPimpl::release_one" alt="" coords="739,286,917,327"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#aa545fc1cffac905225d3a7c7c457b5a8" title="foedus::memory::PagePool\lPimpl::free_pool_head" alt="" coords="997,261,1176,302"/>
<area shape="rect" id="node18" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#abd594ac94d8ac0445ebef734b7305fb6" title="foedus::memory::PagePool\lPimpl::get_debug_pool_name" alt="" coords="990,27,1183,69"/>
<area shape="rect" id="node21" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="997,326,1176,367"/>
<area shape="rect" id="node22" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a3b5b895c26ed502d93e753389ce0a21b" title="foedus::memory::PagePool\lPimpl::increase_free_pool_count" alt="" coords="981,391,1192,433"/>
<area shape="rect" id="node23" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="1001,195,1173,237"/>
<area shape="rect" id="node19" href="classfoedus_1_1assorted_1_1FixedString.html#a3269f7c68f175a1fd42e78110a57cbf2" title="Test if string is empty. " alt="" coords="1251,57,1443,98"/>
<area shape="rect" id="node20" href="classfoedus_1_1assorted_1_1FixedString.html#a16f6de0859f599127e2d4a51a6537a01" title="Convert to a std::string object. " alt="" coords="1240,5,1455,32"/>
<area shape="rect" id="node25" href="classfoedus_1_1memory_1_1PageReleaseBatch.html#aacfb0dd808ba1a987cea4d957e8e511b" title="Called at the end to return all batched pages to their pools. " alt="" coords="728,509,928,550"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0d24e70c0a141db733ff45411b5a161e" title="foedus::storage::masstree\l::MasstreePage::release\l_pages_recursive_common" alt="" coords="739,963,917,1019"/>
<area shape="rect" id="node26" href="classfoedus_1_1memory_1_1PageReleaseBatch.html#af16728969f6c3544544000355b6d4f30" title="Return all batched pages in the given chunk to its pool. " alt="" coords="987,509,1187,550"/>
<area shape="rect" id="node27" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774" title="foedus::memory::NumaNode\lMemoryRef::get_volatile_pool" alt="" coords="1252,435,1443,477"/>
<area shape="rect" id="node28" href="classfoedus_1_1memory_1_1PagePool.html#a802171ff0578875748d20b4e9c8c9463" title="Returns the specified number of free pages from the chunk. " alt="" coords="1258,370,1437,411"/>
<area shape="rect" id="node29" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a13d785355359fd936c2b3863d296ba2c" title="foedus::memory::PagePool\lPimpl::release" alt="" coords="1515,370,1693,411"/>
<area shape="rect" id="node31" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1769,1631,1959,1673"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a09552cf1a9e8f061f9bd6cbdb9268688" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::release_pages_recursive" alt="" coords="994,909,1179,965"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#abdd08567e3f74c11a90c599cbac45a24" title="foedus::storage::masstree\l::MasstreeBorderPage::release\l_pages_recursive" alt="" coords="985,1016,1188,1072"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a14cdcef87b3c0a6ef431df9d06a1a663" title="An empty&#45;range page, either intermediate or border, never has any entries. " alt="" coords="1240,786,1455,827"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#adc22d21883e15b87cd5ff6b6ec513c35" title="foedus::storage::masstree\l::MasstreePage::is_moved" alt="" coords="1259,851,1435,893"/>
<area shape="rect" id="node35" href="classfoedus_1_1memory_1_1PageReleaseBatch.html#afe13efbf3cc2111936b08e31bd18e179" title="Returns the given in&#45;memory volatile page to appropriate NUMA node. " alt="" coords="1247,917,1447,958"/>
<area shape="rect" id="node37" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1527,1501,1681,1542"/>
<area shape="rect" id="node39" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1789,1501,1939,1542"/>
<area shape="rect" id="node40" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1517,1383,1691,1425"/>
<area shape="rect" id="node41" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1503,1567,1705,1623"/>
<area shape="rect" id="node38" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1787,1566,1941,1607"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="1253,1164,1441,1220"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="1258,1084,1437,1140"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="2249,1091,2456,1133"/>
<area shape="rect" id="node45" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="1543,1165,1665,1206"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="1515,1084,1693,1140"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="1753,1085,1975,1126"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="1775,1151,1953,1207"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="2023,1084,2201,1140"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67ab7c42dbfd788773d6293ffdb64d52_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67ab7c42dbfd788773d6293ffdb64d52_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67ab7c42dbfd788773d6293ffdb64d52_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67ab7c42dbfd788773d6293ffdb64d52_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a40e22349aa6902839d3b80ac35e84790" title="foedus::storage::masstree\l::MasstreeStorage::drop" alt="" coords="248,5,421,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4a025ff60e7c0717967a091f2c1e01fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool foedus::storage::masstree::MasstreeStoragePimpl::exists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00111">111</a> of file <a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00164">create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;exists(); }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4a025ff60e7c0717967a091f2c1e01fb_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4a025ff60e7c0717967a091f2c1e01fb_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4a025ff60e7c0717967a091f2c1e01fb_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4a025ff60e7c0717967a091f2c1e01fb_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a192a4976aa71f457b356bf536d9f5fc2" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::create" alt="" coords="227,5,400,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a92ad35031262ae95e767c53746de2e29" title="foedus::storage::masstree\l::MasstreeStorage::create" alt="" coords="448,13,621,54"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac3b15bb4f888327ba49050f62d020f52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::fatify_first_root </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>desired_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>disable_no_record_split</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defined in <a class="el" href="masstree__storage__fatify_8cpp.html">masstree_storage_fatify.cpp</a>. </p>

<p>Definition at line <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00054">54</a> of file <a class="el" href="masstree__storage__fatify_8cpp_source.html">masstree_storage_fatify.cpp</a>.</p>

<p>References <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00042">approximate_count_root_children()</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="stop__watch_8hpp_source.html#l00045">foedus::debugging::StopWatch::elapsed_us()</a>, <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00094">fatify_first_root_double()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00113">get_name()</a>, <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00052">foedus::storage::masstree::kIntermediateAlmostFull</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="stop__watch_8cpp_source.html#l00030">foedus::debugging::StopWatch::start()</a>, <a class="el" href="stop__watch_8cpp_source.html#l00035">foedus::debugging::StopWatch::stop()</a>, and <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00604">foedus::storage::masstree::MasstreeStorage::fatify_first_root()</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Masstree-&quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">get_name</a>() &lt;&lt; <span class="stringliteral">&quot; being fatified for &quot;</span> &lt;&lt; desired_count</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;, disable_no_record_split=&quot;</span> &lt;&lt; disable_no_record_split;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span> (desired_count &gt; <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#ae2d5b5067f38a22191eb77d85bc2d2d1">kIntermediateAlmostFull</a>) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;desired_count too large. adjusted to the max&quot;</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    desired_count = <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#ae2d5b5067f38a22191eb77d85bc2d2d1">kIntermediateAlmostFull</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  uint32_t initial_children;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24">approximate_count_root_children</a>(context, &amp;initial_children));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;initial_children=&quot;</span> &lt;&lt; initial_children;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// We keep doubling the direct root-children</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  debugging::StopWatch watch;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  watch.start();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  uint16_t iterations = 0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">for</span> (uint32_t count = initial_children; count &lt; desired_count &amp;&amp; iterations &lt; 10U; ++iterations) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a32332060560b864a857a839bb0adb4fd">fatify_first_root_double</a>(context, disable_no_record_split));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    uint32_t new_count;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24">approximate_count_root_children</a>(context, &amp;new_count));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (count == new_count) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Not enough descendants for further fatification. Stopped here&quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    count = new_count;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  uint32_t after_children;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24">approximate_count_root_children</a>(context, &amp;after_children));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  watch.stop();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;fatify done: Iterations=&quot;</span> &lt;&lt; iterations</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;, took &quot;</span> &lt;&lt; watch.elapsed_us() &lt;&lt; <span class="stringliteral">&quot;us in total.&quot;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; child count: &quot;</span> &lt;&lt; initial_children &lt;&lt; <span class="stringliteral">&quot;-&gt;&quot;</span> &lt;&lt; after_children;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a94e2b69404cabddbead1d1fb0ef1dc42"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">foedus::storage::masstree::MasstreeStoragePimpl::get_name</a></div><div class="ttdeci">const StorageName &amp; get_name() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00113">masstree_storage_pimpl.hpp:113</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_ae2d5b5067f38a22191eb77d85bc2d2d1"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#ae2d5b5067f38a22191eb77d85bc2d2d1">foedus::storage::masstree::kIntermediateAlmostFull</a></div><div class="ttdeci">constexpr uint32_t kIntermediateAlmostFull</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__fatify_8cpp_source.html#l00052">masstree_storage_fatify.cpp:52</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a32332060560b864a857a839bb0adb4fd"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a32332060560b864a857a839bb0adb4fd">foedus::storage::masstree::MasstreeStoragePimpl::fatify_first_root_double</a></div><div class="ttdeci">ErrorStack fatify_first_root_double(thread::Thread *context, bool disable_no_record_split)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__fatify_8cpp_source.html#l00094">masstree_storage_fatify.cpp:94</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_ad6c9eb02ad32cc1bffe9daac3521ad24"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24">foedus::storage::masstree::MasstreeStoragePimpl::approximate_count_root_children</a></div><div class="ttdeci">ErrorCode approximate_count_root_children(thread::Thread *context, uint32_t *out)</div><div class="ttdoc">Returns the count of direct children in the first-root node. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__fatify_8cpp_source.html#l00042">masstree_storage_fatify.cpp:42</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ac3b15bb4f888327ba49050f62d020f52_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ac3b15bb4f888327ba49050f62d020f52_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ac3b15bb4f888327ba49050f62d020f52_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ac3b15bb4f888327ba49050f62d020f52_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24" title="Returns the count of direct children in the first&#45;root node. " alt="" coords="454,304,627,375"/>
<area shape="rect" id="node38" href="classfoedus_1_1debugging_1_1StopWatch.html#a7f1f05f4dd494dd57c3ecafb5d9131fb" title="foedus::debugging::\lStopWatch::elapsed_us" alt="" coords="460,5,621,47"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a32332060560b864a857a839bb0adb4fd" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::fatify_first_root_double" alt="" coords="227,501,400,557"/>
<area shape="rect" id="node40" href="classfoedus_1_1debugging_1_1StopWatch.html#a9f35df8dc3c371659227375baa247074" title="Take current time tick. " alt="" coords="473,931,608,972"/>
<area shape="rect" id="node48" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="473,996,608,1037"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_name" alt="" coords="227,682,400,738"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1storage_1_1masstree.html#aa275c1ef79668cf8c173ee51f0753dc3" title="foedus::storage::masstree\l::count_children_approximate" alt="" coords="681,260,873,301"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="691,667,864,723"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="926,195,1133,236"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="937,262,1122,318"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer\l_address" alt="" coords="943,739,1116,809"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="954,951,1105,992"/>
<area shape="rect" id="node16" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="2433,765,2587,807"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="942,673,1117,715"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="927,476,1131,517"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="925,1068,1134,1109"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="943,345,1116,387"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="921,833,1137,875"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="943,593,1116,649"/>
<area shape="rect" id="node32" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="954,411,1105,452"/>
<area shape="rect" id="node9" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1189,1220,1373,1261"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1962,1197,2123,1239"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="2435,1219,2585,1260"/>
<area shape="rect" id="node12" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1425,1468,1636,1509"/>
<area shape="rect" id="node13" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1951,1357,2135,1413"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1962,1068,2123,1109"/>
<area shape="rect" id="node15" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="2202,908,2357,949"/>
<area shape="rect" id="node18" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343" title="Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v..." alt="" coords="1695,1139,1882,1180"/>
<area shape="rect" id="node19" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1941,991,2144,1032"/>
<area shape="rect" id="node20" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="1439,1351,1623,1392"/>
<area shape="rect" id="node21" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1684,1468,1893,1509"/>
<area shape="rect" id="node22" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1461,1220,1600,1261"/>
<area shape="rect" id="node23" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="1460,1285,1601,1327"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="2415,413,2605,455"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="1185,841,1377,883"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="1435,841,1627,883"/>
<area shape="rect" id="node33" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="1189,411,1373,452"/>
<area shape="rect" id="node34" href="classfoedus_1_1xct_1_1Xct.html#aca66ae9959651b7c6fa86a75db287f54" title="foedus::xct::Xct::get\l_sysxct_workspace" alt="" coords="1461,411,1600,452"/>
<area shape="rect" id="node35" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761" title="foedus::thread::ThreadPimpl\l::cll_get_max_locked_id" alt="" coords="1439,476,1623,517"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4" title="foedus::thread::ThreadPimpl\l::is_simple_mcs_rw" alt="" coords="1439,280,1623,321"/>
<area shape="rect" id="node37" href="group__SYSXCT.html#gaf49955c6d4efe3d92e6e09b4ff890618" title="Runs a system transaction nested in a user transaction. " alt="" coords="1451,345,1610,387"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#adc22d21883e15b87cd5ff6b6ec513c35" title="foedus::storage::masstree\l::MasstreePage::is_moved" alt="" coords="689,748,865,789"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="448,122,633,178"/>
<area shape="rect" id="node44" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="448,501,633,557"/>
<area shape="rect" id="node45" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="691,814,864,870"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="2192,269,2367,311"/>
<area shape="rect" id="node41" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="710,945,845,987"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="1701,1073,1876,1115"/>
<area shape="rect" id="node49" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="697,1011,858,1052"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ac3b15bb4f888327ba49050f62d020f52_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ac3b15bb4f888327ba49050f62d020f52_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ac3b15bb4f888327ba49050f62d020f52_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ac3b15bb4f888327ba49050f62d020f52_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a70b1c5e023fa0aac150e7b607e37727c" title="Deliberately causes splits under the volatile root of first layer, or &quot;fatify&quot; it. " alt="" coords="227,5,400,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a32332060560b864a857a839bb0adb4fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::fatify_first_root_double </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>disable_no_record_split</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00094">94</a> of file <a class="el" href="masstree__storage__fatify_8cpp_source.html">masstree_storage_fatify.cpp</a>.</p>

<p>References <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00042">approximate_count_root_children()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00032">foedus::storage::masstree::count_children_approximate()</a>, <a class="el" href="stop__watch_8hpp_source.html#l00045">foedus::debugging::StopWatch::elapsed_us()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00312">foedus::storage::masstree::MasstreeIntermediatePage::find_minipage()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00287">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::find_pointer()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00367">follow_page()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">get_first_root()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00099">foedus::storage::masstree::MasstreePage::get_high_fence()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00148">foedus::storage::masstree::MasstreePage::get_key_count()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00098">foedus::storage::masstree::MasstreePage::get_low_fence()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00322">foedus::storage::masstree::MasstreeIntermediatePage::get_minipage()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00084">foedus::storage::masstree::MasstreePage::is_border()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00169">foedus::storage::masstree::MasstreePage::is_moved()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00132">foedus::storage::masstree::kInfimumSlice</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="masstree__id_8hpp_source.html#l00137">foedus::storage::masstree::kSupremumSlice</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00952">foedus::thread::Thread::run_nested_sysxct()</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, <a class="el" href="stop__watch_8cpp_source.html#l00030">foedus::debugging::StopWatch::start()</a>, <a class="el" href="stop__watch_8cpp_source.html#l00035">foedus::debugging::StopWatch::stop()</a>, and <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00054">fatify_first_root()</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// We invoke split sysxct and adopt sysxct many times.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  debugging::StopWatch watch;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  watch.start();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  uint16_t root_retries = 0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> cur_slice = <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  uint16_t skipped_children = 0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  uint16_t adopted_children = 0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  uint32_t initial_children;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24">approximate_count_root_children</a>(context, &amp;initial_children));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">while</span> (cur_slice != <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">kSupremumSlice</a>) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span> (initial_children + adopted_children &gt;= <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#ae2d5b5067f38a22191eb77d85bc2d2d1">kIntermediateAlmostFull</a>) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Root page nearing full. Stopped fatification&quot;</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// Get a non-moved root. This might trigger grow-root.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// grow-root is a non-mandatory operation, so we might keep seeing a moved root.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    MasstreeIntermediatePage* root;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">get_first_root</a>(context, <span class="keyword">true</span>, &amp;root));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(root-&gt;get_low_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(root-&gt;get_high_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">kSupremumSlice</a>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (root-&gt;is_moved()) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      ++root_retries;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">if</span> (root_retries &gt; 50U) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;Hm? there might be some contention to prevent grow-root. Gave up&quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    root_retries = 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> minipage_index = root-&gt;find_minipage(cur_slice);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keyword">auto</span>&amp; minipage = root-&gt;get_minipage(minipage_index);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">auto</span> pointer_index = minipage.find_pointer(cur_slice);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    MasstreePage* child;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">follow_page</a>(</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      context,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keyword">true</span>,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      minipage.pointers_ + pointer_index,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      &amp;child));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!child-&gt;header().snapshot_);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    cur_slice = child-&gt;get_high_fence();  <span class="comment">// go on to next</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (!child-&gt;is_moved()) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="comment">// Split the child so that we can adopt it to the root</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordflow">if</span> (child-&gt;is_border()) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">if</span> (child-&gt;get_key_count() &gt;= 2U) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          MasstreeBorderPage* casted = <span class="keyword">reinterpret_cast&lt;</span>MasstreeBorderPage*<span class="keyword">&gt;</span>(child);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="keyword">auto</span> low_slice = child-&gt;get_low_fence();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <span class="keyword">auto</span> high_slice = child-&gt;get_high_fence();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          <span class="keyword">auto</span> mid_slice = low_slice + (high_slice - low_slice) / 2U;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          SplitBorder split(context, casted, mid_slice, disable_no_record_split);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;split, 2U));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          ++skipped_children;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="keywordflow">continue</span>;  <span class="comment">// not worth splitting</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        MasstreeIntermediatePage* casted = <span class="keyword">reinterpret_cast&lt;</span>MasstreeIntermediatePage*<span class="keyword">&gt;</span>(child);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        uint32_t grandchild_count = <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#aa275c1ef79668cf8c173ee51f0753dc3">count_children_approximate</a>(casted);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> (grandchild_count &gt;= 2U) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          SplitIntermediate split(context, casted);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;split, 2U));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          ++skipped_children;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keywordflow">continue</span>;  <span class="comment">// not worth splitting</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    Adopt adopt(context, root, child);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;adopt, 2U));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    ++adopted_children;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  uint32_t after_children;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24">approximate_count_root_children</a>(context, &amp;after_children));</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  watch.stop();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;fatify_double: adopted &quot;</span> &lt;&lt; adopted_children &lt;&lt; <span class="stringliteral">&quot; root-children and skipped &quot;</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    &lt;&lt; skipped_children &lt;&lt; <span class="stringliteral">&quot; that are already too sparse in &quot;</span> &lt;&lt; watch.elapsed_us() &lt;&lt; <span class="stringliteral">&quot;us.&quot;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; child count: &quot;</span> &lt;&lt; initial_children &lt;&lt; <span class="stringliteral">&quot;-&gt;&quot;</span> &lt;&lt; after_children;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a9cffc20f29ad72d4edbeedece861c48f"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">foedus::storage::masstree::kInfimumSlice</a></div><div class="ttdeci">const KeySlice kInfimumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00132">masstree_id.hpp:132</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aff31f521523d7a7b81ff5b750e081dac"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">foedus::storage::masstree::MasstreeStoragePimpl::follow_page</a></div><div class="ttdeci">ErrorCode follow_page(thread::Thread *context, bool for_writes, storage::DualPagePointer *pointer, MasstreePage **page)</div><div class="ttdoc">Thread::follow_page_pointer() for masstree. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00367">masstree_storage_pimpl.cpp:367</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga556e8f0d5e02e78f3ddecd8f5b022bf6"><div class="ttname"><a href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">foedus::storage::masstree::KeySlice</a></div><div class="ttdeci">uint64_t KeySlice</div><div class="ttdoc">Each key slice is an 8-byte integer. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00126">masstree_id.hpp:126</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_ae2d5b5067f38a22191eb77d85bc2d2d1"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#ae2d5b5067f38a22191eb77d85bc2d2d1">foedus::storage::masstree::kIntermediateAlmostFull</a></div><div class="ttdeci">constexpr uint32_t kIntermediateAlmostFull</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__fatify_8cpp_source.html#l00052">masstree_storage_fatify.cpp:52</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_aa275c1ef79668cf8c173ee51f0753dc3"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#aa275c1ef79668cf8c173ee51f0753dc3">foedus::storage::masstree::count_children_approximate</a></div><div class="ttdeci">uint32_t count_children_approximate(const MasstreeIntermediatePage *page)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__fatify_8cpp_source.html#l00032">masstree_storage_fatify.cpp:32</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_adc32aaf6f4537fcc1ada207e1d6902ec"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">foedus::storage::masstree::MasstreeStoragePimpl::get_first_root</a></div><div class="ttdeci">ErrorCode get_first_root(thread::Thread *context, bool for_write, MasstreeIntermediatePage **root)</div><div class="ttdoc">Root-node related, such as a method to retrieve 1st-root, to grow, etc. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00058">masstree_storage_pimpl.cpp:58</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a7bfcd277a96bcd1e9008459abe1ec40d"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">foedus::storage::masstree::kSupremumSlice</a></div><div class="ttdeci">const KeySlice kSupremumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00137">masstree_id.hpp:137</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_ad6c9eb02ad32cc1bffe9daac3521ad24"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24">foedus::storage::masstree::MasstreeStoragePimpl::approximate_count_root_children</a></div><div class="ttdeci">ErrorCode approximate_count_root_children(thread::Thread *context, uint32_t *out)</div><div class="ttdoc">Returns the count of direct children in the first-root node. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__fatify_8cpp_source.html#l00042">masstree_storage_fatify.cpp:42</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a32332060560b864a857a839bb0adb4fd_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a32332060560b864a857a839bb0adb4fd_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a32332060560b864a857a839bb0adb4fd_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a32332060560b864a857a839bb0adb4fd_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24" title="Returns the count of direct children in the first&#45;root node. " alt="" coords="233,810,406,880"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1storage_1_1masstree.html#aa275c1ef79668cf8c173ee51f0753dc3" title="foedus::storage::masstree\l::count_children_approximate" alt="" coords="460,499,652,540"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="705,360,911,402"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="715,426,901,482"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="469,873,643,929"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="706,982,910,1023"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="703,1047,913,1088"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="721,1112,895,1154"/>
<area shape="rect" id="node33" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="733,1230,883,1271"/>
<area shape="rect" id="node40" href="classfoedus_1_1debugging_1_1StopWatch.html#a7f1f05f4dd494dd57c3ecafb5d9131fb" title="foedus::debugging::\lStopWatch::elapsed_us" alt="" coords="239,1331,400,1372"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="463,418,649,474"/>
<area shape="rect" id="node42" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="227,1397,412,1453"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="469,616,643,672"/>
<area shape="rect" id="node45" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="1971,1028,2145,1070"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#adc22d21883e15b87cd5ff6b6ec513c35" title="foedus::storage::masstree\l::MasstreePage::is_moved" alt="" coords="231,1162,407,1203"/>
<area shape="rect" id="node47" href="classfoedus_1_1debugging_1_1StopWatch.html#a9f35df8dc3c371659227375baa247074" title="Take current time tick. " alt="" coords="252,1478,387,1519"/>
<area shape="rect" id="node49" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="252,1543,387,1584"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer\l_address" alt="" coords="721,623,895,694"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="733,558,883,599"/>
<area shape="rect" id="node17" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="2211,642,2366,683"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="721,770,895,811"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="700,916,916,958"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="721,836,895,892"/>
<area shape="rect" id="node9" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="968,334,1152,375"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1741,450,1902,491"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="2214,215,2363,256"/>
<area shape="rect" id="node13" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1204,268,1415,310"/>
<area shape="rect" id="node14" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1729,298,1913,354"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1741,60,1902,102"/>
<area shape="rect" id="node16" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1981,570,2135,611"/>
<area shape="rect" id="node19" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343" title="Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v..." alt="" coords="1474,247,1661,288"/>
<area shape="rect" id="node20" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1720,382,1923,423"/>
<area shape="rect" id="node21" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="1217,203,1401,244"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1463,130,1672,171"/>
<area shape="rect" id="node23" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1240,334,1379,375"/>
<area shape="rect" id="node24" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="1239,399,1380,440"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="2208,508,2369,550"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="2193,902,2384,943"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="964,942,1156,983"/>
<area shape="rect" id="node31" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="1213,942,1405,983"/>
<area shape="rect" id="node34" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="968,1164,1152,1206"/>
<area shape="rect" id="node35" href="classfoedus_1_1xct_1_1Xct.html#aca66ae9959651b7c6fa86a75db287f54" title="foedus::xct::Xct::get\l_sysxct_workspace" alt="" coords="1240,1034,1379,1075"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761" title="foedus::thread::ThreadPimpl\l::cll_get_max_locked_id" alt="" coords="1217,1099,1401,1140"/>
<area shape="rect" id="node38" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4" title="foedus::thread::ThreadPimpl\l::is_simple_mcs_rw" alt="" coords="1217,1164,1401,1206"/>
<area shape="rect" id="node39" href="group__SYSXCT.html#gaf49955c6d4efe3d92e6e09b4ff890618" title="Runs a system transaction nested in a user transaction. " alt="" coords="1230,1230,1389,1271"/>
<area shape="rect" id="node37" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8" title="foedus::xct::Xct::get\l_current_lock_list" alt="" coords="1498,1099,1637,1140"/>
<area shape="rect" id="node44" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="973,555,1147,596"/>
<area shape="rect" id="node48" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="489,1478,623,1519"/>
<area shape="rect" id="node50" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="475,1543,637,1584"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a32332060560b864a857a839bb0adb4fd_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a32332060560b864a857a839bb0adb4fd_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a32332060560b864a857a839bb0adb4fd_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a32332060560b864a857a839bb0adb4fd_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ac3b15bb4f888327ba49050f62d020f52" title="Defined in masstree_storage_fatify.cpp. " alt="" coords="227,5,400,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a70b1c5e023fa0aac150e7b607e37727c" title="Deliberately causes splits under the volatile root of first layer, or &quot;fatify&quot; it. " alt="" coords="448,5,621,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a738313356f0e54e8e2d732c2017797c0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::find_border_physical </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *&#160;</td>
          <td class="paramname"><em>layer_root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>current_layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_writes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>slice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html">MasstreeBorderPage</a> **&#160;</td>
          <td class="paramname"><em>border</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find a border node in the layer that corresponds to the given key slice. </p>
<p>Record-wise or page-wise operations.</p>
<dl class="section note"><dt>Note</dt><dd>this method is <em>physical-only</em>. It doesn't take any long-term lock or readset.</dd></dl>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00213">213</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="page_8hpp_source.html#l00402">foedus::storage::assert_aligned_page()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00312">foedus::storage::masstree::MasstreeIntermediatePage::find_minipage()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00287">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::find_pointer()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00367">follow_page()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00098">foedus::storage::masstree::MasstreePage::get_low_fence()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00322">foedus::storage::masstree::MasstreeIntermediatePage::get_minipage()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00139">foedus::storage::masstree::MasstreePage::has_foster_child()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00100">foedus::storage::masstree::MasstreePage::is_high_fence_supremum()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00168">foedus::storage::masstree::MasstreePage::is_locked()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="masstree__id_8hpp_source.html#l00132">foedus::storage::masstree::kInfimumSlice</a>, <a class="el" href="compiler_8hpp_source.html#l00103">LIKELY</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00046">foedus::assorted::memory_fence_acquire()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00278">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::pointers_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00281">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::prefetch()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00158">foedus::storage::masstree::MasstreePage::prefetch_general()</a>, <a class="el" href="thread_8cpp_source.html#l00129">foedus::thread::Thread::resolve()</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00952">foedus::thread::Thread::run_nested_sysxct()</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, and <a class="el" href="masstree__page__impl_8hpp_source.html#l00126">foedus::storage::masstree::MasstreePage::within_fences()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00283">locate_record()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00336">locate_record_normalized()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00412">reserve_record()</a>, and <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00515">reserve_record_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                               {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec">assert_aligned_page</a>(layer_root);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(layer_root-&gt;is_high_fence_supremum());</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(layer_root-&gt;get_low_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  MasstreePage* cur = layer_root;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  cur-&gt;prefetch_general();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec">assert_aligned_page</a>(cur);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur-&gt;get_layer() == current_layer);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur-&gt;within_fences(slice));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (cur-&gt;is_border()) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="comment">// We follow foster-twins only in border pages.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="comment">// In intermediate pages, Master-Tree invariant tells us that we don&#39;t have to.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="comment">// Furthermore, if we do, we need to handle the case of empty-range intermediate pages.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// Rather we just do this only in border pages.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(cur-&gt;has_foster_child())) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment">// follow one of foster-twin.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> (cur-&gt;within_foster_minor(slice)) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          cur = <span class="keyword">reinterpret_cast&lt;</span>MasstreePage*<span class="keyword">&gt;</span>(context-&gt;resolve(cur-&gt;get_foster_minor()));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          cur = <span class="keyword">reinterpret_cast&lt;</span>MasstreePage*<span class="keyword">&gt;</span>(context-&gt;resolve(cur-&gt;get_foster_major()));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur-&gt;within_fences(slice));</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      *border = <span class="keyword">reinterpret_cast&lt;</span>MasstreeBorderPage*<span class="keyword">&gt;</span>(cur);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      MasstreeIntermediatePage* page = <span class="keyword">reinterpret_cast&lt;</span>MasstreeIntermediatePage*<span class="keyword">&gt;</span>(cur);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      uint8_t minipage_index = page-&gt;find_minipage(slice);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      MasstreeIntermediatePage::MiniPage&amp; minipage = page-&gt;get_minipage(minipage_index);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      minipage.prefetch();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      uint8_t pointer_index = minipage.find_pointer(slice);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      DualPagePointer&amp; pointer = minipage.pointers_[pointer_index];</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      MasstreePage* next;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">follow_page</a>(context, for_writes, &amp;pointer, &amp;next));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      next-&gt;prefetch_general();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#gad10e2a9bf230cc6fdd98a6c70958ef81">LIKELY</a>(next-&gt;within_fences(slice))) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">if</span> (next-&gt;has_foster_child() &amp;&amp; !cur-&gt;is_moved()) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          <span class="comment">// oh, the page has foster child, so we should adopt it.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          <span class="comment">// Whether Adopt actually adopted it or not,</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <span class="comment">// we follow the &quot;old&quot; next page. Master-Tree invariant guarantees that it&#39;s safe.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <span class="comment">// This is beneficial when we lazily give up adoption in the method, eg other threads</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <span class="comment">// holding locks in the intermediate page.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          <span class="keywordflow">if</span> (!next-&gt;is_locked() &amp;&amp; !cur-&gt;is_locked()) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="comment">// Let&#39;s try adopting. No need to try many times. Adopt can be delayed</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            Adopt functor(context, page, next);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;functor, 2));</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="comment">// We don&#39;t have to adopt it right away. Do it when it&#39;s not contended</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            DVLOG(1) &lt;&lt; <span class="stringliteral">&quot;Someone else seems doing something there.. already adopting? skip it&quot;</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        cur = next;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">// even in this case, local retry suffices thanks to foster-twin</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        DVLOG(0) &lt;&lt; <span class="stringliteral">&quot;Interesting. concurrent thread affected the search. local retry&quot;</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_html_ab7207e6e276af504c0e358a923ee75ec"><div class="ttname"><a href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec">foedus::storage::assert_aligned_page</a></div><div class="ttdeci">void assert_aligned_page(const void *page)</div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00402">page.hpp:402</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a9cffc20f29ad72d4edbeedece861c48f"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">foedus::storage::masstree::kInfimumSlice</a></div><div class="ttdeci">const KeySlice kInfimumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00132">masstree_id.hpp:132</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aff31f521523d7a7b81ff5b750e081dac"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">foedus::storage::masstree::MasstreeStoragePimpl::follow_page</a></div><div class="ttdeci">ErrorCode follow_page(thread::Thread *context, bool for_writes, storage::DualPagePointer *pointer, MasstreePage **page)</div><div class="ttdoc">Thread::follow_page_pointer() for masstree. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00367">masstree_storage_pimpl.cpp:367</a></div></div>
<div class="ttc" id="group__COMPILER_html_gad10e2a9bf230cc6fdd98a6c70958ef81"><div class="ttname"><a href="group__COMPILER.html#gad10e2a9bf230cc6fdd98a6c70958ef81">LIKELY</a></div><div class="ttdeci">#define LIKELY(x)        </div><div class="ttdoc">Hints that x is highly likely true. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00103">compiler.hpp:103</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaf84f9944a16c5848f69beacdfeedf939"><div class="ttname"><a href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">foedus::assorted::memory_fence_acquire</a></div><div class="ttdeci">void memory_fence_acquire()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acquire). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00046">atomic_fences.hpp:46</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a738313356f0e54e8e2d732c2017797c0_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a738313356f0e54e8e2d732c2017797c0_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a738313356f0e54e8e2d732c2017797c0_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a738313356f0e54e8e2d732c2017797c0_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="2021,817,2175,859"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="242,174,427,230"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="242,501,427,557"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="248,418,421,474"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="233,647,437,688"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="242,713,427,769"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="227,581,443,623"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="507,1019,681,1075"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a16a2c06a304514be7b99fb6c884e7e9b" title="foedus::storage::masstree\l::MasstreePage::is_locked" alt="" coords="246,859,423,900"/>
<area shape="rect" id="node36" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="248,976,421,1017"/>
<area shape="rect" id="node37" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#a541c911b49454a9baece1d658f51abf5" title="prefetch upto separators. " alt="" coords="242,1107,427,1163"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3260be02451d5017a2301854454dd203" title="prefetch upto keys/separators, whether this page is border or interior. " alt="" coords="248,1187,421,1243"/>
<area shape="rect" id="node41" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="259,793,410,835"/>
<area shape="rect" id="node43" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="259,1352,410,1393"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0f8830e2b301b1bdd3f2e16d9b047d79" title="foedus::storage::masstree\l::MasstreePage::within_fences" alt="" coords="235,1041,435,1083"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="491,5,697,47"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="1261,56,1436,97"/>
<area shape="rect" id="node10" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="519,425,669,467"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1522,157,1683,199"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="2017,216,2179,257"/>
<area shape="rect" id="node11" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="749,425,933,467"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="2023,539,2173,580"/>
<area shape="rect" id="node13" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="985,483,1196,524"/>
<area shape="rect" id="node14" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1511,427,1695,483"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1522,568,1683,609"/>
<area shape="rect" id="node16" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1776,744,1931,785"/>
<area shape="rect" id="node18" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343" title="Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v..." alt="" coords="1255,509,1442,551"/>
<area shape="rect" id="node19" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1501,685,1704,727"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="999,183,1183,224"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1244,325,1453,367"/>
<area shape="rect" id="node24" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="1021,300,1160,341"/>
<area shape="rect" id="node25" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="1020,365,1161,407"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="2003,744,2193,785"/>
<area shape="rect" id="node20" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1767,627,1940,668"/>
<area shape="rect" id="node21" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1752,810,1955,866"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="498,581,690,623"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="745,581,937,623"/>
<area shape="rect" id="node33" href="structfoedus_1_1storage_1_1PageVersion.html#a301cba19b01cf82d7b576a04180b56e2" title="foedus::storage::PageVersion\l::is_locked" alt="" coords="498,933,690,975"/>
<area shape="rect" id="node34" href="structfoedus_1_1xct_1_1McsWwLock.html#abe15a0d250a2186ac534fc5d2d0b7f8e" title="This is a &quot;relaxed&quot; check. " alt="" coords="757,933,926,975"/>
<area shape="rect" id="node35" href="structfoedus_1_1xct_1_1McsWwBlockData.html#aa6a3e9b495bb234bf4c840a0e43d082e" title="foedus::xct::McsWwBlockData\l::is_valid_relaxed" alt="" coords="990,933,1191,975"/>
<area shape="rect" id="node38" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="508,1155,680,1196"/>
<area shape="rect" id="node39" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="755,1155,927,1196"/>
<area shape="rect" id="node42" href="classfoedus_1_1thread_1_1Thread.html#aa77cde98794b5a55e0d295284acb3e6d" title="Returns the page resolver to convert page ID to page pointer. " alt="" coords="519,853,669,909"/>
<area shape="rect" id="node44" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="502,1384,686,1425"/>
<area shape="rect" id="node45" href="classfoedus_1_1xct_1_1Xct.html#aca66ae9959651b7c6fa86a75db287f54" title="foedus::xct::Xct::get\l_sysxct_workspace" alt="" coords="772,1515,911,1556"/>
<area shape="rect" id="node46" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761" title="foedus::thread::ThreadPimpl\l::cll_get_max_locked_id" alt="" coords="749,1319,933,1360"/>
<area shape="rect" id="node48" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4" title="foedus::thread::ThreadPimpl\l::is_simple_mcs_rw" alt="" coords="749,1384,933,1425"/>
<area shape="rect" id="node49" href="group__SYSXCT.html#gaf49955c6d4efe3d92e6e09b4ff890618" title="Runs a system transaction nested in a user transaction. " alt="" coords="762,1449,921,1491"/>
<area shape="rect" id="node47" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8" title="foedus::xct::Xct::get\l_current_lock_list" alt="" coords="1021,1319,1160,1360"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a738313356f0e54e8e2d732c2017797c0_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a738313356f0e54e8e2d732c2017797c0_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a738313356f0e54e8e2d732c2017797c0_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a738313356f0e54e8e2d732c2017797c0_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. " alt="" coords="480,195,653,251"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a0ce23624d660da08cb1ee04ac2297171" title="Identifies page and record for the normalized key. " alt="" coords="229,395,408,451"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a52a1bce48d9230ad2ce3f52c4da51b8e" title="Like locate_record(), this is also a logical operation. " alt="" coords="232,669,405,725"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#acac5f9308b4aed46777d34f6fa171c8e" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::reserve_record_normalized" alt="" coords="227,807,411,863"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#acdf38eea62d1432e3715a661d0790caf" title="Retrieves an entire record of the given key in this Masstree. " alt="" coords="742,5,941,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a01a2996a1ee370611b72c88f33fe2753" title="Retrieves a part of the given key in this Masstree. " alt="" coords="755,71,928,127"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a3be736c76c38dd23444cbd78947a63fd" title="Retrieves a part of the given key in this Masstree as a primitive value. " alt="" coords="755,151,928,207"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="734,377,949,419"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="726,443,957,484"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="748,231,935,287"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="723,312,960,353"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a4f2492b6a04c2db18cdf2a4a2d7fecc0" title="Retrieves an entire record of the given primitive key in this Masstree. " alt="" coords="480,7,653,63"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adda60c43db1237644270e90f2a255d35" title="Retrieves a part of the given primitive key in this Masstree. " alt="" coords="480,97,653,153"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae4bf2da94babc15bf43bd50b17ffb562" title="Retrieves a part of the given primitive key in this Masstree as a primitive value. " alt="" coords="472,275,661,331"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="480,355,653,411"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="473,435,660,491"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="472,515,661,571"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="469,595,664,651"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="461,676,673,717"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="459,741,675,783"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="480,807,653,863"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="480,887,653,943"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6188e676e564b4ebecaa556178cdb81e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::follow_layer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_writes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html">MasstreeBorderPage</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a>&#160;</td>
          <td class="paramname"><em>record_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> **&#160;</td>
          <td class="paramname"><em>page</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Follows to next layer's root page. </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00384">384</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00796">foedus::storage::masstree::MasstreeBorderPage::does_point_to_layer()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00367">follow_page()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00750">foedus::storage::masstree::MasstreeBorderPage::get_next_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00813">foedus::storage::masstree::MasstreeBorderPage::get_owner_id()</a>, <a class="el" href="xct__id_8hpp_source.html#l01041">foedus::xct::XctId::is_moved()</a>, <a class="el" href="xct__id_8hpp_source.html#l01042">foedus::xct::XctId::is_next_layer()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00163">foedus::storage::masstree::kBorderPageMaxSlots</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00952">foedus::thread::Thread::run_nested_sysxct()</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, and <a class="el" href="xct__id_8hpp_source.html#l01137">foedus::xct::RwLockableXctId::xct_id_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00283">locate_record()</a>, and <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00412">reserve_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                       {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(record_index &lt; <a class="code" href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">kBorderPageMaxSlots</a>);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(parent-&gt;does_point_to_layer(record_index));</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  DualPagePointer* pointer = parent-&gt;get_next_layer(record_index);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  xct::RwLockableXctId* owner = parent-&gt;get_owner_id(record_index);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(owner-&gt;xct_id_.is_next_layer() || owner-&gt;xct_id_.is_moved());</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!pointer-&gt;is_both_null());</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  MasstreePage* next_root;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">follow_page</a>(context, for_writes, pointer, &amp;next_root));</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// root page has a foster child... time for tree growth!</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(next_root-&gt;has_foster_child())) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(next_root-&gt;get_layer() &gt; 0);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// Either case, we follow the old page. Master-Tree invariant guarantees it&#39;s safe</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    GrowNonFirstLayerRoot functor(context, parent, record_index);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;functor, 2U));</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(next_root);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  *page = next_root;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aff31f521523d7a7b81ff5b750e081dac"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">foedus::storage::masstree::MasstreeStoragePimpl::follow_page</a></div><div class="ttdeci">ErrorCode follow_page(thread::Thread *context, bool for_writes, storage::DualPagePointer *pointer, MasstreePage **page)</div><div class="ttdoc">Thread::follow_page_pointer() for masstree. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00367">masstree_storage_pimpl.cpp:367</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga78a96e3a0ec4256513d9d2e9c94f37fd"><div class="ttname"><a href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">foedus::storage::masstree::kBorderPageMaxSlots</a></div><div class="ttdeci">const SlotIndex kBorderPageMaxSlots</div><div class="ttdoc">Maximum number of slots in one MasstreeBorderPage. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00163">masstree_id.hpp:163</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6188e676e564b4ebecaa556178cdb81e_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6188e676e564b4ebecaa556178cdb81e_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6188e676e564b4ebecaa556178cdb81e_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6188e676e564b4ebecaa556178cdb81e_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="227,361,415,417"/>
<area shape="rect" id="node5" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="493,318,616,359"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="234,441,407,497"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="231,167,410,223"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="465,237,644,293"/>
<area shape="rect" id="node41" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="259,522,382,563"/>
<area shape="rect" id="node42" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="245,947,396,989"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1219,246,1425,287"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1485,246,1692,287"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="1235,419,1409,461"/>
<area shape="rect" id="node10" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="479,673,630,714"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1508,529,1669,570"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="2016,689,2177,730"/>
<area shape="rect" id="node11" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="713,857,897,898"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="2022,1031,2171,1073"/>
<area shape="rect" id="node13" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1483,1258,1694,1299"/>
<area shape="rect" id="node16" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1497,607,1681,663"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1508,805,1669,846"/>
<area shape="rect" id="node18" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1775,750,1929,791"/>
<area shape="rect" id="node21" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343" title="Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v..." alt="" coords="1229,689,1415,730"/>
<area shape="rect" id="node23" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1487,922,1690,963"/>
<area shape="rect" id="node26" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="975,739,1159,781"/>
<area shape="rect" id="node27" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1217,1090,1427,1131"/>
<area shape="rect" id="node30" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="997,857,1136,898"/>
<area shape="rect" id="node31" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="996,922,1137,963"/>
<area shape="rect" id="node14" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ac661b8baf462a1e969a8a1c7e619858b" title="foedus::memory::PagePool\lOffsetChunk::empty" alt="" coords="2007,1283,2186,1325"/>
<area shape="rect" id="node15" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#af897b38ac1ef4217ff99018436c0112e" title="foedus::memory::PagePool\lOffsetChunk::pop_back" alt="" coords="1763,1313,1941,1354"/>
<area shape="rect" id="node19" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="2019,822,2174,863"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="2001,754,2192,795"/>
<area shape="rect" id="node22" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a6c9bf7d6b21ac33a61d6f7176023ea3a" title="Returns one free volatile page to local page pool. " alt="" coords="1475,687,1703,729"/>
<area shape="rect" id="node24" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1765,897,1939,938"/>
<area shape="rect" id="node25" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1751,816,1953,872"/>
<area shape="rect" id="node29" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="1230,856,1414,912"/>
<area shape="rect" id="node28" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="1521,1090,1656,1131"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="465,157,644,213"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="695,173,916,214"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="716,85,895,141"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="977,165,1156,221"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="977,245,1156,301"/>
<area shape="rect" id="node38" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="980,85,1153,141"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="977,5,1156,61"/>
<area shape="rect" id="node43" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="463,1309,647,1350"/>
<area shape="rect" id="node44" href="classfoedus_1_1xct_1_1Xct.html#aca66ae9959651b7c6fa86a75db287f54" title="foedus::xct::Xct::get\l_sysxct_workspace" alt="" coords="736,1243,875,1285"/>
<area shape="rect" id="node45" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761" title="foedus::thread::ThreadPimpl\l::cll_get_max_locked_id" alt="" coords="713,1309,897,1350"/>
<area shape="rect" id="node48" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4" title="foedus::thread::ThreadPimpl\l::is_simple_mcs_rw" alt="" coords="713,1374,897,1415"/>
<area shape="rect" id="node49" href="group__SYSXCT.html#gaf49955c6d4efe3d92e6e09b4ff890618" title="Runs a system transaction nested in a user transaction. " alt="" coords="726,1439,885,1481"/>
<area shape="rect" id="node46" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8" title="foedus::xct::Xct::get\l_current_lock_list" alt="" coords="997,1374,1136,1415"/>
<area shape="rect" id="node47" href="classfoedus_1_1xct_1_1CurrentLockList.html#a398ec264786992d102b8edd74d5767b3" title="foedus::xct::CurrentLock\lList::get_max_locked_id" alt="" coords="985,1309,1149,1350"/>
<area shape="rect" id="node50" href="structfoedus_1_1xct_1_1SysxctFunctor.html#a383a9cfd5d8fa5caf45c7ffb6dc05535" title="Execute the system transaction. " alt="" coords="964,1447,1169,1473"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6188e676e564b4ebecaa556178cdb81e_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6188e676e564b4ebecaa556178cdb81e_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6188e676e564b4ebecaa556178cdb81e_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a6188e676e564b4ebecaa556178cdb81e_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. " alt="" coords="227,258,400,314"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a52a1bce48d9230ad2ce3f52c4da51b8e" title="Like locate_record(), this is also a logical operation. " alt="" coords="227,502,400,558"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#acdf38eea62d1432e3715a661d0790caf" title="Retrieves an entire record of the given key in this Masstree. " alt="" coords="467,5,666,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a01a2996a1ee370611b72c88f33fe2753" title="Retrieves a part of the given key in this Masstree. " alt="" coords="480,71,653,127"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a3be736c76c38dd23444cbd78947a63fd" title="Retrieves a part of the given key in this Masstree as a primitive value. " alt="" coords="480,151,653,207"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="459,232,674,273"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="451,297,682,339"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="473,363,660,419"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="448,444,685,485"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="461,509,673,551"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="459,575,675,616"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aff31f521523d7a7b81ff5b750e081dac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::follow_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_writes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html">storage::DualPagePointer</a> *&#160;</td>
          <td class="paramname"><em>pointer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> **&#160;</td>
          <td class="paramname"><em>page</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Thread::follow_page_pointer() for masstree. </p>
<p>Because of how masstree works, this method never creates a completely new page. In other words, always !pointer-&gt;is_both_null(). It either reads an existing volatile/snapshot page or creates a volatile page from existing snapshot page. </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00367">367</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00353">foedus::thread::Thread::follow_page_pointer()</a>, and <a class="el" href="storage__id_8hpp_source.html#l00303">foedus::storage::DualPagePointer::is_both_null()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00094">fatify_first_root_double()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00213">find_border_physical()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00384">follow_layer()</a>, <a class="el" href="masstree__storage__verify_8cpp_source.html#l00201">verify_single_thread_border()</a>, and <a class="el" href="masstree__storage__verify_8cpp_source.html#l00103">verify_single_thread_intermediate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                       {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!pointer-&gt;is_both_null());</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">return</span> context-&gt;follow_page_pointer(</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keyword">nullptr</span>,  <span class="comment">// masstree doesn&#39;t create a new page except splits.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keyword">false</span>,  <span class="comment">// so, there is no null page possible</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    for_writes,  <span class="comment">// always get volatile pages for writes</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">true</span>,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    pointer,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    reinterpret_cast&lt;Page**&gt;(page),</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keyword">nullptr</span>,  <span class="comment">// only used for new page creation, so nothing to pass</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    -1);  <span class="comment">// same as above</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff31f521523d7a7b81ff5b750e081dac_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff31f521523d7a7b81ff5b750e081dac_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff31f521523d7a7b81ff5b750e081dac_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff31f521523d7a7b81ff5b750e081dac_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="227,317,377,358"/>
<area shape="rect" id="node50" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="430,118,605,160"/>
<area shape="rect" id="node3" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="425,318,609,360"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1171,100,1333,141"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1717,474,1866,516"/>
<area shape="rect" id="node7" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1147,734,1357,776"/>
<area shape="rect" id="node10" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1160,654,1344,710"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1171,537,1333,578"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1449,194,1604,236"/>
<area shape="rect" id="node15" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343" title="Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v..." alt="" coords="901,478,1087,520"/>
<area shape="rect" id="node19" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1151,318,1353,360"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="657,596,841,637"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="889,954,1099,996"/>
<area shape="rect" id="node48" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="680,41,819,82"/>
<area shape="rect" id="node49" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="679,158,820,200"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1711,133,1872,174"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ac661b8baf462a1e969a8a1c7e619858b" title="foedus::memory::PagePool\lOffsetChunk::empty" alt="" coords="1945,888,2124,929"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#af897b38ac1ef4217ff99018436c0112e" title="foedus::memory::PagePool\lOffsetChunk::pop_back" alt="" coords="1702,888,1881,929"/>
<area shape="rect" id="node13" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1714,298,1869,340"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1696,198,1887,240"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a6c9bf7d6b21ac33a61d6f7176023ea3a" title="Returns one free volatile page to local page pool. " alt="" coords="1413,705,1641,746"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ace44cb03e7da84d29f3a02a790c69191" title="foedus::memory::PagePool\lOffsetChunk::full" alt="" coords="1945,716,2124,757"/>
<area shape="rect" id="node18" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#a6f558bb023b2c5c7dd9bf7ab9d054ef0" title="foedus::memory::PagePool\lOffsetChunk::push_back" alt="" coords="1702,716,1881,757"/>
<area shape="rect" id="node20" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1440,260,1613,301"/>
<area shape="rect" id="node21" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1425,326,1628,382"/>
<area shape="rect" id="node47" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="902,646,1086,702"/>
<area shape="rect" id="node24" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="1185,982,1319,1024"/>
<area shape="rect" id="node25" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="1149,1429,1355,1470"/>
<area shape="rect" id="node35" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8" title="foedus::memory::PagePool\l::get_base" alt="" coords="1437,1004,1616,1045"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="1160,917,1344,958"/>
<area shape="rect" id="node38" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="1435,1069,1619,1110"/>
<area shape="rect" id="node43" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="1149,1200,1355,1241"/>
<area shape="rect" id="node46" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8" title="Get a tentative work memory of the specified size from pre&#45;allocated thread&#45;private memory..." alt="" coords="1171,852,1333,893"/>
<area shape="rect" id="node26" href="classfoedus_1_1cache_1_1CacheHashtable.html#a30b6a0b28cce30d50da7e0419c8cad20" title="Returns a bucket number the given page ID should belong to. " alt="" coords="1423,1265,1630,1306"/>
<area shape="rect" id="node28" href="structfoedus_1_1cache_1_1CacheBucket.html#ab91d1b89c885979b7a6a4ef70b12b54d" title="foedus::cache::CacheBucket\l::get_content_id" alt="" coords="1432,1526,1621,1568"/>
<area shape="rect" id="node29" href="classfoedus_1_1cache_1_1CacheHashtable.html#acea3236385a3b8d05ed1a60186e32ee8" title="foedus::cache::CacheHashtable\l::get_logical_buckets" alt="" coords="1423,1592,1630,1633"/>
<area shape="rect" id="node30" href="structfoedus_1_1cache_1_1HashFunc.html#a9470855bb66d98df48f82fc5ba6655c6" title="Returns another hash value used to differentiate IDs with similar hash values. " alt="" coords="1441,1330,1612,1372"/>
<area shape="rect" id="node31" href="structfoedus_1_1cache_1_1CacheBucket.html#aad7099f48418a335a80260a664bf2f02" title="foedus::cache::CacheBucket\l::get_tag" alt="" coords="1432,1461,1621,1502"/>
<area shape="rect" id="node32" href="structfoedus_1_1cache_1_1CacheRefCount.html#af555d7665e995d8e65f315c708d28daa" title="foedus::cache::CacheRefCount\l::increment" alt="" coords="1426,1396,1627,1437"/>
<area shape="rect" id="node33" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="1441,1657,1613,1698"/>
<area shape="rect" id="node27" href="structfoedus_1_1cache_1_1HashFunc.html#a19737fa3c91676f9c85536f5928b7501" title="Returns a bucket number the given snapshot page ID should belong to. " alt="" coords="1706,1265,1877,1306"/>
<area shape="rect" id="node34" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1705,1657,1877,1698"/>
<area shape="rect" id="node37" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ac3e2f6d24f2b0f5c04d2cde48db11f6a" title="Same, except it&#39;s for snapshot page. " alt="" coords="1414,938,1639,980"/>
<area shape="rect" id="node42" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a7ea5067e450fa872240cb010ddb65464" title="Same, except it&#39;s for snapshot page. " alt="" coords="1405,770,1648,812"/>
<area shape="rect" id="node39" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="1698,1069,1885,1110"/>
<area shape="rect" id="node40" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="1935,1098,2135,1154"/>
<area shape="rect" id="node41" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="1941,1032,2128,1073"/>
<area shape="rect" id="node44" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7" title="Equivalent to std::atomic_thread_fence(std::memory_order_release). " alt="" coords="1440,1134,1613,1176"/>
<area shape="rect" id="node45" href="structfoedus_1_1cache_1_1CacheBucket.html#aaa52396996e73a08cace2a2dcef82ffb" title="foedus::cache::CacheBucket\l::reset" alt="" coords="1432,1200,1621,1241"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff31f521523d7a7b81ff5b750e081dac_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff31f521523d7a7b81ff5b750e081dac_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff31f521523d7a7b81ff5b750e081dac_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff31f521523d7a7b81ff5b750e081dac_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a32332060560b864a857a839bb0adb4fd" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::fatify_first_root_double" alt="" coords="233,104,407,160"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0" title="Find a border node in the layer that corresponds to the given key slice. " alt="" coords="233,315,407,371"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6188e676e564b4ebecaa556178cdb81e" title="Follows to next layer&#39;s root page. " alt="" coords="233,216,407,272"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_border" alt="" coords="227,940,413,996"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_intermediate" alt="" coords="461,1017,683,1073"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ac3b15bb4f888327ba49050f62d020f52" title="Defined in masstree_storage_fatify.cpp. " alt="" coords="485,36,659,92"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a70b1c5e023fa0aac150e7b607e37727c" title="Deliberately causes splits under the volatile root of first layer, or &quot;fatify&quot; it. " alt="" coords="752,5,925,61"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. " alt="" coords="752,217,925,273"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a0ce23624d660da08cb1ee04ac2297171" title="Identifies page and record for the normalized key. " alt="" coords="483,657,661,713"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a52a1bce48d9230ad2ce3f52c4da51b8e" title="Like locate_record(), this is also a logical operation. " alt="" coords="485,147,659,203"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#acac5f9308b4aed46777d34f6fa171c8e" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::reserve_record_normalized" alt="" coords="480,332,664,388"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#acdf38eea62d1432e3715a661d0790caf" title="Retrieves an entire record of the given key in this Masstree. " alt="" coords="1014,553,1213,594"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a01a2996a1ee370611b72c88f33fe2753" title="Retrieves a part of the given key in this Masstree. " alt="" coords="1027,699,1200,755"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a3be736c76c38dd23444cbd78947a63fd" title="Retrieves a part of the given key in this Masstree as a primitive value. " alt="" coords="1027,137,1200,193"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="1006,862,1221,903"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="998,414,1229,455"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="1020,217,1207,273"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="995,298,1232,339"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a4f2492b6a04c2db18cdf2a4a2d7fecc0" title="Retrieves an entire record of the given primitive key in this Masstree. " alt="" coords="752,617,925,673"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adda60c43db1237644270e90f2a255d35" title="Retrieves a part of the given primitive key in this Masstree. " alt="" coords="752,777,925,833"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae4bf2da94babc15bf43bd50b17ffb562" title="Retrieves a part of the given primitive key in this Masstree as a primitive value. " alt="" coords="744,857,933,913"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="752,937,925,993"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="745,457,932,513"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="744,537,933,593"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="741,697,936,753"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="733,86,945,127"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="731,151,947,193"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="752,297,925,353"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="752,377,925,433"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_layer" alt="" coords="749,1017,928,1073"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a2a4e90569074d49ab538041caedacf6a" title="These are defined in masstree_storage_verify.cpp. " alt="" coords="1027,1017,1200,1073"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aedee683fbced316953d1cbc622f22c87" title="foedus::storage::masstree\l::MasstreeStorage::verify\l_single_thread" alt="" coords="1280,1017,1453,1073"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adc32aaf6f4537fcc1ada207e1d6902ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::get_first_root </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html">MasstreeIntermediatePage</a> **&#160;</td>
          <td class="paramname"><em>root</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Root-node related, such as a method to retrieve 1st-root, to grow, etc. </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">58</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="page_8hpp_source.html#l00402">foedus::storage::assert_aligned_page()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00353">foedus::thread::Thread::follow_page_pointer()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00118">get_first_root_pointer_address()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00099">foedus::storage::masstree::MasstreePage::get_high_fence()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00112">get_id()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00144">foedus::storage::masstree::MasstreePage::get_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00098">foedus::storage::masstree::MasstreePage::get_low_fence()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00139">foedus::storage::masstree::MasstreePage::has_foster_child()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="masstree__id_8hpp_source.html#l00132">foedus::storage::masstree::kInfimumSlice</a>, <a class="el" href="masstree__id_8hpp_source.html#l00137">foedus::storage::masstree::kSupremumSlice</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00952">foedus::thread::Thread::run_nested_sysxct()</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, and <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00042">approximate_count_root_children()</a>, <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00094">fatify_first_root_double()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00283">locate_record()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00336">locate_record_normalized()</a>, <a class="el" href="masstree__cursor_8cpp_source.html#l00932">foedus::storage::masstree::MasstreeCursor::open()</a>, <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00030">prefetch_pages_normalized()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00412">reserve_record()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00515">reserve_record_normalized()</a>, and <a class="el" href="masstree__storage__verify_8cpp_source.html#l00039">verify_single_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                   {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  DualPagePointer* root_pointer = <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008">get_first_root_pointer_address</a>();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  MasstreeIntermediatePage* page = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;follow_page_pointer(</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">false</span>,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    for_write,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">true</span>,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    root_pointer,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    reinterpret_cast&lt;Page**&gt;(&amp;page),</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    0));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec">assert_aligned_page</a>(page);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;get_layer() == 0);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;get_low_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;get_high_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">kSupremumSlice</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!for_write || !page-&gt;header().snapshot_);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(page-&gt;has_foster_child())) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!page-&gt;header().snapshot_);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// root page has a foster child... time for tree growth!</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// either case, we just follow the moved page. Master-Tree invariant guarantees it&#39;s safe.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;first_root_locked_) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="comment">// To avoid contention, we begin it only when the lock seems uncontended.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      DVLOG(0) &lt;&lt; <span class="stringliteral">&quot;Other thread seems growing the first-layer. let him do that&quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      GrowFirstLayerRoot functor(context, <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>());</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;functor, 2));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;get_layer() == 0);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;get_low_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;get_high_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">kSupremumSlice</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  *root = page;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_html_ab7207e6e276af504c0e358a923ee75ec"><div class="ttname"><a href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec">foedus::storage::assert_aligned_page</a></div><div class="ttdeci">void assert_aligned_page(const void *page)</div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00402">page.hpp:402</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a9cffc20f29ad72d4edbeedece861c48f"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">foedus::storage::masstree::kInfimumSlice</a></div><div class="ttdeci">const KeySlice kInfimumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00132">masstree_id.hpp:132</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a36d78c30d1b07389c3c0e7180e301008"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008">foedus::storage::masstree::MasstreeStoragePimpl::get_first_root_pointer_address</a></div><div class="ttdeci">DualPagePointer * get_first_root_pointer_address()</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00118">masstree_storage_pimpl.hpp:118</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aca6d912133fd8b46eacb660b840bada0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">foedus::storage::masstree::MasstreeStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00112">masstree_storage_pimpl.hpp:112</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a7bfcd277a96bcd1e9008459abe1ec40d"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">foedus::storage::masstree::kSupremumSlice</a></div><div class="ttdeci">const KeySlice kSupremumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00137">masstree_id.hpp:137</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adc32aaf6f4537fcc1ada207e1d6902ec_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adc32aaf6f4537fcc1ada207e1d6902ec_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adc32aaf6f4537fcc1ada207e1d6902ec_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adc32aaf6f4537fcc1ada207e1d6902ec_cgraph">
<area shape="rect" id="node2" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1773,418,1927,460"/>
<area shape="rect" id="node3" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="259,741,410,782"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer\l_address" alt="" coords="248,816,421,886"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="230,910,439,952"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="248,976,421,1032"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="247,1057,422,1098"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="233,1122,437,1164"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="227,1188,443,1229"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="248,1253,421,1294"/>
<area shape="rect" id="node42" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="259,1336,410,1377"/>
<area shape="rect" id="node4" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="495,705,679,746"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1261,1092,1423,1133"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1775,693,1925,734"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1237,594,1447,636"/>
<area shape="rect" id="node11" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1250,1011,1434,1067"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1261,777,1423,818"/>
<area shape="rect" id="node13" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1528,492,1683,533"/>
<area shape="rect" id="node15" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343" title="Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v..." alt="" coords="982,894,1169,936"/>
<area shape="rect" id="node18" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1241,660,1443,701"/>
<area shape="rect" id="node21" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="735,924,919,965"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="971,382,1180,424"/>
<area shape="rect" id="node31" href="classfoedus_1_1xct_1_1Xct.html#abae2ae5210db8eda39a1507940bf7352" title="Returns the level of isolation for this transaction. " alt="" coords="757,581,896,622"/>
<area shape="rect" id="node32" href="classfoedus_1_1xct_1_1Xct.html#adfd2125c9cc252494693f65719ed53b3" title="Add the given page pointer to the pointer set of this transaction. " alt="" coords="756,646,897,688"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1769,1092,1931,1133"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ac661b8baf462a1e969a8a1c7e619858b" title="foedus::memory::PagePool\lOffsetChunk::empty" alt="" coords="1761,316,1939,357"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#af897b38ac1ef4217ff99018436c0112e" title="foedus::memory::PagePool\lOffsetChunk::pop_back" alt="" coords="1516,345,1695,386"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1755,492,1945,533"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#a6c9bf7d6b21ac33a61d6f7176023ea3a" title="Returns one free volatile page to local page pool. " alt="" coords="1228,894,1456,936"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1PagePoolOffsetChunk.html#ace44cb03e7da84d29f3a02a790c69191" title="foedus::memory::PagePool\lOffsetChunk::full" alt="" coords="1516,894,1695,936"/>
<area shape="rect" id="node19" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1519,609,1692,650"/>
<area shape="rect" id="node20" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1504,411,1707,467"/>
<area shape="rect" id="node30" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="983,814,1167,870"/>
<area shape="rect" id="node23" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="1275,412,1409,453"/>
<area shape="rect" id="node24" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="1239,477,1445,518"/>
<area shape="rect" id="node25" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8" title="foedus::memory::PagePool\l::get_base" alt="" coords="1516,177,1695,218"/>
<area shape="rect" id="node26" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="1250,112,1434,153"/>
<area shape="rect" id="node27" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="1513,86,1697,128"/>
<area shape="rect" id="node28" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="1239,229,1445,270"/>
<area shape="rect" id="node29" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8" title="Get a tentative work memory of the specified size from pre&#45;allocated thread&#45;private memory..." alt="" coords="1261,294,1423,336"/>
<area shape="rect" id="node39" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="491,1197,683,1238"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="731,1214,923,1256"/>
<area shape="rect" id="node43" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="495,1345,679,1386"/>
<area shape="rect" id="node44" href="classfoedus_1_1xct_1_1Xct.html#aca66ae9959651b7c6fa86a75db287f54" title="foedus::xct::Xct::get\l_sysxct_workspace" alt="" coords="757,1410,896,1452"/>
<area shape="rect" id="node45" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a6ff575610172c3b1ed337665a277f761" title="foedus::thread::ThreadPimpl\l::cll_get_max_locked_id" alt="" coords="735,1476,919,1517"/>
<area shape="rect" id="node48" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a33a1b8b428cd84029b8b377867197ea4" title="foedus::thread::ThreadPimpl\l::is_simple_mcs_rw" alt="" coords="735,1280,919,1321"/>
<area shape="rect" id="node49" href="group__SYSXCT.html#gaf49955c6d4efe3d92e6e09b4ff890618" title="Runs a system transaction nested in a user transaction. " alt="" coords="747,1345,906,1386"/>
<area shape="rect" id="node46" href="classfoedus_1_1xct_1_1Xct.html#afc0b909c82e905105f4f9701082a16b8" title="foedus::xct::Xct::get\l_current_lock_list" alt="" coords="1006,1508,1145,1549"/>
<area shape="rect" id="node47" href="classfoedus_1_1xct_1_1CurrentLockList.html#a398ec264786992d102b8edd74d5767b3" title="foedus::xct::CurrentLock\lList::get_max_locked_id" alt="" coords="993,1442,1157,1484"/>
<area shape="rect" id="node50" href="structfoedus_1_1xct_1_1SysxctFunctor.html#a383a9cfd5d8fa5caf45c7ffb6dc05535" title="Execute the system transaction. " alt="" coords="973,1352,1178,1379"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adc32aaf6f4537fcc1ada207e1d6902ec_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adc32aaf6f4537fcc1ada207e1d6902ec_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adc32aaf6f4537fcc1ada207e1d6902ec_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_adc32aaf6f4537fcc1ada207e1d6902ec_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24" title="Returns the count of direct children in the first&#45;root node. " alt="" coords="234,46,407,117"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a32332060560b864a857a839bb0adb4fd" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::fatify_first_root_double" alt="" coords="484,53,657,109"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. " alt="" coords="484,293,657,349"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a0ce23624d660da08cb1ee04ac2297171" title="Identifies page and record for the normalized key. " alt="" coords="231,493,410,549"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a226f6c437144cfb13f8e64baecb41d8a" title="foedus::storage::masstree\l::MasstreeCursor::open" alt="" coords="234,781,407,822"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a99bb085d9e427fc36182b13bb20371e9" title="defined in masstree_storage_prefetch.cpp " alt="" coords="227,847,415,903"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a52a1bce48d9230ad2ce3f52c4da51b8e" title="Like locate_record(), this is also a logical operation. " alt="" coords="234,927,407,983"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#acac5f9308b4aed46777d34f6fa171c8e" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::reserve_record_normalized" alt="" coords="229,1065,413,1121"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a2a4e90569074d49ab538041caedacf6a" title="These are defined in masstree_storage_verify.cpp. " alt="" coords="234,1185,407,1241"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ac3b15bb4f888327ba49050f62d020f52" title="Defined in masstree_storage_fatify.cpp. " alt="" coords="759,5,932,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a70b1c5e023fa0aac150e7b607e37727c" title="Deliberately causes splits under the volatile root of first layer, or &quot;fatify&quot; it. " alt="" coords="1012,5,1185,61"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#acdf38eea62d1432e3715a661d0790caf" title="Retrieves an entire record of the given key in this Masstree. " alt="" coords="746,103,945,145"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a01a2996a1ee370611b72c88f33fe2753" title="Retrieves a part of the given key in this Masstree. " alt="" coords="759,169,932,225"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a3be736c76c38dd23444cbd78947a63fd" title="Retrieves a part of the given key in this Masstree as a primitive value. " alt="" coords="759,249,932,305"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="738,475,953,517"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="730,541,961,582"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="752,329,939,385"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="727,410,964,451"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a4f2492b6a04c2db18cdf2a4a2d7fecc0" title="Retrieves an entire record of the given primitive key in this Masstree. " alt="" coords="484,133,657,189"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adda60c43db1237644270e90f2a255d35" title="Retrieves a part of the given primitive key in this Masstree. " alt="" coords="484,213,657,269"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae4bf2da94babc15bf43bd50b17ffb562" title="Retrieves a part of the given primitive key in this Masstree as a primitive value. " alt="" coords="476,373,665,429"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="484,453,657,509"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="477,533,664,589"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="476,613,665,669"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="473,693,668,749"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a3ca58d4acdbc13f9cfd341d95f45caa2" title="foedus::storage::masstree\l::MasstreeCursor::open\l_normalized" alt="" coords="484,773,657,829"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a10db264b9d354e1813bd20ef8fdb72bb" title="Prefetch data pages in this storage. " alt="" coords="479,853,662,909"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="465,934,677,975"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="463,999,679,1041"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="484,1065,657,1121"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="484,1145,657,1201"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aedee683fbced316953d1cbc622f22c87" title="foedus::storage::masstree\l::MasstreeStorage::verify\l_single_thread" alt="" coords="484,1225,657,1281"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa23487ce62cb84213dedb7917cbf2602"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html">DualPagePointer</a>&amp; foedus::storage::masstree::MasstreeStoragePimpl::get_first_root_pointer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00115">115</a> of file <a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__peek_8cpp_source.html#l00037">peek_volatile_page_boundaries()</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                                        {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa23487ce62cb84213dedb7917cbf2602_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa23487ce62cb84213dedb7917cbf2602_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa23487ce62cb84213dedb7917cbf2602_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa23487ce62cb84213dedb7917cbf2602_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a67482433dfc680921b443bdb8a1ea78e" title="Defined in masstree_storage_peek.cpp. " alt="" coords="227,5,436,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#abf137494ad55ab4d60cec25c7c654e99" title="Checks the volatile pages of this storage to give hints to decide page boundary keys. " alt="" coords="484,5,657,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a36d78c30d1b07389c3c0e7180e301008"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html">DualPagePointer</a>* foedus::storage::masstree::MasstreeStoragePimpl::get_first_root_pointer_address </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00118">118</a> of file <a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">get_first_root()</a>.</p>
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{ <span class="keywordflow">return</span> &amp;<a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_; }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a36d78c30d1b07389c3c0e7180e301008_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a36d78c30d1b07389c3c0e7180e301008_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a36d78c30d1b07389c3c0e7180e301008_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a36d78c30d1b07389c3c0e7180e301008_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="227,773,400,829"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24" title="Returns the count of direct children in the first&#45;root node. " alt="" coords="455,46,629,117"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a32332060560b864a857a839bb0adb4fd" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::fatify_first_root_double" alt="" coords="705,53,879,109"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. " alt="" coords="705,293,879,349"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a0ce23624d660da08cb1ee04ac2297171" title="Identifies page and record for the normalized key. " alt="" coords="453,493,631,549"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a226f6c437144cfb13f8e64baecb41d8a" title="foedus::storage::masstree\l::MasstreeCursor::open" alt="" coords="455,781,629,822"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a99bb085d9e427fc36182b13bb20371e9" title="defined in masstree_storage_prefetch.cpp " alt="" coords="448,847,636,903"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a52a1bce48d9230ad2ce3f52c4da51b8e" title="Like locate_record(), this is also a logical operation. " alt="" coords="455,927,629,983"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#acac5f9308b4aed46777d34f6fa171c8e" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::reserve_record_normalized" alt="" coords="450,1065,634,1121"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a2a4e90569074d49ab538041caedacf6a" title="These are defined in masstree_storage_verify.cpp. " alt="" coords="455,1185,629,1241"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ac3b15bb4f888327ba49050f62d020f52" title="Defined in masstree_storage_fatify.cpp. " alt="" coords="980,5,1153,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a70b1c5e023fa0aac150e7b607e37727c" title="Deliberately causes splits under the volatile root of first layer, or &quot;fatify&quot; it. " alt="" coords="1233,5,1407,61"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#acdf38eea62d1432e3715a661d0790caf" title="Retrieves an entire record of the given key in this Masstree. " alt="" coords="967,103,1166,145"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a01a2996a1ee370611b72c88f33fe2753" title="Retrieves a part of the given key in this Masstree. " alt="" coords="980,169,1153,225"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a3be736c76c38dd23444cbd78947a63fd" title="Retrieves a part of the given key in this Masstree as a primitive value. " alt="" coords="980,249,1153,305"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="959,475,1174,517"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="951,541,1182,582"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="973,329,1160,385"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="948,410,1185,451"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a4f2492b6a04c2db18cdf2a4a2d7fecc0" title="Retrieves an entire record of the given primitive key in this Masstree. " alt="" coords="705,133,879,189"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adda60c43db1237644270e90f2a255d35" title="Retrieves a part of the given primitive key in this Masstree. " alt="" coords="705,213,879,269"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae4bf2da94babc15bf43bd50b17ffb562" title="Retrieves a part of the given primitive key in this Masstree as a primitive value. " alt="" coords="697,373,887,429"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="705,453,879,509"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="699,533,885,589"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="697,613,887,669"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="695,693,889,749"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a3ca58d4acdbc13f9cfd341d95f45caa2" title="foedus::storage::masstree\l::MasstreeCursor::open\l_normalized" alt="" coords="705,773,879,829"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a10db264b9d354e1813bd20ef8fdb72bb" title="Prefetch data pages in this storage. " alt="" coords="701,853,883,909"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="686,934,898,975"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="684,999,900,1041"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="705,1065,879,1121"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="705,1145,879,1201"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aedee683fbced316953d1cbc622f22c87" title="foedus::storage::masstree\l::MasstreeStorage::verify\l_single_thread" alt="" coords="705,1225,879,1281"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aca6d912133fd8b46eacb660b840bada0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__STORAGE.html#ga595ca7fc4a3011a9704a883a25141e5f">StorageId</a> foedus::storage::masstree::MasstreeStoragePimpl::get_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00112">112</a> of file <a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00691">delete_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">get_first_root()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00806">increment_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00661">insert_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00122">load_empty()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00772">overwrite_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00645">register_record_write_log()</a>, and <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00711">upsert_general()</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_.id_; }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aca6d912133fd8b46eacb660b840bada0_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aca6d912133fd8b46eacb660b840bada0_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aca6d912133fd8b46eacb660b840bada0_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aca6d912133fd8b46eacb660b840bada0_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a45396b70b246f330355397b447af55f3" title="implementation of delete_record family. " alt="" coords="460,122,633,178"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="227,1359,401,1415"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa71566d3a4d56ded35df567784b13525" title="implementation of increment_record family. " alt="" coords="460,995,633,1051"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#af0b96482a874777c4871a152ad733da3" title="implementation of insert_record family. " alt="" coords="460,1075,633,1131"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a9c2b2febfce356451e8183f66f71dcc3" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::load_empty" alt="" coords="227,1778,401,1834"/>
<area shape="rect" id="node45" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ab9cc59cbbef3fd23a62cbd25cbd00abb" title="implementation of overwrite_record family. " alt="" coords="460,747,633,803"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549" title="Used in the following methods. " alt="" coords="227,978,401,1034"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aeeccc272d2f9a4d895f4d117f6b96b27" title="implementation of upsert_record family. " alt="" coords="460,1235,633,1291"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#af263fb1494c7ac6a5dbfd28b926ede3b" title="foedus::storage::masstree\l::MasstreeCursor::delete_record" alt="" coords="703,5,911,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="982,129,1197,171"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="721,122,894,178"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6c9eb02ad32cc1bffe9daac3521ad24" title="Returns the count of direct children in the first&#45;root node. " alt="" coords="460,1396,633,1467"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a32332060560b864a857a839bb0adb4fd" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::fatify_first_root_double" alt="" coords="721,1469,894,1525"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. " alt="" coords="721,282,894,338"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a0ce23624d660da08cb1ee04ac2297171" title="Identifies page and record for the normalized key. " alt="" coords="457,482,636,538"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a226f6c437144cfb13f8e64baecb41d8a" title="foedus::storage::masstree\l::MasstreeCursor::open" alt="" coords="460,1543,633,1584"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a99bb085d9e427fc36182b13bb20371e9" title="defined in masstree_storage_prefetch.cpp " alt="" coords="453,1610,641,1666"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a52a1bce48d9230ad2ce3f52c4da51b8e" title="Like locate_record(), this is also a logical operation. " alt="" coords="460,1155,633,1211"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#acac5f9308b4aed46777d34f6fa171c8e" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::reserve_record_normalized" alt="" coords="455,1315,639,1371"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a2a4e90569074d49ab538041caedacf6a" title="These are defined in masstree_storage_verify.cpp. " alt="" coords="460,1693,633,1749"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ac3b15bb4f888327ba49050f62d020f52" title="Defined in masstree_storage_fatify.cpp. " alt="" coords="1003,1435,1176,1491"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a70b1c5e023fa0aac150e7b607e37727c" title="Deliberately causes splits under the volatile root of first layer, or &quot;fatify&quot; it. " alt="" coords="1256,1435,1429,1491"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#acdf38eea62d1432e3715a661d0790caf" title="Retrieves an entire record of the given key in this Masstree. " alt="" coords="990,212,1189,253"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a01a2996a1ee370611b72c88f33fe2753" title="Retrieves a part of the given key in this Masstree. " alt="" coords="1003,362,1176,418"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a3be736c76c38dd23444cbd78947a63fd" title="Retrieves a part of the given key in this Masstree as a primitive value. " alt="" coords="1003,282,1176,338"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="974,529,1205,571"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="996,657,1183,713"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="971,871,1208,912"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a4f2492b6a04c2db18cdf2a4a2d7fecc0" title="Retrieves an entire record of the given primitive key in this Masstree. " alt="" coords="721,202,894,258"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adda60c43db1237644270e90f2a255d35" title="Retrieves a part of the given primitive key in this Masstree. " alt="" coords="721,362,894,418"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae4bf2da94babc15bf43bd50b17ffb562" title="Retrieves a part of the given primitive key in this Masstree as a primitive value. " alt="" coords="713,442,902,498"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="714,522,901,578"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="713,602,902,658"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="710,930,905,986"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a3ca58d4acdbc13f9cfd341d95f45caa2" title="foedus::storage::masstree\l::MasstreeCursor::open\l_normalized" alt="" coords="721,1549,894,1605"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a10db264b9d354e1813bd20ef8fdb72bb" title="Prefetch data pages in this storage. " alt="" coords="716,1629,899,1685"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="701,1127,913,1168"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="699,1192,915,1233"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="721,1258,894,1314"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="721,1338,894,1394"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aedee683fbced316953d1cbc622f22c87" title="foedus::storage::masstree\l::MasstreeStorage::verify\l_single_thread" alt="" coords="721,1709,894,1765"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a81ce493961aa7dedc518ca4230d01868" title="foedus::storage::masstree\l::MasstreeCursor::increment_record" alt="" coords="692,1061,923,1103"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a192a4976aa71f457b356bf536d9f5fc2" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::create" alt="" coords="460,1778,633,1834"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a8d4ac5a88e7ce112f83b67597719fa82" title="foedus::storage::masstree\l::MasstreeStoragePimpl::load" alt="" coords="449,1859,644,1900"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a92ad35031262ae95e767c53746de2e29" title="foedus::storage::masstree\l::MasstreeStorage::create" alt="" coords="721,1789,894,1831"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a2731aaf3a733c773a63df6d691ede3ac" title="foedus::storage::masstree\l::MasstreeStorage::load" alt="" coords="721,1859,894,1900"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#ab8b1919cb195dd063be409f772b36630" title="foedus::storage::masstree\l::MasstreeCursor::overwrite_record" alt="" coords="696,784,919,825"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a496370a645284f8578875529c6eacb0f" title="foedus::storage::masstree\l::MasstreeCursor::overwrite\l_record_primitive" alt="" coords="717,850,897,906"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a950d071732ec8bd3251c03181d42692f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeMetadata.html">MasstreeMetadata</a>&amp; foedus::storage::masstree::MasstreeStoragePimpl::get_meta </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00114">114</a> of file <a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00176">load()</a>, and <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00412">reserve_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_; }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a950d071732ec8bd3251c03181d42692f_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a950d071732ec8bd3251c03181d42692f_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a950d071732ec8bd3251c03181d42692f_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a950d071732ec8bd3251c03181d42692f_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a8d4ac5a88e7ce112f83b67597719fa82" title="foedus::storage::masstree\l::MasstreeStoragePimpl::load" alt="" coords="227,5,421,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a52a1bce48d9230ad2ce3f52c4da51b8e" title="Like locate_record(), this is also a logical operation. " alt="" coords="237,71,411,127"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a2731aaf3a733c773a63df6d691ede3ac" title="foedus::storage::masstree\l::MasstreeStorage::load" alt="" coords="491,5,664,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="471,75,683,116"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="469,140,685,181"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a94e2b69404cabddbead1d1fb0ef1dc42"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacefoedus_1_1storage.html#a0c15c034d49af969335271617a73a846">StorageName</a>&amp; foedus::storage::masstree::MasstreeStoragePimpl::get_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00113">113</a> of file <a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a>.</p>

<p>References <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00164">create()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00105">drop()</a>, <a class="el" href="masstree__storage__fatify_8cpp_source.html#l00054">fatify_first_root()</a>, and <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00030">prefetch_pages_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_.name_; }</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a94e2b69404cabddbead1d1fb0ef1dc42_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a94e2b69404cabddbead1d1fb0ef1dc42_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a94e2b69404cabddbead1d1fb0ef1dc42_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a94e2b69404cabddbead1d1fb0ef1dc42_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a192a4976aa71f457b356bf536d9f5fc2" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::create" alt="" coords="237,5,411,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a67ab7c42dbfd788773d6293ffdb64d52" title="Storage&#45;wide operations, such as drop, create, etc. " alt="" coords="227,86,421,127"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ac3b15bb4f888327ba49050f62d020f52" title="Defined in masstree_storage_fatify.cpp. " alt="" coords="237,152,411,208"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a99bb085d9e427fc36182b13bb20371e9" title="defined in masstree_storage_prefetch.cpp " alt="" coords="230,232,418,288"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a92ad35031262ae95e767c53746de2e29" title="foedus::storage::masstree\l::MasstreeStorage::create" alt="" coords="474,13,647,54"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a40e22349aa6902839d3b80ac35e84790" title="foedus::storage::masstree\l::MasstreeStorage::drop" alt="" coords="474,86,647,127"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a70b1c5e023fa0aac150e7b607e37727c" title="Deliberately causes splits under the volatile root of first layer, or &quot;fatify&quot; it. " alt="" coords="474,152,647,208"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a10db264b9d354e1813bd20ef8fdb72bb" title="Prefetch data pages in this storage. " alt="" coords="469,232,652,288"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0fe6a82d90f30d4b9724009ba2fc40ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::hcc_reset_all_temperature_stat </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For stupid reasons (I'm lazy!) these are defined in _debug.cpp. </p>

<p>Definition at line <a class="el" href="masstree__storage__debug_8cpp_source.html#l00151">151</a> of file <a class="el" href="masstree__storage__debug_8cpp_source.html">masstree_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a>, <a class="el" href="masstree__storage__debug_8cpp_source.html#l00192">hcc_reset_all_temperature_stat_follow()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00586">foedus::storage::masstree::MasstreeStorage::hcc_reset_all_temperature_stat()</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                                                {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;**&quot;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***************************************************************&quot;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***   Reseting &quot;</span> &lt;&lt; MasstreeStorage(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>, <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>) &lt;&lt; <span class="stringliteral">&quot;&#39;s &quot;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;*** temperature stat for HCC&quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;***************************************************************&quot;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  DualPagePointer pointer = <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">if</span> (pointer.volatile_pointer_.is_null()) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;No volatile pages.&quot;</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a89828c1df02cadd8a38824f24e2adef9">hcc_reset_all_temperature_stat_follow</a>(pointer.volatile_pointer_));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Done resettting&quot;</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a89828c1df02cadd8a38824f24e2adef9"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a89828c1df02cadd8a38824f24e2adef9">foedus::storage::masstree::MasstreeStoragePimpl::hcc_reset_all_temperature_stat_follow</a></div><div class="ttdeci">ErrorStack hcc_reset_all_temperature_stat_follow(VolatilePagePointer page_id)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__debug_8cpp_source.html#l00192">masstree_storage_debug.cpp:192</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0fe6a82d90f30d4b9724009ba2fc40ae_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0fe6a82d90f30d4b9724009ba2fc40ae_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0fe6a82d90f30d4b9724009ba2fc40ae_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0fe6a82d90f30d4b9724009ba2fc40ae_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a89828c1df02cadd8a38824f24e2adef9" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::hcc_reset_all_temperature\l_stat_follow" alt="" coords="265,129,448,200"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="521,5,682,47"/>
<area shape="rect" id="node5" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="534,71,669,112"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="496,137,707,193"/>
<area shape="rect" id="node7" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="500,217,703,259"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a7e4b647b3c95a74b4de7fd18931cafb3" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::hcc_reset_all_temperature\l_stat_recurse" alt="" coords="510,429,693,500"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1053,17,1215,59"/>
<area shape="rect" id="node8" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="795,115,950,156"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1059,104,1209,145"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="786,180,959,221"/>
<area shape="rect" id="node13" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="771,246,974,302"/>
<area shape="rect" id="node9" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1057,212,1211,253"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1039,281,1229,323"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="2028,501,2235,543"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="785,327,960,368"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="786,444,959,485"/>
<area shape="rect" id="node18" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="773,509,972,551"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="779,575,967,631"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="783,655,962,711"/>
<area shape="rect" id="node32" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="755,799,991,855"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1773,501,1980,543"/>
<area shape="rect" id="node21" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="1073,583,1195,624"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="1045,654,1223,710"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="1277,581,1499,623"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="1299,654,1477,710"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="1547,494,1725,550"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="1547,574,1725,630"/>
<area shape="rect" id="node28" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="1549,734,1723,790"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="1547,654,1725,710"/>
<area shape="rect" id="node29" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="1797,693,1957,719"/>
<area shape="rect" id="node30" href="namespacefoedus_1_1storage_1_1masstree.html#a575ba44804b98a334fc66eedf4b18d70" title="foedus::storage::masstree\l::calculate_suffix_length" alt="" coords="1790,744,1963,785"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="1041,865,1227,921"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0fe6a82d90f30d4b9724009ba2fc40ae_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0fe6a82d90f30d4b9724009ba2fc40ae_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0fe6a82d90f30d4b9724009ba2fc40ae_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0fe6a82d90f30d4b9724009ba2fc40ae_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad23c8139c379dac6b0a1c07a52debd62" title="Resets all volatile pages&#39; temperature stat to be zero in this storage. " alt="" coords="265,5,448,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a89828c1df02cadd8a38824f24e2adef9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::hcc_reset_all_temperature_stat_follow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1VolatilePagePointer.html">VolatilePagePointer</a>&#160;</td>
          <td class="paramname"><em>page_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__debug_8cpp_source.html#l00192">192</a> of file <a class="el" href="masstree__storage__debug_8cpp_source.html">masstree_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="masstree__storage__debug_8cpp_source.html#l00170">hcc_reset_all_temperature_stat_recurse()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, and <a class="el" href="page__resolver_8hpp_source.html#l00120">foedus::memory::GlobalVolatilePageResolver::resolve_offset()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__debug_8cpp_source.html#l00151">hcc_reset_all_temperature_stat()</a>, and <a class="el" href="masstree__storage__debug_8cpp_source.html#l00170">hcc_reset_all_temperature_stat_recurse()</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                               {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">if</span> (page_id.is_null()) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    MasstreePage* page = <span class="keyword">reinterpret_cast&lt;</span>MasstreePage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">get_global_volatile_page_resolver</a>().<a class="code" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f">resolve_offset</a>(page_id));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a7e4b647b3c95a74b4de7fd18931cafb3">hcc_reset_all_temperature_stat_recurse</a>(page));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div>
<div class="ttc" id="structfoedus_1_1memory_1_1GlobalVolatilePageResolver_html_a56250946b7719a7bd15532d211eac88f"><div class="ttname"><a href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f">foedus::memory::GlobalVolatilePageResolver::resolve_offset</a></div><div class="ttdeci">storage::Page * resolve_offset(uint8_t numa_node, PagePoolOffset offset) const __attribute__((always_inline))</div><div class="ttdoc">Resolves offset plus NUMA node ID to storage::Page*. </div><div class="ttdef"><b>Definition:</b> <a href="page__resolver_8hpp_source.html#l00120">page_resolver.hpp:120</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a62b2d4de6a72644e9e31d35a7f9beae0"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0">foedus::memory::EngineMemory::get_global_volatile_page_resolver</a></div><div class="ttdeci">const GlobalVolatilePageResolver &amp; get_global_volatile_page_resolver() const </div><div class="ttdoc">Returns the page resolver to convert volatile page ID to page pointer. </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00090">engine_memory.hpp:90</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a7e4b647b3c95a74b4de7fd18931cafb3"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a7e4b647b3c95a74b4de7fd18931cafb3">foedus::storage::masstree::MasstreeStoragePimpl::hcc_reset_all_temperature_stat_recurse</a></div><div class="ttdeci">ErrorStack hcc_reset_all_temperature_stat_recurse(MasstreePage *parent)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__debug_8cpp_source.html#l00170">masstree_storage_debug.cpp:170</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a89828c1df02cadd8a38824f24e2adef9_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a89828c1df02cadd8a38824f24e2adef9_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a89828c1df02cadd8a38824f24e2adef9_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a89828c1df02cadd8a38824f24e2adef9_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="236,132,447,188"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="274,213,409,254"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a7e4b647b3c95a74b4de7fd18931cafb3" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::hcc_reset_all_temperature\l_stat_recurse" alt="" coords="250,278,433,349"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="261,438,422,480"/>
<area shape="rect" id="node27" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="240,637,443,678"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1768,66,1975,108"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="525,446,700,488"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="526,74,699,116"/>
<area shape="rect" id="node9" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="513,140,712,181"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="519,366,707,422"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="523,286,702,342"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="495,206,731,262"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="779,497,969,538"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1513,332,1720,373"/>
<area shape="rect" id="node12" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="813,373,935,414"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="785,286,963,342"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="1017,256,1239,297"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="1039,322,1217,378"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="1287,284,1465,340"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="1287,124,1465,180"/>
<area shape="rect" id="node19" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="1289,204,1463,260"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="1287,364,1465,420"/>
<area shape="rect" id="node20" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="1537,230,1697,256"/>
<area shape="rect" id="node21" href="namespacefoedus_1_1storage_1_1masstree.html#a575ba44804b98a334fc66eedf4b18d70" title="foedus::storage::masstree\l::calculate_suffix_length" alt="" coords="1530,164,1703,205"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="781,206,967,262"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="793,564,955,605"/>
<area shape="rect" id="node28" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="535,564,690,605"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="799,700,949,741"/>
<area shape="rect" id="node31" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="526,761,699,802"/>
<area shape="rect" id="node32" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="511,630,714,686"/>
<area shape="rect" id="node29" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="797,633,951,674"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a89828c1df02cadd8a38824f24e2adef9_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a89828c1df02cadd8a38824f24e2adef9_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a89828c1df02cadd8a38824f24e2adef9_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a89828c1df02cadd8a38824f24e2adef9_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a0fe6a82d90f30d4b9724009ba2fc40ae" title="For stupid reasons (I&#39;m lazy!) these are defined in _debug.cpp. " alt="" coords="236,5,448,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a7e4b647b3c95a74b4de7fd18931cafb3" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::hcc_reset_all_temperature\l_stat_recurse" alt="" coords="251,86,433,157"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad23c8139c379dac6b0a1c07a52debd62" title="Resets all volatile pages&#39; temperature stat to be zero in this storage. " alt="" coords="496,5,679,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7e4b647b3c95a74b4de7fd18931cafb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::hcc_reset_all_temperature_stat_recurse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *&#160;</td>
          <td class="paramname"><em>parent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__debug_8cpp_source.html#l00170">170</a> of file <a class="el" href="masstree__storage__debug_8cpp_source.html">masstree_storage_debug.cpp</a>.</p>

<p>References <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00796">foedus::storage::masstree::MasstreeBorderPage::does_point_to_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00148">foedus::storage::masstree::MasstreePage::get_key_count()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00750">foedus::storage::masstree::MasstreeBorderPage::get_next_layer()</a>, <a class="el" href="masstree__storage__debug_8cpp_source.html#l00192">hcc_reset_all_temperature_stat_follow()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="page_8hpp_source.html#l00268">foedus::storage::PageHeader::hotness_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00084">foedus::storage::masstree::MasstreePage::is_border()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01067">foedus::storage::masstree::MasstreeIntermediatePointerIterator::is_valid()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="prob__counter_8hpp_source.html#l00049">foedus::assorted::ProbCounter::reset()</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__debug_8cpp_source.html#l00192">hcc_reset_all_temperature_stat_follow()</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                                                                            {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  uint16_t key_count = parent-&gt;get_key_count();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">if</span> (parent-&gt;is_border()) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    MasstreeBorderPage* casted = <span class="keyword">reinterpret_cast&lt;</span>MasstreeBorderPage*<span class="keyword">&gt;</span>(parent);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    casted-&gt;header().hotness_.reset();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">for</span> (uint16_t i = 0; i &lt; key_count; ++i) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">if</span> (casted-&gt;does_point_to_layer(i)) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a89828c1df02cadd8a38824f24e2adef9">hcc_reset_all_temperature_stat_follow</a>(</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          casted-&gt;get_next_layer(i)-&gt;volatile_pointer_));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    MasstreeIntermediatePage* casted = <span class="keyword">reinterpret_cast&lt;</span>MasstreeIntermediatePage*<span class="keyword">&gt;</span>(parent);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">for</span> (MasstreeIntermediatePointerIterator it(casted); it.is_valid(); it.next()) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a89828c1df02cadd8a38824f24e2adef9">hcc_reset_all_temperature_stat_follow</a>(</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        it.get_pointer().volatile_pointer_));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a89828c1df02cadd8a38824f24e2adef9"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a89828c1df02cadd8a38824f24e2adef9">foedus::storage::masstree::MasstreeStoragePimpl::hcc_reset_all_temperature_stat_follow</a></div><div class="ttdeci">ErrorStack hcc_reset_all_temperature_stat_follow(VolatilePagePointer page_id)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__debug_8cpp_source.html#l00192">masstree_storage_debug.cpp:192</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a7e4b647b3c95a74b4de7fd18931cafb3_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a7e4b647b3c95a74b4de7fd18931cafb3_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a7e4b647b3c95a74b4de7fd18931cafb3_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a7e4b647b3c95a74b4de7fd18931cafb3_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="260,412,448,468"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1541,222,1748,263"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="265,273,443,329"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a89828c1df02cadd8a38824f24e2adef9" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::hcc_reset_all_temperature\l_stat_follow" alt="" coords="263,543,445,614"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="267,690,441,731"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="538,814,713,855"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="236,94,472,150"/>
<area shape="rect" id="node32" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="255,755,453,796"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1287,222,1493,263"/>
<area shape="rect" id="node5" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="564,426,687,467"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="536,244,715,300"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="779,251,1000,292"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="800,134,979,190"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="1054,214,1233,270"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="1054,294,1233,350"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="1057,54,1230,110"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="1054,134,1233,190"/>
<area shape="rect" id="node13" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="1310,62,1470,89"/>
<area shape="rect" id="node14" href="namespacefoedus_1_1storage_1_1masstree.html#a575ba44804b98a334fc66eedf4b18d70" title="foedus::storage::masstree\l::calculate_suffix_length" alt="" coords="1303,114,1477,155"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="520,616,731,672"/>
<area shape="rect" id="node18" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="558,696,693,738"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="809,755,970,796"/>
<area shape="rect" id="node21" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="524,550,727,591"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1063,719,1224,760"/>
<area shape="rect" id="node22" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="812,690,967,731"/>
<area shape="rect" id="node24" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1069,552,1218,594"/>
<area shape="rect" id="node26" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="803,492,976,534"/>
<area shape="rect" id="node27" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="788,609,991,665"/>
<area shape="rect" id="node23" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1066,620,1221,662"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1048,799,1239,840"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="533,94,718,150"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a7e4b647b3c95a74b4de7fd18931cafb3_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a7e4b647b3c95a74b4de7fd18931cafb3_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a7e4b647b3c95a74b4de7fd18931cafb3_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a7e4b647b3c95a74b4de7fd18931cafb3_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a89828c1df02cadd8a38824f24e2adef9" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::hcc_reset_all_temperature\l_stat_follow" alt="" coords="236,5,419,76"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a0fe6a82d90f30d4b9724009ba2fc40ae" title="For stupid reasons (I&#39;m lazy!) these are defined in _debug.cpp. " alt="" coords="467,13,679,69"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad23c8139c379dac6b0a1c07a52debd62" title="Resets all volatile pages&#39; temperature stat to be zero in this storage. " alt="" coords="727,13,909,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa71566d3a4d56ded35df567784b13525"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename PAYLOAD &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::increment_general </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>be_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a>&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PAYLOAD *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>payload_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of increment_record family. </p>
<p>use with <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. ">locate_record()</a> </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00806">806</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="masstree__log__types_8hpp_source.html#l00098">foedus::storage::masstree::MasstreeCommonLogType::calculate_log_length()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00589">check_next_layer_bit()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00112">get_id()</a>, <a class="el" href="thread_8hpp_source.html#l00066">foedus::thread::Thread::get_numa_node()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00832">foedus::storage::masstree::MasstreeBorderPage::get_payload_length()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00740">foedus::storage::masstree::MasstreeBorderPage::get_record_payload()</a>, <a class="el" href="thread_8cpp_source.html#l00078">foedus::thread::Thread::get_thread_log_buffer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00043">foedus::storage::masstree::RecordLocation::index_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="error__code_8hpp_source.html#l00176">foedus::kErrorCodeStrTooShortPayload</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00048">foedus::storage::masstree::RecordLocation::observed_</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00041">foedus::storage::masstree::RecordLocation::page_</a>, <a class="el" href="masstree__log__types_8hpp_source.html#l00436">foedus::storage::masstree::MasstreeOverwriteLogType::populate()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00645">register_record_write_log()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">foedus::log::ThreadLogBuffer::reserve_new_log()</a>, and <a class="el" href="page_8hpp_source.html#l00251">foedus::storage::PageHeader::stat_last_updater_node_</a>.</p>

<p>Referenced by <a class="el" href="masstree__cursor_8cpp_source.html#l01317">foedus::storage::masstree::MasstreeCursor::increment_record()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00523">foedus::storage::masstree::MasstreeStorage::increment_record()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00553">foedus::storage::masstree::MasstreeStorage::increment_record_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordflow">if</span> (location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">// in this case, we don&#39;t need a page-version set. the physical record is surely there.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">check_next_layer_bit</a>(location.observed_));</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  MasstreeBorderPage* border = location.page_;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordflow">if</span> (border-&gt;get_payload_length(location.index_) &lt; payload_offset + <span class="keyword">sizeof</span>(PAYLOAD)) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;short record &quot;</span>;  <span class="comment">// probably this is a rare error. so warn.</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">kErrorCodeStrTooShortPayload</a>;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="keywordtype">char</span>* ptr = border-&gt;get_record_payload(location.index_) + payload_offset;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  *value += *<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>PAYLOAD*<span class="keyword">&gt;</span>(ptr);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3">MasstreeOverwriteLogType::calculate_log_length</a>(key_length, <span class="keyword">sizeof</span>(PAYLOAD));</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  MasstreeOverwriteLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>MasstreeOverwriteLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  log_entry-&gt;populate(</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>(),</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    be_key,</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    key_length,</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    value,</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    payload_offset,</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keyword">sizeof</span>(PAYLOAD));</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  border-&gt;header().stat_last_updater_node_ = context-&gt;get_numa_node();</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">register_record_write_log</a>(context, location, log_entry);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">foedus::kErrorCodeStrTooShortPayload</a></div><div class="ttdoc">0x080A : "STORAGE: The record&#39;s payload is smaller than requested" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00176">error_code.hpp:176</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a3036d6662c0bd89e330ca19cbca1f549"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">foedus::storage::masstree::MasstreeStoragePimpl::register_record_write_log</a></div><div class="ttdeci">ErrorCode register_record_write_log(thread::Thread *context, const RecordLocation &amp;location, log::RecordLogType *log_entry)</div><div class="ttdoc">Used in the following methods. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00645">masstree_storage_pimpl.cpp:645</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aca6d912133fd8b46eacb660b840bada0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">foedus::storage::masstree::MasstreeStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00112">masstree_storage_pimpl.hpp:112</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType_html_aaa0d49b768842255f27147327cc72ef3"><div class="ttname"><a href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3">foedus::storage::masstree::MasstreeCommonLogType::calculate_log_length</a></div><div class="ttdeci">static uint16_t calculate_log_length(KeyLength key_length, PayloadLength payload_count) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__log__types_8hpp_source.html#l00098">masstree_log_types.hpp:98</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">foedus::storage::masstree::MasstreeStoragePimpl::check_next_layer_bit</a></div><div class="ttdeci">static ErrorCode check_next_layer_bit(xct::XctId observed) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00589">masstree_storage_pimpl.cpp:589</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa71566d3a4d56ded35df567784b13525_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa71566d3a4d56ded35df567784b13525_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa71566d3a4d56ded35df567784b13525_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa71566d3a4d56ded35df567784b13525_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3" title="foedus::storage::masstree\l::MasstreeCommonLogType\l::calculate_log_length" alt="" coords="228,60,412,116"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::check_next_layer_bit" alt="" coords="233,525,407,581"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="485,329,659,385"/>
<area shape="rect" id="node7" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="245,606,395,647"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a634aa97d761122a7d7cd4cb7889d844f" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_payload_length" alt="" coords="231,315,409,371"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="231,235,409,291"/>
<area shape="rect" id="node21" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="243,671,397,713"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="233,737,407,778"/>
<area shape="rect" id="node23" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="259,802,381,843"/>
<area shape="rect" id="node24" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeOverwriteLogType.html#ad59889a05bfad73c47891ee9be60d7f2" title="foedus::storage::masstree\l::MasstreeOverwriteLogType\l::populate" alt="" coords="227,868,413,924"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549" title="Used in the following methods. " alt="" coords="233,445,407,501"/>
<area shape="rect" id="node38" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="227,949,413,990"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="989,5,1149,32"/>
<area shape="rect" id="node5" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="511,673,633,714"/>
<area shape="rect" id="node8" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="483,803,661,845"/>
<area shape="rect" id="node9" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="497,738,647,779"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="965,238,1172,279"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1220,238,1427,279"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="461,263,683,305"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="483,132,661,188"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="735,263,913,319"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="735,343,913,399"/>
<area shape="rect" id="node18" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="737,52,911,108"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="735,132,913,188"/>
<area shape="rect" id="node19" href="namespacefoedus_1_1storage_1_1masstree.html#a575ba44804b98a334fc66eedf4b18d70" title="foedus::storage::masstree\l::calculate_suffix_length" alt="" coords="982,59,1155,101"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="483,409,661,465"/>
<area shape="rect" id="node27" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="497,555,647,597"/>
<area shape="rect" id="node28" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="501,490,643,531"/>
<area shape="rect" id="node31" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="753,589,895,630"/>
<area shape="rect" id="node29" href="group__LOGTYPE.html#gad2d33090f44d00949a05c245e5ff1046" title="Invokes the assertion logic of each log type. " alt="" coords="1004,490,1133,531"/>
<area shape="rect" id="node30" href="structfoedus_1_1log_1_1LogHeader.html#a6ebe3b99442f2a58a4adeeb60f9a37e0" title="Convenience method to cast into LogCode. " alt="" coords="1246,490,1401,531"/>
<area shape="rect" id="node32" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a1ff8ccbccdede750fb5a18b4da505ad9" title="foedus::xct::Retrospective\lLockList::get_volatile\l_page_resolver" alt="" coords="983,556,1155,612"/>
<area shape="rect" id="node33" href="namespacefoedus_1_1storage.html#a263602e0a73eedbe5f32128635106e17" title="foedus::storage::assert\l_within_valid_volatile_page" alt="" coords="981,637,1156,678"/>
<area shape="rect" id="node35" href="structfoedus_1_1xct_1_1RecordXctAccess.html#ace820ba89437e4d3a59fdb47a47525ba" title="Calculate owner_lock_id using the resolver. " alt="" coords="968,706,1169,747"/>
<area shape="rect" id="node34" href="namespacefoedus_1_1storage.html#ad38ebb5eb992249a7b42001fe464ec48" title="foedus::storage::assert\l_within_valid_volatile\l_page_impl" alt="" coords="1246,625,1401,681"/>
<area shape="rect" id="node36" href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748" title="foedus::xct::xct_id\l_to_universal_lock_id" alt="" coords="1251,706,1396,747"/>
<area shape="rect" id="node37" href="structfoedus_1_1xct_1_1RecordXctAccess.html#adf2e2a9d414bf5cfe86f33198ebdf434" title="Setter for owner_id_address_/owner_lock_id_. " alt="" coords="1225,771,1422,813"/>
<area shape="rect" id="node39" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="479,890,665,931"/>
<area shape="rect" id="node40" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="731,911,917,953"/>
<area shape="rect" id="node42" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="479,1075,665,1117"/>
<area shape="rect" id="node41" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5" title="Subtract operator, considering wrapping around. " alt="" coords="975,911,1162,953"/>
<area shape="rect" id="node43" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6" title="Only for Debug&#45;assertion. " alt="" coords="731,977,917,1018"/>
<area shape="rect" id="node45" href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc" title="See Log Manager. " alt="" coords="757,1042,891,1083"/>
<area shape="rect" id="node46" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="757,1107,891,1149"/>
<area shape="rect" id="node47" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="737,1173,911,1214"/>
<area shape="rect" id="node48" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7" title="Equivalent to std::atomic_thread_fence(std::memory_order_release). " alt="" coords="737,1238,911,1279"/>
<area shape="rect" id="node49" href="classfoedus_1_1log_1_1LogManager.html#a5c844c3bc8d71ce709999fd286a5e7b8" title="Wake up loggers if they are sleeping. " alt="" coords="742,1303,906,1345"/>
<area shape="rect" id="node44" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a05db4e7c61f07d2320aa7b2c3c76d520" title="Only for Debug&#45;assertion. " alt="" coords="975,977,1162,1018"/>
<area shape="rect" id="node50" href="classfoedus_1_1log_1_1LogManagerPimpl.html#ae0a0fc275f36ad22a57786bc7d17413e" title="foedus::log::LogManagerPimpl\l::wakeup_loggers" alt="" coords="970,1303,1167,1345"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa71566d3a4d56ded35df567784b13525_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa71566d3a4d56ded35df567784b13525_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa71566d3a4d56ded35df567784b13525_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aa71566d3a4d56ded35df567784b13525_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a81ce493961aa7dedc518ca4230d01868" title="foedus::storage::masstree\l::MasstreeCursor::increment_record" alt="" coords="230,5,461,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="227,71,464,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="248,137,443,193"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af0b96482a874777c4871a152ad733da3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::insert_general </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>be_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a>&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>payload_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of insert_record family. </p>
<p>use with <b><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a52a1bce48d9230ad2ce3f52c4da51b8e" title="Like locate_record(), this is also a logical operation. ">reserve_record()</a></b> </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00661">661</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="masstree__log__types_8hpp_source.html#l00098">foedus::storage::masstree::MasstreeCommonLogType::calculate_log_length()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00589">check_next_layer_bit()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00112">get_id()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00838">foedus::storage::masstree::MasstreeBorderPage::get_max_payload_length()</a>, <a class="el" href="thread_8hpp_source.html#l00066">foedus::thread::Thread::get_numa_node()</a>, <a class="el" href="thread_8cpp_source.html#l00078">foedus::thread::Thread::get_thread_log_buffer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00043">foedus::storage::masstree::RecordLocation::index_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="error__code_8hpp_source.html#l00177">foedus::kErrorCodeStrKeyAlreadyExists</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00048">foedus::storage::masstree::RecordLocation::observed_</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00041">foedus::storage::masstree::RecordLocation::page_</a>, <a class="el" href="masstree__log__types_8hpp_source.html#l00311">foedus::storage::masstree::MasstreeInsertLogType::populate()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00645">register_record_write_log()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">foedus::log::ThreadLogBuffer::reserve_new_log()</a>, and <a class="el" href="page_8hpp_source.html#l00251">foedus::storage::PageHeader::stat_last_updater_node_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00247">foedus::storage::masstree::MasstreeStorage::insert_record()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00283">foedus::storage::masstree::MasstreeStorage::insert_record_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">if</span> (!location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56adfc9588c95653090f65a029c574bfc9c">kErrorCodeStrKeyAlreadyExists</a>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">check_next_layer_bit</a>(location.observed_));</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// as of reserve_record() it was spacious enough, and this length is</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="comment">// either immutable or only increases, so this must hold.</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  MasstreeBorderPage* border = location.page_;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(border-&gt;get_max_payload_length(location.index_) &gt;= payload_count);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3">MasstreeInsertLogType::calculate_log_length</a>(key_length, payload_count);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  MasstreeInsertLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>MasstreeInsertLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  log_entry-&gt;populate(</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>(),</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    be_key,</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    key_length,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    payload,</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    payload_count);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  border-&gt;header().stat_last_updater_node_ = context-&gt;get_numa_node();</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">register_record_write_log</a>(context, location, log_entry);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a3036d6662c0bd89e330ca19cbca1f549"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">foedus::storage::masstree::MasstreeStoragePimpl::register_record_write_log</a></div><div class="ttdeci">ErrorCode register_record_write_log(thread::Thread *context, const RecordLocation &amp;location, log::RecordLogType *log_entry)</div><div class="ttdoc">Used in the following methods. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00645">masstree_storage_pimpl.cpp:645</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aca6d912133fd8b46eacb660b840bada0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">foedus::storage::masstree::MasstreeStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00112">masstree_storage_pimpl.hpp:112</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType_html_aaa0d49b768842255f27147327cc72ef3"><div class="ttname"><a href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3">foedus::storage::masstree::MasstreeCommonLogType::calculate_log_length</a></div><div class="ttdeci">static uint16_t calculate_log_length(KeyLength key_length, PayloadLength payload_count) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__log__types_8hpp_source.html#l00098">masstree_log_types.hpp:98</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">foedus::storage::masstree::MasstreeStoragePimpl::check_next_layer_bit</a></div><div class="ttdeci">static ErrorCode check_next_layer_bit(xct::XctId observed) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00589">masstree_storage_pimpl.cpp:589</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56adfc9588c95653090f65a029c574bfc9c"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56adfc9588c95653090f65a029c574bfc9c">foedus::kErrorCodeStrKeyAlreadyExists</a></div><div class="ttdoc">0x080B : "STORAGE: This key already exists in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00177">error_code.hpp:177</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_af0b96482a874777c4871a152ad733da3_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_af0b96482a874777c4871a152ad733da3_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_af0b96482a874777c4871a152ad733da3_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_af0b96482a874777c4871a152ad733da3_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3" title="foedus::storage::masstree\l::MasstreeCommonLogType\l::calculate_log_length" alt="" coords="977,58,1161,114"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::check_next_layer_bit" alt="" coords="233,125,407,181"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="485,427,659,483"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9c0b897c662c4fdaaff4ac5b131da506" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_max_payload_length" alt="" coords="231,285,409,341"/>
<area shape="rect" id="node14" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="245,219,395,260"/>
<area shape="rect" id="node17" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="243,416,397,457"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="233,481,407,523"/>
<area shape="rect" id="node19" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="259,547,381,588"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeInsertLogType.html#a4ea983f4436e0519b7d2aaa7f1ef67a0" title="foedus::storage::masstree\l::MasstreeInsertLogType\l::populate" alt="" coords="233,613,407,669"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549" title="Used in the following methods. " alt="" coords="233,693,407,749"/>
<area shape="rect" id="node38" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="227,873,413,915"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="1243,129,1403,155"/>
<area shape="rect" id="node5" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="511,100,633,141"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_1_1Slot.html#a447049b6067b0d1be460802f1b6a7076" title="This might be affected by concurrent threads. " alt="" coords="481,297,663,353"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="965,435,1172,476"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_1_1Slot.html#adecf558d81c86d2c96a701b6305a68b0" title="foedus::storage::masstree\l::MasstreeBorderPage::Slot\l::get_aligned_suffix_length" alt="" coords="733,274,915,330"/>
<area shape="rect" id="node10" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="982,229,1155,285"/>
<area shape="rect" id="node11" href="namespacefoedus_1_1storage_1_1masstree.html#a575ba44804b98a334fc66eedf4b18d70" title="foedus::storage::masstree\l::calculate_suffix_length" alt="" coords="1237,236,1410,277"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1220,435,1427,476"/>
<area shape="rect" id="node15" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="483,231,661,272"/>
<area shape="rect" id="node16" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="497,165,647,207"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="483,574,661,630"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="461,508,683,549"/>
<area shape="rect" id="node26" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="497,655,647,696"/>
<area shape="rect" id="node27" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="501,720,643,761"/>
<area shape="rect" id="node30" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="753,748,895,789"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="735,427,913,483"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="735,507,913,563"/>
<area shape="rect" id="node28" href="group__LOGTYPE.html#gad2d33090f44d00949a05c245e5ff1046" title="Invokes the assertion logic of each log type. " alt="" coords="1004,639,1133,680"/>
<area shape="rect" id="node29" href="structfoedus_1_1log_1_1LogHeader.html#a6ebe3b99442f2a58a4adeeb60f9a37e0" title="Convenience method to cast into LogCode. " alt="" coords="1246,639,1401,680"/>
<area shape="rect" id="node31" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a1ff8ccbccdede750fb5a18b4da505ad9" title="foedus::xct::Retrospective\lLockList::get_volatile\l_page_resolver" alt="" coords="983,770,1155,826"/>
<area shape="rect" id="node32" href="namespacefoedus_1_1storage.html#a263602e0a73eedbe5f32128635106e17" title="foedus::storage::assert\l_within_valid_volatile_page" alt="" coords="981,851,1156,892"/>
<area shape="rect" id="node35" href="structfoedus_1_1xct_1_1RecordXctAccess.html#ace820ba89437e4d3a59fdb47a47525ba" title="Calculate owner_lock_id using the resolver. " alt="" coords="968,704,1169,745"/>
<area shape="rect" id="node33" href="namespacefoedus_1_1storage.html#ad38ebb5eb992249a7b42001fe464ec48" title="foedus::storage::assert\l_within_valid_volatile\l_page_impl" alt="" coords="1246,843,1401,899"/>
<area shape="rect" id="node34" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1475,851,1648,892"/>
<area shape="rect" id="node36" href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748" title="foedus::xct::xct_id\l_to_universal_lock_id" alt="" coords="1251,769,1396,811"/>
<area shape="rect" id="node37" href="structfoedus_1_1xct_1_1RecordXctAccess.html#adf2e2a9d414bf5cfe86f33198ebdf434" title="Setter for owner_id_address_/owner_lock_id_. " alt="" coords="1225,704,1422,745"/>
<area shape="rect" id="node39" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="479,844,665,885"/>
<area shape="rect" id="node40" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="731,903,917,944"/>
<area shape="rect" id="node42" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="479,1067,665,1108"/>
<area shape="rect" id="node41" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5" title="Subtract operator, considering wrapping around. " alt="" coords="975,916,1162,957"/>
<area shape="rect" id="node43" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6" title="Only for Debug&#45;assertion. " alt="" coords="731,1164,917,1205"/>
<area shape="rect" id="node45" href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc" title="See Log Manager. " alt="" coords="757,1229,891,1271"/>
<area shape="rect" id="node46" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="757,1295,891,1336"/>
<area shape="rect" id="node47" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="737,968,911,1009"/>
<area shape="rect" id="node48" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7" title="Equivalent to std::atomic_thread_fence(std::memory_order_release). " alt="" coords="737,1033,911,1075"/>
<area shape="rect" id="node49" href="classfoedus_1_1log_1_1LogManager.html#a5c844c3bc8d71ce709999fd286a5e7b8" title="Wake up loggers if they are sleeping. " alt="" coords="742,1099,906,1140"/>
<area shape="rect" id="node44" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a05db4e7c61f07d2320aa7b2c3c76d520" title="Only for Debug&#45;assertion. " alt="" coords="975,1164,1162,1205"/>
<area shape="rect" id="node50" href="classfoedus_1_1log_1_1LogManagerPimpl.html#ae0a0fc275f36ad22a57786bc7d17413e" title="foedus::log::LogManagerPimpl\l::wakeup_loggers" alt="" coords="970,1099,1167,1140"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_af0b96482a874777c4871a152ad733da3_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_af0b96482a874777c4871a152ad733da3_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_af0b96482a874777c4871a152ad733da3_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_af0b96482a874777c4871a152ad733da3_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="227,5,439,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="246,71,419,127"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8d4ac5a88e7ce112f83b67597719fa82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::load </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1StorageControlBlock.html">StorageControlBlock</a> &amp;&#160;</td>
          <td class="paramname"><em>snapshot_block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00176">176</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00114">get_meta()</a>, <a class="el" href="initializable_8hpp_source.html#l00169">foedus::DefaultInitializable::initialize()</a>, <a class="el" href="storage__id_8hpp_source.html#l00158">foedus::storage::kExists</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="initializable_8hpp_source.html#l00243">foedus::UninitializeGuard::kWarnIfUninitializeError</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00122">load_empty()</a>, <a class="el" href="engine__memory_8cpp_source.html#l00148">foedus::memory::EngineMemory::load_one_volatile_page()</a>, <a class="el" href="storage_8hpp_source.html#l00084">foedus::storage::StorageControlBlock::meta_</a>, <a class="el" href="metadata_8hpp_source.html#l00112">foedus::storage::Metadata::root_snapshot_page_id_</a>, and <a class="el" href="initializable_8hpp_source.html#l00187">foedus::DefaultInitializable::uninitialize()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00066">foedus::storage::masstree::MasstreeStorage::load()</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                                                               {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_ = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>MasstreeMetadata&amp;<span class="keyword">&gt;</span>(snapshot_block.meta_);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keyword">const</span> MasstreeMetadata&amp; meta = <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.snapshot_pointer_ = meta.root_snapshot_page_id_;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_.word = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;first_root_locked_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// So far we assume the root page always has a volatile version.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// Create it now.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">if</span> (meta.root_snapshot_page_id_ != 0) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    cache::SnapshotFileSet fileset(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(fileset.initialize());</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    UninitializeGuard fileset_guard(&amp;fileset, <a class="code" href="classfoedus_1_1UninitializeGuard.html#ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568">UninitializeGuard::kWarnIfUninitializeError</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    VolatilePagePointer volatile_pointer;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    MasstreeIntermediatePage* volatile_root;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a3c3c8902b7000d09878a5a2085f6058c">load_one_volatile_page</a>(</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      &amp;fileset,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      meta.root_snapshot_page_id_,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      &amp;volatile_pointer,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      reinterpret_cast&lt;Page**&gt;(&amp;volatile_root)));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(fileset.uninitialize());</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_ = volatile_pointer;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;This is an empty masstree: &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a950d071732ec8bd3251c03181d42692f">get_meta</a>();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a9c2b2febfce356451e8183f66f71dcc3">load_empty</a>());</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;status_ = <a class="code" href="group__STORAGE.html#ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1">kExists</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Loaded a masstree-storage &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a950d071732ec8bd3251c03181d42692f">get_meta</a>();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1UninitializeGuard_html_ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568"><div class="ttname"><a href="classfoedus_1_1UninitializeGuard.html#ae6caa12ca9b75a22b53c2eed31402721af0067551d00455a2a16416216de53568">foedus::UninitializeGuard::kWarnIfUninitializeError</a></div><div class="ttdoc">Automatically calls if uninitialize() wasn&#39;t called when it gets out of scope, and just complains whe...</div><div class="ttdef"><b>Definition:</b> <a href="initializable_8hpp_source.html#l00243">initializable.hpp:243</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a3c3c8902b7000d09878a5a2085f6058c"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a3c3c8902b7000d09878a5a2085f6058c">foedus::memory::EngineMemory::load_one_volatile_page</a></div><div class="ttdeci">ErrorStack load_one_volatile_page(cache::SnapshotFileSet *fileset, storage::SnapshotPagePointer snapshot_pointer, storage::VolatilePagePointer *pointer, storage::Page **page)</div><div class="ttdoc">Another convenience method that also reads an existing snapshot page to the volatile page...</div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8cpp_source.html#l00148">engine_memory.cpp:148</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="group__STORAGE_html_ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1"><div class="ttname"><a href="group__STORAGE.html#ggaa532fc59a87dc23b6d432d444e98d63fadb3a41d3a531bce354f2df2aebef8dd1">foedus::storage::kExists</a></div><div class="ttdoc">The storage has been created and ready for use. </div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00158">storage_id.hpp:158</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a950d071732ec8bd3251c03181d42692f"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a950d071732ec8bd3251c03181d42692f">foedus::storage::masstree::MasstreeStoragePimpl::get_meta</a></div><div class="ttdeci">const MasstreeMetadata &amp; get_meta() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00114">masstree_storage_pimpl.hpp:114</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a9c2b2febfce356451e8183f66f71dcc3"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a9c2b2febfce356451e8183f66f71dcc3">foedus::storage::masstree::MasstreeStoragePimpl::load_empty</a></div><div class="ttdeci">ErrorStack load_empty()</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00122">masstree_storage_pimpl.cpp:122</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8d4ac5a88e7ce112f83b67597719fa82_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8d4ac5a88e7ce112f83b67597719fa82_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8d4ac5a88e7ce112f83b67597719fa82_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8d4ac5a88e7ce112f83b67597719fa82_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="803,479,938,520"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a950d071732ec8bd3251c03181d42692f" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_meta" alt="" coords="267,274,440,330"/>
<area shape="rect" id="node4" href="classfoedus_1_1DefaultInitializable.html#a22a0dc3bbbca682c3bc41eace9b6d1ff" title="Typical implementation of Initializable::initialize() that provides initialize&#45;once semantics..." alt="" coords="267,208,439,249"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a9c2b2febfce356451e8183f66f71dcc3" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::load_empty" alt="" coords="525,786,699,842"/>
<area shape="rect" id="node35" href="classfoedus_1_1memory_1_1EngineMemory.html#a3c3c8902b7000d09878a5a2085f6058c" title="Another convenience method that also reads an existing snapshot page to the volatile page..." alt="" coords="248,420,459,461"/>
<area shape="rect" id="node50" href="classfoedus_1_1DefaultInitializable.html#ab14b136a7d26f9f499ab9dc15a45a8cb" title="Typical implementation of Initializable::uninitialize() that provides uninitialize&#45;once semantics..." alt="" coords="267,355,439,396"/>
<area shape="rect" id="node5" href="classfoedus_1_1DefaultInitializable.html#ab8ae37e5f20f312f8b945fc40d3e0250" title="foedus::DefaultInitializable\l::initialize_once" alt="" coords="526,93,698,135"/>
<area shape="rect" id="node6" href="classfoedus_1_1ErrorStack.html#a9c7b3a8b3806ff623c7fb4a9db5cbeec" title="Returns if this return code is not kErrorCodeOk. " alt="" coords="547,159,677,200"/>
<area shape="rect" id="node7" href="classfoedus_1_1DefaultInitializable.html#a1abda1e84b8af8bd6916e52fd0a09f3e" title="Returns whether the object has been already initialized or not. " alt="" coords="526,289,698,331"/>
<area shape="rect" id="node8" href="classfoedus_1_1DefaultInitializable.html#a764be22ce1454279e7a7e78f4c8e380b" title="foedus::DefaultInitializable\l::uninitialize_once" alt="" coords="526,224,698,265"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8" title="foedus::memory::EngineMemory\l::get_node_memory" alt="" coords="765,691,976,732"/>
<area shape="rect" id="node11" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774" title="foedus::memory::NumaNode\lMemoryRef::get_volatile_pool" alt="" coords="775,756,966,797"/>
<area shape="rect" id="node12" href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e" title="Gives an object to resolve an offset in this page pool (thus local) to an actual pointer and vice ver..." alt="" coords="781,821,960,863"/>
<area shape="rect" id="node14" href="classfoedus_1_1memory_1_1PagePool.html#a3e9390381783077a504116988cae05c4" title="Grab only one page. " alt="" coords="781,887,960,928"/>
<area shape="rect" id="node22" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="779,545,963,601"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ab25cb34a8304c744bf309cc02b515e72" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::initialize_volatile_page" alt="" coords="778,1113,963,1169"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="1027,1162,1212,1218"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="784,953,957,1009"/>
<area shape="rect" id="node33" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="790,625,951,667"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a5ab741ff207d274efcb4a5664880600f" title="foedus::storage::masstree\l::MasstreeBorderPage::initialize\l_volatile_page" alt="" coords="767,1033,974,1089"/>
<area shape="rect" id="node13" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#ae901dc06f6b6f4594626ed0b233daec6" title="foedus::memory::PagePool\lPimpl::get_resolver" alt="" coords="1030,821,1209,863"/>
<area shape="rect" id="node15" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a3293a43a76f3720cf5c92c5fbcf2d02f" title="foedus::memory::PagePool\lPimpl::grab_one" alt="" coords="1030,887,1209,928"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a1a41295b63274fb300e5937a9bb1eca7" title="foedus::memory::PagePool\lPimpl::decrease_free_pool_count" alt="" coords="1263,957,1477,999"/>
<area shape="rect" id="node17" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#aa545fc1cffac905225d3a7c7c457b5a8" title="foedus::memory::PagePool\lPimpl::free_pool_head" alt="" coords="1281,761,1459,803"/>
<area shape="rect" id="node18" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#abd594ac94d8ac0445ebef734b7305fb6" title="foedus::memory::PagePool\lPimpl::get_debug_pool_name" alt="" coords="1273,827,1467,868"/>
<area shape="rect" id="node21" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="1281,892,1459,933"/>
<area shape="rect" id="node19" href="classfoedus_1_1assorted_1_1FixedString.html#a3269f7c68f175a1fd42e78110a57cbf2" title="Test if string is empty. " alt="" coords="1537,797,1729,839"/>
<area shape="rect" id="node20" href="classfoedus_1_1assorted_1_1FixedString.html#a16f6de0859f599127e2d4a51a6537a01" title="Convert to a std::string object. " alt="" coords="1525,863,1740,890"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa95b56b38e523e345e5fb0283e43d65e" title="foedus::storage::masstree\l::MasstreePage::initialize\l_volatile_common" alt="" coords="1033,1071,1206,1127"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1267,1103,1473,1144"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1PageHeader.html#a5a84eed10b8675e5df2f35f791991eb5" title="foedus::storage::PageHeader\l::init_volatile" alt="" coords="1275,1037,1465,1079"/>
<area shape="rect" id="node28" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="1533,1004,1732,1045"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1PageVersion.html#ae40168c82f16645e85bb66f9019e53cf" title="used only while page initialization " alt="" coords="1537,1069,1729,1111"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1PageVersionStatus.html#af49ef4f3320148130f46f494f1c845aa" title="foedus::storage::PageVersion\lStatus::reset" alt="" coords="1788,1036,1980,1077"/>
<area shape="rect" id="node31" href="structfoedus_1_1xct_1_1McsWwLock.html#a4114c2dec151ad650a294dedac4f239d" title="used only while page initialization " alt="" coords="1799,1101,1969,1143"/>
<area shape="rect" id="node36" href="namespacefoedus_1_1storage.html#a8f6e96ac10eb804602349a54292d26a1" title="foedus::storage::extract\l_numa_node_from_snapshot\l_pointer" alt="" coords="1025,413,1213,469"/>
<area shape="rect" id="node37" href="classfoedus_1_1memory_1_1EngineMemory.html#ae35d16d716451eaa878ec2888960127d" title="A convenience function to grab one free volatile page from the given node. " alt="" coords="507,691,717,732"/>
<area shape="rect" id="node38" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ad7ea1e9815cd47c3175371d37974526a" title="foedus::cache::SnapshotFile\lSet::read_page" alt="" coords="519,355,705,396"/>
<area shape="rect" id="node39" href="namespacefoedus_1_1storage.html#a3c3e7a984303d1ef88e001db1591b1be" title="foedus::storage::extract\l_local_page_id_from_snapshot\l_pointer" alt="" coords="771,347,971,403"/>
<area shape="rect" id="node40" href="classfoedus_1_1cache_1_1SnapshotFileSet.html#ae5b153acb9f3115c44a48e10ff2262fb" title="foedus::cache::SnapshotFile\lSet::get_or_open_file" alt="" coords="777,281,964,323"/>
<area shape="rect" id="node42" href="classfoedus_1_1fs_1_1DirectIoFile.html#a5353bbb3b2a815d6c858c8190edeccf4" title="A version that receives a raw pointer that has to be aligned (be careful to use this ver)..." alt="" coords="795,140,946,181"/>
<area shape="rect" id="node49" href="classfoedus_1_1fs_1_1DirectIoFile.html#a35814dfec4dab81d5bb46e453f1993e6" title="Sets the position of the next byte to be written/extracted from/to the stream. " alt="" coords="795,212,946,253"/>
<area shape="rect" id="node41" href="namespacefoedus_1_1storage.html#a82df0b3921d7c863275baf4f9c59959c" title="foedus::storage::extract\l_snapshot_id_from_snapshot\l_pointer" alt="" coords="1024,333,1215,389"/>
<area shape="rect" id="node43" href="namespacefoedus_1_1fs.html#a1a3ea81bf627928d9a5f154986af9c48" title="foedus::fs::is_odirect\l_aligned" alt="" coords="1048,136,1191,177"/>
<area shape="rect" id="node44" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1d89a9c761a388f13f9b59490b6caa00" title="Whether the file is already and successfully opened. " alt="" coords="1044,71,1195,112"/>
<area shape="rect" id="node45" href="group__ASSORTED.html#gaaa260096daf8620266c2799d1f5a0270" title="Thread&#45;safe strerror(errno). " alt="" coords="1049,201,1189,243"/>
<area shape="rect" id="node46" href="classfoedus_1_1fs_1_1DirectIoFile.html#a1c6bff6aafc955fd4c2a8e11e7f41f40" title="Sequentially read the given amount of contents from the current position. " alt="" coords="1044,5,1195,47"/>
<area shape="rect" id="node47" href="group__DEBUGGING.html#gac7eac15b41b0fab4e689f62d147ce620" title="Wait until the given CPU cycles elapse. " alt="" coords="1052,267,1187,308"/>
<area shape="rect" id="node48" href="group__DEBUGGING.html#ga48dd46b3a1382506a34fcb4e6e0941f6" title="Returns the current CPU cycle via x86 RDTSC. " alt="" coords="1303,267,1437,308"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8d4ac5a88e7ce112f83b67597719fa82_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8d4ac5a88e7ce112f83b67597719fa82_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8d4ac5a88e7ce112f83b67597719fa82_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8d4ac5a88e7ce112f83b67597719fa82_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a2731aaf3a733c773a63df6d691ede3ac" title="foedus::storage::masstree\l::MasstreeStorage::load" alt="" coords="248,5,421,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9c2b2febfce356451e8183f66f71dcc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::load_empty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00122">122</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="attachable_8hpp_source.html#l00111">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00112">get_id()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00322">foedus::storage::masstree::MasstreeIntermediatePage::get_minipage()</a>, <a class="el" href="engine__memory_8hpp_source.html#l00076">foedus::memory::EngineMemory::get_node_memory()</a>, <a class="el" href="page__pool_8cpp_source.html#l00146">foedus::memory::PagePool::get_resolver()</a>, <a class="el" href="numa__node__memory_8hpp_source.html#l00175">foedus::memory::NumaNodeMemoryRef::get_volatile_pool()</a>, <a class="el" href="page__pool_8cpp_source.html#l00132">foedus::memory::PagePool::grab_one()</a>, <a class="el" href="masstree__page__impl_8cpp_source.html#l00088">foedus::storage::masstree::MasstreeIntermediatePage::initialize_volatile_page()</a>, <a class="el" href="masstree__page__impl_8cpp_source.html#l00128">foedus::storage::masstree::MasstreeBorderPage::initialize_volatile_page()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00132">foedus::storage::masstree::kInfimumSlice</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="masstree__id_8hpp_source.html#l00137">foedus::storage::masstree::kSupremumSlice</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00278">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::pointers_</a>, <a class="el" href="page__resolver_8hpp_source.html#l00064">foedus::memory::LocalPageResolver::resolve_offset_newpage()</a>, <a class="el" href="storage__id_8hpp_source.html#l00212">foedus::storage::VolatilePagePointer::set()</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>, and <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00164">create()</a>, and <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00176">load()</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                            {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.snapshot_pointer_ = 0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_.word = 0;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;meta_.root_snapshot_page_id_ = 0;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keyword">const</span> uint16_t kDummyNode = 0;  <span class="comment">// whatever. just pick from the first node</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  memory::PagePool* pool</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    = <a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>-&gt;<a class="code" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">get_memory_manager</a>()-&gt;<a class="code" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8">get_node_memory</a>(kDummyNode)-&gt;<a class="code" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774">get_volatile_pool</a>();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keyword">const</span> memory::LocalPageResolver &amp;local_resolver = pool-&gt;<a class="code" href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e">get_resolver</a>();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// The root of first layer is always an intermediate page.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">// This is a special rule only for first layer to simplify partitioning and composer.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> root_offset;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(pool-&gt;grab_one(&amp;root_offset));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(root_offset);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  MasstreeIntermediatePage* root_page = <span class="keyword">reinterpret_cast&lt;</span>MasstreeIntermediatePage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    local_resolver.resolve_offset_newpage(root_offset));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;first_root_locked_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.snapshot_pointer_ = 0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_.set(kDummyNode, root_offset);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  root_page-&gt;initialize_volatile_page(</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>(),</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">control_block_</a>-&gt;root_page_pointer_.volatile_pointer_,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    0,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    1,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a>,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">kSupremumSlice</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// Also allocate the only child.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">memory::PagePoolOffset</a> child_offset;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(pool-&gt;grab_one(&amp;child_offset));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(child_offset);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  MasstreeBorderPage* child_page = <span class="keyword">reinterpret_cast&lt;</span>MasstreeBorderPage*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    local_resolver.resolve_offset_newpage(child_offset));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  VolatilePagePointer child_pointer;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  child_pointer.set(kDummyNode, child_offset);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  child_page-&gt;initialize_volatile_page(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>(), child_pointer, 0, <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a>, <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">kSupremumSlice</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  root_page-&gt;get_minipage(0).pointers_[0].snapshot_pointer_ = 0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  root_page-&gt;get_minipage(0).pointers_[0].volatile_pointer_ = child_pointer;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a9cffc20f29ad72d4edbeedece861c48f"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">foedus::storage::masstree::kInfimumSlice</a></div><div class="ttdeci">const KeySlice kInfimumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00132">masstree_id.hpp:132</a></div></div>
<div class="ttc" id="group__MEMORY_html_gaf7ed7c23d184b14ce978b1775a86dfae"><div class="ttname"><a href="group__MEMORY.html#gaf7ed7c23d184b14ce978b1775a86dfae">foedus::memory::PagePoolOffset</a></div><div class="ttdeci">uint32_t PagePoolOffset</div><div class="ttdoc">Offset in PagePool that compactly represents the page address (unlike 8 bytes pointer). </div><div class="ttdef"><b>Definition:</b> <a href="memory__id_8hpp_source.html#l00044">memory_id.hpp:44</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_af9f87c691e2df0b04322e6df8d7c0d81"><div class="ttname"><a href="classfoedus_1_1Attachable.html#af9f87c691e2df0b04322e6df8d7c0d81">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::control_block_</a></div><div class="ttdeci">MasstreeStorageControlBlock * control_block_</div><div class="ttdoc">The shared data on shared memory that has been initialized in some SOC or master engine. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00111">attachable.hpp:111</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aca6d912133fd8b46eacb660b840bada0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">foedus::storage::masstree::MasstreeStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00112">masstree_storage_pimpl.hpp:112</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1EngineMemory_html_a8bf8832e627cd97fe92c60d38ed96ac8"><div class="ttname"><a href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8">foedus::memory::EngineMemory::get_node_memory</a></div><div class="ttdeci">NumaNodeMemoryRef * get_node_memory(foedus::thread::ThreadGroupId group) const </div><div class="ttdef"><b>Definition:</b> <a href="engine__memory_8hpp_source.html#l00076">engine_memory.hpp:76</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1NumaNodeMemoryRef_html_a70b68580143ce771f5b5b1f9a209f774"><div class="ttname"><a href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774">foedus::memory::NumaNodeMemoryRef::get_volatile_pool</a></div><div class="ttdeci">PagePool * get_volatile_pool()</div><div class="ttdef"><b>Definition:</b> <a href="numa__node__memory_8hpp_source.html#l00175">numa_node_memory.hpp:175</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a7bfcd277a96bcd1e9008459abe1ec40d"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">foedus::storage::masstree::kSupremumSlice</a></div><div class="ttdeci">const KeySlice kSupremumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00137">masstree_id.hpp:137</a></div></div>
<div class="ttc" id="classfoedus_1_1memory_1_1PagePool_html_a18916c76eea7aa49572e69e48e75717e"><div class="ttname"><a href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e">foedus::memory::PagePool::get_resolver</a></div><div class="ttdeci">const LocalPageResolver &amp; get_resolver() const </div><div class="ttdoc">Gives an object to resolve an offset in this page pool (thus local) to an actual pointer and vice ver...</div><div class="ttdef"><b>Definition:</b> <a href="page__pool_8cpp_source.html#l00146">page_pool.cpp:146</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
<div class="ttc" id="classfoedus_1_1Engine_html_a02ed05009c7baa8d75e04f202a86b2c6"><div class="ttname"><a href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6">foedus::Engine::get_memory_manager</a></div><div class="ttdeci">memory::EngineMemory * get_memory_manager() const </div><div class="ttdoc">See Memory Manager. </div><div class="ttdef"><b>Definition:</b> <a href="engine_8cpp_source.html#l00050">engine.cpp:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a9c2b2febfce356451e8183f66f71dcc3_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a9c2b2febfce356451e8183f66f71dcc3_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a9c2b2febfce356451e8183f66f71dcc3_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a9c2b2febfce356451e8183f66f71dcc3_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="245,5,419,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="265,86,399,127"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="485,432,671,488"/>
<area shape="rect" id="node5" href="classfoedus_1_1memory_1_1EngineMemory.html#a8bf8832e627cd97fe92c60d38ed96ac8" title="foedus::memory::EngineMemory\l::get_node_memory" alt="" coords="227,217,437,258"/>
<area shape="rect" id="node6" href="classfoedus_1_1memory_1_1PagePool.html#a18916c76eea7aa49572e69e48e75717e" title="Gives an object to resolve an offset in this page pool (thus local) to an actual pointer and vice ver..." alt="" coords="243,151,421,193"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1NumaNodeMemoryRef.html#a70b68580143ce771f5b5b1f9a209f774" title="foedus::memory::NumaNode\lMemoryRef::get_volatile_pool" alt="" coords="237,347,427,389"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1PagePool.html#a3e9390381783077a504116988cae05c4" title="Grab only one page. " alt="" coords="243,282,421,323"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ab25cb34a8304c744bf309cc02b515e72" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::initialize_volatile_page" alt="" coords="239,464,425,520"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a5ab741ff207d274efcb4a5664880600f" title="foedus::storage::masstree\l::MasstreeBorderPage::initialize\l_volatile_page" alt="" coords="229,544,435,600"/>
<area shape="rect" id="node27" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="240,624,424,680"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="251,705,413,746"/>
<area shape="rect" id="node7" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#ae901dc06f6b6f4594626ed0b233daec6" title="foedus::memory::PagePool\lPimpl::get_resolver" alt="" coords="489,151,667,193"/>
<area shape="rect" id="node10" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a3293a43a76f3720cf5c92c5fbcf2d02f" title="foedus::memory::PagePool\lPimpl::grab_one" alt="" coords="489,282,667,323"/>
<area shape="rect" id="node11" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a1a41295b63274fb300e5937a9bb1eca7" title="foedus::memory::PagePool\lPimpl::decrease_free_pool_count" alt="" coords="719,314,933,355"/>
<area shape="rect" id="node12" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#aa545fc1cffac905225d3a7c7c457b5a8" title="foedus::memory::PagePool\lPimpl::free_pool_head" alt="" coords="737,379,915,421"/>
<area shape="rect" id="node13" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#abd594ac94d8ac0445ebef734b7305fb6" title="foedus::memory::PagePool\lPimpl::get_debug_pool_name" alt="" coords="729,183,923,225"/>
<area shape="rect" id="node16" href="classfoedus_1_1memory_1_1PagePoolPimpl.html#a50e6fad1a2e9735182f83a52a5e329b0" title="foedus::memory::PagePool\lPimpl::get_free_pool_count" alt="" coords="737,249,915,290"/>
<area shape="rect" id="node14" href="classfoedus_1_1assorted_1_1FixedString.html#a3269f7c68f175a1fd42e78110a57cbf2" title="Test if string is empty. " alt="" coords="993,154,1185,195"/>
<area shape="rect" id="node15" href="classfoedus_1_1assorted_1_1FixedString.html#a16f6de0859f599127e2d4a51a6537a01" title="Convert to a std::string object. " alt="" coords="981,220,1196,247"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa95b56b38e523e345e5fb0283e43d65e" title="foedus::storage::masstree\l::MasstreePage::initialize\l_volatile_common" alt="" coords="491,512,665,568"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="723,486,929,527"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1PageHeader.html#a5a84eed10b8675e5df2f35f791991eb5" title="foedus::storage::PageHeader\l::init_volatile" alt="" coords="731,551,921,593"/>
<area shape="rect" id="node21" href="structfoedus_1_1assorted_1_1ProbCounter.html#a8e7b31f9a6b4997f6c0916f7e20d755a" title="foedus::assorted::ProbCounter\l::reset" alt="" coords="989,518,1188,559"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1PageVersion.html#ae40168c82f16645e85bb66f9019e53cf" title="used only while page initialization " alt="" coords="993,583,1185,625"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1PageVersionStatus.html#af49ef4f3320148130f46f494f1c845aa" title="foedus::storage::PageVersion\lStatus::reset" alt="" coords="1244,550,1436,591"/>
<area shape="rect" id="node24" href="structfoedus_1_1xct_1_1McsWwLock.html#a4114c2dec151ad650a294dedac4f239d" title="used only while page initialization " alt="" coords="1255,615,1425,657"/>
<area shape="rect" id="node25" href="structfoedus_1_1xct_1_1McsWwBlockData.html#a3161e47c41388e9c1b50929f585e366b" title="foedus::xct::McsWwBlockData\l::clear" alt="" coords="1484,615,1685,657"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a9c2b2febfce356451e8183f66f71dcc3_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a9c2b2febfce356451e8183f66f71dcc3_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a9c2b2febfce356451e8183f66f71dcc3_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a9c2b2febfce356451e8183f66f71dcc3_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a192a4976aa71f457b356bf536d9f5fc2" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::create" alt="" coords="237,5,411,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a8d4ac5a88e7ce112f83b67597719fa82" title="foedus::storage::masstree\l::MasstreeStoragePimpl::load" alt="" coords="227,86,421,127"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a92ad35031262ae95e767c53746de2e29" title="foedus::storage::masstree\l::MasstreeStorage::create" alt="" coords="469,13,643,54"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a2731aaf3a733c773a63df6d691ede3ac" title="foedus::storage::masstree\l::MasstreeStorage::load" alt="" coords="469,86,643,127"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a91dac48625f8f7d2906fcfba5908cbc1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::locate_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a>&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_writes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifies page and record for the key. </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00283">283</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="xct_8cpp_source.html#l00242">foedus::xct::Xct::add_to_page_version_set()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00057">foedus::storage::masstree::RecordLocation::clear()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00796">foedus::storage::masstree::MasstreeBorderPage::does_point_to_layer()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00213">find_border_physical()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01120">foedus::storage::masstree::MasstreeBorderPage::find_key()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00384">follow_layer()</a>, <a class="el" href="thread_8cpp_source.html#l00075">foedus::thread::Thread::get_current_xct()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">get_first_root()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00162">foedus::storage::masstree::MasstreePage::get_version()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00164">foedus::storage::masstree::MasstreePage::get_version_address()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00163">foedus::storage::masstree::kBorderPageMaxSlots</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="masstree__id_8hpp_source.html#l00075">foedus::storage::masstree::kMaxKeyLength</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00081">foedus::assorted::memory_fence_consume()</a>, <a class="el" href="masstree__record__location_8cpp_source.html#l00027">foedus::storage::masstree::RecordLocation::populate_logical()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00279">foedus::storage::masstree::slice_layer()</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, and <a class="el" href="page_8hpp_source.html#l00172">foedus::storage::PageVersion::status_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00312">foedus::storage::masstree::MasstreeStorage::delete_record()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00079">foedus::storage::masstree::MasstreeStorage::get_record()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00107">foedus::storage::masstree::MasstreeStorage::get_record_part()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00139">foedus::storage::masstree::MasstreeStorage::get_record_primitive()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00523">foedus::storage::masstree::MasstreeStorage::increment_record()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00412">foedus::storage::masstree::MasstreeStorage::overwrite_record()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00444">foedus::storage::masstree::MasstreeStorage::overwrite_record_primitive()</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                          {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(result);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(key_length &lt;= <a class="code" href="group__MASSTREE.html#gae33cf61cd45f5956aa2e46283b9474ab">kMaxKeyLength</a>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  result-&gt;clear();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  xct::Xct* cur_xct = &amp;context-&gt;get_current_xct();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  MasstreePage* layer_root;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">get_first_root</a>(</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    context,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    for_writes,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    reinterpret_cast&lt;MasstreeIntermediatePage**&gt;(&amp;layer_root)));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">for</span> (uint16_t current_layer = 0;; ++current_layer) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> remainder_length = key_length - current_layer * 8;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> slice = <a class="code" href="group__MASSTREE.html#gabdb6a706258be601e621e58653bf528e">slice_layer</a>(key, key_length, current_layer);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">void</span>* suffix = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(key) + (current_layer + 1) * 8;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    MasstreeBorderPage* border;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0">find_border_physical</a>(</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      context,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      layer_root,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      current_layer,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      for_writes,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      slice,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      &amp;border));</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    PageVersionStatus border_version = border-&gt;get_version().status_;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f">assorted::memory_fence_consume</a>();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a> index = border-&gt;find_key(slice, suffix, remainder_length);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span> (index == <a class="code" href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">kBorderPageMaxSlots</a>) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">// this means not found. add it to page version set to protect the lack of record</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">if</span> (!border-&gt;header().snapshot_) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(cur_xct-&gt;add_to_page_version_set(</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          border-&gt;get_version_address(),</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          border_version));</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="comment">// So far we just use page-version set to protect this non-existence.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">// TASK(Hideaki) range lock rather than page-set to improve concurrency?</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      result-&gt;clear();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span> (border-&gt;does_point_to_layer(index)) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6188e676e564b4ebecaa556178cdb81e">follow_layer</a>(context, for_writes, border, index, &amp;layer_root));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(result-&gt;populate_logical(cur_xct, border, index, for_writes));</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a738313356f0e54e8e2d732c2017797c0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0">foedus::storage::masstree::MasstreeStoragePimpl::find_border_physical</a></div><div class="ttdeci">ErrorCode find_border_physical(thread::Thread *context, MasstreePage *layer_root, uint8_t current_layer, bool for_writes, KeySlice slice, MasstreeBorderPage **border) __attribute__((always_inline))</div><div class="ttdoc">Find a border node in the layer that corresponds to the given key slice. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00213">masstree_storage_pimpl.cpp:213</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga6280f932bf17f1d9d4acc294ca984bee"><div class="ttname"><a href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">foedus::storage::masstree::SlotIndex</a></div><div class="ttdeci">uint16_t SlotIndex</div><div class="ttdoc">Index of a record in a (border) page. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00110">masstree_id.hpp:110</a></div></div>
<div class="ttc" id="group__MASSTREE_html_gae33cf61cd45f5956aa2e46283b9474ab"><div class="ttname"><a href="group__MASSTREE.html#gae33cf61cd45f5956aa2e46283b9474ab">foedus::storage::masstree::kMaxKeyLength</a></div><div class="ttdeci">const KeyLength kMaxKeyLength</div><div class="ttdoc">Max length of a key. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00075">masstree_id.hpp:75</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga556e8f0d5e02e78f3ddecd8f5b022bf6"><div class="ttname"><a href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">foedus::storage::masstree::KeySlice</a></div><div class="ttdeci">uint64_t KeySlice</div><div class="ttdoc">Each key slice is an 8-byte integer. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00126">masstree_id.hpp:126</a></div></div>
<div class="ttc" id="group__MASSTREE_html_gaa0c469cd4f863aa64e07fcea90b72859"><div class="ttname"><a href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">foedus::storage::masstree::KeyLength</a></div><div class="ttdeci">uint16_t KeyLength</div><div class="ttdoc">Represents a byte-length of a key in this package. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00069">masstree_id.hpp:69</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_adc32aaf6f4537fcc1ada207e1d6902ec"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">foedus::storage::masstree::MasstreeStoragePimpl::get_first_root</a></div><div class="ttdeci">ErrorCode get_first_root(thread::Thread *context, bool for_write, MasstreeIntermediatePage **root)</div><div class="ttdoc">Root-node related, such as a method to retrieve 1st-root, to grow, etc. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00058">masstree_storage_pimpl.cpp:58</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga78a96e3a0ec4256513d9d2e9c94f37fd"><div class="ttname"><a href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">foedus::storage::masstree::kBorderPageMaxSlots</a></div><div class="ttdeci">const SlotIndex kBorderPageMaxSlots</div><div class="ttdoc">Maximum number of slots in one MasstreeBorderPage. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00163">masstree_id.hpp:163</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a6188e676e564b4ebecaa556178cdb81e"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6188e676e564b4ebecaa556178cdb81e">foedus::storage::masstree::MasstreeStoragePimpl::follow_layer</a></div><div class="ttdeci">ErrorCode follow_layer(thread::Thread *context, bool for_writes, MasstreeBorderPage *parent, SlotIndex record_index, MasstreePage **page) __attribute__((always_inline))</div><div class="ttdoc">Follows to next layer&#39;s root page. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00384">masstree_storage_pimpl.cpp:384</a></div></div>
<div class="ttc" id="group__ASSORTED_html_ga641117f56315b0f239d72948cf5aa56f"><div class="ttname"><a href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f">foedus::assorted::memory_fence_consume</a></div><div class="ttdeci">void memory_fence_consume()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_consume). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00081">atomic_fences.hpp:81</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__MASSTREE_html_gabdb6a706258be601e621e58653bf528e"><div class="ttname"><a href="group__MASSTREE.html#gabdb6a706258be601e621e58653bf528e">foedus::storage::masstree::slice_layer</a></div><div class="ttdeci">KeySlice slice_layer(const void *be_bytes, KeyLength key_length, Layer current_layer)</div><div class="ttdoc">Extract a part of a big-endian byte array of given length as KeySlice. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00279">masstree_id.hpp:279</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a91dac48625f8f7d2906fcfba5908cbc1_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a91dac48625f8f7d2906fcfba5908cbc1_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a91dac48625f8f7d2906fcfba5908cbc1_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a91dac48625f8f7d2906fcfba5908cbc1_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="257,131,404,173"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html#a952de8a37ed522dc611039c2fa90fa93" title="foedus::storage::masstree\l::RecordLocation::clear" alt="" coords="244,197,417,238"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="499,539,687,595"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0" title="Find a border node in the layer that corresponds to the given key slice. " alt="" coords="244,1685,417,1741"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a6883c1c1e9ef2fb0e6a40d7863f2d85b" title="Navigates a searching key&#45;slice to one of the record in this page. " alt="" coords="227,779,435,821"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6188e676e564b4ebecaa556178cdb81e" title="Follows to next layer&#39;s root page. " alt="" coords="244,499,417,555"/>
<area shape="rect" id="node34" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="255,1766,406,1807"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="244,1395,417,1451"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="507,1467,680,1509"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3b27750b62fcc70c1677b0fceac983cf" title="foedus::storage::masstree\l::MasstreePage::get_version" alt="" coords="237,1831,424,1873"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abbc553596fb9e1dc115e3aaccf3352f9" title="foedus::storage::masstree\l::MasstreePage::get_version\l_address" alt="" coords="237,1897,424,1953"/>
<area shape="rect" id="node43" href="group__ASSORTED.html#ga641117f56315b0f239d72948cf5aa56f" title="Equivalent to std::atomic_thread_fence(std::memory_order_consume). " alt="" coords="244,1978,417,2019"/>
<area shape="rect" id="node44" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html#aee3fe977e78528510c5ac422cc31f534" title="Populates the result with XID and possibly readset. " alt="" coords="242,263,419,319"/>
<area shape="rect" id="node48" href="group__MASSTREE.html#gabdb6a706258be601e621e58653bf528e" title="Extract a part of a big&#45;endian byte array of given length as KeySlice. " alt="" coords="244,2393,417,2434"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="752,630,959,671"/>
<area shape="rect" id="node7" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="794,295,917,337"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1007,903,1213,945"/>
<area shape="rect" id="node9" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="516,1663,671,1705"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="763,1619,948,1675"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="501,1897,686,1953"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="507,1123,680,1179"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="491,1598,695,1639"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="501,1977,686,2033"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="485,1533,701,1574"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="769,2072,942,2128"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a16a2c06a304514be7b99fb6c884e7e9b" title="foedus::storage::masstree\l::MasstreePage::is_locked" alt="" coords="505,2174,682,2215"/>
<area shape="rect" id="node19" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="769,487,942,529"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#a541c911b49454a9baece1d658f51abf5" title="prefetch upto separators. " alt="" coords="501,2240,686,2296"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3260be02451d5017a2301854454dd203" title="prefetch upto keys/separators, whether this page is border or interior. " alt="" coords="507,2320,680,2376"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="518,1831,669,1873"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="518,1350,669,1391"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0f8830e2b301b1bdd3f2e16d9b047d79" title="foedus::storage::masstree\l::MasstreePage::within_fences" alt="" coords="493,2109,693,2150"/>
<area shape="rect" id="node13" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="780,1269,931,1310"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="483,779,704,821"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="504,699,683,755"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="487,845,699,886"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a874518901eb38e4dc3b7b69afb69e5c0" title="foedus::storage::masstree\l::MasstreeBorderPage::prefetch\l_additional_if_needed" alt="" coords="490,619,697,675"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="504,459,683,515"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="504,379,683,435"/>
<area shape="rect" id="node33" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="794,161,917,202"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer\l_address" alt="" coords="507,962,680,1033"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="489,1057,698,1098"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="507,1269,680,1325"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="506,1203,681,1245"/>
<area shape="rect" id="node45" href="classfoedus_1_1xct_1_1Xct.html#abc3a6688cdf5249c46613a1988b71975" title="The general logic invoked for every record read. " alt="" coords="526,161,661,202"/>
<area shape="rect" id="node46" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="794,41,917,82"/>
<area shape="rect" id="node47" href="structfoedus_1_1xct_1_1XctId.html#a449da7fea452dd81c194f94b28e7a7e2" title="foedus::xct::XctId\l::is_valid" alt="" coords="532,95,655,137"/>
<area shape="rect" id="node49" href="group__MASSTREE.html#gaa6842bc28437a9d4319e51471f4e3237" title="Convert a big&#45;endian byte array of given length to KeySlice. " alt="" coords="492,2451,695,2493"/>
<area shape="rect" id="node50" href="group__MASSTREE.html#ga6818c708d9ac34b794cb1f91fa6f5296" title="Convert a big&#45;endian byte array of at least 8&#45;bytes&#45;length to KeySlice. " alt="" coords="769,2422,942,2463"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a91dac48625f8f7d2906fcfba5908cbc1_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a91dac48625f8f7d2906fcfba5908cbc1_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a91dac48625f8f7d2906fcfba5908cbc1_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a91dac48625f8f7d2906fcfba5908cbc1_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="238,5,453,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#acdf38eea62d1432e3715a661d0790caf" title="Retrieves an entire record of the given key in this Masstree. " alt="" coords="246,71,445,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a01a2996a1ee370611b72c88f33fe2753" title="Retrieves a part of the given key in this Masstree. " alt="" coords="259,137,432,193"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a3be736c76c38dd23444cbd78947a63fd" title="Retrieves a part of the given key in this Masstree as a primitive value. " alt="" coords="259,217,432,273"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="227,297,464,339"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="230,363,461,404"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="252,429,439,485"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0ce23624d660da08cb1ee04ac2297171"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::locate_record_normalized </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>for_writes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifies page and record for the normalized key. </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00336">336</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="xct_8cpp_source.html#l00242">foedus::xct::Xct::add_to_page_version_set()</a>, <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00057">foedus::storage::masstree::RecordLocation::clear()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00796">foedus::storage::masstree::MasstreeBorderPage::does_point_to_layer()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00213">find_border_physical()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01179">foedus::storage::masstree::MasstreeBorderPage::find_key_normalized()</a>, <a class="el" href="thread_8cpp_source.html#l00075">foedus::thread::Thread::get_current_xct()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">get_first_root()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00148">foedus::storage::masstree::MasstreePage::get_key_count()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00162">foedus::storage::masstree::MasstreePage::get_version()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00164">foedus::storage::masstree::MasstreePage::get_version_address()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00163">foedus::storage::masstree::kBorderPageMaxSlots</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="masstree__record__location_8cpp_source.html#l00027">foedus::storage::masstree::RecordLocation::populate_logical()</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, and <a class="el" href="page_8hpp_source.html#l00172">foedus::storage::PageVersion::status_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00333">foedus::storage::masstree::MasstreeStorage::delete_record_normalized()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00169">foedus::storage::masstree::MasstreeStorage::get_record_normalized()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00189">foedus::storage::masstree::MasstreeStorage::get_record_part_normalized()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00212">foedus::storage::masstree::MasstreeStorage::get_record_primitive_normalized()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00553">foedus::storage::masstree::MasstreeStorage::increment_record_normalized()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00474">foedus::storage::masstree::MasstreeStorage::overwrite_record_normalized()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00499">foedus::storage::masstree::MasstreeStorage::overwrite_record_primitive_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                          {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(result);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  result-&gt;clear();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  xct::Xct* cur_xct = &amp;context-&gt;get_current_xct();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  MasstreeBorderPage* border;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  MasstreeIntermediatePage* layer_root;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">get_first_root</a>(context, for_writes, &amp;layer_root));</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0">find_border_physical</a>(context, layer_root, 0, for_writes, key, &amp;border));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a> index = border-&gt;find_key_normalized(0, border-&gt;get_key_count(), key);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  PageVersionStatus border_version = border-&gt;get_version().status_;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">if</span> (index == <a class="code" href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">kBorderPageMaxSlots</a>) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// this means not found</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (!border-&gt;header().snapshot_) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(cur_xct-&gt;add_to_page_version_set(</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        border-&gt;get_version_address(),</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        border_version));</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// TASK(Hideaki) range lock</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    result-&gt;clear();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// because this is just one slice, we never go to second layer</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!border-&gt;does_point_to_layer(index));</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(result-&gt;populate_logical(cur_xct, border, index, for_writes));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a738313356f0e54e8e2d732c2017797c0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0">foedus::storage::masstree::MasstreeStoragePimpl::find_border_physical</a></div><div class="ttdeci">ErrorCode find_border_physical(thread::Thread *context, MasstreePage *layer_root, uint8_t current_layer, bool for_writes, KeySlice slice, MasstreeBorderPage **border) __attribute__((always_inline))</div><div class="ttdoc">Find a border node in the layer that corresponds to the given key slice. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00213">masstree_storage_pimpl.cpp:213</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga6280f932bf17f1d9d4acc294ca984bee"><div class="ttname"><a href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">foedus::storage::masstree::SlotIndex</a></div><div class="ttdeci">uint16_t SlotIndex</div><div class="ttdoc">Index of a record in a (border) page. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00110">masstree_id.hpp:110</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_adc32aaf6f4537fcc1ada207e1d6902ec"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">foedus::storage::masstree::MasstreeStoragePimpl::get_first_root</a></div><div class="ttdeci">ErrorCode get_first_root(thread::Thread *context, bool for_write, MasstreeIntermediatePage **root)</div><div class="ttdoc">Root-node related, such as a method to retrieve 1st-root, to grow, etc. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00058">masstree_storage_pimpl.cpp:58</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga78a96e3a0ec4256513d9d2e9c94f37fd"><div class="ttname"><a href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">foedus::storage::masstree::kBorderPageMaxSlots</a></div><div class="ttdeci">const SlotIndex kBorderPageMaxSlots</div><div class="ttdoc">Maximum number of slots in one MasstreeBorderPage. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00163">masstree_id.hpp:163</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0ce23624d660da08cb1ee04ac2297171_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0ce23624d660da08cb1ee04ac2297171_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0ce23624d660da08cb1ee04ac2297171_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0ce23624d660da08cb1ee04ac2297171_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1Xct.html#a68b92830ccd52b310445b41bfef06fd7" title="Add the given page version to the page version set of this transaction. " alt="" coords="252,5,399,47"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html#a952de8a37ed522dc611039c2fa90fa93" title="foedus::storage::masstree\l::RecordLocation::clear" alt="" coords="239,71,412,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="481,1734,669,1790"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="985,1523,1192,1564"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0" title="Find a border node in the layer that corresponds to the given key slice. " alt="" coords="239,1129,412,1185"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#ad27289df29e50bc9a55c3f3b53f876af" title="Specialized version for 8 byte native integer search. " alt="" coords="235,1510,415,1566"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="250,1985,401,2027"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="239,553,412,609"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="488,188,661,229"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3b27750b62fcc70c1677b0fceac983cf" title="foedus::storage::masstree\l::MasstreePage::get_version" alt="" coords="232,2051,419,2092"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abbc553596fb9e1dc115e3aaccf3352f9" title="foedus::storage::masstree\l::MasstreePage::get_version\l_address" alt="" coords="232,2117,419,2173"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html#aee3fe977e78528510c5ac422cc31f534" title="Populates the result with XID and possibly readset. " alt="" coords="237,1905,414,1961"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="731,1697,937,1739"/>
<area shape="rect" id="node7" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="773,2004,895,2045"/>
<area shape="rect" id="node9" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="497,743,652,784"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="741,1515,927,1571"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="482,954,667,1010"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="488,874,661,930"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="473,808,677,849"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="482,1034,667,1090"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="467,560,683,601"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="747,1125,921,1181"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a16a2c06a304514be7b99fb6c884e7e9b" title="foedus::storage::masstree\l::MasstreePage::is_locked" alt="" coords="486,1231,663,1272"/>
<area shape="rect" id="node22" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="747,2075,921,2116"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#a541c911b49454a9baece1d658f51abf5" title="prefetch upto separators. " alt="" coords="482,1297,667,1353"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3260be02451d5017a2301854454dd203" title="prefetch upto keys/separators, whether this page is border or interior. " alt="" coords="488,1377,661,1433"/>
<area shape="rect" id="node26" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="499,1588,650,1629"/>
<area shape="rect" id="node29" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="499,677,650,719"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0f8830e2b301b1bdd3f2e16d9b047d79" title="foedus::storage::masstree\l::MasstreePage::within_fences" alt="" coords="475,1165,675,1207"/>
<area shape="rect" id="node13" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="759,779,909,820"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="747,881,921,923"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="738,560,930,601"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1PageVersion.html#a301cba19b01cf82d7b576a04180b56e2" title="foedus::storage::PageVersion\l::is_locked" alt="" coords="738,1231,930,1272"/>
<area shape="rect" id="node24" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="748,1384,920,1425"/>
<area shape="rect" id="node27" href="classfoedus_1_1thread_1_1Thread.html#aa77cde98794b5a55e0d295284acb3e6d" title="Returns the page resolver to convert page ID to page pointer. " alt="" coords="759,1843,909,1899"/>
<area shape="rect" id="node28" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="733,1596,935,1637"/>
<area shape="rect" id="node30" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="742,677,926,719"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="485,1654,664,1710"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="469,1945,681,1987"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a874518901eb38e4dc3b7b69afb69e5c0" title="foedus::storage::masstree\l::MasstreeBorderPage::prefetch\l_additional_if_needed" alt="" coords="471,1457,678,1513"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer\l_address" alt="" coords="488,400,661,471"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="470,495,679,536"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="488,254,661,310"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="487,335,662,376"/>
<area shape="rect" id="node46" href="classfoedus_1_1xct_1_1Xct.html#abc3a6688cdf5249c46613a1988b71975" title="The general logic invoked for every record read. " alt="" coords="507,2128,642,2169"/>
<area shape="rect" id="node47" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="773,2159,895,2200"/>
<area shape="rect" id="node48" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="773,2233,895,2275"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="485,1814,664,1870"/>
<area shape="rect" id="node50" href="structfoedus_1_1xct_1_1XctId.html#a449da7fea452dd81c194f94b28e7a7e2" title="foedus::xct::XctId\l::is_valid" alt="" coords="513,2063,636,2104"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0ce23624d660da08cb1ee04ac2297171_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0ce23624d660da08cb1ee04ac2297171_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0ce23624d660da08cb1ee04ac2297171_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a0ce23624d660da08cb1ee04ac2297171_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="243,5,416,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a4f2492b6a04c2db18cdf2a4a2d7fecc0" title="Retrieves an entire record of the given primitive key in this Masstree. " alt="" coords="243,85,416,141"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adda60c43db1237644270e90f2a255d35" title="Retrieves a part of the given primitive key in this Masstree. " alt="" coords="243,165,416,221"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae4bf2da94babc15bf43bd50b17ffb562" title="Retrieves a part of the given primitive key in this Masstree as a primitive value. " alt="" coords="235,245,424,301"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="232,325,427,381"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="236,405,423,461"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="235,485,424,541"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="483,13,697,54"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#acdf38eea62d1432e3715a661d0790caf" title="Retrieves an entire record of the given key in this Masstree. " alt="" coords="491,93,689,134"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a01a2996a1ee370611b72c88f33fe2753" title="Retrieves a part of the given key in this Masstree. " alt="" coords="503,165,677,221"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="475,413,705,454"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab9cc59cbbef3fd23a62cbd25cbd00abb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::overwrite_general </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>be_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a>&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>payload_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>payload_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of overwrite_record family. </p>
<p>use with <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. ">locate_record()</a> </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00772">772</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="masstree__log__types_8hpp_source.html#l00098">foedus::storage::masstree::MasstreeCommonLogType::calculate_log_length()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00589">check_next_layer_bit()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00112">get_id()</a>, <a class="el" href="thread_8hpp_source.html#l00066">foedus::thread::Thread::get_numa_node()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00832">foedus::storage::masstree::MasstreeBorderPage::get_payload_length()</a>, <a class="el" href="thread_8cpp_source.html#l00078">foedus::thread::Thread::get_thread_log_buffer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00043">foedus::storage::masstree::RecordLocation::index_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="error__code_8hpp_source.html#l00176">foedus::kErrorCodeStrTooShortPayload</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00048">foedus::storage::masstree::RecordLocation::observed_</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00041">foedus::storage::masstree::RecordLocation::page_</a>, <a class="el" href="masstree__log__types_8hpp_source.html#l00436">foedus::storage::masstree::MasstreeOverwriteLogType::populate()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00645">register_record_write_log()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">foedus::log::ThreadLogBuffer::reserve_new_log()</a>, and <a class="el" href="page_8hpp_source.html#l00251">foedus::storage::PageHeader::stat_last_updater_node_</a>.</p>

<p>Referenced by <a class="el" href="masstree__cursor_8cpp_source.html#l01271">foedus::storage::masstree::MasstreeCursor::overwrite_record()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00412">foedus::storage::masstree::MasstreeStorage::overwrite_record()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00474">foedus::storage::masstree::MasstreeStorage::overwrite_record_normalized()</a>, <a class="el" href="masstree__cursor_8cpp_source.html#l01289">foedus::storage::masstree::MasstreeCursor::overwrite_record_primitive()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00444">foedus::storage::masstree::MasstreeStorage::overwrite_record_primitive()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00499">foedus::storage::masstree::MasstreeStorage::overwrite_record_primitive_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordflow">if</span> (location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">// in this case, we don&#39;t need a page-version set. the physical record is surely there.</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">check_next_layer_bit</a>(location.observed_));</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  MasstreeBorderPage* border = location.page_;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordflow">if</span> (border-&gt;get_payload_length(location.index_) &lt; payload_offset + payload_count) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;short record &quot;</span>;  <span class="comment">// probably this is a rare error. so warn.</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">kErrorCodeStrTooShortPayload</a>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3">MasstreeOverwriteLogType::calculate_log_length</a>(key_length, payload_count);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  MasstreeOverwriteLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>MasstreeOverwriteLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  log_entry-&gt;populate(</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>(),</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    be_key,</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    key_length,</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    payload,</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    payload_offset,</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    payload_count);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  border-&gt;header().stat_last_updater_node_ = context-&gt;get_numa_node();</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">register_record_write_log</a>(context, location, log_entry);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">foedus::kErrorCodeStrTooShortPayload</a></div><div class="ttdoc">0x080A : "STORAGE: The record&#39;s payload is smaller than requested" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00176">error_code.hpp:176</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a3036d6662c0bd89e330ca19cbca1f549"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">foedus::storage::masstree::MasstreeStoragePimpl::register_record_write_log</a></div><div class="ttdeci">ErrorCode register_record_write_log(thread::Thread *context, const RecordLocation &amp;location, log::RecordLogType *log_entry)</div><div class="ttdoc">Used in the following methods. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00645">masstree_storage_pimpl.cpp:645</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aca6d912133fd8b46eacb660b840bada0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">foedus::storage::masstree::MasstreeStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00112">masstree_storage_pimpl.hpp:112</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType_html_aaa0d49b768842255f27147327cc72ef3"><div class="ttname"><a href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3">foedus::storage::masstree::MasstreeCommonLogType::calculate_log_length</a></div><div class="ttdeci">static uint16_t calculate_log_length(KeyLength key_length, PayloadLength payload_count) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__log__types_8hpp_source.html#l00098">masstree_log_types.hpp:98</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">foedus::storage::masstree::MasstreeStoragePimpl::check_next_layer_bit</a></div><div class="ttdeci">static ErrorCode check_next_layer_bit(xct::XctId observed) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00589">masstree_storage_pimpl.cpp:589</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ab9cc59cbbef3fd23a62cbd25cbd00abb_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ab9cc59cbbef3fd23a62cbd25cbd00abb_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ab9cc59cbbef3fd23a62cbd25cbd00abb_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ab9cc59cbbef3fd23a62cbd25cbd00abb_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3" title="foedus::storage::masstree\l::MasstreeCommonLogType\l::calculate_log_length" alt="" coords="228,7,412,63"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::check_next_layer_bit" alt="" coords="233,101,407,157"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="485,123,659,179"/>
<area shape="rect" id="node7" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="245,482,395,523"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a634aa97d761122a7d7cd4cb7889d844f" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_payload_length" alt="" coords="231,401,409,457"/>
<area shape="rect" id="node13" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="243,547,397,589"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="233,613,407,654"/>
<area shape="rect" id="node15" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="259,678,381,719"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeOverwriteLogType.html#ad59889a05bfad73c47891ee9be60d7f2" title="foedus::storage::masstree\l::MasstreeOverwriteLogType\l::populate" alt="" coords="227,744,413,800"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549" title="Used in the following methods. " alt="" coords="233,320,407,376"/>
<area shape="rect" id="node38" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="227,827,413,869"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="492,5,652,32"/>
<area shape="rect" id="node5" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="511,57,633,98"/>
<area shape="rect" id="node8" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="483,567,661,609"/>
<area shape="rect" id="node9" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="497,633,647,674"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="965,443,1172,485"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1220,443,1427,485"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="735,436,913,492"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="461,386,683,427"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="497,269,647,310"/>
<area shape="rect" id="node23" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="501,203,643,245"/>
<area shape="rect" id="node26" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="753,210,895,251"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="735,356,913,412"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="735,276,913,332"/>
<area shape="rect" id="node24" href="group__LOGTYPE.html#gad2d33090f44d00949a05c245e5ff1046" title="Invokes the assertion logic of each log type. " alt="" coords="1004,145,1133,186"/>
<area shape="rect" id="node25" href="structfoedus_1_1log_1_1LogHeader.html#a6ebe3b99442f2a58a4adeeb60f9a37e0" title="Convenience method to cast into LogCode. " alt="" coords="1246,145,1401,186"/>
<area shape="rect" id="node27" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a1ff8ccbccdede750fb5a18b4da505ad9" title="foedus::xct::Retrospective\lLockList::get_volatile\l_page_resolver" alt="" coords="983,276,1155,332"/>
<area shape="rect" id="node28" href="namespacefoedus_1_1storage.html#a263602e0a73eedbe5f32128635106e17" title="foedus::storage::assert\l_within_valid_volatile_page" alt="" coords="981,357,1156,398"/>
<area shape="rect" id="node34" href="structfoedus_1_1xct_1_1RecordXctAccess.html#ace820ba89437e4d3a59fdb47a47525ba" title="Calculate owner_lock_id using the resolver. " alt="" coords="968,210,1169,251"/>
<area shape="rect" id="node29" href="namespacefoedus_1_1storage.html#ad38ebb5eb992249a7b42001fe464ec48" title="foedus::storage::assert\l_within_valid_volatile\l_page_impl" alt="" coords="1246,349,1401,405"/>
<area shape="rect" id="node30" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1725,351,1899,393"/>
<area shape="rect" id="node31" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1737,430,1887,471"/>
<area shape="rect" id="node32" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1475,397,1677,438"/>
<area shape="rect" id="node33" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="1493,295,1659,321"/>
<area shape="rect" id="node35" href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748" title="foedus::xct::xct_id\l_to_universal_lock_id" alt="" coords="1251,210,1396,251"/>
<area shape="rect" id="node37" href="structfoedus_1_1xct_1_1RecordXctAccess.html#adf2e2a9d414bf5cfe86f33198ebdf434" title="Setter for owner_id_address_/owner_lock_id_. " alt="" coords="1225,275,1422,317"/>
<area shape="rect" id="node36" href="namespacefoedus_1_1xct.html#a94b21516b530d0be271c6005a72009ad" title="foedus::xct::to_universal\l_lock_id" alt="" coords="1495,210,1657,251"/>
<area shape="rect" id="node39" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="479,829,665,870"/>
<area shape="rect" id="node40" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="731,959,917,1001"/>
<area shape="rect" id="node42" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="479,763,665,805"/>
<area shape="rect" id="node41" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5" title="Subtract operator, considering wrapping around. " alt="" coords="975,959,1162,1001"/>
<area shape="rect" id="node43" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6" title="Only for Debug&#45;assertion. " alt="" coords="731,698,917,739"/>
<area shape="rect" id="node45" href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc" title="See Log Manager. " alt="" coords="757,763,891,805"/>
<area shape="rect" id="node46" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="757,829,891,870"/>
<area shape="rect" id="node47" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="737,894,911,935"/>
<area shape="rect" id="node48" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7" title="Equivalent to std::atomic_thread_fence(std::memory_order_release). " alt="" coords="737,567,911,609"/>
<area shape="rect" id="node49" href="classfoedus_1_1log_1_1LogManager.html#a5c844c3bc8d71ce709999fd286a5e7b8" title="Wake up loggers if they are sleeping. " alt="" coords="742,633,906,674"/>
<area shape="rect" id="node44" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a05db4e7c61f07d2320aa7b2c3c76d520" title="Only for Debug&#45;assertion. " alt="" coords="975,698,1162,739"/>
<area shape="rect" id="node50" href="classfoedus_1_1log_1_1LogManagerPimpl.html#ae0a0fc275f36ad22a57786bc7d17413e" title="foedus::log::LogManagerPimpl\l::wakeup_loggers" alt="" coords="970,633,1167,674"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ab9cc59cbbef3fd23a62cbd25cbd00abb_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ab9cc59cbbef3fd23a62cbd25cbd00abb_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ab9cc59cbbef3fd23a62cbd25cbd00abb_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ab9cc59cbbef3fd23a62cbd25cbd00abb_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#ab8b1919cb195dd063be409f772b36630" title="foedus::storage::masstree\l::MasstreeCursor::overwrite_record" alt="" coords="227,5,449,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="497,97,728,139"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="245,122,431,178"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a496370a645284f8578875529c6eacb0f" title="foedus::storage::masstree\l::MasstreeCursor::overwrite\l_record_primitive" alt="" coords="248,202,428,258"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="245,282,431,338"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="243,362,433,418"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a67482433dfc680921b443bdb8a1ea78e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::peek_volatile_page_boundaries </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1Engine.html">Engine</a> *&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__MASSTREE.html#structfoedus_1_1storage_1_1masstree_1_1MasstreeStorage_1_1PeekBoundariesArguments">MasstreeStorage::PeekBoundariesArguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defined in <a class="el" href="masstree__storage__peek_8cpp.html">masstree_storage_peek.cpp</a>. </p>

<p>Definition at line <a class="el" href="masstree__storage__peek_8cpp_source.html#l00037">37</a> of file <a class="el" href="masstree__storage__peek_8cpp_source.html">masstree_storage_peek.cpp</a>.</p>

<p>References <a class="el" href="masstree__storage_8hpp_source.html#l00575">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::found_boundary_count_</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00115">get_first_root_pointer()</a>, <a class="el" href="engine__memory_8hpp_source.html#l00090">foedus::memory::EngineMemory::get_global_volatile_page_resolver()</a>, <a class="el" href="engine_8cpp_source.html#l00050">foedus::Engine::get_memory_manager()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="masstree__storage__peek_8cpp_source.html#l00061">peek_volatile_page_boundaries_next_layer()</a>, <a class="el" href="masstree__storage__peek_8cpp_source.html#l00144">peek_volatile_page_boundaries_this_layer()</a>, <a class="el" href="masstree__storage_8hpp_source.html#l00565">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::prefix_slice_count_</a>, <a class="el" href="page__resolver_8hpp_source.html#l00120">foedus::memory::GlobalVolatilePageResolver::resolve_offset()</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__peek_8cpp_source.html#l00031">foedus::storage::masstree::MasstreeStorage::peek_volatile_page_boundaries()</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                                      {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  *args.found_boundary_count_ = 0;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  VolatilePagePointer root_pointer = <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa23487ce62cb84213dedb7917cbf2602">get_first_root_pointer</a>().<a class="code" href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">volatile_pointer_</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span> (root_pointer.is_null()) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    VLOG(0) &lt;&lt; <span class="stringliteral">&quot;This masstree has no volatile pages. Maybe the composer is executed as part of&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; restart?&quot;</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keyword">const</span> memory::GlobalVolatilePageResolver&amp; resolver</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    = engine-&gt;get_memory_manager()-&gt;get_global_volatile_page_resolver();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keyword">const</span> MasstreePage* root</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>MasstreePage*<span class="keyword">&gt;</span>(resolver.resolve_offset(root_pointer));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">if</span> (args.prefix_slice_count_ == 0) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a96688f523312e356ea1a03adfbfba7b2">peek_volatile_page_boundaries_this_layer</a>(root, resolver, args);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a14fb0ae2a643a45c3f32ab6395285d8d">peek_volatile_page_boundaries_next_layer</a>(root, resolver, args);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a96688f523312e356ea1a03adfbfba7b2"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a96688f523312e356ea1a03adfbfba7b2">foedus::storage::masstree::MasstreeStoragePimpl::peek_volatile_page_boundaries_this_layer</a></div><div class="ttdeci">ErrorCode peek_volatile_page_boundaries_this_layer(const MasstreePage *layer_root, const memory::GlobalVolatilePageResolver &amp;resolver, const MasstreeStorage::PeekBoundariesArguments &amp;args)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__peek_8cpp_source.html#l00144">masstree_storage_peek.cpp:144</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a14fb0ae2a643a45c3f32ab6395285d8d"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a14fb0ae2a643a45c3f32ab6395285d8d">foedus::storage::masstree::MasstreeStoragePimpl::peek_volatile_page_boundaries_next_layer</a></div><div class="ttdeci">ErrorCode peek_volatile_page_boundaries_next_layer(const MasstreePage *layer_root, const memory::GlobalVolatilePageResolver &amp;resolver, const MasstreeStorage::PeekBoundariesArguments &amp;args)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__peek_8cpp_source.html#l00061">masstree_storage_peek.cpp:61</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aa23487ce62cb84213dedb7917cbf2602"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa23487ce62cb84213dedb7917cbf2602">foedus::storage::masstree::MasstreeStoragePimpl::get_first_root_pointer</a></div><div class="ttdeci">const DualPagePointer &amp; get_first_root_pointer() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00115">masstree_storage_pimpl.hpp:115</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1DualPagePointer_html_a99e67179a5576a52a4710c700ac309f4"><div class="ttname"><a href="structfoedus_1_1storage_1_1DualPagePointer.html#a99e67179a5576a52a4710c700ac309f4">foedus::storage::DualPagePointer::volatile_pointer_</a></div><div class="ttdeci">VolatilePagePointer volatile_pointer_</div><div class="ttdef"><b>Definition:</b> <a href="storage__id_8hpp_source.html#l00308">storage_id.hpp:308</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67482433dfc680921b443bdb8a1ea78e_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67482433dfc680921b443bdb8a1ea78e_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67482433dfc680921b443bdb8a1ea78e_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67482433dfc680921b443bdb8a1ea78e_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa23487ce62cb84213dedb7917cbf2602" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer" alt="" coords="281,261,455,317"/>
<area shape="rect" id="node3" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="263,341,473,397"/>
<area shape="rect" id="node4" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="301,422,435,463"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1093,539,1254,580"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a14fb0ae2a643a45c3f32ab6395285d8d" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::peek_volatile_page_boundaries\l_next_layer" alt="" coords="263,694,473,764"/>
<area shape="rect" id="node22" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1072,1934,1275,1975"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a96688f523312e356ea1a03adfbfba7b2" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::peek_volatile_page_boundaries\l_this_layer" alt="" coords="523,1632,732,1703"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1663,719,1824,760"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="1087,1686,1260,1727"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="1086,1803,1261,1844"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="1372,1635,1576,1676"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="1387,828,1561,884"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3260be02451d5017a2301854454dd203" title="prefetch upto keys/separators, whether this page is border or interior. " alt="" coords="799,277,973,333"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="1086,1868,1261,1910"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0f8830e2b301b1bdd3f2e16d9b047d79" title="foedus::storage::masstree\l::MasstreePage::within_fences" alt="" coords="1073,904,1273,946"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="1081,226,1266,282"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1895,371,2101,412"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#a541c911b49454a9baece1d658f51abf5" title="prefetch upto separators. " alt="" coords="1081,408,1266,464"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="1081,824,1266,880"/>
<area shape="rect" id="node28" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="541,1567,714,1608"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a874518901eb38e4dc3b7b69afb69e5c0" title="foedus::storage::masstree\l::MasstreeBorderPage::prefetch\l_additional_if_needed" alt="" coords="783,357,989,413"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="521,1816,733,1858"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="533,66,721,122"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="538,146,717,202"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="1077,707,1270,748"/>
<area shape="rect" id="node13" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="1388,350,1560,391"/>
<area shape="rect" id="node14" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1657,350,1829,391"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1648,1751,1839,1792"/>
<area shape="rect" id="node23" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1397,1810,1551,1851"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1669,1875,1818,1916"/>
<area shape="rect" id="node26" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1387,1875,1561,1916"/>
<area shape="rect" id="node27" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1373,1992,1575,2048"/>
<area shape="rect" id="node24" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1666,1940,1821,1982"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1640,160,1847,202"/>
<area shape="rect" id="node33" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="825,74,947,115"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="797,146,975,202"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="1063,80,1284,122"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="1084,146,1263,202"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="1385,153,1563,209"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="1385,73,1563,129"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a139bb707048331de71c3abe8c0282d7d" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::peek_volatile_page_boundaries\l_this_layer_recurse" alt="" coords="781,1218,991,1288"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="1069,1518,1278,1559"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="1651,1202,1836,1258"/>
<area shape="rect" id="node45" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab55e48873dcf5700871a035c65bfa588" title="used only in masstree. " alt="" coords="1069,1320,1277,1362"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="1356,1137,1592,1193"/>
<area shape="rect" id="node47" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#a50f249d95bb8fceda793e40a76b4e386" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator::next" alt="" coords="1039,1203,1308,1244"/>
<area shape="rect" id="node48" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#a8988fe635186bff06191f3eb87447bc8" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::get_pointer" alt="" coords="1055,1072,1291,1128"/>
<area shape="rect" id="node49" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#aefcac4f0e94dee19b7b26ff392ba4c54" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::get_low_key" alt="" coords="1055,1386,1291,1442"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#adaf1febd2954da507ffd8daa2757c890" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_separator" alt="" coords="1381,1386,1567,1442"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67482433dfc680921b443bdb8a1ea78e_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67482433dfc680921b443bdb8a1ea78e_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67482433dfc680921b443bdb8a1ea78e_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a67482433dfc680921b443bdb8a1ea78e_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#abf137494ad55ab4d60cec25c7c654e99" title="Checks the volatile pages of this storage to give hints to decide page boundary keys. " alt="" coords="263,5,436,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a14fb0ae2a643a45c3f32ab6395285d8d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::peek_volatile_page_boundaries_next_layer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *&#160;</td>
          <td class="paramname"><em>layer_root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html">memory::GlobalVolatilePageResolver</a> &amp;&#160;</td>
          <td class="paramname"><em>resolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__MASSTREE.html#structfoedus_1_1storage_1_1masstree_1_1MasstreeStorage_1_1PeekBoundariesArguments">MasstreeStorage::PeekBoundariesArguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__peek_8cpp_source.html#l00061">61</a> of file <a class="el" href="masstree__storage__peek_8cpp_source.html">masstree_storage_peek.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="page__resolver_8hpp_source.html#l00154">foedus::memory::GlobalVolatilePageResolver::begin_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00796">foedus::storage::masstree::MasstreeBorderPage::does_point_to_layer()</a>, <a class="el" href="page__resolver_8hpp_source.html#l00156">foedus::memory::GlobalVolatilePageResolver::end_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00312">foedus::storage::masstree::MasstreeIntermediatePage::find_minipage()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00287">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::find_pointer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00148">foedus::storage::masstree::MasstreePage::get_key_count()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00144">foedus::storage::masstree::MasstreePage::get_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00098">foedus::storage::masstree::MasstreePage::get_low_fence()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00750">foedus::storage::masstree::MasstreeBorderPage::get_next_layer()</a>, <a class="el" href="storage__id_8hpp_source.html#l00201">foedus::storage::VolatilePagePointer::get_numa_node()</a>, <a class="el" href="storage__id_8hpp_source.html#l00202">foedus::storage::VolatilePagePointer::get_offset()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00801">foedus::storage::masstree::MasstreeBorderPage::get_slice()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00084">foedus::storage::masstree::MasstreePage::is_border()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00100">foedus::storage::masstree::MasstreePage::is_high_fence_supremum()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00163">foedus::storage::masstree::kBorderPageMaxSlots</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="masstree__id_8hpp_source.html#l00132">foedus::storage::masstree::kInfimumSlice</a>, <a class="el" href="compiler_8hpp_source.html#l00103">LIKELY</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00046">foedus::assorted::memory_fence_acquire()</a>, <a class="el" href="page__resolver_8hpp_source.html#l00152">foedus::memory::GlobalVolatilePageResolver::numa_node_count_</a>, <a class="el" href="masstree__storage__peek_8cpp_source.html#l00144">peek_volatile_page_boundaries_this_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00278">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::pointers_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00281">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::prefetch()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00937">foedus::storage::masstree::MasstreeBorderPage::prefetch_additional_if_needed()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00158">foedus::storage::masstree::MasstreePage::prefetch_general()</a>, <a class="el" href="masstree__storage_8hpp_source.html#l00565">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::prefix_slice_count_</a>, <a class="el" href="masstree__storage_8hpp_source.html#l00563">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::prefix_slices_</a>, <a class="el" href="page__resolver_8hpp_source.html#l00120">foedus::memory::GlobalVolatilePageResolver::resolve_offset()</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>, and <a class="el" href="masstree__page__impl_8hpp_source.html#l00126">foedus::storage::masstree::MasstreePage::within_fences()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__peek_8cpp_source.html#l00037">peek_volatile_page_boundaries()</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                                      {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!layer_root-&gt;header().snapshot_);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  uint8_t this_layer = layer_root-&gt;get_layer();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(this_layer &lt; args.prefix_slice_count_);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(layer_root-&gt;get_low_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a> &amp;&amp; layer_root-&gt;is_high_fence_supremum());</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> slice = args.prefix_slices_[layer_root-&gt;get_layer()];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// look for this slice in this layer. If we can&#39;t find it (which is unlikely), no results.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// compared to tree-traversal code in the transactional methods, we can give up whenever</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// something rare happens.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keyword">const</span> MasstreePage* cur = layer_root;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  cur-&gt;prefetch_general();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">while</span> (!cur-&gt;is_border()) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur-&gt;within_fences(slice));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// We do NOT follow foster-twins here.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// Foster-twins are sooner or later adopted, and Master-Tree invariant for intermediate page</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// guarantees that we can just read the old page. no need to follow foster-twins.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keyword">const</span> MasstreeIntermediatePage* page = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>MasstreeIntermediatePage*<span class="keyword">&gt;</span>(cur);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    uint8_t minipage_index = page-&gt;find_minipage(slice);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">const</span> MasstreeIntermediatePage::MiniPage&amp; minipage = page-&gt;get_minipage(minipage_index);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    minipage.prefetch();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    uint8_t pointer_index = minipage.find_pointer(slice);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    VolatilePagePointer pointer = minipage.pointers_[pointer_index].volatile_pointer_;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keyword">const</span> MasstreePage* next</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>MasstreePage*<span class="keyword">&gt;</span>(resolver.resolve_offset(pointer));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    next-&gt;prefetch_general();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#gad10e2a9bf230cc6fdd98a6c70958ef81">LIKELY</a>(next-&gt;within_fences(slice))) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      cur = next;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="comment">// even in this case, local retry suffices thanks to foster-twin</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Interesting. concurrent thread affected the search. local retry&quot;</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keyword">const</span> MasstreeBorderPage* border = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>MasstreeBorderPage*<span class="keyword">&gt;</span>(cur);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">// following code are not transactional at all, but it&#39;s fine because these are just hints.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// however, make sure we don&#39;t hit something like segfault. check nulls etc.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(border-&gt;within_fences(slice));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  uint8_t key_count = border-&gt;get_key_count();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a> rec = <a class="code" href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">kBorderPageMaxSlots</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  border-&gt;prefetch_additional_if_needed(key_count);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a> i = 0; i &lt; key_count; ++i) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> cur_slice = border-&gt;get_slice(i);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#gad10e2a9bf230cc6fdd98a6c70958ef81">LIKELY</a>(cur_slice &lt; slice)) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (cur_slice &gt; slice) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// one slice might be used for up to 10 keys, length 0 to 8 and pointer to next layer.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (border-&gt;does_point_to_layer(i)) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      rec = i;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(rec &gt;= key_count || !border-&gt;does_point_to_layer(rec))) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Slice not found during peeking. Gives up finding a page boundary hint&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  VolatilePagePointer pointer = border-&gt;get_next_layer(rec)-&gt;volatile_pointer_;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(pointer.is_null()</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    || pointer.get_numa_node() &gt;= resolver.numa_node_count_</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    || pointer.get_offset() &lt; resolver.begin_</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    || pointer.get_offset() &gt;= resolver.end_)) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;Encountered invalid page during peeking. Gives up finding a page boundary hint&quot;</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keyword">const</span> MasstreePage* next_root</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>MasstreePage*<span class="keyword">&gt;</span>(resolver.resolve_offset(pointer));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">if</span> (this_layer + 1U == args.prefix_slice_count_) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a96688f523312e356ea1a03adfbfba7b2">peek_volatile_page_boundaries_this_layer</a>(next_root, resolver, args);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a14fb0ae2a643a45c3f32ab6395285d8d">peek_volatile_page_boundaries_next_layer</a>(next_root, resolver, args);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a96688f523312e356ea1a03adfbfba7b2"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a96688f523312e356ea1a03adfbfba7b2">foedus::storage::masstree::MasstreeStoragePimpl::peek_volatile_page_boundaries_this_layer</a></div><div class="ttdeci">ErrorCode peek_volatile_page_boundaries_this_layer(const MasstreePage *layer_root, const memory::GlobalVolatilePageResolver &amp;resolver, const MasstreeStorage::PeekBoundariesArguments &amp;args)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__peek_8cpp_source.html#l00144">masstree_storage_peek.cpp:144</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a9cffc20f29ad72d4edbeedece861c48f"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">foedus::storage::masstree::kInfimumSlice</a></div><div class="ttdeci">const KeySlice kInfimumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00132">masstree_id.hpp:132</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga6280f932bf17f1d9d4acc294ca984bee"><div class="ttname"><a href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">foedus::storage::masstree::SlotIndex</a></div><div class="ttdeci">uint16_t SlotIndex</div><div class="ttdoc">Index of a record in a (border) page. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00110">masstree_id.hpp:110</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a14fb0ae2a643a45c3f32ab6395285d8d"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a14fb0ae2a643a45c3f32ab6395285d8d">foedus::storage::masstree::MasstreeStoragePimpl::peek_volatile_page_boundaries_next_layer</a></div><div class="ttdeci">ErrorCode peek_volatile_page_boundaries_next_layer(const MasstreePage *layer_root, const memory::GlobalVolatilePageResolver &amp;resolver, const MasstreeStorage::PeekBoundariesArguments &amp;args)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__peek_8cpp_source.html#l00061">masstree_storage_peek.cpp:61</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga556e8f0d5e02e78f3ddecd8f5b022bf6"><div class="ttname"><a href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">foedus::storage::masstree::KeySlice</a></div><div class="ttdeci">uint64_t KeySlice</div><div class="ttdoc">Each key slice is an 8-byte integer. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00126">masstree_id.hpp:126</a></div></div>
<div class="ttc" id="group__COMPILER_html_gad10e2a9bf230cc6fdd98a6c70958ef81"><div class="ttname"><a href="group__COMPILER.html#gad10e2a9bf230cc6fdd98a6c70958ef81">LIKELY</a></div><div class="ttdeci">#define LIKELY(x)        </div><div class="ttdoc">Hints that x is highly likely true. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00103">compiler.hpp:103</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga78a96e3a0ec4256513d9d2e9c94f37fd"><div class="ttname"><a href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">foedus::storage::masstree::kBorderPageMaxSlots</a></div><div class="ttdeci">const SlotIndex kBorderPageMaxSlots</div><div class="ttdoc">Maximum number of slots in one MasstreeBorderPage. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00163">masstree_id.hpp:163</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaf84f9944a16c5848f69beacdfeedf939"><div class="ttname"><a href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">foedus::assorted::memory_fence_acquire</a></div><div class="ttdeci">void memory_fence_acquire()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acquire). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00046">atomic_fences.hpp:46</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a14fb0ae2a643a45c3f32ab6395285d8d_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a14fb0ae2a643a45c3f32ab6395285d8d_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a14fb0ae2a643a45c3f32ab6395285d8d_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a14fb0ae2a643a45c3f32ab6395285d8d_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="275,103,463,159"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1636,414,1843,456"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="822,507,1007,563"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="822,587,1007,643"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="827,798,1002,840"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="1113,1489,1317,1530"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="279,376,458,432"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="818,668,1011,709"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1404,862,1565,904"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="263,902,475,944"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="828,864,1001,905"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="827,1644,1002,1685"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="1129,1703,1302,1759"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="834,733,995,774"/>
<area shape="rect" id="node28" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="282,1761,455,1802"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a96688f523312e356ea1a03adfbfba7b2" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::peek_volatile_page_boundaries\l_this_layer" alt="" coords="264,1156,473,1226"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0f8830e2b301b1bdd3f2e16d9b047d79" title="foedus::storage::masstree\l::MasstreePage::within_fences" alt="" coords="815,1812,1015,1853"/>
<area shape="rect" id="node34" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#a541c911b49454a9baece1d658f51abf5" title="prefetch upto separators. " alt="" coords="822,1995,1007,2051"/>
<area shape="rect" id="node43" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="813,1929,1016,1970"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a874518901eb38e4dc3b7b69afb69e5c0" title="foedus::storage::masstree\l::MasstreeBorderPage::prefetch\l_additional_if_needed" alt="" coords="524,2030,731,2086"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3260be02451d5017a2301854454dd203" title="prefetch upto keys/separators, whether this page is border or interior. " alt="" coords="541,2111,714,2167"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1381,296,1588,337"/>
<area shape="rect" id="node5" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="566,52,689,93"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="538,344,717,400"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="804,256,1025,297"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="825,344,1004,400"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="1126,248,1305,304"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="1126,168,1305,224"/>
<area shape="rect" id="node16" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="1129,408,1302,464"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="1126,328,1305,384"/>
<area shape="rect" id="node17" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="1405,412,1565,439"/>
<area shape="rect" id="node18" href="namespacefoedus_1_1storage_1_1masstree.html#a575ba44804b98a334fc66eedf4b18d70" title="foedus::storage::masstree\l::calculate_suffix_length" alt="" coords="1398,464,1571,505"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1389,1644,1580,1685"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a139bb707048331de71c3abe8c0282d7d" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::peek_volatile_page_boundaries\l_this_layer_recurse" alt="" coords="523,1156,732,1226"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="810,1410,1019,1452"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="1392,1067,1577,1123"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab55e48873dcf5700871a035c65bfa588" title="used only in masstree. " alt="" coords="811,1476,1019,1517"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="1097,1132,1333,1188"/>
<area shape="rect" id="node39" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#a50f249d95bb8fceda793e40a76b4e386" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator::next" alt="" coords="780,1112,1049,1153"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#a8988fe635186bff06191f3eb87447bc8" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::get_pointer" alt="" coords="797,1031,1033,1087"/>
<area shape="rect" id="node41" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#aefcac4f0e94dee19b7b26ff392ba4c54" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::get_low_key" alt="" coords="797,1228,1033,1284"/>
<area shape="rect" id="node35" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="1129,2068,1301,2109"/>
<area shape="rect" id="node36" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1399,2068,1571,2109"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#adaf1febd2954da507ffd8daa2757c890" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_separator" alt="" coords="1123,1212,1308,1268"/>
<area shape="rect" id="node44" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1138,1788,1293,1829"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1410,1908,1559,1949"/>
<area shape="rect" id="node47" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1129,1985,1302,2026"/>
<area shape="rect" id="node48" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1114,1854,1317,1910"/>
<area shape="rect" id="node45" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1407,1806,1562,1848"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a14fb0ae2a643a45c3f32ab6395285d8d_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a14fb0ae2a643a45c3f32ab6395285d8d_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a14fb0ae2a643a45c3f32ab6395285d8d_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a14fb0ae2a643a45c3f32ab6395285d8d_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a67482433dfc680921b443bdb8a1ea78e" title="Defined in masstree_storage_peek.cpp. " alt="" coords="263,13,472,69"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#abf137494ad55ab4d60cec25c7c654e99" title="Checks the volatile pages of this storage to give hints to decide page boundary keys. " alt="" coords="520,13,693,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a96688f523312e356ea1a03adfbfba7b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::peek_volatile_page_boundaries_this_layer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *&#160;</td>
          <td class="paramname"><em>layer_root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html">memory::GlobalVolatilePageResolver</a> &amp;&#160;</td>
          <td class="paramname"><em>resolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__MASSTREE.html#structfoedus_1_1storage_1_1masstree_1_1MasstreeStorage_1_1PeekBoundariesArguments">MasstreeStorage::PeekBoundariesArguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__peek_8cpp_source.html#l00144">144</a> of file <a class="el" href="masstree__storage__peek_8cpp_source.html">masstree_storage_peek.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00144">foedus::storage::masstree::MasstreePage::get_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00098">foedus::storage::masstree::MasstreePage::get_low_fence()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00084">foedus::storage::masstree::MasstreePage::is_border()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00100">foedus::storage::masstree::MasstreePage::is_high_fence_supremum()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="masstree__id_8hpp_source.html#l00132">foedus::storage::masstree::kInfimumSlice</a>, <a class="el" href="masstree__storage__peek_8cpp_source.html#l00161">peek_volatile_page_boundaries_this_layer_recurse()</a>, <a class="el" href="masstree__storage_8hpp_source.html#l00565">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::prefix_slice_count_</a>, and <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__peek_8cpp_source.html#l00037">peek_volatile_page_boundaries()</a>, and <a class="el" href="masstree__storage__peek_8cpp_source.html#l00061">peek_volatile_page_boundaries_next_layer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                                      {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!layer_root-&gt;header().snapshot_);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(layer_root-&gt;get_layer() == args.prefix_slice_count_);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(layer_root-&gt;get_low_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a> &amp;&amp; layer_root-&gt;is_high_fence_supremum());</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">if</span> (layer_root-&gt;is_border()) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(layer_root-&gt;get_layer() &gt; 0);  <span class="comment">// first layer&#39;s root page is always intermediate</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// the root page of the layer of interest is a border page, hence no boundaries.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keyword">const</span> MasstreeIntermediatePage* cur</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>MasstreeIntermediatePage*<span class="keyword">&gt;</span>(layer_root);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a139bb707048331de71c3abe8c0282d7d">peek_volatile_page_boundaries_this_layer_recurse</a>(cur, resolver, args);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a9cffc20f29ad72d4edbeedece861c48f"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">foedus::storage::masstree::kInfimumSlice</a></div><div class="ttdeci">const KeySlice kInfimumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00132">masstree_id.hpp:132</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a139bb707048331de71c3abe8c0282d7d"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a139bb707048331de71c3abe8c0282d7d">foedus::storage::masstree::MasstreeStoragePimpl::peek_volatile_page_boundaries_this_layer_recurse</a></div><div class="ttdeci">ErrorCode peek_volatile_page_boundaries_this_layer_recurse(const MasstreeIntermediatePage *cur, const memory::GlobalVolatilePageResolver &amp;resolver, const MasstreeStorage::PeekBoundariesArguments &amp;args)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__peek_8cpp_source.html#l00161">masstree_storage_peek.cpp:161</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a96688f523312e356ea1a03adfbfba7b2_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a96688f523312e356ea1a03adfbfba7b2_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a96688f523312e356ea1a03adfbfba7b2_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a96688f523312e356ea1a03adfbfba7b2_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="567,59,742,100"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="853,329,1057,371"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="568,124,741,165"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="567,1132,742,1173"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="869,1445,1042,1501"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a139bb707048331de71c3abe8c0282d7d" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::peek_volatile_page_boundaries\l_this_layer_recurse" alt="" coords="263,680,472,751"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1129,1124,1320,1165"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="550,271,759,312"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0f8830e2b301b1bdd3f2e16d9b047d79" title="foedus::storage::masstree\l::MasstreePage::within_fences" alt="" coords="555,1317,755,1359"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="863,847,1048,903"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="1132,651,1317,707"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#a541c911b49454a9baece1d658f51abf5" title="prefetch upto separators. " alt="" coords="562,190,747,246"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="562,387,747,443"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab55e48873dcf5700871a035c65bfa588" title="used only in masstree. " alt="" coords="551,468,759,509"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="837,717,1073,773"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#a50f249d95bb8fceda793e40a76b4e386" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator::next" alt="" coords="520,665,789,707"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#a8988fe635186bff06191f3eb87447bc8" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::get_pointer" alt="" coords="537,782,773,838"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#aefcac4f0e94dee19b7b26ff392ba4c54" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::get_low_key" alt="" coords="537,585,773,641"/>
<area shape="rect" id="node24" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="875,1015,1036,1056"/>
<area shape="rect" id="node25" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1144,1015,1305,1056"/>
<area shape="rect" id="node26" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="558,964,751,1005"/>
<area shape="rect" id="node27" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="553,1248,756,1289"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1121,793,1328,835"/>
<area shape="rect" id="node15" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="869,197,1041,239"/>
<area shape="rect" id="node16" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1139,197,1311,239"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#adaf1febd2954da507ffd8daa2757c890" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_separator" alt="" coords="863,535,1048,591"/>
<area shape="rect" id="node28" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="878,1248,1033,1289"/>
<area shape="rect" id="node30" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1150,1368,1299,1409"/>
<area shape="rect" id="node31" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="869,1183,1042,1224"/>
<area shape="rect" id="node32" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="854,1314,1057,1370"/>
<area shape="rect" id="node29" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1147,1267,1302,1308"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a96688f523312e356ea1a03adfbfba7b2_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a96688f523312e356ea1a03adfbfba7b2_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a96688f523312e356ea1a03adfbfba7b2_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a96688f523312e356ea1a03adfbfba7b2_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a67482433dfc680921b443bdb8a1ea78e" title="Defined in masstree_storage_peek.cpp. " alt="" coords="520,13,729,69"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a14fb0ae2a643a45c3f32ab6395285d8d" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::peek_volatile_page_boundaries\l_next_layer" alt="" coords="263,41,472,112"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#abf137494ad55ab4d60cec25c7c654e99" title="Checks the volatile pages of this storage to give hints to decide page boundary keys. " alt="" coords="777,13,951,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a139bb707048331de71c3abe8c0282d7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::peek_volatile_page_boundaries_this_layer_recurse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html">MasstreeIntermediatePage</a> *&#160;</td>
          <td class="paramname"><em>cur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html">memory::GlobalVolatilePageResolver</a> &amp;&#160;</td>
          <td class="paramname"><em>resolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__MASSTREE.html#structfoedus_1_1storage_1_1masstree_1_1MasstreeStorage_1_1PeekBoundariesArguments">MasstreeStorage::PeekBoundariesArguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__peek_8cpp_source.html#l00161">161</a> of file <a class="el" href="masstree__storage__peek_8cpp_source.html">masstree_storage_peek.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="page__resolver_8hpp_source.html#l00154">foedus::memory::GlobalVolatilePageResolver::begin_</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="page__resolver_8hpp_source.html#l00156">foedus::memory::GlobalVolatilePageResolver::end_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00312">foedus::storage::masstree::MasstreeIntermediatePage::find_minipage()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00287">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::find_pointer()</a>, <a class="el" href="masstree__storage_8hpp_source.html#l00573">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::found_boundaries_</a>, <a class="el" href="masstree__storage_8hpp_source.html#l00567">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::found_boundary_capacity_</a>, <a class="el" href="masstree__storage_8hpp_source.html#l00575">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::found_boundary_count_</a>, <a class="el" href="masstree__storage_8hpp_source.html#l00569">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::from_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00146">foedus::storage::masstree::MasstreePage::get_btree_level()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00099">foedus::storage::masstree::MasstreePage::get_high_fence()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00144">foedus::storage::masstree::MasstreePage::get_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00098">foedus::storage::masstree::MasstreePage::get_low_fence()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01071">foedus::storage::masstree::MasstreeIntermediatePointerIterator::get_low_key()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00322">foedus::storage::masstree::MasstreeIntermediatePage::get_minipage()</a>, <a class="el" href="storage__id_8hpp_source.html#l00201">foedus::storage::VolatilePagePointer::get_numa_node()</a>, <a class="el" href="storage__id_8hpp_source.html#l00202">foedus::storage::VolatilePagePointer::get_offset()</a>, <a class="el" href="page_8hpp_source.html#l00280">foedus::storage::PageHeader::get_page_type()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01093">foedus::storage::masstree::MasstreeIntermediatePointerIterator::get_pointer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01100">foedus::storage::masstree::MasstreeIntermediatePointerIterator::index_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01101">foedus::storage::masstree::MasstreeIntermediatePointerIterator::index_mini_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00084">foedus::storage::masstree::MasstreePage::is_border()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00100">foedus::storage::masstree::MasstreePage::is_high_fence_supremum()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01067">foedus::storage::masstree::MasstreeIntermediatePointerIterator::is_valid()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="masstree__id_8hpp_source.html#l00132">foedus::storage::masstree::kInfimumSlice</a>, <a class="el" href="page_8hpp_source.html#l00049">foedus::storage::kMasstreeIntermediatePageType</a>, <a class="el" href="compiler_8hpp_source.html#l00103">LIKELY</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01057">foedus::storage::masstree::MasstreeIntermediatePointerIterator::next()</a>, <a class="el" href="page__resolver_8hpp_source.html#l00152">foedus::memory::GlobalVolatilePageResolver::numa_node_count_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00281">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::prefetch()</a>, <a class="el" href="masstree__storage_8hpp_source.html#l00565">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::prefix_slice_count_</a>, <a class="el" href="page__resolver_8hpp_source.html#l00120">foedus::memory::GlobalVolatilePageResolver::resolve_offset()</a>, <a class="el" href="page_8hpp_source.html#l00211">foedus::storage::PageHeader::snapshot_</a>, <a class="el" href="masstree__storage_8hpp_source.html#l00571">foedus::storage::masstree::MasstreeStorage::PeekBoundariesArguments::to_</a>, <a class="el" href="compiler_8hpp_source.html#l00104">UNLIKELY</a>, <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>, and <a class="el" href="masstree__page__impl_8hpp_source.html#l00126">foedus::storage::masstree::MasstreePage::within_fences()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__peek_8cpp_source.html#l00144">peek_volatile_page_boundaries_this_layer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                                      {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!cur-&gt;header().snapshot_);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!cur-&gt;is_border());</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur-&gt;get_layer() == args.prefix_slice_count_);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// because of concurrent modifications, this is possible. we just give up finding hints.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a>(cur-&gt;get_low_fence() &gt;= args.to_ || cur-&gt;get_high_fence() &lt;= args.from_)) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  uint8_t begin_index = 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  uint8_t begin_mini_index = 0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">if</span> (cur-&gt;within_fences(args.from_)) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    begin_index = cur-&gt;find_minipage(args.from_);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keyword">const</span> MasstreeIntermediatePage::MiniPage&amp; minipage = cur-&gt;get_minipage(begin_index);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    minipage.prefetch();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    begin_mini_index = minipage.find_pointer(args.from_);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// if children of this page are intermediate pages (this level&gt;=2), we further recurse.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// if children of this page are border pages, just append the page boundaries stored in this page.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> needs_recurse = (cur-&gt;get_btree_level() &gt;= 2U);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// we don&#39;t care wherther the child has foster twins. it&#39;s rare, and most keys are already</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// pushed up to this page. again, this method is opportunistic.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// this guarantees that the cost of peeking is cheap. we just read intermediate pages.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// again, this code is not protected from concurrent transactions at all.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// we just make sure it doesn&#39;t hit segfault etc.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  MasstreeIntermediatePointerIterator it(cur);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  it.index_ = begin_index;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  it.index_mini_ = begin_mini_index;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">for</span> (; it.is_valid(); it.next()) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    VolatilePagePointer pointer = it.get_pointer().volatile_pointer_;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> boundary = it.get_low_key();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span> (boundary &gt;= args.to_) {  <span class="comment">// all pages under the pointer are &gt;= boundary.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> (boundary &gt; args.from_) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="comment">// at least guarantee that the resulting found_boundaries_ is ordered.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">if</span> ((*args.found_boundary_count_) == 0</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        || args.found_boundaries_[(*args.found_boundary_count_) - 1U] &lt; boundary) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*args.found_boundary_count_) &lt; args.found_boundary_capacity_);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        args.found_boundaries_[*args.found_boundary_count_] = boundary;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        ++(*args.found_boundary_count_);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">if</span> ((*args.found_boundary_count_) &gt;= args.found_boundary_capacity_) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Found too many boundaries while peeking. stops here.&quot;</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// recurse to find more. note that it might contain pages of interest</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// even if boundary &lt; args.from_ because it&#39;s a *low*-fence.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (needs_recurse &amp;&amp; !pointer.is_null()) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__COMPILER.html#gad10e2a9bf230cc6fdd98a6c70958ef81">LIKELY</a>(pointer.get_numa_node() &lt; resolver.numa_node_count_</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        &amp;&amp; pointer.get_offset() &gt;= resolver.begin_</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        &amp;&amp; pointer.get_offset() &lt; resolver.end_)) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keyword">const</span> MasstreeIntermediatePage* next</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>MasstreeIntermediatePage*<span class="keyword">&gt;</span>(resolver.resolve_offset(pointer));</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span> (next-&gt;is_border()) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <span class="comment">// this is possible because our masstree might be unbalanced.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur-&gt;get_layer() == 0);  <span class="comment">// but it can happen only at first layer&#39;s root</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(cur-&gt;get_low_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a> &amp;&amp; cur-&gt;is_high_fence_supremum());</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(next-&gt;header().get_page_type() == <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba23ef27cc0a436fe010a22a7374e8737b">kMasstreeIntermediatePageType</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a139bb707048331de71c3abe8c0282d7d">peek_volatile_page_boundaries_this_layer_recurse</a>(next, resolver, args));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>((*args.found_boundary_count_) &lt;= args.found_boundary_capacity_);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">if</span> ((*args.found_boundary_count_) &gt;= args.found_boundary_capacity_) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a9cffc20f29ad72d4edbeedece861c48f"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">foedus::storage::masstree::kInfimumSlice</a></div><div class="ttdeci">const KeySlice kInfimumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00132">masstree_id.hpp:132</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a139bb707048331de71c3abe8c0282d7d"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a139bb707048331de71c3abe8c0282d7d">foedus::storage::masstree::MasstreeStoragePimpl::peek_volatile_page_boundaries_this_layer_recurse</a></div><div class="ttdeci">ErrorCode peek_volatile_page_boundaries_this_layer_recurse(const MasstreeIntermediatePage *cur, const memory::GlobalVolatilePageResolver &amp;resolver, const MasstreeStorage::PeekBoundariesArguments &amp;args)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__peek_8cpp_source.html#l00161">masstree_storage_peek.cpp:161</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga556e8f0d5e02e78f3ddecd8f5b022bf6"><div class="ttname"><a href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">foedus::storage::masstree::KeySlice</a></div><div class="ttdeci">uint64_t KeySlice</div><div class="ttdoc">Each key slice is an 8-byte integer. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00126">masstree_id.hpp:126</a></div></div>
<div class="ttc" id="group__COMPILER_html_gad10e2a9bf230cc6fdd98a6c70958ef81"><div class="ttname"><a href="group__COMPILER.html#gad10e2a9bf230cc6fdd98a6c70958ef81">LIKELY</a></div><div class="ttdeci">#define LIKELY(x)        </div><div class="ttdoc">Hints that x is highly likely true. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00103">compiler.hpp:103</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga14e35f7fbe4bc18276fde8e8ba460f5ba23ef27cc0a436fe010a22a7374e8737b"><div class="ttname"><a href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba23ef27cc0a436fe010a22a7374e8737b">foedus::storage::kMasstreeIntermediatePageType</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00049">page.hpp:49</a></div></div>
<div class="ttc" id="group__COMPILER_html_ga967462e28f63546ee191a661cd4b9dd2"><div class="ttname"><a href="group__COMPILER.html#ga967462e28f63546ee191a661cd4b9dd2">UNLIKELY</a></div><div class="ttdeci">#define UNLIKELY(x)    </div><div class="ttdoc">Hints that x is highly likely false. </div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00104">compiler.hpp:104</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a139bb707048331de71c3abe8c0282d7d_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a139bb707048331de71c3abe8c0282d7d_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a139bb707048331de71c3abe8c0282d7d_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a139bb707048331de71c3abe8c0282d7d_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="605,15,791,71"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="305,459,490,515"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab55e48873dcf5700871a035c65bfa588" title="used only in masstree. " alt="" coords="293,540,501,581"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="293,605,502,646"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="310,670,485,712"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="596,460,800,501"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#aefcac4f0e94dee19b7b26ff392ba4c54" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::get_low_key" alt="" coords="279,328,515,384"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="875,211,1060,267"/>
<area shape="rect" id="node12" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#acd0b166a127ed5fbadecd838f8e32be5" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::is_valid" alt="" coords="580,146,816,202"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="301,736,494,777"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="887,837,1048,878"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="872,954,1063,996"/>
<area shape="rect" id="node16" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#a8988fe635186bff06191f3eb87447bc8" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator\l::get_pointer" alt="" coords="279,80,515,136"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="311,1118,484,1160"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="611,954,785,996"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="611,1282,785,1338"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="617,837,779,878"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePointerIterator.html#a50f249d95bb8fceda793e40a76b4e386" title="foedus::storage::masstree\l::MasstreeIntermediatePointerIterator::next" alt="" coords="263,212,532,253"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#a541c911b49454a9baece1d658f51abf5" title="prefetch upto separators. " alt="" coords="305,1331,490,1387"/>
<area shape="rect" id="node25" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="296,1053,499,1094"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0f8830e2b301b1bdd3f2e16d9b047d79" title="foedus::storage::masstree\l::MasstreePage::within_fences" alt="" coords="297,1190,497,1232"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="864,84,1071,125"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#adaf1febd2954da507ffd8daa2757c890" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_separator" alt="" coords="605,379,791,435"/>
<area shape="rect" id="node23" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="612,1362,784,1404"/>
<area shape="rect" id="node24" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="881,1362,1053,1404"/>
<area shape="rect" id="node26" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="621,1020,775,1061"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="893,1189,1042,1230"/>
<area shape="rect" id="node29" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="611,1085,785,1126"/>
<area shape="rect" id="node30" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="597,1151,799,1207"/>
<area shape="rect" id="node27" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="890,1089,1045,1130"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a139bb707048331de71c3abe8c0282d7d_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a139bb707048331de71c3abe8c0282d7d_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a139bb707048331de71c3abe8c0282d7d_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a139bb707048331de71c3abe8c0282d7d_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a96688f523312e356ea1a03adfbfba7b2" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::peek_volatile_page_boundaries\l_this_layer" alt="" coords="263,5,472,76"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a67482433dfc680921b443bdb8a1ea78e" title="Defined in masstree_storage_peek.cpp. " alt="" coords="777,13,987,69"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a14fb0ae2a643a45c3f32ab6395285d8d" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::peek_volatile_page_boundaries\l_next_layer" alt="" coords="520,41,729,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#abf137494ad55ab4d60cec25c7c654e99" title="Checks the volatile pages of this storage to give hints to decide page boundary keys. " alt="" coords="1035,13,1208,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abe8cbf3d8edfb47a32d460029707aace"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::prefetch_pages_follow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1DualPagePointer.html">DualPagePointer</a> *&#160;</td>
          <td class="paramname"><em>pointer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>vol_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>snp_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00112">112</a> of file <a class="el" href="masstree__storage__prefetch_8cpp_source.html">masstree_storage_prefetch.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="thread_8cpp_source.html#l00095">foedus::thread::Thread::find_or_read_a_snapshot_page()</a>, <a class="el" href="thread_8cpp_source.html#l00107">foedus::thread::Thread::install_a_volatile_page()</a>, <a class="el" href="storage__id_8hpp_source.html#l00210">foedus::storage::VolatilePagePointer::is_null()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="page__prefetch_8hpp_source.html#l00034">foedus::storage::prefetch_page_l2()</a>, <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00051">prefetch_pages_normalized_recurse()</a>, <a class="el" href="thread_8hpp_source.html#l00110">foedus::thread::Thread::resolve_cast()</a>, <a class="el" href="storage__id_8hpp_source.html#l00307">foedus::storage::DualPagePointer::snapshot_pointer_</a>, <a class="el" href="page_8hpp_source.html#l00395">foedus::storage::to_page()</a>, and <a class="el" href="storage__id_8hpp_source.html#l00308">foedus::storage::DualPagePointer::volatile_pointer_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00051">prefetch_pages_normalized_recurse()</a>.</p>
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;               {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// first, do we have to cache snapshot page?</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">if</span> (pointer-&gt;snapshot_pointer_ != 0) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span> (snp_on) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      MasstreePage* child;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;find_or_read_a_snapshot_page(</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        pointer-&gt;snapshot_pointer_,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        reinterpret_cast&lt;Page**&gt;(&amp;child)));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="group__STORAGE.html#ga9a2f9d6e4c010712ecd8987d65e634c3">prefetch_page_l2</a>(child);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef">prefetch_pages_normalized_recurse</a>(</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        context,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keyword">false</span>,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        snp_on,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        from,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        to,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        child));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// do we have to install volatile page based on it?</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (pointer-&gt;volatile_pointer_.is_null() &amp;&amp; vol_on) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!<a class="code" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25">to_page</a>(pointer)-&gt;get_header().snapshot_);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      Page* child;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;install_a_volatile_page(pointer, &amp;child));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// then go down</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">if</span> (!pointer-&gt;volatile_pointer_.is_null() &amp;&amp; vol_on) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(!<a class="code" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25">to_page</a>(pointer)-&gt;get_header().snapshot_);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    MasstreePage* child = context-&gt;resolve_cast&lt;MasstreePage&gt;(pointer-&gt;volatile_pointer_);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="group__STORAGE.html#ga9a2f9d6e4c010712ecd8987d65e634c3">prefetch_page_l2</a>(child);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef">prefetch_pages_normalized_recurse</a>(</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      context,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      vol_on,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      snp_on,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      from,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      to,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      child));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gaa114fc1859c2d4cb8b9e2021cb11cb25"><div class="ttname"><a href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25">foedus::storage::to_page</a></div><div class="ttdeci">Page * to_page(const void *address)</div><div class="ttdoc">super-dirty way to obtain Page the address belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00395">page.hpp:395</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga9a2f9d6e4c010712ecd8987d65e634c3"><div class="ttname"><a href="group__STORAGE.html#ga9a2f9d6e4c010712ecd8987d65e634c3">foedus::storage::prefetch_page_l2</a></div><div class="ttdeci">void prefetch_page_l2(const void *page)</div><div class="ttdoc">Prefetch a page to L2/L3 cache. </div><div class="ttdef"><b>Definition:</b> <a href="page__prefetch_8hpp_source.html#l00034">page_prefetch.hpp:34</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a4c4630d85af99ceafad404bc5c5c7eef"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef">foedus::storage::masstree::MasstreeStoragePimpl::prefetch_pages_normalized_recurse</a></div><div class="ttdeci">ErrorCode prefetch_pages_normalized_recurse(thread::Thread *context, bool install_volatile, bool cache_snapshot, KeySlice from, KeySlice to, MasstreePage *page)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__prefetch_8cpp_source.html#l00051">masstree_storage_prefetch.cpp:51</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_abe8cbf3d8edfb47a32d460029707aace_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_abe8cbf3d8edfb47a32d460029707aace_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_abe8cbf3d8edfb47a32d460029707aace_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_abe8cbf3d8edfb47a32d460029707aace_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="227,700,436,742"/>
<area shape="rect" id="node20" href="classfoedus_1_1thread_1_1Thread.html#a13d14670c512a2f2f85ff6519a28488c" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="252,858,411,899"/>
<area shape="rect" id="node24" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1031,936,1192,978"/>
<area shape="rect" id="node28" href="group__STORAGE.html#ga9a2f9d6e4c010712ecd8987d65e634c3" title="Prefetch a page to L2/L3 cache. " alt="" coords="249,476,414,518"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::prefetch_pages_normalized\l_recurse" alt="" coords="237,1306,425,1376"/>
<area shape="rect" id="node34" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="518,1022,669,1063"/>
<area shape="rect" id="node50" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="249,1401,414,1428"/>
<area shape="rect" id="node3" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="751,471,960,512"/>
<area shape="rect" id="node4" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="1044,322,1179,363"/>
<area shape="rect" id="node5" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="1008,246,1215,287"/>
<area shape="rect" id="node14" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8" title="foedus::memory::PagePool\l::get_base" alt="" coords="1277,498,1455,539"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1291,730,1441,771"/>
<area shape="rect" id="node16" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="1019,439,1203,480"/>
<area shape="rect" id="node17" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="1274,563,1458,604"/>
<area shape="rect" id="node18" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="1008,106,1215,147"/>
<area shape="rect" id="node19" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8" title="Get a tentative work memory of the specified size from pre&#45;allocated thread&#45;private memory..." alt="" coords="1030,504,1193,546"/>
<area shape="rect" id="node6" href="classfoedus_1_1cache_1_1CacheHashtable.html#a30b6a0b28cce30d50da7e0419c8cad20" title="Returns a bucket number the given page ID should belong to. " alt="" coords="1263,40,1469,82"/>
<area shape="rect" id="node7" href="structfoedus_1_1cache_1_1CacheBucket.html#ab91d1b89c885979b7a6a4ef70b12b54d" title="foedus::cache::CacheBucket\l::get_content_id" alt="" coords="1271,171,1461,212"/>
<area shape="rect" id="node8" href="classfoedus_1_1cache_1_1CacheHashtable.html#acea3236385a3b8d05ed1a60186e32ee8" title="foedus::cache::CacheHashtable\l::get_logical_buckets" alt="" coords="1263,236,1469,278"/>
<area shape="rect" id="node9" href="structfoedus_1_1cache_1_1HashFunc.html#a9470855bb66d98df48f82fc5ba6655c6" title="Returns another hash value used to differentiate IDs with similar hash values. " alt="" coords="1281,106,1451,147"/>
<area shape="rect" id="node10" href="structfoedus_1_1cache_1_1CacheBucket.html#aad7099f48418a335a80260a664bf2f02" title="foedus::cache::CacheBucket\l::get_tag" alt="" coords="1271,302,1461,343"/>
<area shape="rect" id="node11" href="structfoedus_1_1cache_1_1CacheRefCount.html#af555d7665e995d8e65f315c708d28daa" title="foedus::cache::CacheRefCount\l::increment" alt="" coords="1265,367,1467,408"/>
<area shape="rect" id="node12" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="1280,432,1452,474"/>
<area shape="rect" id="node13" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1517,207,1689,248"/>
<area shape="rect" id="node21" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="501,810,685,851"/>
<area shape="rect" id="node22" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="763,840,947,896"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1285,975,1447,1016"/>
<area shape="rect" id="node25" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1019,722,1203,778"/>
<area shape="rect" id="node26" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343" title="Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v..." alt="" coords="762,774,949,815"/>
<area shape="rect" id="node27" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1010,854,1213,895"/>
<area shape="rect" id="node29" href="group__ASSORTED.html#ga776c53f69f97c1edfc5d34a0f6cb3100" title="Prefetch multiple contiguous cachelines to L2/L3 cache. " alt="" coords="761,221,950,248"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a14cdcef87b3c0a6ef431df9d06a1a663" title="An empty&#45;range page, either intermediate or border, never has any entries. " alt="" coords="486,1394,701,1435"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="485,1459,701,1500"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a32653a16ddca213c94560652e9388dd5" title="foedus::storage::masstree\l::MasstreePage::get_foster_minor" alt="" coords="484,1524,703,1566"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a27d301fad7d4d340cd2d6255dc330607" title="foedus::storage::masstree\l::MasstreePage::get_foster_major" alt="" coords="484,1590,703,1631"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1008,1710,1215,1751"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="506,1812,681,1854"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="499,1706,687,1762"/>
<area shape="rect" id="node45" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="487,1087,699,1128"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="504,1153,683,1209"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#adaf1febd2954da507ffd8daa2757c890" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_separator" alt="" coords="501,1233,686,1289"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="501,1313,686,1369"/>
<area shape="rect" id="node33" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="759,1459,951,1500"/>
<area shape="rect" id="node35" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="780,1072,931,1114"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1Thread.html#aa77cde98794b5a55e0d295284acb3e6d" title="Returns the page resolver to convert page ID to page pointer. " alt="" coords="1036,1072,1187,1128"/>
<area shape="rect" id="node41" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="760,1838,951,1879"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="752,1772,959,1814"/>
<area shape="rect" id="node44" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="794,1707,917,1748"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="766,1153,945,1209"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_abe8cbf3d8edfb47a32d460029707aace_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_abe8cbf3d8edfb47a32d460029707aace_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_abe8cbf3d8edfb47a32d460029707aace_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_abe8cbf3d8edfb47a32d460029707aace_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::prefetch_pages_normalized\l_recurse" alt="" coords="227,5,415,76"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a99bb085d9e427fc36182b13bb20371e9" title="defined in masstree_storage_prefetch.cpp " alt="" coords="463,13,651,69"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a10db264b9d354e1813bd20ef8fdb72bb" title="Prefetch data pages in this storage. " alt="" coords="699,13,881,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a99bb085d9e427fc36182b13bb20371e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::prefetch_pages_normalized </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>install_volatile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cache_snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>defined in <a class="el" href="masstree__storage__prefetch_8cpp.html">masstree_storage_prefetch.cpp</a> </p>

<p>Definition at line <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00030">30</a> of file <a class="el" href="masstree__storage__prefetch_8cpp_source.html">masstree_storage_prefetch.cpp</a>.</p>

<p>References <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="stop__watch_8hpp_source.html#l00045">foedus::debugging::StopWatch::elapsed_us()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">get_first_root()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00113">get_name()</a>, <a class="el" href="thread_8cpp_source.html#l00053">foedus::thread::Thread::get_thread_id()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="page__prefetch_8hpp_source.html#l00034">foedus::storage::prefetch_page_l2()</a>, <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00051">prefetch_pages_normalized_recurse()</a>, and <a class="el" href="stop__watch_8cpp_source.html#l00035">foedus::debugging::StopWatch::stop()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00590">foedus::storage::masstree::MasstreeStorage::prefetch_pages_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;               {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  debugging::StopWatch watch;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; context-&gt;get_thread_id()</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; prefetching &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">get_name</a>() &lt;&lt; <span class="stringliteral">&quot; from=&quot;</span> &lt;&lt; from &lt;&lt; <span class="stringliteral">&quot;, to=&quot;</span> &lt;&lt; to;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  MasstreeIntermediatePage* root_page;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">get_first_root</a>(context, <span class="keyword">false</span>, &amp;root_page));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="group__STORAGE.html#ga9a2f9d6e4c010712ecd8987d65e634c3">prefetch_page_l2</a>(root_page);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef">prefetch_pages_normalized_recurse</a>(context, vol_on, snp_on, from, to, root_page));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  watch.stop();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Thread-&quot;</span> &lt;&lt; context-&gt;get_thread_id()</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; prefetched &quot;</span> &lt;&lt; <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">get_name</a>() &lt;&lt; <span class="stringliteral">&quot; in &quot;</span> &lt;&lt; watch.elapsed_us() &lt;&lt; <span class="stringliteral">&quot;us&quot;</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a94e2b69404cabddbead1d1fb0ef1dc42"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42">foedus::storage::masstree::MasstreeStoragePimpl::get_name</a></div><div class="ttdeci">const StorageName &amp; get_name() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00113">masstree_storage_pimpl.hpp:113</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_adc32aaf6f4537fcc1ada207e1d6902ec"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">foedus::storage::masstree::MasstreeStoragePimpl::get_first_root</a></div><div class="ttdeci">ErrorCode get_first_root(thread::Thread *context, bool for_write, MasstreeIntermediatePage **root)</div><div class="ttdoc">Root-node related, such as a method to retrieve 1st-root, to grow, etc. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00058">masstree_storage_pimpl.cpp:58</a></div></div>
<div class="ttc" id="group__STORAGE_html_ga9a2f9d6e4c010712ecd8987d65e634c3"><div class="ttname"><a href="group__STORAGE.html#ga9a2f9d6e4c010712ecd8987d65e634c3">foedus::storage::prefetch_page_l2</a></div><div class="ttdeci">void prefetch_page_l2(const void *page)</div><div class="ttdoc">Prefetch a page to L2/L3 cache. </div><div class="ttdef"><b>Definition:</b> <a href="page__prefetch_8hpp_source.html#l00034">page_prefetch.hpp:34</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a4c4630d85af99ceafad404bc5c5c7eef"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef">foedus::storage::masstree::MasstreeStoragePimpl::prefetch_pages_normalized_recurse</a></div><div class="ttdeci">ErrorCode prefetch_pages_normalized_recurse(thread::Thread *context, bool install_volatile, bool cache_snapshot, KeySlice from, KeySlice to, MasstreePage *page)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__prefetch_8cpp_source.html#l00051">masstree_storage_prefetch.cpp:51</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a99bb085d9e427fc36182b13bb20371e9_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a99bb085d9e427fc36182b13bb20371e9_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a99bb085d9e427fc36182b13bb20371e9_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a99bb085d9e427fc36182b13bb20371e9_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1debugging_1_1StopWatch.html#a7f1f05f4dd494dd57c3ecafb5d9131fb" title="foedus::debugging::\lStopWatch::elapsed_us" alt="" coords="255,5,416,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="249,1197,422,1253"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a94e2b69404cabddbead1d1fb0ef1dc42" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_name" alt="" coords="249,1277,422,1333"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="260,1357,411,1399"/>
<area shape="rect" id="node24" href="group__STORAGE.html#ga9a2f9d6e4c010712ecd8987d65e634c3" title="Prefetch a page to L2/L3 cache. " alt="" coords="766,137,931,179"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::prefetch_pages_normalized\l_recurse" alt="" coords="241,529,429,600"/>
<area shape="rect" id="node48" href="classfoedus_1_1debugging_1_1StopWatch.html#a2ee5315a0f6bf736a2a73b29b1709bd2" title="Take another current time tick. " alt="" coords="268,1652,403,1693"/>
<area shape="rect" id="node4" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="509,1019,664,1060"/>
<area shape="rect" id="node5" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="511,1084,662,1125"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer\l_address" alt="" coords="500,1149,673,1220"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="482,1244,691,1285"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="500,1310,673,1366"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="499,1391,674,1432"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="485,1456,689,1497"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="479,953,695,995"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="500,1521,673,1563"/>
<area shape="rect" id="node20" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="511,1587,662,1628"/>
<area shape="rect" id="node6" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="757,1051,941,1092"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1026,564,1187,605"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1032,1017,1181,1059"/>
<area shape="rect" id="node9" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1001,1083,1212,1124"/>
<area shape="rect" id="node10" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1015,1149,1199,1205"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1026,952,1187,993"/>
<area shape="rect" id="node18" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="753,953,945,995"/>
<area shape="rect" id="node21" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="757,1587,941,1628"/>
<area shape="rect" id="node25" href="group__ASSORTED.html#ga776c53f69f97c1edfc5d34a0f6cb3100" title="Prefetch multiple contiguous cachelines to L2/L3 cache. " alt="" coords="1012,145,1201,171"/>
<area shape="rect" id="node26" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1260,137,1432,179"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a14cdcef87b3c0a6ef431df9d06a1a663" title="An empty&#45;range page, either intermediate or border, never has any entries. " alt="" coords="479,413,694,455"/>
<area shape="rect" id="node29" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="773,275,924,316"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a32653a16ddca213c94560652e9388dd5" title="foedus::storage::masstree\l::MasstreePage::get_foster_minor" alt="" coords="477,479,696,520"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a27d301fad7d4d340cd2d6255dc330607" title="foedus::storage::masstree\l::MasstreePage::get_foster_major" alt="" coords="477,544,696,585"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1003,645,1210,687"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="499,741,674,783"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="493,661,681,717"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="481,807,693,848"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="497,873,676,929"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#abe8cbf3d8edfb47a32d460029707aace" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::prefetch_pages_follow" alt="" coords="500,333,673,389"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#adaf1febd2954da507ffd8daa2757c890" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_separator" alt="" coords="494,122,679,178"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="494,202,679,258"/>
<area shape="rect" id="node30" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="1031,275,1182,316"/>
<area shape="rect" id="node35" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="753,792,944,833"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="745,661,952,703"/>
<area shape="rect" id="node38" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="787,727,910,768"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="759,873,938,929"/>
<area shape="rect" id="node43" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="744,340,953,381"/>
<area shape="rect" id="node44" href="classfoedus_1_1thread_1_1Thread.html#a13d14670c512a2f2f85ff6519a28488c" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="769,405,928,447"/>
<area shape="rect" id="node45" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="766,471,931,498"/>
<area shape="rect" id="node49" href="classfoedus_1_1debugging_1_1StopWatch.html#adacc2b7108e7b4df019cc79733050b8c" title="foedus::debugging::\lStopWatch::elapsed_ns" alt="" coords="506,1652,667,1693"/>
<area shape="rect" id="node50" href="namespacefoedus_1_1debugging.html#a35a786b0492e9799cb74359408079091" title="foedus::debugging::\lget_now_nanosec" alt="" coords="519,1717,654,1759"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a99bb085d9e427fc36182b13bb20371e9_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a99bb085d9e427fc36182b13bb20371e9_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a99bb085d9e427fc36182b13bb20371e9_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a99bb085d9e427fc36182b13bb20371e9_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a10db264b9d354e1813bd20ef8fdb72bb" title="Prefetch data pages in this storage. " alt="" coords="241,5,424,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4c4630d85af99ceafad404bc5c5c7eef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::prefetch_pages_normalized_recurse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>install_volatile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cache_snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *&#160;</td>
          <td class="paramname"><em>page</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00051">51</a> of file <a class="el" href="masstree__storage__prefetch_8cpp_source.html">masstree_storage_prefetch.cpp</a>.</p>

<p>References <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00796">foedus::storage::masstree::MasstreeBorderPage::does_point_to_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00113">foedus::storage::masstree::MasstreePage::get_foster_major()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00112">foedus::storage::masstree::MasstreePage::get_foster_minor()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00148">foedus::storage::masstree::MasstreePage::get_key_count()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00322">foedus::storage::masstree::MasstreeIntermediatePage::get_minipage()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00750">foedus::storage::masstree::MasstreeBorderPage::get_next_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00324">foedus::storage::masstree::MasstreeIntermediatePage::get_separator()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00801">foedus::storage::masstree::MasstreeBorderPage::get_slice()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00139">foedus::storage::masstree::MasstreePage::has_foster_child()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00084">foedus::storage::masstree::MasstreePage::is_border()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00097">foedus::storage::masstree::MasstreePage::is_empty_range()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00271">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::key_count_</a>, <a class="el" href="masstree__id_8hpp_source.html#l00132">foedus::storage::masstree::kInfimumSlice</a>, <a class="el" href="masstree__id_8hpp_source.html#l00137">foedus::storage::masstree::kSupremumSlice</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00278">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::pointers_</a>, <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00112">prefetch_pages_follow()</a>, <a class="el" href="thread_8hpp_source.html#l00110">foedus::thread::Thread::resolve_cast()</a>, and <a class="el" href="masstree__page__impl_8hpp_source.html#l00276">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::separators_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00112">prefetch_pages_follow()</a>, and <a class="el" href="masstree__storage__prefetch_8cpp_source.html#l00030">prefetch_pages_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                   {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">if</span> (p-&gt;is_empty_range()) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span> (p-&gt;has_foster_child()) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    MasstreePage* minor = context-&gt;resolve_cast&lt;MasstreePage&gt;(p-&gt;get_foster_minor());</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    MasstreePage* major = context-&gt;resolve_cast&lt;MasstreePage&gt;(p-&gt;get_foster_major());</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef">prefetch_pages_normalized_recurse</a>(context, vol_on, snp_on, from, to, minor));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef">prefetch_pages_normalized_recurse</a>(context, vol_on, snp_on, from, to, major));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  uint8_t count = p-&gt;get_key_count();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">if</span> (p-&gt;is_border()) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    MasstreeBorderPage* page = <span class="keyword">reinterpret_cast&lt;</span>MasstreeBorderPage*<span class="keyword">&gt;</span>(p);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; count; ++i) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordflow">if</span> (page-&gt;does_point_to_layer(i) &amp;&amp; page-&gt;get_slice(i) &gt;= from &amp;&amp; page-&gt;get_slice(i) &lt;= to) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        DualPagePointer* pointer = page-&gt;get_next_layer(i);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="comment">// next layer. exhaustively read</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#abe8cbf3d8edfb47a32d460029707aace">prefetch_pages_follow</a>(</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          context,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;          pointer,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;          vol_on,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          snp_on,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;          <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a>,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;          <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">kSupremumSlice</a>));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    MasstreeIntermediatePage* page = <span class="keyword">reinterpret_cast&lt;</span>MasstreeIntermediatePage*<span class="keyword">&gt;</span>(p);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt;= count; ++i) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">if</span> (i &lt; count &amp;&amp; page-&gt;get_separator(i) &gt;= from) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; page-&gt;get_separator(i - 1) &gt; to) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      MasstreeIntermediatePage::MiniPage&amp; minipage = page-&gt;get_minipage(i);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">for</span> (uint8_t j = 0; j &lt;= minipage.key_count_; ++j) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">if</span> (j &lt; minipage.key_count_ &amp;&amp; minipage.separators_[j] &gt;= from) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">if</span> (j &gt; 0 &amp;&amp; minipage.separators_[j - 1] &gt; to) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        DualPagePointer* pointer = &amp;minipage.pointers_[j];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">// next layer. exhaustively read</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#abe8cbf3d8edfb47a32d460029707aace">prefetch_pages_follow</a>(context, pointer, vol_on, snp_on, from, to));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_abe8cbf3d8edfb47a32d460029707aace"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#abe8cbf3d8edfb47a32d460029707aace">foedus::storage::masstree::MasstreeStoragePimpl::prefetch_pages_follow</a></div><div class="ttdeci">ErrorCode prefetch_pages_follow(thread::Thread *context, DualPagePointer *pointer, bool vol_on, bool snp_on, KeySlice from, KeySlice to)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__prefetch_8cpp_source.html#l00112">masstree_storage_prefetch.cpp:112</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a9cffc20f29ad72d4edbeedece861c48f"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">foedus::storage::masstree::kInfimumSlice</a></div><div class="ttdeci">const KeySlice kInfimumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00132">masstree_id.hpp:132</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a4c4630d85af99ceafad404bc5c5c7eef"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a4c4630d85af99ceafad404bc5c5c7eef">foedus::storage::masstree::MasstreeStoragePimpl::prefetch_pages_normalized_recurse</a></div><div class="ttdeci">ErrorCode prefetch_pages_normalized_recurse(thread::Thread *context, bool install_volatile, bool cache_snapshot, KeySlice from, KeySlice to, MasstreePage *page)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__prefetch_8cpp_source.html#l00051">masstree_storage_prefetch.cpp:51</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a7bfcd277a96bcd1e9008459abe1ec40d"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">foedus::storage::masstree::kSupremumSlice</a></div><div class="ttdeci">const KeySlice kSupremumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00137">masstree_id.hpp:137</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4c4630d85af99ceafad404bc5c5c7eef_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4c4630d85af99ceafad404bc5c5c7eef_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4c4630d85af99ceafad404bc5c5c7eef_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4c4630d85af99ceafad404bc5c5c7eef_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="257,80,445,136"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1529,65,1736,106"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a27d301fad7d4d340cd2d6255dc330607" title="foedus::storage::masstree\l::MasstreePage::get_foster_major" alt="" coords="241,241,460,282"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a32653a16ddca213c94560652e9388dd5" title="foedus::storage::masstree\l::MasstreePage::get_foster_minor" alt="" coords="241,306,460,347"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="258,372,443,428"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="261,160,440,216"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#adaf1febd2954da507ffd8daa2757c890" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_separator" alt="" coords="258,452,443,508"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="245,533,457,574"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="243,598,459,639"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="263,663,438,705"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a14cdcef87b3c0a6ef431df9d06a1a663" title="An empty&#45;range page, either intermediate or border, never has any entries. " alt="" coords="243,729,458,770"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#abe8cbf3d8edfb47a32d460029707aace" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::prefetch_pages_follow" alt="" coords="264,795,437,851"/>
<area shape="rect" id="node47" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="529,970,679,1011"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1275,129,1481,170"/>
<area shape="rect" id="node5" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="543,110,665,151"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="515,183,693,239"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="748,277,969,318"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="769,183,948,239"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="1033,269,1211,325"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="1033,349,1211,405"/>
<area shape="rect" id="node15" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="1035,109,1209,165"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="1033,189,1211,245"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="508,381,700,422"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="763,381,955,422"/>
<area shape="rect" id="node23" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="509,446,699,487"/>
<area shape="rect" id="node26" href="classfoedus_1_1thread_1_1Thread.html#ad9a1cd82a866fd82299acc66a59c2487" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="754,931,963,973"/>
<area shape="rect" id="node36" href="classfoedus_1_1thread_1_1Thread.html#a13d14670c512a2f2f85ff6519a28488c" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="525,737,683,778"/>
<area shape="rect" id="node40" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1297,581,1459,622"/>
<area shape="rect" id="node44" href="group__STORAGE.html#ga9a2f9d6e4c010712ecd8987d65e634c3" title="Prefetch a page to L2/L3 cache. " alt="" coords="521,802,687,843"/>
<area shape="rect" id="node50" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="521,868,687,895"/>
<area shape="rect" id="node27" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a16c6375f66e9f177c908dc1fbc132681" title="Find the given page in snapshot cache, reading it if not found. " alt="" coords="1017,1075,1227,1117"/>
<area shape="rect" id="node28" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="1311,1074,1445,1115"/>
<area shape="rect" id="node29" href="classfoedus_1_1cache_1_1CacheHashtable.html#ac92d7a0c69e61cfdcacd72b9e8c7bd74" title="Returns an offset for the given page ID opportunistically. " alt="" coords="1275,1139,1481,1181"/>
<area shape="rect" id="node30" href="classfoedus_1_1memory_1_1PagePool.html#af9db36a92eb5116e01545d73cc7e1ab8" title="foedus::memory::PagePool\l::get_base" alt="" coords="1543,1223,1722,1265"/>
<area shape="rect" id="node31" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1558,870,1707,911"/>
<area shape="rect" id="node32" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3c43ac83a4cdcc3e48d8b125dfcff963" title="foedus::thread::ThreadPimpl\l::on_snapshot_cache_miss" alt="" coords="1286,1257,1470,1298"/>
<area shape="rect" id="node33" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a3d583a33e85e1a33568fa04b409ae2ca" title="Read a snapshot page using the thread&#45;local file descriptor set. " alt="" coords="1541,1302,1725,1343"/>
<area shape="rect" id="node34" href="classfoedus_1_1cache_1_1CacheHashtable.html#af7762689517cd7a18dd64d8591a3272a" title="Called when a cached page is not found. " alt="" coords="1275,1374,1481,1415"/>
<area shape="rect" id="node35" href="classfoedus_1_1xct_1_1Xct.html#a7f299489d8dd719eb055ce2ef29309b8" title="Get a tentative work memory of the specified size from pre&#45;allocated thread&#45;private memory..." alt="" coords="1297,1009,1459,1050"/>
<area shape="rect" id="node37" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a4a95ef1bd710a66e0c24df998f881d04" title="Installs a volatile page to the given dual pointer as a copy of the snapshot page. " alt="" coords="767,737,951,778"/>
<area shape="rect" id="node38" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#afb436d68c982228d9e4bc66104b2aa98" title="Wrapper for grab_free_volatile_page(). " alt="" coords="1030,613,1214,669"/>
<area shape="rect" id="node39" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1552,617,1713,658"/>
<area shape="rect" id="node41" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1286,709,1470,765"/>
<area shape="rect" id="node42" href="classfoedus_1_1thread_1_1ThreadPimpl.html#ab1611b1e29b58ee7aaf3b88cc57f9343" title="Subroutine of install_a_volatile_page() and follow_page_pointer() to atomically place the given new v..." alt="" coords="1029,795,1215,837"/>
<area shape="rect" id="node43" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1277,841,1479,882"/>
<area shape="rect" id="node45" href="group__ASSORTED.html#ga776c53f69f97c1edfc5d34a0f6cb3100" title="Prefetch multiple contiguous cachelines to L2/L3 cache. " alt="" coords="764,835,953,861"/>
<area shape="rect" id="node46" href="group__ASSORTED.html#ga354bfce84ebf918859d54ba97b8ddc36" title="Prefetch one cacheline to L1 cache. " alt="" coords="1036,958,1208,999"/>
<area shape="rect" id="node48" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="783,1017,934,1058"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1Thread.html#aa77cde98794b5a55e0d295284acb3e6d" title="Returns the page resolver to convert page ID to page pointer. " alt="" coords="1047,1141,1197,1197"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4c4630d85af99ceafad404bc5c5c7eef_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4c4630d85af99ceafad404bc5c5c7eef_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4c4630d85af99ceafad404bc5c5c7eef_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a4c4630d85af99ceafad404bc5c5c7eef_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#abe8cbf3d8edfb47a32d460029707aace" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::prefetch_pages_follow" alt="" coords="249,13,422,69"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a99bb085d9e427fc36182b13bb20371e9" title="defined in masstree_storage_prefetch.cpp " alt="" coords="241,93,429,149"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a10db264b9d354e1813bd20ef8fdb72bb" title="Prefetch data pages in this storage. " alt="" coords="477,93,660,149"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3036d6662c0bd89e330ca19cbca1f549"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::register_record_write_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1log_1_1RecordLogType.html">log::RecordLogType</a> *&#160;</td>
          <td class="paramname"><em>log_entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used in the following methods. </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00645">645</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="xct_8cpp_source.html#l00506">foedus::xct::Xct::add_related_write_set()</a>, <a class="el" href="xct_8cpp_source.html#l00444">foedus::xct::Xct::add_to_write_set()</a>, <a class="el" href="thread_8cpp_source.html#l00075">foedus::thread::Thread::get_current_xct()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00112">get_id()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00813">foedus::storage::masstree::MasstreeBorderPage::get_owner_id()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00732">foedus::storage::masstree::MasstreeBorderPage::get_record()</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00043">foedus::storage::masstree::RecordLocation::index_</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00041">foedus::storage::masstree::RecordLocation::page_</a>, and <a class="el" href="masstree__record__location_8hpp_source.html#l00054">foedus::storage::masstree::RecordLocation::readset_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00691">delete_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00806">increment_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00661">insert_general()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00772">overwrite_general()</a>, and <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00711">upsert_general()</a>.</p>
<div class="fragment"><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                               {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="comment">// If we have taken readset in locate_record, add as a related write set</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  MasstreeBorderPage* border = location.page_;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keyword">auto</span>* tid = border-&gt;get_owner_id(location.index_);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">char</span>* record = border-&gt;get_record(location.index_);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  xct::Xct* cur_xct = &amp;context-&gt;get_current_xct();</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">if</span> (location.readset_) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">return</span> cur_xct-&gt;add_related_write_set(location.readset_, tid, record, log_entry);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">return</span> cur_xct-&gt;add_to_write_set(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>(), tid, record, log_entry);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aca6d912133fd8b46eacb660b840bada0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">foedus::storage::masstree::MasstreeStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00112">masstree_storage_pimpl.hpp:112</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a3036d6662c0bd89e330ca19cbca1f549_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a3036d6662c0bd89e330ca19cbca1f549_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a3036d6662c0bd89e330ca19cbca1f549_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a3036d6662c0bd89e330ca19cbca1f549_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="268,20,409,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="516,79,657,120"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="263,137,414,179"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="252,203,425,259"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="497,258,676,314"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="228,345,449,387"/>
<area shape="rect" id="node3" href="group__LOGTYPE.html#gad2d33090f44d00949a05c245e5ff1046" title="Invokes the assertion logic of each log type. " alt="" coords="763,5,892,47"/>
<area shape="rect" id="node4" href="structfoedus_1_1log_1_1LogHeader.html#a6ebe3b99442f2a58a4adeeb60f9a37e0" title="Convenience method to cast into LogCode. " alt="" coords="1005,5,1159,47"/>
<area shape="rect" id="node6" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a1ff8ccbccdede750fb5a18b4da505ad9" title="foedus::xct::Retrospective\lLockList::get_volatile\l_page_resolver" alt="" coords="741,71,913,127"/>
<area shape="rect" id="node7" href="namespacefoedus_1_1storage.html#a263602e0a73eedbe5f32128635106e17" title="foedus::storage::assert\l_within_valid_volatile_page" alt="" coords="740,152,915,193"/>
<area shape="rect" id="node18" href="structfoedus_1_1xct_1_1RecordXctAccess.html#ace820ba89437e4d3a59fdb47a47525ba" title="Calculate owner_lock_id using the resolver. " alt="" coords="727,255,928,296"/>
<area shape="rect" id="node8" href="namespacefoedus_1_1storage.html#ad38ebb5eb992249a7b42001fe464ec48" title="foedus::storage::assert\l_within_valid_volatile\l_page_impl" alt="" coords="1005,107,1159,163"/>
<area shape="rect" id="node9" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1499,72,1672,113"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1755,128,1905,169"/>
<area shape="rect" id="node11" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1233,173,1436,215"/>
<area shape="rect" id="node17" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="1252,71,1417,98"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1508,189,1663,231"/>
<area shape="rect" id="node16" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1484,255,1687,311"/>
<area shape="rect" id="node13" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1753,260,1907,301"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1749,327,1911,368"/>
<area shape="rect" id="node15" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1735,193,1925,235"/>
<area shape="rect" id="node19" href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748" title="foedus::xct::xct_id\l_to_universal_lock_id" alt="" coords="1009,255,1155,296"/>
<area shape="rect" id="node22" href="structfoedus_1_1xct_1_1RecordXctAccess.html#adf2e2a9d414bf5cfe86f33198ebdf434" title="Setter for owner_id_address_/owner_lock_id_. " alt="" coords="983,320,1181,361"/>
<area shape="rect" id="node20" href="namespacefoedus_1_1xct.html#a94b21516b530d0be271c6005a72009ad" title="foedus::xct::to_universal\l_lock_id" alt="" coords="1253,328,1416,369"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#adb76c33cd20ea764c7a8e554e8201077" title="foedus::storage::Volatile\lPagePointer::get_numa_node" alt="" coords="1489,387,1682,428"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="724,405,931,447"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="979,405,1185,447"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="497,418,676,474"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="497,338,676,394"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a3036d6662c0bd89e330ca19cbca1f549_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a3036d6662c0bd89e330ca19cbca1f549_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a3036d6662c0bd89e330ca19cbca1f549_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a3036d6662c0bd89e330ca19cbca1f549_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a45396b70b246f330355397b447af55f3" title="implementation of delete_record family. " alt="" coords="228,90,401,146"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aa71566d3a4d56ded35df567784b13525" title="implementation of increment_record family. " alt="" coords="228,298,401,354"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#af0b96482a874777c4871a152ad733da3" title="implementation of insert_record family. " alt="" coords="228,445,401,501"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ab9cc59cbbef3fd23a62cbd25cbd00abb" title="implementation of overwrite_record family. " alt="" coords="228,678,401,734"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aeeccc272d2f9a4d895f4d117f6b96b27" title="implementation of upsert_record family. " alt="" coords="228,991,401,1047"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#af263fb1494c7ac6a5dbfd28b926ede3b" title="foedus::storage::masstree\l::MasstreeCursor::delete_record" alt="" coords="464,5,672,47"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ac6b8b9c2d3b756b4559e43fbe93950a5" title="Deletes a record of the given key from this Masstree. " alt="" coords="743,97,957,139"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0051986148bca838483cf3a81d3f5236" title="Deletes a record of the given primitive key from this Masstree. " alt="" coords="481,122,655,178"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a81ce493961aa7dedc518ca4230d01868" title="foedus::storage::masstree\l::MasstreeCursor::increment_record" alt="" coords="453,203,683,244"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0fc21940320e38fa61ebfc88af210fde" title="This one further optimizes overwrite methods for the frequent use case of incrementing some data in p..." alt="" coords="449,268,687,309"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adba3fe323a9ea3e8f8e006459ef7e442" title="For primitive key. " alt="" coords="471,334,665,390"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="462,415,674,456"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="481,481,655,537"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#ab8b1919cb195dd063be409f772b36630" title="foedus::storage::masstree\l::MasstreeCursor::overwrite_record" alt="" coords="457,561,679,603"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae7221368afad2669e36cdf1bfe8dcb5f" title="Overwrites a part of one record of the given key in this Masstree. " alt="" coords="735,652,965,693"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ad27ac2a920f1f63adc768f7c95ea5c6f" title="Overwrites a part of one record of the given primitive key in this Masstree. " alt="" coords="475,678,661,734"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeCursor.html#a496370a645284f8578875529c6eacb0f" title="foedus::storage::masstree\l::MasstreeCursor::overwrite\l_record_primitive" alt="" coords="478,758,658,814"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a384c8fadf63901aa055285c7f680570f" title="Overwrites a part of one record of the given key in this Masstree as a primitive value. " alt="" coords="475,838,661,894"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aadbf62a4594062706294a2402777e223" title="Overwrites a part of one record of the given primitive key in this Masstree as a primitive value..." alt="" coords="473,918,663,974"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="460,999,676,1040"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="481,1065,655,1121"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a52a1bce48d9230ad2ce3f52c4da51b8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::reserve_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a>&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>payload_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>physical_payload_hint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Like <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. ">locate_record()</a>, this is also a logical operation. </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00412">412</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00057">foedus::storage::masstree::RecordLocation::clear()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00213">find_border_physical()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01198">foedus::storage::masstree::MasstreeBorderPage::find_key_for_reserve()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00384">follow_layer()</a>, <a class="el" href="thread_8cpp_source.html#l00075">foedus::thread::Thread::get_current_xct()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">get_first_root()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00113">foedus::storage::masstree::MasstreePage::get_foster_major()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00112">foedus::storage::masstree::MasstreePage::get_foster_minor()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00148">foedus::storage::masstree::MasstreePage::get_key_count()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00838">foedus::storage::masstree::MasstreeBorderPage::get_max_payload_length()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00114">get_meta()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00139">foedus::storage::masstree::MasstreePage::has_foster_child()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00596">foedus::storage::masstree::MasstreeBorderPage::FindKeyForReserveResult::index_</a>, <a class="el" href="xct__id_8hpp_source.html#l01041">foedus::xct::XctId::is_moved()</a>, <a class="el" href="xct__id_8hpp_source.html#l01042">foedus::xct::XctId::is_next_layer()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00163">foedus::storage::masstree::kBorderPageMaxSlots</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00588">foedus::storage::masstree::MasstreeBorderPage::kExactMatchLayerPointer</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00587">foedus::storage::masstree::MasstreeBorderPage::kExactMatchLocalRecord</a>, <a class="el" href="masstree__id_8hpp_source.html#l00075">foedus::storage::masstree::kMaxKeyLength</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00586">foedus::storage::masstree::MasstreeBorderPage::kNotFound</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00597">foedus::storage::masstree::MasstreeBorderPage::FindKeyForReserveResult::match_type_</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00046">foedus::assorted::memory_fence_acquire()</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00048">foedus::storage::masstree::RecordLocation::observed_</a>, <a class="el" href="masstree__reserve__impl_8hpp_source.html#l00089">foedus::storage::masstree::ReserveRecords::out_split_needed_</a>, <a class="el" href="masstree__record__location_8cpp_source.html#l00027">foedus::storage::masstree::RecordLocation::populate_logical()</a>, <a class="el" href="thread_8hpp_source.html#l00110">foedus::thread::Thread::resolve_cast()</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00952">foedus::thread::Thread::run_nested_sysxct()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00279">foedus::storage::masstree::slice_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00126">foedus::storage::masstree::MasstreePage::within_fences()</a>, and <a class="el" href="masstree__page__impl_8hpp_source.html#l00129">foedus::storage::masstree::MasstreePage::within_foster_minor()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00247">foedus::storage::masstree::MasstreeStorage::insert_record()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00347">foedus::storage::masstree::MasstreeStorage::upsert_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                          {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(key_length &lt;= <a class="code" href="group__MASSTREE.html#gae33cf61cd45f5956aa2e46283b9474ab">kMaxKeyLength</a>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(physical_payload_hint &gt;= payload_count);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(result);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  result-&gt;clear();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  xct::Xct* cur_xct = &amp;context-&gt;get_current_xct();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  MasstreePage* layer_root;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">get_first_root</a>(</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    context,</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keyword">true</span>,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    reinterpret_cast&lt;MasstreeIntermediatePage**&gt;(&amp;layer_root)));</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">for</span> (uint16_t layer = 0;; ++layer) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keyword">const</span> <a class="code" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> remainder = key_length - layer * <span class="keyword">sizeof</span>(<a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keyword">const</span> <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> slice = <a class="code" href="group__MASSTREE.html#gabdb6a706258be601e621e58653bf528e">slice_layer</a>(key, key_length, layer);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">void</span>* <span class="keyword">const</span> suffix = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(key) + (layer + 1) * <span class="keyword">sizeof</span>(<a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    MasstreeBorderPage* border;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0">find_border_physical</a>(context, layer_root, layer, <span class="keyword">true</span>, slice, &amp;border));</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {  <span class="comment">// retry loop for following foster child and temporary failure</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="comment">// if we found out that the page was split and we should follow foster child, do it.</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">while</span> (border-&gt;has_foster_child()) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">if</span> (border-&gt;within_foster_minor(slice)) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          border = context-&gt;resolve_cast&lt;MasstreeBorderPage&gt;(border-&gt;get_foster_minor());</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;          border = context-&gt;resolve_cast&lt;MasstreeBorderPage&gt;(border-&gt;get_foster_major());</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(border-&gt;within_fences(slice));</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keyword">const</span> <a class="code" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a> count = border-&gt;get_key_count();</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="comment">// ReserveRecords, we need a fence on BOTH sides.</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="comment">// observe key count first, then verify the keys.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      MasstreeBorderPage::FindKeyForReserveResult match = border-&gt;find_key_for_reserve(</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        0,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        count,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        slice,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        suffix,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        remainder);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordflow">if</span> (match.match_type_ == <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8f7a0dbbbc0b3684cb349f551638a19da7c834f0fdc4afb46ae9992b2a4396763">MasstreeBorderPage::kExactMatchLayerPointer</a>) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(match.index_ &lt; <a class="code" href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">kBorderPageMaxSlots</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6188e676e564b4ebecaa556178cdb81e">follow_layer</a>(context, <span class="keyword">true</span>, border, match.index_, &amp;layer_root));</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">break</span>;  <span class="comment">// next layer</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (match.match_type_ == <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8f7a0dbbbc0b3684cb349f551638a19dac61d11c33d266ee7aee52cef8d7b2b50">MasstreeBorderPage::kExactMatchLocalRecord</a>) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">// Even in this case, if the record space is too small, we must migrate it first.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">if</span> (border-&gt;get_max_payload_length(match.index_) &gt;= payload_count) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          <span class="comment">// Ok, this seems to already satisfy our need. but...</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          <span class="comment">// Up until now, all the searches/expands were physical-only.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          <span class="comment">// Now we finalize the XID in the search result so that precommit will</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          <span class="comment">// catch any change since now. This also means we need to re-check</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          <span class="comment">// the status again, and retry if pointing to next layer or moved.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(result-&gt;populate_logical(cur_xct, border, match.index_, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          <span class="keywordflow">if</span> (result-&gt;observed_.is_next_layer() || result-&gt;observed_.is_moved()) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="comment">// because the search is optimistic, we might now see a XctId with next-layer bit on.</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="comment">// in this case, we retry.</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Interesting. Next-layer-retry due to concurrent transaction&quot;</span>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;          }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="comment">// In all other cases, we (probably) need to do something complex.</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="comment">// ReserveRecords sysxct does it.</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      ReserveRecords reserve(</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        context,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        border,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        slice,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        remainder,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        suffix,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        physical_payload_hint,  <span class="comment">// let&#39;s allocate conservatively</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a950d071732ec8bd3251c03181d42692f">get_meta</a>().should_aggresively_create_next_layer(layer, remainder),</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        match.match_type_ == <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8f7a0dbbbc0b3684cb349f551638a19da6e2a8365af0c79a106cad65d93890795">MasstreeBorderPage::kNotFound</a> ? count : match.index_);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;reserve, 2U));</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="comment">// We might need to split the page</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="keywordflow">if</span> (reserve.out_split_needed_) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        SplitBorder split(</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          context,</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          border,</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;          slice,</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;          <span class="keyword">false</span>,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;          <span class="keyword">true</span>,</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;          remainder,</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          physical_payload_hint,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;          suffix);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;split, 2U));</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="comment">// In either case, we should resume the search.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a738313356f0e54e8e2d732c2017797c0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0">foedus::storage::masstree::MasstreeStoragePimpl::find_border_physical</a></div><div class="ttdeci">ErrorCode find_border_physical(thread::Thread *context, MasstreePage *layer_root, uint8_t current_layer, bool for_writes, KeySlice slice, MasstreeBorderPage **border) __attribute__((always_inline))</div><div class="ttdoc">Find a border node in the layer that corresponds to the given key slice. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00213">masstree_storage_pimpl.cpp:213</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga6280f932bf17f1d9d4acc294ca984bee"><div class="ttname"><a href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">foedus::storage::masstree::SlotIndex</a></div><div class="ttdeci">uint16_t SlotIndex</div><div class="ttdoc">Index of a record in a (border) page. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00110">masstree_id.hpp:110</a></div></div>
<div class="ttc" id="group__MASSTREE_html_gae33cf61cd45f5956aa2e46283b9474ab"><div class="ttname"><a href="group__MASSTREE.html#gae33cf61cd45f5956aa2e46283b9474ab">foedus::storage::masstree::kMaxKeyLength</a></div><div class="ttdeci">const KeyLength kMaxKeyLength</div><div class="ttdoc">Max length of a key. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00075">masstree_id.hpp:75</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_html_a8f7a0dbbbc0b3684cb349f551638a19dac61d11c33d266ee7aee52cef8d7b2b50"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8f7a0dbbbc0b3684cb349f551638a19dac61d11c33d266ee7aee52cef8d7b2b50">foedus::storage::masstree::MasstreeBorderPage::kExactMatchLocalRecord</a></div><div class="ttdef"><b>Definition:</b> <a href="masstree__page__impl_8hpp_source.html#l00587">masstree_page_impl.hpp:587</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_html_a8f7a0dbbbc0b3684cb349f551638a19da7c834f0fdc4afb46ae9992b2a4396763"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8f7a0dbbbc0b3684cb349f551638a19da7c834f0fdc4afb46ae9992b2a4396763">foedus::storage::masstree::MasstreeBorderPage::kExactMatchLayerPointer</a></div><div class="ttdef"><b>Definition:</b> <a href="masstree__page__impl_8hpp_source.html#l00588">masstree_page_impl.hpp:588</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_html_a8f7a0dbbbc0b3684cb349f551638a19da6e2a8365af0c79a106cad65d93890795"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8f7a0dbbbc0b3684cb349f551638a19da6e2a8365af0c79a106cad65d93890795">foedus::storage::masstree::MasstreeBorderPage::kNotFound</a></div><div class="ttdef"><b>Definition:</b> <a href="masstree__page__impl_8hpp_source.html#l00586">masstree_page_impl.hpp:586</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga556e8f0d5e02e78f3ddecd8f5b022bf6"><div class="ttname"><a href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">foedus::storage::masstree::KeySlice</a></div><div class="ttdeci">uint64_t KeySlice</div><div class="ttdoc">Each key slice is an 8-byte integer. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00126">masstree_id.hpp:126</a></div></div>
<div class="ttc" id="group__MASSTREE_html_gaa0c469cd4f863aa64e07fcea90b72859"><div class="ttname"><a href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">foedus::storage::masstree::KeyLength</a></div><div class="ttdeci">uint16_t KeyLength</div><div class="ttdoc">Represents a byte-length of a key in this package. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00069">masstree_id.hpp:69</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_adc32aaf6f4537fcc1ada207e1d6902ec"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">foedus::storage::masstree::MasstreeStoragePimpl::get_first_root</a></div><div class="ttdeci">ErrorCode get_first_root(thread::Thread *context, bool for_write, MasstreeIntermediatePage **root)</div><div class="ttdoc">Root-node related, such as a method to retrieve 1st-root, to grow, etc. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00058">masstree_storage_pimpl.cpp:58</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga78a96e3a0ec4256513d9d2e9c94f37fd"><div class="ttname"><a href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">foedus::storage::masstree::kBorderPageMaxSlots</a></div><div class="ttdeci">const SlotIndex kBorderPageMaxSlots</div><div class="ttdoc">Maximum number of slots in one MasstreeBorderPage. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00163">masstree_id.hpp:163</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a950d071732ec8bd3251c03181d42692f"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a950d071732ec8bd3251c03181d42692f">foedus::storage::masstree::MasstreeStoragePimpl::get_meta</a></div><div class="ttdeci">const MasstreeMetadata &amp; get_meta() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00114">masstree_storage_pimpl.hpp:114</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a6188e676e564b4ebecaa556178cdb81e"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6188e676e564b4ebecaa556178cdb81e">foedus::storage::masstree::MasstreeStoragePimpl::follow_layer</a></div><div class="ttdeci">ErrorCode follow_layer(thread::Thread *context, bool for_writes, MasstreeBorderPage *parent, SlotIndex record_index, MasstreePage **page) __attribute__((always_inline))</div><div class="ttdoc">Follows to next layer&#39;s root page. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00384">masstree_storage_pimpl.cpp:384</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaf84f9944a16c5848f69beacdfeedf939"><div class="ttname"><a href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">foedus::assorted::memory_fence_acquire</a></div><div class="ttdeci">void memory_fence_acquire()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acquire). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00046">atomic_fences.hpp:46</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="group__MASSTREE_html_gabdb6a706258be601e621e58653bf528e"><div class="ttname"><a href="group__MASSTREE.html#gabdb6a706258be601e621e58653bf528e">foedus::storage::masstree::slice_layer</a></div><div class="ttdeci">KeySlice slice_layer(const void *be_bytes, KeyLength key_length, Layer current_layer)</div><div class="ttdoc">Extract a part of a big-endian byte array of given length as KeySlice. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00279">masstree_id.hpp:279</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a52a1bce48d9230ad2ce3f52c4da51b8e_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a52a1bce48d9230ad2ce3f52c4da51b8e_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a52a1bce48d9230ad2ce3f52c4da51b8e_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a52a1bce48d9230ad2ce3f52c4da51b8e_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html#a952de8a37ed522dc611039c2fa90fa93" title="foedus::storage::masstree\l::RecordLocation::clear" alt="" coords="249,5,423,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0" title="Find a border node in the layer that corresponds to the given key slice. " alt="" coords="249,1711,423,1767"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1017,481,1224,523"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="496,2579,712,2620"/>
<area shape="rect" id="node16" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="779,1149,953,1191"/>
<area shape="rect" id="node20" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="529,1288,679,1329"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0f8830e2b301b1bdd3f2e16d9b047d79" title="foedus::storage::masstree\l::MasstreePage::within_fences" alt="" coords="504,2513,704,2555"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#aec72735812ddc62ef4290a6fadfab13c" title="This is for the case we are looking for either the matching slot or the slot we will modify..." alt="" coords="246,298,426,354"/>
<area shape="rect" id="node25" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="805,749,927,791"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a6188e676e564b4ebecaa556178cdb81e" title="Follows to next layer&#39;s root page. " alt="" coords="249,993,423,1049"/>
<area shape="rect" id="node33" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="805,939,927,980"/>
<area shape="rect" id="node34" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="261,2279,411,2320"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="249,2017,423,2073"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a27d301fad7d4d340cd2d6255dc330607" title="foedus::storage::masstree\l::MasstreePage::get_foster_major" alt="" coords="227,2344,445,2385"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a32653a16ddca213c94560652e9388dd5" title="foedus::storage::masstree\l::MasstreePage::get_foster_minor" alt="" coords="227,2409,445,2451"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9c0b897c662c4fdaaff4ac5b131da506" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_max_payload_length" alt="" coords="247,466,425,522"/>
<area shape="rect" id="node45" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a950d071732ec8bd3251c03181d42692f" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_meta" alt="" coords="249,2475,423,2531"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html#aee3fe977e78528510c5ac422cc31f534" title="Populates the result with XID and possibly readset. " alt="" coords="247,793,425,849"/>
<area shape="rect" id="node48" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="261,1843,411,1884"/>
<area shape="rect" id="node49" href="group__MASSTREE.html#gabdb6a706258be601e621e58653bf528e" title="Extract a part of a big&#45;endian byte array of given length as KeySlice. " alt="" coords="249,2556,423,2597"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a73f1aa3c62852944d653777574af1602" title="foedus::storage::masstree\l::MasstreePage::within\l_foster_minor" alt="" coords="249,2147,423,2203"/>
<area shape="rect" id="node4" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="527,1959,681,2000"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="773,1630,959,1686"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="511,1631,697,1687"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="517,1207,691,1263"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="502,2024,706,2065"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="511,1711,697,1767"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="779,2162,953,2218"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a16a2c06a304514be7b99fb6c884e7e9b" title="foedus::storage::masstree\l::MasstreePage::is_locked" alt="" coords="515,1405,693,1447"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#a541c911b49454a9baece1d658f51abf5" title="prefetch upto separators. " alt="" coords="511,1471,697,1527"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3260be02451d5017a2301854454dd203" title="prefetch upto keys/separators, whether this page is border or interior. " alt="" coords="517,1551,691,1607"/>
<area shape="rect" id="node19" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="529,1893,679,1935"/>
<area shape="rect" id="node9" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="791,1331,941,1372"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="770,2579,962,2620"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="510,546,698,602"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="493,123,715,164"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="515,189,693,245"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="498,269,710,311"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a874518901eb38e4dc3b7b69afb69e5c0" title="foedus::storage::masstree\l::MasstreeBorderPage::prefetch\l_additional_if_needed" alt="" coords="501,335,707,391"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="763,481,969,523"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="515,1026,693,1082"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="515,677,693,733"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer\l_address" alt="" coords="517,2207,691,2277"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="499,2301,709,2343"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="517,2367,691,2423"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="517,2448,691,2489"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="517,2141,691,2183"/>
<area shape="rect" id="node44" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_1_1Slot.html#a447049b6067b0d1be460802f1b6a7076" title="This might be affected by concurrent threads. " alt="" coords="513,466,695,522"/>
<area shape="rect" id="node47" href="classfoedus_1_1xct_1_1Xct.html#abc3a6688cdf5249c46613a1988b71975" title="The general logic invoked for every record read. " alt="" coords="537,909,671,951"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a52a1bce48d9230ad2ce3f52c4da51b8e_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a52a1bce48d9230ad2ce3f52c4da51b8e_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a52a1bce48d9230ad2ce3f52c4da51b8e_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a52a1bce48d9230ad2ce3f52c4da51b8e_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a86b4db183c677a364c7ddf71100699b9" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="229,5,441,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="227,71,443,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acac5f9308b4aed46777d34f6fa171c8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::reserve_record_normalized </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>payload_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>physical_payload_hint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00515">515</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00057">foedus::storage::masstree::RecordLocation::clear()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00213">find_border_physical()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l01179">foedus::storage::masstree::MasstreeBorderPage::find_key_normalized()</a>, <a class="el" href="thread_8cpp_source.html#l00075">foedus::thread::Thread::get_current_xct()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">get_first_root()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00113">foedus::storage::masstree::MasstreePage::get_foster_major()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00112">foedus::storage::masstree::MasstreePage::get_foster_minor()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00148">foedus::storage::masstree::MasstreePage::get_key_count()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00838">foedus::storage::masstree::MasstreeBorderPage::get_max_payload_length()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00139">foedus::storage::masstree::MasstreePage::has_foster_child()</a>, <a class="el" href="xct__id_8hpp_source.html#l01041">foedus::xct::XctId::is_moved()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00163">foedus::storage::masstree::kBorderPageMaxSlots</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="atomic__fences_8hpp_source.html#l00046">foedus::assorted::memory_fence_acquire()</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00048">foedus::storage::masstree::RecordLocation::observed_</a>, <a class="el" href="masstree__reserve__impl_8hpp_source.html#l00089">foedus::storage::masstree::ReserveRecords::out_split_needed_</a>, <a class="el" href="masstree__record__location_8cpp_source.html#l00027">foedus::storage::masstree::RecordLocation::populate_logical()</a>, <a class="el" href="thread_8hpp_source.html#l00110">foedus::thread::Thread::resolve_cast()</a>, <a class="el" href="thread__pimpl_8cpp_source.html#l00952">foedus::thread::Thread::run_nested_sysxct()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00126">foedus::storage::masstree::MasstreePage::within_fences()</a>, and <a class="el" href="masstree__page__impl_8hpp_source.html#l00129">foedus::storage::masstree::MasstreePage::within_foster_minor()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00283">foedus::storage::masstree::MasstreeStorage::insert_record_normalized()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00383">foedus::storage::masstree::MasstreeStorage::upsert_record_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                          {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(result);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  result-&gt;clear();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  xct::Xct* cur_xct = &amp;context-&gt;get_current_xct();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  MasstreeBorderPage* border;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  MasstreeIntermediatePage* layer_root;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">get_first_root</a>(context, <span class="keyword">true</span>, &amp;layer_root));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0">find_border_physical</a>(context, layer_root, 0, <span class="keyword">true</span>, key, &amp;border));</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {  <span class="comment">// retry loop for following foster child</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// if we found out that the page was split and we should follow foster child, do it.</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">while</span> (border-&gt;has_foster_child()) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordflow">if</span> (border-&gt;within_foster_minor(key)) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        border = context-&gt;resolve_cast&lt;MasstreeBorderPage&gt;(border-&gt;get_foster_minor());</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        border = context-&gt;resolve_cast&lt;MasstreeBorderPage&gt;(border-&gt;get_foster_major());</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(border-&gt;within_fences(key));</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// because we never go on to second layer in this case, it&#39;s either a full match or not-found</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keyword">const</span> <a class="code" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a> count = border-&gt;get_key_count();</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keyword">const</span> <a class="code" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a> index = border-&gt;find_key_normalized(0, count, key);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">if</span> (index != <a class="code" href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">kBorderPageMaxSlots</a>) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="comment">// If the record space is too small, we can&#39;t insert.</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordflow">if</span> (border-&gt;get_max_payload_length(index) &gt;= payload_count) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(result-&gt;populate_logical(cur_xct, border, index, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">if</span> (result-&gt;observed_.is_moved()) {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          <span class="comment">// because the search is optimistic, we might now see a XctId with next-layer bit on.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          <span class="comment">// in this case, we retry.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Interesting. Moved by concurrent transaction&quot;</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;          <a class="code" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">assorted::memory_fence_acquire</a>();</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">// Same as the general case.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    ReserveRecords reserve(</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      context,</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      border,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      key,</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keyword">sizeof</span>(<a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>),</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      physical_payload_hint,</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keyword">false</span>,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      index == <a class="code" href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">kBorderPageMaxSlots</a> ? count : index);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;reserve, 2U));</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">if</span> (reserve.out_split_needed_) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      SplitBorder split(</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        context,</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        border,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        key,</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keyword">false</span>,</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keyword">true</span>,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keyword">sizeof</span>(<a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>),</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        physical_payload_hint,</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(context-&gt;run_nested_sysxct(&amp;split, 2U));</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a738313356f0e54e8e2d732c2017797c0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0">foedus::storage::masstree::MasstreeStoragePimpl::find_border_physical</a></div><div class="ttdeci">ErrorCode find_border_physical(thread::Thread *context, MasstreePage *layer_root, uint8_t current_layer, bool for_writes, KeySlice slice, MasstreeBorderPage **border) __attribute__((always_inline))</div><div class="ttdoc">Find a border node in the layer that corresponds to the given key slice. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00213">masstree_storage_pimpl.cpp:213</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga6280f932bf17f1d9d4acc294ca984bee"><div class="ttname"><a href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">foedus::storage::masstree::SlotIndex</a></div><div class="ttdeci">uint16_t SlotIndex</div><div class="ttdoc">Index of a record in a (border) page. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00110">masstree_id.hpp:110</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga556e8f0d5e02e78f3ddecd8f5b022bf6"><div class="ttname"><a href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">foedus::storage::masstree::KeySlice</a></div><div class="ttdeci">uint64_t KeySlice</div><div class="ttdoc">Each key slice is an 8-byte integer. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00126">masstree_id.hpp:126</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_adc32aaf6f4537fcc1ada207e1d6902ec"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">foedus::storage::masstree::MasstreeStoragePimpl::get_first_root</a></div><div class="ttdeci">ErrorCode get_first_root(thread::Thread *context, bool for_write, MasstreeIntermediatePage **root)</div><div class="ttdoc">Root-node related, such as a method to retrieve 1st-root, to grow, etc. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00058">masstree_storage_pimpl.cpp:58</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga78a96e3a0ec4256513d9d2e9c94f37fd"><div class="ttname"><a href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">foedus::storage::masstree::kBorderPageMaxSlots</a></div><div class="ttdeci">const SlotIndex kBorderPageMaxSlots</div><div class="ttdoc">Maximum number of slots in one MasstreeBorderPage. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00163">masstree_id.hpp:163</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__ASSORTED_html_gaf84f9944a16c5848f69beacdfeedf939"><div class="ttname"><a href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939">foedus::assorted::memory_fence_acquire</a></div><div class="ttdeci">void memory_fence_acquire()</div><div class="ttdoc">Equivalent to std::atomic_thread_fence(std::memory_order_acquire). </div><div class="ttdef"><b>Definition:</b> <a href="atomic__fences_8hpp_source.html#l00046">atomic_fences.hpp:46</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_acac5f9308b4aed46777d34f6fa171c8e_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_acac5f9308b4aed46777d34f6fa171c8e_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_acac5f9308b4aed46777d34f6fa171c8e_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_acac5f9308b4aed46777d34f6fa171c8e_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html#a952de8a37ed522dc611039c2fa90fa93" title="foedus::storage::masstree\l::RecordLocation::clear" alt="" coords="260,325,433,367"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a738313356f0e54e8e2d732c2017797c0" title="Find a border node in the layer that corresponds to the given key slice. " alt="" coords="260,926,433,982"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1023,1659,1229,1700"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="504,559,720,600"/>
<area shape="rect" id="node18" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="785,1921,958,1963"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="537,624,687,665"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0f8830e2b301b1bdd3f2e16d9b047d79" title="foedus::storage::masstree\l::MasstreePage::within_fences" alt="" coords="512,689,712,731"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#ad27289df29e50bc9a55c3f3b53f876af" title="Specialized version for 8 byte native integer search. " alt="" coords="257,1611,437,1667"/>
<area shape="rect" id="node31" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="271,2111,422,2152"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="260,391,433,447"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a27d301fad7d4d340cd2d6255dc330607" title="foedus::storage::masstree\l::MasstreePage::get_foster_major" alt="" coords="237,2176,456,2217"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a32653a16ddca213c94560652e9388dd5" title="foedus::storage::masstree\l::MasstreePage::get_foster_minor" alt="" coords="237,2241,456,2283"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9c0b897c662c4fdaaff4ac5b131da506" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_max_payload_length" alt="" coords="257,1479,436,1535"/>
<area shape="rect" id="node42" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="810,2023,933,2064"/>
<area shape="rect" id="node43" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html#aee3fe977e78528510c5ac422cc31f534" title="Populates the result with XID and possibly readset. " alt="" coords="258,2030,435,2086"/>
<area shape="rect" id="node49" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="271,1388,422,1429"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a73f1aa3c62852944d653777574af1602" title="foedus::storage::masstree\l::MasstreePage::within\l_foster_minor" alt="" coords="260,682,433,738"/>
<area shape="rect" id="node4" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="535,428,689,469"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="779,1422,964,1478"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="519,806,705,862"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="525,966,699,1022"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="510,493,714,535"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="519,886,705,942"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="785,715,958,771"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a16a2c06a304514be7b99fb6c884e7e9b" title="foedus::storage::masstree\l::MasstreePage::is_locked" alt="" coords="523,1047,701,1088"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#a541c911b49454a9baece1d658f51abf5" title="prefetch upto separators. " alt="" coords="519,1113,705,1169"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3260be02451d5017a2301854454dd203" title="prefetch upto keys/separators, whether this page is border or interior. " alt="" coords="525,1193,699,1249"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="537,1375,687,1416"/>
<area shape="rect" id="node9" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="796,432,947,473"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="784,973,959,1015"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="775,559,967,600"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1PageVersion.html#a301cba19b01cf82d7b576a04180b56e2" title="foedus::storage::PageVersion\l::is_locked" alt="" coords="775,1047,967,1088"/>
<area shape="rect" id="node20" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="785,1200,957,1241"/>
<area shape="rect" id="node24" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="779,624,963,665"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="523,1651,701,1707"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="506,1732,718,1773"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a874518901eb38e4dc3b7b69afb69e5c0" title="foedus::storage::masstree\l::MasstreeBorderPage::prefetch\l_additional_if_needed" alt="" coords="509,1571,715,1627"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="768,1659,975,1700"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer\l_address" alt="" coords="525,136,699,207"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="507,231,717,272"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="525,297,699,353"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="525,5,699,47"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="525,71,699,112"/>
<area shape="rect" id="node41" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_1_1Slot.html#a447049b6067b0d1be460802f1b6a7076" title="This might be affected by concurrent threads. " alt="" coords="521,1491,703,1547"/>
<area shape="rect" id="node44" href="classfoedus_1_1xct_1_1Xct.html#abc3a6688cdf5249c46613a1988b71975" title="The general logic invoked for every record read. " alt="" coords="545,2081,679,2123"/>
<area shape="rect" id="node45" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="810,2115,933,2156"/>
<area shape="rect" id="node46" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="810,2205,933,2247"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="523,1849,701,1905"/>
<area shape="rect" id="node48" href="structfoedus_1_1xct_1_1XctId.html#a449da7fea452dd81c194f94b28e7a7e2" title="foedus::xct::XctId\l::is_valid" alt="" coords="551,2199,673,2240"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_acac5f9308b4aed46777d34f6fa171c8e_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_acac5f9308b4aed46777d34f6fa171c8e_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_acac5f9308b4aed46777d34f6fa171c8e_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_acac5f9308b4aed46777d34f6fa171c8e_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a6d7f9dea9af7356face9815ac10c37b4" title="With this method, you can also specify physical_payload_hint. " alt="" coords="237,5,411,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="237,85,411,141"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8e24325e4b203cb3e2008283c6ef0c89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::retrieve_general </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> *&#160;</td>
          <td class="paramname"><em>payload_capacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of get_record family. </p>
<p>use with <a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a91dac48625f8f7d2906fcfba5908cbc1" title="Identifies page and record for the key. ">locate_record()</a> </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00599">599</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00589">check_next_layer_bit()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00832">foedus::storage::masstree::MasstreeBorderPage::get_payload_length()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00740">foedus::storage::masstree::MasstreeBorderPage::get_record_payload()</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00043">foedus::storage::masstree::RecordLocation::index_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="error__code_8hpp_source.html#l00175">foedus::kErrorCodeStrTooSmallPayloadBuffer</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00048">foedus::storage::masstree::RecordLocation::observed_</a>, and <a class="el" href="masstree__record__location_8hpp_source.html#l00041">foedus::storage::masstree::RecordLocation::page_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00079">foedus::storage::masstree::MasstreeStorage::get_record()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00169">foedus::storage::masstree::MasstreeStorage::get_record_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                   {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">if</span> (location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">// This result is protected by readset</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">check_next_layer_bit</a>(location.observed_));</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// here, we do NOT have to do another optimistic-read protocol because we already took</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">// the owner_id into read-set. If this read is corrupted, we will be aware of it at commit time.</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  MasstreeBorderPage* border = location.page_;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <a class="code" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a> payload_length = border-&gt;get_payload_length(location.index_);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">if</span> (payload_length &gt; *payload_capacity) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">// buffer too small</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    DVLOG(0) &lt;&lt; <span class="stringliteral">&quot;buffer too small??&quot;</span> &lt;&lt; payload_length &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; *payload_capacity;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    *payload_capacity = payload_length;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae0409810fc5028d8885fe6025cb6fdbe">kErrorCodeStrTooSmallPayloadBuffer</a>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  *payload_capacity = payload_length;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  std::memcpy(payload, border-&gt;get_record_payload(location.index_), payload_length);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;}</div>
<div class="ttc" id="group__MASSTREE_html_ga9d05e904033c0bba7113cdafb43d6610"><div class="ttname"><a href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">foedus::storage::masstree::PayloadLength</a></div><div class="ttdeci">uint16_t PayloadLength</div><div class="ttdoc">Represents a byte-length of a payload in this package. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00092">masstree_id.hpp:92</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56ae0409810fc5028d8885fe6025cb6fdbe"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56ae0409810fc5028d8885fe6025cb6fdbe">foedus::kErrorCodeStrTooSmallPayloadBuffer</a></div><div class="ttdoc">0x0809 : "STORAGE: The record&#39;s payload is larger than the buffer" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00175">error_code.hpp:175</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">foedus::storage::masstree::MasstreeStoragePimpl::check_next_layer_bit</a></div><div class="ttdeci">static ErrorCode check_next_layer_bit(xct::XctId observed) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00589">masstree_storage_pimpl.cpp:589</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8e24325e4b203cb3e2008283c6ef0c89_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8e24325e4b203cb3e2008283c6ef0c89_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8e24325e4b203cb3e2008283c6ef0c89_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8e24325e4b203cb3e2008283c6ef0c89_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::check_next_layer_bit" alt="" coords="229,5,403,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a634aa97d761122a7d7cd4cb7889d844f" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_payload_length" alt="" coords="475,73,653,129"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="227,145,405,201"/>
<area shape="rect" id="node16" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="255,226,377,267"/>
<area shape="rect" id="node3" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="503,7,625,49"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="949,110,1156,151"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1204,110,1411,151"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="453,154,675,195"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="475,263,653,319"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="723,103,901,159"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="723,183,901,239"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="725,343,899,399"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="723,263,901,319"/>
<area shape="rect" id="node13" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="973,328,1133,355"/>
<area shape="rect" id="node14" href="namespacefoedus_1_1storage_1_1masstree.html#a575ba44804b98a334fc66eedf4b18d70" title="foedus::storage::masstree\l::calculate_suffix_length" alt="" coords="966,379,1139,421"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8e24325e4b203cb3e2008283c6ef0c89_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8e24325e4b203cb3e2008283c6ef0c89_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8e24325e4b203cb3e2008283c6ef0c89_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a8e24325e4b203cb3e2008283c6ef0c89_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#acdf38eea62d1432e3715a661d0790caf" title="Retrieves an entire record of the given key in this Masstree. " alt="" coords="448,13,647,54"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a4f2492b6a04c2db18cdf2a4a2d7fecc0" title="Retrieves an entire record of the given primitive key in this Masstree. " alt="" coords="227,37,400,93"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae301e3aa587aa907eed1f6ae1ec5edb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::retrieve_part_general </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>payload_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>payload_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00625">625</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00589">check_next_layer_bit()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00832">foedus::storage::masstree::MasstreeBorderPage::get_payload_length()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00740">foedus::storage::masstree::MasstreeBorderPage::get_record_payload()</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00043">foedus::storage::masstree::RecordLocation::index_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="error__code_8hpp_source.html#l00087">foedus::kErrorCodeOk</a>, <a class="el" href="error__code_8hpp_source.html#l00178">foedus::kErrorCodeStrKeyNotFound</a>, <a class="el" href="error__code_8hpp_source.html#l00176">foedus::kErrorCodeStrTooShortPayload</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00048">foedus::storage::masstree::RecordLocation::observed_</a>, and <a class="el" href="masstree__record__location_8hpp_source.html#l00041">foedus::storage::masstree::RecordLocation::page_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00107">foedus::storage::masstree::MasstreeStorage::get_record_part()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00189">foedus::storage::masstree::MasstreeStorage::get_record_part_normalized()</a>, <a class="el" href="masstree__storage_8cpp_source.html#l00139">foedus::storage::masstree::MasstreeStorage::get_record_primitive()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00212">foedus::storage::masstree::MasstreeStorage::get_record_primitive_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordflow">if</span> (location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">// This result is protected by readset</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">kErrorCodeStrKeyNotFound</a>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">check_next_layer_bit</a>(location.observed_));</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  MasstreeBorderPage* border = location.page_;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keywordflow">if</span> (border-&gt;get_payload_length(location.index_) &lt; payload_offset + payload_count) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    LOG(WARNING) &lt;&lt; <span class="stringliteral">&quot;short record&quot;</span>;  <span class="comment">// probably this is a rare error. so warn.</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">kErrorCodeStrTooShortPayload</a>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  std::memcpy(payload, border-&gt;get_record_payload(location.index_) + payload_offset, payload_count);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">kErrorCodeOk</a>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a947e657c9c51f0108e55d6792089345a">foedus::kErrorCodeStrTooShortPayload</a></div><div class="ttdoc">0x080A : "STORAGE: The record&#39;s payload is smaller than requested" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00176">error_code.hpp:176</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56afcf2a3fbf0d4de0b82d6754532a73381">foedus::kErrorCodeStrKeyNotFound</a></div><div class="ttdoc">0x080C : "STORAGE: This key is not found in this storage" . </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00178">error_code.hpp:178</a></div></div>
<div class="ttc" id="namespacefoedus_html_gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9"><div class="ttname"><a href="namespacefoedus.html#gaae5f98d1b4caace7febc49e59ae5ac56a6fe6714ceb6dbd09ad6f627d11b775c9">foedus::kErrorCodeOk</a></div><div class="ttdoc">0 means no-error. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00087">error_code.hpp:87</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">foedus::storage::masstree::MasstreeStoragePimpl::check_next_layer_bit</a></div><div class="ttdeci">static ErrorCode check_next_layer_bit(xct::XctId observed) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00589">masstree_storage_pimpl.cpp:589</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ae301e3aa587aa907eed1f6ae1ec5edb0_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ae301e3aa587aa907eed1f6ae1ec5edb0_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ae301e3aa587aa907eed1f6ae1ec5edb0_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ae301e3aa587aa907eed1f6ae1ec5edb0_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::check_next_layer_bit" alt="" coords="229,5,403,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a634aa97d761122a7d7cd4cb7889d844f" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_payload_length" alt="" coords="475,73,653,129"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="227,145,405,201"/>
<area shape="rect" id="node16" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="255,226,377,267"/>
<area shape="rect" id="node3" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="503,7,625,49"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="949,110,1156,151"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1204,110,1411,151"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="453,154,675,195"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="475,263,653,319"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="723,103,901,159"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="723,183,901,239"/>
<area shape="rect" id="node12" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="725,343,899,399"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="723,263,901,319"/>
<area shape="rect" id="node13" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="973,328,1133,355"/>
<area shape="rect" id="node14" href="namespacefoedus_1_1storage_1_1masstree.html#a575ba44804b98a334fc66eedf4b18d70" title="foedus::storage::masstree\l::calculate_suffix_length" alt="" coords="966,379,1139,421"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ae301e3aa587aa907eed1f6ae1ec5edb0_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ae301e3aa587aa907eed1f6ae1ec5edb0_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ae301e3aa587aa907eed1f6ae1ec5edb0_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_ae301e3aa587aa907eed1f6ae1ec5edb0_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a01a2996a1ee370611b72c88f33fe2753" title="Retrieves a part of the given key in this Masstree. " alt="" coords="464,5,637,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#adda60c43db1237644270e90f2a255d35" title="Retrieves a part of the given primitive key in this Masstree. " alt="" coords="235,37,408,93"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a3be736c76c38dd23444cbd78947a63fd" title="Retrieves a part of the given key in this Masstree as a primitive value. " alt="" coords="235,117,408,173"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#ae4bf2da94babc15bf43bd50b17ffb562" title="Retrieves a part of the given primitive key in this Masstree as a primitive value. " alt="" coords="227,197,416,253"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aff57df4d2b237e63e459d5fefe9d4cfb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfoedus_1_1xct_1_1TrackMovedRecordResult.html">xct::TrackMovedRecordResult</a> foedus::storage::masstree::MasstreeStoragePimpl::track_moved_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1xct_1_1RwLockableXctId.html">xct::RwLockableXctId</a> *&#160;</td>
          <td class="paramname"><em>old_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1xct_1_1WriteXctAccess.html">xct::WriteXctAccess</a> *&#160;</td>
          <td class="paramname"><em>write_set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00848">848</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="attachable_8hpp_source.html#l00107">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00084">foedus::storage::masstree::MasstreePage::is_border()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00169">foedus::storage::masstree::MasstreePage::is_moved()</a>, <a class="el" href="xct__id_8hpp_source.html#l01143">foedus::xct::RwLockableXctId::is_next_layer()</a>, <a class="el" href="page_8hpp_source.html#l00395">foedus::storage::to_page()</a>, and <a class="el" href="masstree__page__impl_8cpp_source.html#l00534">foedus::storage::masstree::MasstreeBorderPage::track_moved_record()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00842">foedus::storage::masstree::MasstreeStorage::track_moved_record()</a>.</p>
<div class="fragment"><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                                {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(old_address);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// We use moved bit only for volatile border pages</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  MasstreeBorderPage* page = <span class="keyword">reinterpret_cast&lt;</span>MasstreeBorderPage*<span class="keyword">&gt;</span>(<a class="code" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25">to_page</a>(old_address));</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;is_border());</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(page-&gt;is_moved() || old_address-&gt;is_next_layer());</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordflow">return</span> page-&gt;track_moved_record(<a class="code" href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">engine_</a>, old_address, write_set);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;}</div>
<div class="ttc" id="group__STORAGE_html_gaa114fc1859c2d4cb8b9e2021cb11cb25"><div class="ttname"><a href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25">foedus::storage::to_page</a></div><div class="ttdeci">Page * to_page(const void *address)</div><div class="ttdoc">super-dirty way to obtain Page the address belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00395">page.hpp:395</a></div></div>
<div class="ttc" id="classfoedus_1_1Attachable_html_a5f84f871a1d36f9ee990f3175661cd99"><div class="ttname"><a href="classfoedus_1_1Attachable.html#a5f84f871a1d36f9ee990f3175661cd99">foedus::Attachable&lt; MasstreeStorageControlBlock &gt;::engine_</a></div><div class="ttdeci">Engine * engine_</div><div class="ttdoc">Most attachable object stores an engine pointer (local engine), so we define it here. </div><div class="ttdef"><b>Definition:</b> <a href="attachable_8hpp_source.html#l00107">attachable.hpp:107</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff57df4d2b237e63e459d5fefe9d4cfb_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff57df4d2b237e63e459d5fefe9d4cfb_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff57df4d2b237e63e459d5fefe9d4cfb_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff57df4d2b237e63e459d5fefe9d4cfb_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="746,1809,921,1851"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#adc22d21883e15b87cd5ff6b6ec513c35" title="foedus::storage::masstree\l::MasstreePage::is_moved" alt="" coords="484,5,660,47"/>
<area shape="rect" id="node7" href="structfoedus_1_1xct_1_1RwLockableXctId.html#ac49bd73652693a170f3755c1daf96736" title="foedus::xct::RwLockableXct\lId::is_next_layer" alt="" coords="481,123,663,164"/>
<area shape="rect" id="node9" href="group__STORAGE.html#gaa114fc1859c2d4cb8b9e2021cb11cb25" title="super&#45;dirty way to obtain Page the address belongs to. " alt="" coords="239,1935,404,1962"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#ab905ff02e9f747f00d44e72ffc16f546" title="foedus::storage::masstree\l::MasstreeBorderPage::track\l_moved_record" alt="" coords="227,466,416,522"/>
<area shape="rect" id="node3" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1262,1743,1453,1784"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="737,123,929,164"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="997,123,1189,164"/>
<area shape="rect" id="node8" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="1296,579,1419,620"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="999,571,1187,627"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1743,779,1949,820"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1997,779,2204,820"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a6883c1c1e9ef2fb0e6a40d7863f2d85b" title="Navigates a searching key&#45;slice to one of the record in this page. " alt="" coords="729,356,937,397"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="1247,947,1468,988"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="987,268,1199,309"/>
<area shape="rect" id="node22" href="classfoedus_1_1memory_1_1EngineMemory.html#a62b2d4de6a72644e9e31d35a7f9beae0" title="Returns the page resolver to convert volatile page ID to page pointer. " alt="" coords="728,1729,939,1785"/>
<area shape="rect" id="node23" href="classfoedus_1_1Engine.html#a02ed05009c7baa8d75e04f202a86b2c6" title="See Memory Manager. " alt="" coords="766,473,901,515"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="464,188,680,229"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="747,539,920,580"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a7a9d09469e106d14513932f3aebeef97" title="foedus::storage::masstree\l::MasstreePage::is_foster\l_major_null" alt="" coords="485,1663,659,1719"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a698b417f5e89daf68ebd78044222bb23" title="foedus::storage::masstree\l::MasstreePage::is_foster\l_minor_null" alt="" coords="485,1583,659,1639"/>
<area shape="rect" id="node30" href="structfoedus_1_1xct_1_1RwLockableXctId.html#a03782134d5ef0ebb8e187ddbd89f3c36" title="foedus::xct::RwLockableXct\lId::is_moved" alt="" coords="481,305,663,347"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14aa45c7514f2a2d83dc7a138c24ecd0" title="foedus::storage::masstree\l::MasstreeBorderPage::to\l_slot_index" alt="" coords="747,605,920,661"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a1429b13cd5efb94c7b4735bf84087818" title="This one further tracks it to next layer. " alt="" coords="477,1027,667,1083"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="1516,514,1695,570"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a874518901eb38e4dc3b7b69afb69e5c0" title="foedus::storage::masstree\l::MasstreeBorderPage::prefetch\l_additional_if_needed" alt="" coords="989,465,1196,521"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="1516,855,1695,911"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="1516,939,1695,995"/>
<area shape="rect" id="node21" href="group__ASSORTED.html#ga14adcd2a780f37023df88933f17a5a83" title="Prefetch multiple contiguous cachelines to L1 cache. " alt="" coords="1271,472,1443,513"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="753,1663,914,1704"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1277,1633,1438,1675"/>
<area shape="rect" id="node31" href="structfoedus_1_1xct_1_1XctId.html#a41264f4ced33dae443651f57bc09e964" title="foedus::xct::XctId\l::is_moved" alt="" coords="772,291,895,332"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#ad5ffa0667ef80499cbffb041dbb57b5f" title="Navigates a searching key&#45;slice to one of the mini pages in this page. " alt="" coords="1753,1519,1939,1575"/>
<area shape="rect" id="node35" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage_1_1MiniPage.html#ad8666438d88f0d1c34b8c22d53b20441" title="Navigates a searching key&#45;slice to one of pointers in this mini&#45;page. " alt="" coords="741,954,926,1010"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="746,1035,921,1076"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="731,1100,935,1141"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="741,1166,926,1222"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="744,1246,923,1302"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="1516,771,1695,827"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="1006,1379,1179,1435"/>
<area shape="rect" id="node43" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="732,1327,935,1368"/>
<area shape="rect" id="node48" href="group__MASSTREE.html#gabfe21e7cd7f1a689891743d93c6996c8" title="Extract a part of a big&#45;endian byte array of given length as KeySlice. " alt="" coords="747,837,920,879"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0f8830e2b301b1bdd3f2e16d9b047d79" title="foedus::storage::masstree\l::MasstreePage::within_fences" alt="" coords="733,1444,933,1485"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="1003,1053,1182,1109"/>
<area shape="rect" id="node44" href="namespacefoedus_1_1storage.html#a9220f4aff16817a668990bd85f2f527d" title="foedus::storage::assert\l_valid_volatile_page" alt="" coords="1015,1612,1170,1653"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1283,1495,1432,1536"/>
<area shape="rect" id="node46" href="namespacefoedus_1_1storage.html#a67e1af2de6e13b000e66609cf60849b6" title="foedus::storage::construct\l_volatile_page_pointer" alt="" coords="1006,1263,1179,1304"/>
<area shape="rect" id="node47" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a63ab3e809b38145565cef7791f211a35" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="991,1182,1194,1238"/>
<area shape="rect" id="node49" href="group__MASSTREE.html#gaa6842bc28437a9d4319e51471f4e3237" title="Convert a big&#45;endian byte array of given length to KeySlice. " alt="" coords="991,888,1194,929"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff57df4d2b237e63e459d5fefe9d4cfb_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff57df4d2b237e63e459d5fefe9d4cfb_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff57df4d2b237e63e459d5fefe9d4cfb_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aff57df4d2b237e63e459d5fefe9d4cfb_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a2370f71beab1eb4b8b02e3ac9e4f29bd" title="Resolves a &quot;moved&quot; record. " alt="" coords="227,31,400,87"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1StorageManagerPimpl.html#a3248d8440d805f772ad7b6122a4d309b" title="foedus::storage::Storage\lManagerPimpl::track_moved\l_record" alt="" coords="448,31,635,87"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1StorageManager.html#a02513539acf9d7cd9805d34154281076" title="Resolves a &quot;moved&quot; record. " alt="" coords="683,39,879,80"/>
<area shape="rect" id="node5" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a9090dd1fa81513f61620b44a9a8bbd1d" title="used from verification methods to track moved record " alt="" coords="927,39,1147,80"/>
<area shape="rect" id="node6" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a2c3befa16f448a004d548a2b4675a13b" title="Phase 2 of precommit_xct() for read&#45;only case. " alt="" coords="1196,5,1404,47"/>
<area shape="rect" id="node10" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a9534e63f498a012d9fa401a10e2b4e0b" title="Phase 2 of precommit_xct() for read&#45;write case. " alt="" coords="1195,71,1405,112"/>
<area shape="rect" id="node7" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#add42c2f0d559eafa1f67fd9c048a4855" title="precommit_xct() if the transaction is read&#45;only " alt="" coords="1453,5,1648,47"/>
<area shape="rect" id="node8" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a014506b605e14b3df1b1b7522e8a23b2" title="This is the gut of commit protocol. " alt="" coords="1696,39,1891,80"/>
<area shape="rect" id="node9" href="classfoedus_1_1xct_1_1XctManager.html#a486c653445cb64cc9514af3f1031bdf0" title="Prepares the currently running transaction on the thread for commit. " alt="" coords="1939,39,2101,80"/>
<area shape="rect" id="node11" href="classfoedus_1_1xct_1_1XctManagerPimpl.html#a777caaecec0e7bb19b1cd2841771f755" title="precommit_xct() if the transaction is read&#45;write " alt="" coords="1453,71,1648,112"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeeccc272d2f9a4d895f4d117f6b96b27"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ERRORCODES.html#gaae5f98d1b4caace7febc49e59ae5ac56">ErrorCode</a> foedus::storage::masstree::MasstreeStoragePimpl::upsert_general </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfoedus_1_1storage_1_1masstree_1_1RecordLocation.html">RecordLocation</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>be_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a>&#160;</td>
          <td class="paramname"><em>key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga9d05e904033c0bba7113cdafb43d6610">PayloadLength</a>&#160;</td>
          <td class="paramname"><em>payload_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of upsert_record family. </p>
<p>use with <b><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a52a1bce48d9230ad2ce3f52c4da51b8e" title="Like locate_record(), this is also a logical operation. ">reserve_record()</a></b> </p>

<p>Definition at line <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00711">711</a> of file <a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a>.</p>

<p>References <a class="el" href="assert__nd_8hpp_source.html#l00072">ASSERT_ND</a>, <a class="el" href="masstree__log__types_8hpp_source.html#l00098">foedus::storage::masstree::MasstreeCommonLogType::calculate_log_length()</a>, <a class="el" href="error__code_8hpp_source.html#l00155">CHECK_ERROR_CODE</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00589">check_next_layer_bit()</a>, <a class="el" href="masstree__storage__pimpl_8hpp_source.html#l00112">get_id()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00838">foedus::storage::masstree::MasstreeBorderPage::get_max_payload_length()</a>, <a class="el" href="thread_8hpp_source.html#l00066">foedus::thread::Thread::get_numa_node()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00832">foedus::storage::masstree::MasstreeBorderPage::get_payload_length()</a>, <a class="el" href="thread_8cpp_source.html#l00078">foedus::thread::Thread::get_thread_log_buffer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00073">foedus::storage::masstree::MasstreePage::header()</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00043">foedus::storage::masstree::RecordLocation::index_</a>, <a class="el" href="xct__id_8hpp_source.html#l01040">foedus::xct::XctId::is_deleted()</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00048">foedus::storage::masstree::RecordLocation::observed_</a>, <a class="el" href="masstree__record__location_8hpp_source.html#l00041">foedus::storage::masstree::RecordLocation::page_</a>, <a class="el" href="masstree__log__types_8hpp_source.html#l00311">foedus::storage::masstree::MasstreeInsertLogType::populate()</a>, <a class="el" href="masstree__log__types_8hpp_source.html#l00394">foedus::storage::masstree::MasstreeUpdateLogType::populate()</a>, <a class="el" href="masstree__log__types_8hpp_source.html#l00436">foedus::storage::masstree::MasstreeOverwriteLogType::populate()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00645">register_record_write_log()</a>, <a class="el" href="thread__log__buffer_8hpp_source.html#l00320">foedus::log::ThreadLogBuffer::reserve_new_log()</a>, and <a class="el" href="page_8hpp_source.html#l00251">foedus::storage::PageHeader::stat_last_updater_node_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00347">foedus::storage::masstree::MasstreeStorage::upsert_record()</a>, and <a class="el" href="masstree__storage_8cpp_source.html#l00383">foedus::storage::masstree::MasstreeStorage::upsert_record_normalized()</a>.</p>
<div class="fragment"><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="comment">// Upsert is a combination of what insert does and what delete does.</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="comment">// If there isn&#39;t an existing physical record, it&#39;s exactly same as insert.</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">// If there is, it&#39;s _basically_ a delete followed by an insert.</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="comment">// There are a few complications, depending on the status of the record.</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <a class="code" href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">check_next_layer_bit</a>(location.observed_));</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">// as of reserve_record() it was spacious enough, and this length is</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">// either immutable or only increases, so this must hold.</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  MasstreeBorderPage* border = location.page_;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <a class="code" href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a>(border-&gt;get_max_payload_length(location.index_) &gt;= payload_count);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  MasstreeCommonLogType* common_log;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">if</span> (location.observed_.is_deleted()) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// If it&#39;s a deleted record, this turns to be a plain insert.</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3">MasstreeInsertLogType::calculate_log_length</a>(key_length, payload_count);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    MasstreeInsertLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>MasstreeInsertLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    log_entry-&gt;populate(</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>(),</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      be_key,</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      key_length,</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      payload,</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      payload_count);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    common_log = log_entry;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (payload_count == border-&gt;get_payload_length(location.index_)) {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">// If it&#39;s not changing payload size of existing record, we can conver it to an overwrite,</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">// which is more efficient</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3">MasstreeOverwriteLogType::calculate_log_length</a>(key_length, payload_count);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    MasstreeOverwriteLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>MasstreeOverwriteLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    log_entry-&gt;populate(</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>(),</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      be_key,</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      key_length,</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      payload,</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      0,</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      payload_count);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    common_log = log_entry;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">// If not, this is an update operation.</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    uint16_t log_length = <a class="code" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3">MasstreeUpdateLogType::calculate_log_length</a>(key_length, payload_count);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    MasstreeUpdateLogType* log_entry = <span class="keyword">reinterpret_cast&lt;</span>MasstreeUpdateLogType*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      context-&gt;get_thread_log_buffer().reserve_new_log(log_length));</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    log_entry-&gt;populate(</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">get_id</a>(),</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      be_key,</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      key_length,</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      payload,</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      payload_count);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    common_log = log_entry;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  border-&gt;header().stat_last_updater_node_ = context-&gt;get_numa_node();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">register_record_write_log</a>(context, location, common_log);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;}</div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a3036d6662c0bd89e330ca19cbca1f549"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549">foedus::storage::masstree::MasstreeStoragePimpl::register_record_write_log</a></div><div class="ttdeci">ErrorCode register_record_write_log(thread::Thread *context, const RecordLocation &amp;location, log::RecordLogType *log_entry)</div><div class="ttdoc">Used in the following methods. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00645">masstree_storage_pimpl.cpp:645</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aca6d912133fd8b46eacb660b840bada0"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0">foedus::storage::masstree::MasstreeStoragePimpl::get_id</a></div><div class="ttdeci">StorageId get_id() const </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8hpp_source.html#l00112">masstree_storage_pimpl.hpp:112</a></div></div>
<div class="ttc" id="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType_html_aaa0d49b768842255f27147327cc72ef3"><div class="ttname"><a href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3">foedus::storage::masstree::MasstreeCommonLogType::calculate_log_length</a></div><div class="ttdeci">static uint16_t calculate_log_length(KeyLength key_length, PayloadLength payload_count) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__log__types_8hpp_source.html#l00098">masstree_log_types.hpp:98</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_gaa3832e1d1faf1540161d389edf2a9c17"><div class="ttname"><a href="group__ERRORCODES.html#gaa3832e1d1faf1540161d389edf2a9c17">CHECK_ERROR_CODE</a></div><div class="ttdeci">#define CHECK_ERROR_CODE(x)</div><div class="ttdoc">This macro calls x and checks its returned error code. </div><div class="ttdef"><b>Definition:</b> <a href="error__code_8hpp_source.html#l00155">error_code.hpp:155</a></div></div>
<div class="ttc" id="group__IDIOMS_html_gaa5c1d074da423c0f330d1bc8a098ecb8"><div class="ttname"><a href="group__IDIOMS.html#gaa5c1d074da423c0f330d1bc8a098ecb8">ASSERT_ND</a></div><div class="ttdeci">#define ASSERT_ND(x)</div><div class="ttdoc">A warning-free wrapper macro of assert() that has no performance effect in release mode even when &#39;x&#39;...</div><div class="ttdef"><b>Definition:</b> <a href="assert__nd_8hpp_source.html#l00072">assert_nd.hpp:72</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1">foedus::storage::masstree::MasstreeStoragePimpl::check_next_layer_bit</a></div><div class="ttdeci">static ErrorCode check_next_layer_bit(xct::XctId observed) __attribute__((always_inline))</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00589">masstree_storage_pimpl.cpp:589</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aeeccc272d2f9a4d895f4d117f6b96b27_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aeeccc272d2f9a4d895f4d117f6b96b27_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aeeccc272d2f9a4d895f4d117f6b96b27_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aeeccc272d2f9a4d895f4d117f6b96b27_cgraph">
<area shape="rect" id="node2" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeCommonLogType.html#aaa0d49b768842255f27147327cc72ef3" title="foedus::storage::masstree\l::MasstreeCommonLogType\l::calculate_log_length" alt="" coords="977,64,1161,120"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#ad6f2a3dd83d57c3e7ffb7f1dbfcbdfc1" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::check_next_layer_bit" alt="" coords="233,5,407,61"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="485,481,659,537"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9c0b897c662c4fdaaff4ac5b131da506" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_max_payload_length" alt="" coords="231,136,409,192"/>
<area shape="rect" id="node13" href="classfoedus_1_1thread_1_1Thread.html#aa07f33f2b78aa6e6c66a2149b1db52e8" title="foedus::thread::Thread\l::get_numa_node" alt="" coords="245,217,395,258"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a634aa97d761122a7d7cd4cb7889d844f" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_payload_length" alt="" coords="483,400,661,456"/>
<area shape="rect" id="node17" href="classfoedus_1_1thread_1_1Thread.html#a9a5d37d6dac9966989e23381f600fcee" title="Returns the private log buffer for this thread. " alt="" coords="243,385,397,426"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="233,450,407,491"/>
<area shape="rect" id="node19" href="structfoedus_1_1xct_1_1XctId.html#a6008b5f8531e6ee524d60cf86bc20148" title="foedus::xct::XctId\l::is_deleted" alt="" coords="259,515,381,557"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeInsertLogType.html#a4ea983f4436e0519b7d2aaa7f1ef67a0" title="foedus::storage::masstree\l::MasstreeInsertLogType\l::populate" alt="" coords="233,581,407,637"/>
<area shape="rect" id="node21" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeUpdateLogType.html#a1a980469e419ba477da51dd4c3c01b47" title="foedus::storage::masstree\l::MasstreeUpdateLogType\l::populate" alt="" coords="233,661,407,717"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeOverwriteLogType.html#ad59889a05bfad73c47891ee9be60d7f2" title="foedus::storage::masstree\l::MasstreeOverwriteLogType\l::populate" alt="" coords="227,741,413,797"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a3036d6662c0bd89e330ca19cbca1f549" title="Used in the following methods. " alt="" coords="233,821,407,877"/>
<area shape="rect" id="node39" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9a8c4e8f3a994272f52ddddb312f15b9" title="Reserves a space for a new (uncommitted) log entry at the tail. " alt="" coords="227,1115,413,1157"/>
<area shape="rect" id="node3" href="group__ASSORTED.html#ga34d731a5b871bbd8a43b748808e9ce52" title="8&#45;alignment. " alt="" coords="1243,119,1403,145"/>
<area shape="rect" id="node5" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="511,13,633,54"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_1_1Slot.html#a447049b6067b0d1be460802f1b6a7076" title="This might be affected by concurrent threads. " alt="" coords="481,136,663,192"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="965,449,1172,490"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_1_1Slot.html#adecf558d81c86d2c96a701b6305a68b0" title="foedus::storage::masstree\l::MasstreeBorderPage::Slot\l::get_aligned_suffix_length" alt="" coords="733,136,915,192"/>
<area shape="rect" id="node10" href="namespacefoedus_1_1storage_1_1masstree.html#a907f46e4f7d427806529dd8e2e03dd9c" title="foedus::storage::masstree\l::calculate_suffix_length\l_aligned" alt="" coords="982,144,1155,200"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1220,449,1427,490"/>
<area shape="rect" id="node14" href="group__THREAD.html#ga1622c6d8c64ca80f51c1bef5190ec4fa" title="Extracts NUMA node ID from the given globally unique ID of Thread (core). " alt="" coords="483,267,661,309"/>
<area shape="rect" id="node15" href="classfoedus_1_1thread_1_1Thread.html#af98ed86adde3f5e39c9cab39440f38da" title="foedus::thread::Thread\l::get_thread_id" alt="" coords="497,333,647,374"/>
<area shape="rect" id="node24" href="classfoedus_1_1xct_1_1Xct.html#aa23025809d9c2fdff744f98f78c3882a" title="Registers a write&#45;set related to an existing read&#45;set. " alt="" coords="501,762,643,803"/>
<area shape="rect" id="node27" href="classfoedus_1_1xct_1_1Xct.html#a7dad4e0e5a6770ee941bd365410f9b6a" title="Add the given record to the write set of this transaction. " alt="" coords="753,821,895,862"/>
<area shape="rect" id="node34" href="classfoedus_1_1thread_1_1Thread.html#ac48c54832becbaa9141926af14705ba3" title="Returns the transaction that is currently running on this thread. " alt="" coords="497,827,647,869"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="735,653,913,709"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="461,566,683,607"/>
<area shape="rect" id="node25" href="group__LOGTYPE.html#gad2d33090f44d00949a05c245e5ff1046" title="Invokes the assertion logic of each log type. " alt="" coords="1004,747,1133,789"/>
<area shape="rect" id="node26" href="structfoedus_1_1log_1_1LogHeader.html#a6ebe3b99442f2a58a4adeeb60f9a37e0" title="Convenience method to cast into LogCode. " alt="" coords="1246,747,1401,789"/>
<area shape="rect" id="node28" href="classfoedus_1_1xct_1_1RetrospectiveLockList.html#a1ff8ccbccdede750fb5a18b4da505ad9" title="foedus::xct::Retrospective\lLockList::get_volatile\l_page_resolver" alt="" coords="983,813,1155,869"/>
<area shape="rect" id="node29" href="namespacefoedus_1_1storage.html#a263602e0a73eedbe5f32128635106e17" title="foedus::storage::assert\l_within_valid_volatile_page" alt="" coords="981,894,1156,935"/>
<area shape="rect" id="node31" href="structfoedus_1_1xct_1_1RecordXctAccess.html#ace820ba89437e4d3a59fdb47a47525ba" title="Calculate owner_lock_id using the resolver. " alt="" coords="968,963,1169,1005"/>
<area shape="rect" id="node30" href="namespacefoedus_1_1storage.html#ad38ebb5eb992249a7b42001fe464ec48" title="foedus::storage::assert\l_within_valid_volatile\l_page_impl" alt="" coords="1246,883,1401,939"/>
<area shape="rect" id="node32" href="namespacefoedus_1_1xct.html#ae36b3307af22f430a8f11765e3e57748" title="foedus::xct::xct_id\l_to_universal_lock_id" alt="" coords="1251,963,1396,1005"/>
<area shape="rect" id="node33" href="structfoedus_1_1xct_1_1RecordXctAccess.html#adf2e2a9d414bf5cfe86f33198ebdf434" title="Setter for owner_id_address_/owner_lock_id_. " alt="" coords="1225,1029,1422,1070"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a9527f3829e488359a2d7d80318729bee" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_offset_in_bytes" alt="" coords="735,473,913,529"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#acad0cd3a9c7bffd3ea0a478a21e5db1b" title="Offset versions. " alt="" coords="735,559,913,615"/>
<area shape="rect" id="node40" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a6e105bf908004fd08f79432b326067bc" title="Addition operator, considering wrapping around. " alt="" coords="479,1147,665,1189"/>
<area shape="rect" id="node41" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#af9fcb5a5ae968d079ee20e51e7418967" title="foedus::log::ThreadLogBuffer\l::head_to_tail_distance" alt="" coords="731,1278,917,1319"/>
<area shape="rect" id="node43" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a8de2c4c08a42a349476956be1b853469" title="Called when we have to wait till offset_head_ advances so that we can put new logs. " alt="" coords="479,1082,665,1123"/>
<area shape="rect" id="node42" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a824cf26a13eb7f42d5ae68f5725098c5" title="Subtract operator, considering wrapping around. " alt="" coords="975,1278,1162,1319"/>
<area shape="rect" id="node44" href="classfoedus_1_1log_1_1ThreadLogBuffer.html#a9aa20c59a7d75cf94742beb43b777de6" title="Only for Debug&#45;assertion. " alt="" coords="731,1147,917,1189"/>
<area shape="rect" id="node46" href="classfoedus_1_1Engine.html#aa27f031bd1e256d38e616ec9a499eefc" title="See Log Manager. " alt="" coords="757,1213,891,1254"/>
<area shape="rect" id="node47" href="classfoedus_1_1Engine.html#a6546930099132529543c320327367ef1" title="foedus::Engine::get\l_options" alt="" coords="757,886,891,927"/>
<area shape="rect" id="node48" href="group__ASSORTED.html#gaf84f9944a16c5848f69beacdfeedf939" title="Equivalent to std::atomic_thread_fence(std::memory_order_acquire). " alt="" coords="737,951,911,993"/>
<area shape="rect" id="node49" href="group__ASSORTED.html#gafc1110de4c6bb85c7e1f7feccc27f6d7" title="Equivalent to std::atomic_thread_fence(std::memory_order_release). " alt="" coords="737,1017,911,1058"/>
<area shape="rect" id="node50" href="classfoedus_1_1log_1_1LogManager.html#a5c844c3bc8d71ce709999fd286a5e7b8" title="Wake up loggers if they are sleeping. " alt="" coords="742,1082,906,1123"/>
<area shape="rect" id="node45" href="structfoedus_1_1log_1_1ThreadLogBufferMeta.html#a05db4e7c61f07d2320aa7b2c3c76d520" title="Only for Debug&#45;assertion. " alt="" coords="975,1147,1162,1189"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aeeccc272d2f9a4d895f4d117f6b96b27_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aeeccc272d2f9a4d895f4d117f6b96b27_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aeeccc272d2f9a4d895f4d117f6b96b27_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_aeeccc272d2f9a4d895f4d117f6b96b27_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a0f917244d33e9cdb2fa6ffd686a2a701" title="With this method, you can also specify physical_payload_hint, the physical size of the record&#39;s paylo..." alt="" coords="227,5,443,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#a152a0ecbad9b56385ec7f13e8a1fce19" title="With this method, you can also specify physical_payload_hint. " alt="" coords="248,71,421,127"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2a4e90569074d49ab538041caedacf6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>These are defined in <a class="el" href="masstree__storage__verify_8cpp.html">masstree_storage_verify.cpp</a>. </p>

<p>Definition at line <a class="el" href="masstree__storage__verify_8cpp_source.html#l00039">39</a> of file <a class="el" href="masstree__storage__verify_8cpp_source.html">masstree_storage_verify.cpp</a>.</p>

<p>References <a class="el" href="masstree__storage__verify_8cpp_source.html#l00035">CHECK_AND_ASSERT</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00058">get_first_root()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00084">foedus::storage::masstree::MasstreePage::is_border()</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="masstree__storage__verify_8cpp_source.html#l00047">verify_single_thread_layer()</a>, and <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage_8cpp_source.html#l00575">foedus::storage::masstree::MasstreeStorage::verify_single_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                                                           {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  MasstreeIntermediatePage* layer_root;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">get_first_root</a>(context, <span class="keyword">false</span>, &amp;layer_root));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!layer_root-&gt;is_border());  <span class="comment">// root of first layer is always intermediate page</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736">verify_single_thread_layer</a>(context, 0, layer_root));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="ttc" id="masstree__storage__verify_8cpp_html_aa0227b94f2abc9a7a5ac155db59cb2d3"><div class="ttname"><a href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a></div><div class="ttdeci">#define CHECK_AND_ASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00035">masstree_storage_verify.cpp:35</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_adc32aaf6f4537fcc1ada207e1d6902ec"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec">foedus::storage::masstree::MasstreeStoragePimpl::get_first_root</a></div><div class="ttdeci">ErrorCode get_first_root(thread::Thread *context, bool for_write, MasstreeIntermediatePage **root)</div><div class="ttdoc">Root-node related, such as a method to retrieve 1st-root, to grow, etc. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00058">masstree_storage_pimpl.cpp:58</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a09d587cc38996109b753a7704fa33736"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736">foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread_layer</a></div><div class="ttdeci">ErrorStack verify_single_thread_layer(thread::Thread *context, uint8_t layer, MasstreePage *layer_root)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00047">masstree_storage_verify.cpp:47</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a2a4e90569074d49ab538041caedacf6a_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a2a4e90569074d49ab538041caedacf6a_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a2a4e90569074d49ab538041caedacf6a_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a2a4e90569074d49ab538041caedacf6a_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#adc32aaf6f4537fcc1ada207e1d6902ec" title="Root&#45;node related, such as a method to retrieve 1st&#45;root, to grow, etc. " alt="" coords="1007,265,1181,321"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="1273,1972,1447,2013"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_layer" alt="" coords="227,1137,405,1193"/>
<area shape="rect" id="node3" href="namespacefoedus_1_1storage.html#ab7207e6e276af504c0e358a923ee75ec" title="foedus::storage::assert\l_aligned_page" alt="" coords="1283,217,1437,259"/>
<area shape="rect" id="node4" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1285,377,1435,419"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a36d78c30d1b07389c3c0e7180e301008" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_first_root_pointer\l_address" alt="" coords="1273,283,1447,353"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="1255,443,1465,484"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aca6d912133fd8b46eacb660b840bada0" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::get_id" alt="" coords="1273,71,1447,127"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="1273,5,1447,47"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="1258,508,1462,549"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="1252,639,1468,680"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="1273,704,1447,745"/>
<area shape="rect" id="node19" href="classfoedus_1_1thread_1_1Thread.html#a2a5e6b008138d755e7e401f25927400c" title="Methods related to System transactions (sysxct) nested under this thread. " alt="" coords="1285,152,1435,193"/>
<area shape="rect" id="node5" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1521,401,1705,443"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1782,563,1943,604"/>
<area shape="rect" id="node7" href="structfoedus_1_1storage_1_1Page.html#abee44ea141b30e613f3de40831d6ff8e" title="At least the basic header exists in all pages. " alt="" coords="1788,339,1937,380"/>
<area shape="rect" id="node8" href="classfoedus_1_1memory_1_1NumaCoreMemory.html#ad09e335bbca636246cf2c3d60ec22570" title="Acquires one free volatile page from local page pool. " alt="" coords="1757,404,1968,445"/>
<area shape="rect" id="node9" href="structfoedus_1_1memory_1_1LocalPageResolver.html#aa9d2266686c3a66678b37241a3ac434f" title="As the name suggests, this version is for new pages, which don&#39;t have sanity checks. " alt="" coords="1771,470,1955,526"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#a273a4c4f51c06ebc91663329742e1c69" title="foedus::storage::Volatile\lPagePointer::set" alt="" coords="1782,273,1943,315"/>
<area shape="rect" id="node17" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="1517,763,1709,804"/>
<area shape="rect" id="node20" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a498a6a07313bf9fbb2c0e3d02f075221" title="Sysxct&#45;related. " alt="" coords="1521,152,1705,193"/>
<area shape="rect" id="node22" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1518,1481,1709,1523"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_border" alt="" coords="737,1137,923,1193"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_intermediate" alt="" coords="453,626,675,682"/>
<area shape="rect" id="node25" href="namespacefoedus_1_1storage_1_1masstree.html#acea98e6f343df2d62a9a8f9ddd127234" title="foedus::storage::masstree\l::verify_page_basic" alt="" coords="1007,777,1181,819"/>
<area shape="rect" id="node27" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a27d301fad7d4d340cd2d6255dc330607" title="foedus::storage::masstree\l::MasstreePage::get_foster_major" alt="" coords="1251,952,1469,993"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a32653a16ddca213c94560652e9388dd5" title="foedus::storage::masstree\l::MasstreePage::get_foster_minor" alt="" coords="1251,1039,1469,1080"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#adc22d21883e15b87cd5ff6b6ec513c35" title="foedus::storage::masstree\l::MasstreePage::is_moved" alt="" coords="1272,887,1448,928"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="991,660,1197,701"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="988,1796,1200,1837"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="1005,1097,1183,1153"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a6318577ff1e6f5106712e9ed60a429fe" title="Whether this page is receiving only sequential inserts. " alt="" coords="1007,1177,1181,1233"/>
<area shape="rect" id="node34" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="1019,425,1169,467"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a44cc8d18dc9077ae2310667e88ed5b7c" title="foedus::storage::masstree\l::MasstreePage::get_foster_fence" alt="" coords="985,543,1203,584"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="1005,1257,1183,1313"/>
<area shape="rect" id="node37" href="structfoedus_1_1xct_1_1McsRwLock.html#adc5e6612e3cecf3d2f15d02237b4ef8f" title="foedus::xct::McsRwLock\l::is_locked" alt="" coords="1011,1337,1177,1379"/>
<area shape="rect" id="node38" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="1033,1403,1155,1444"/>
<area shape="rect" id="node39" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="1033,1468,1155,1509"/>
<area shape="rect" id="node40" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="1017,1534,1171,1561"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a1781897598dfbd41a6d1291d0c5dc060" title="foedus::storage::masstree\l::MasstreeBorderPage::verify\l_slot_lengthes" alt="" coords="999,1585,1189,1641"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="1000,1862,1188,1918"/>
<area shape="rect" id="node43" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="1299,1881,1421,1923"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="1005,1665,1183,1721"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="1273,573,1447,615"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="1007,345,1181,401"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab55e48873dcf5700871a035c65bfa588" title="used only in masstree. " alt="" coords="1256,769,1464,811"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a14cdcef87b3c0a6ef431df9d06a1a663" title="An empty&#45;range page, either intermediate or border, never has any entries. " alt="" coords="723,345,937,387"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#adaf1febd2954da507ffd8daa2757c890" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_separator" alt="" coords="737,411,923,467"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="737,593,923,649"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a2a4e90569074d49ab538041caedacf6a_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a2a4e90569074d49ab538041caedacf6a_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a2a4e90569074d49ab538041caedacf6a_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a2a4e90569074d49ab538041caedacf6a_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aedee683fbced316953d1cbc622f22c87" title="foedus::storage::masstree\l::MasstreeStorage::verify\l_single_thread" alt="" coords="227,5,400,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a688e9af62605f137637cc239f161c84f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread_border </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>low_fence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1masstree_1_1HighFence.html">HighFence</a>&#160;</td>
          <td class="paramname"><em>high_fence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html">MasstreeBorderPage</a> *&#160;</td>
          <td class="paramname"><em>page</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__verify_8cpp_source.html#l00201">201</a> of file <a class="el" href="masstree__storage__verify_8cpp_source.html">masstree_storage_verify.cpp</a>.</p>

<p>References <a class="el" href="masstree__storage__verify_8cpp_source.html#l00035">CHECK_AND_ASSERT</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00796">foedus::storage::masstree::MasstreeBorderPage::does_point_to_layer()</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00367">follow_page()</a>, <a class="el" href="xct__id_8hpp_source.html#l00964">foedus::xct::XctId::get_epoch()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00109">foedus::storage::masstree::MasstreePage::get_foster_fence()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00113">foedus::storage::masstree::MasstreePage::get_foster_major()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00112">foedus::storage::masstree::MasstreePage::get_foster_minor()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00148">foedus::storage::masstree::MasstreePage::get_key_count()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00144">foedus::storage::masstree::MasstreePage::get_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00750">foedus::storage::masstree::MasstreeBorderPage::get_next_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00813">foedus::storage::masstree::MasstreeBorderPage::get_owner_id()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00820">foedus::storage::masstree::MasstreeBorderPage::get_remainder_length()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00801">foedus::storage::masstree::MasstreeBorderPage::get_slice()</a>, <a class="el" href="xct__id_8hpp_source.html#l01038">foedus::xct::XctId::is_being_written()</a>, <a class="el" href="storage__id_8hpp_source.html#l00303">foedus::storage::DualPagePointer::is_both_null()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00623">foedus::storage::masstree::MasstreeBorderPage::is_consecutive_inserts()</a>, <a class="el" href="xct__id_8hpp_source.html#l00857">foedus::xct::McsRwLock::is_locked()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00169">foedus::storage::masstree::MasstreePage::is_moved()</a>, <a class="el" href="xct__id_8hpp_source.html#l01042">foedus::xct::XctId::is_next_layer()</a>, <a class="el" href="epoch_8hpp_source.html#l00096">foedus::Epoch::is_valid()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00163">foedus::storage::masstree::kBorderPageMaxSlots</a>, <a class="el" href="page_8hpp_source.html#l00050">foedus::storage::kMasstreeBorderPageType</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="masstree__id_8hpp_source.html#l00137">foedus::storage::masstree::kSupremumSlice</a>, <a class="el" href="xct__id_8hpp_source.html#l01134">foedus::xct::RwLockableXctId::lock_</a>, <a class="el" href="thread_8hpp_source.html#l00110">foedus::thread::Thread::resolve_cast()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00055">foedus::storage::masstree::HighFence::supremum_</a>, <a class="el" href="masstree__storage__verify_8cpp_source.html#l00069">foedus::storage::masstree::verify_page_basic()</a>, <a class="el" href="masstree__storage__verify_8cpp_source.html#l00047">verify_single_thread_layer()</a>, <a class="el" href="masstree__page__impl_8cpp_source.html#l00708">foedus::storage::masstree::MasstreeBorderPage::verify_slot_lengthes()</a>, <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>, and <a class="el" href="xct__id_8hpp_source.html#l01137">foedus::xct::RwLockableXctId::xct_id_</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__verify_8cpp_source.html#l00103">verify_single_thread_intermediate()</a>, and <a class="el" href="masstree__storage__verify_8cpp_source.html#l00047">verify_single_thread_layer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                            {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#acea98e6f343df2d62a9a8f9ddd127234">verify_page_basic</a>(context, page, <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba0fb7a3d57453730f4ed6bb2914d076db">kMasstreeBorderPageType</a>, low_fence, high_fence));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// check consecutive_inserts_. this should be consistent whether it&#39;s moved or not.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordtype">bool</span> sorted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a> i = 1; i &lt; page-&gt;get_key_count(); ++i) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> prev = page-&gt;get_slice(i - 1);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> slice = page-&gt;get_slice(i);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> prev_len = page-&gt;get_remainder_length(i - 1);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">KeyLength</a> len = page-&gt;get_remainder_length(i);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (prev &gt; slice || (prev == slice &amp;&amp; prev_len &gt; len)) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      sorted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;is_consecutive_inserts() == sorted);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span> (page-&gt;is_moved()) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keyword">auto</span>* minor = context-&gt;resolve_cast&lt;MasstreeBorderPage&gt;(page-&gt;get_foster_minor());</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keyword">auto</span>* major = context-&gt;resolve_cast&lt;MasstreeBorderPage&gt;(page-&gt;get_foster_major());</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// If major is empty-range, the minor might be supremum</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">bool</span> is_minor_supremum = high_fence.supremum_ &amp;&amp; page-&gt;get_foster_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">kSupremumSlice</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f">verify_single_thread_border</a>(</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      context,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      low_fence,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      HighFence(page-&gt;get_foster_fence(), is_minor_supremum),</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      minor));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f">verify_single_thread_border</a>(</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      context,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      page-&gt;get_foster_fence(),</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      high_fence,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      major));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;is_moved());</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;get_key_count() &lt;= <a class="code" href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">kBorderPageMaxSlots</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">SlotIndex</a> i = 0; i &lt; page-&gt;get_key_count(); ++i) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;get_owner_id(i)-&gt;lock_.is_locked());</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;get_owner_id(i)-&gt;xct_id_.is_being_written());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;get_owner_id(i)-&gt;xct_id_.get_epoch().is_valid());</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;verify_slot_lengthes(i));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> slice = page-&gt;get_slice(i);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(slice &gt;= low_fence);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(slice &lt; high_fence.slice_ || page-&gt;is_high_fence_supremum());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (page-&gt;does_point_to_layer(i)) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;get_owner_id(i)-&gt;xct_id_.is_next_layer());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;get_next_layer(i)-&gt;is_both_null());</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      MasstreePage* next;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="comment">// TASK(Hideaki) probably two versions: always follow volatile vs snapshot</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="comment">// so far check volatile only</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">follow_page</a>(context, <span class="keyword">true</span>, page-&gt;get_next_layer(i), &amp;next));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736">verify_single_thread_layer</a>(context, page-&gt;get_layer() + 1, next));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;get_owner_id(i)-&gt;xct_id_.is_next_layer());</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
<div class="ttc" id="masstree__storage__verify_8cpp_html_aa0227b94f2abc9a7a5ac155db59cb2d3"><div class="ttname"><a href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a></div><div class="ttdeci">#define CHECK_AND_ASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00035">masstree_storage_verify.cpp:35</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga6280f932bf17f1d9d4acc294ca984bee"><div class="ttname"><a href="group__MASSTREE.html#ga6280f932bf17f1d9d4acc294ca984bee">foedus::storage::masstree::SlotIndex</a></div><div class="ttdeci">uint16_t SlotIndex</div><div class="ttdoc">Index of a record in a (border) page. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00110">masstree_id.hpp:110</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aff31f521523d7a7b81ff5b750e081dac"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">foedus::storage::masstree::MasstreeStoragePimpl::follow_page</a></div><div class="ttdeci">ErrorCode follow_page(thread::Thread *context, bool for_writes, storage::DualPagePointer *pointer, MasstreePage **page)</div><div class="ttdoc">Thread::follow_page_pointer() for masstree. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00367">masstree_storage_pimpl.cpp:367</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a688e9af62605f137637cc239f161c84f"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f">foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread_border</a></div><div class="ttdeci">ErrorStack verify_single_thread_border(thread::Thread *context, KeySlice low_fence, HighFence high_fence, MasstreeBorderPage *page)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00201">masstree_storage_verify.cpp:201</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga14e35f7fbe4bc18276fde8e8ba460f5ba0fb7a3d57453730f4ed6bb2914d076db"><div class="ttname"><a href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba0fb7a3d57453730f4ed6bb2914d076db">foedus::storage::kMasstreeBorderPageType</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00050">page.hpp:50</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga556e8f0d5e02e78f3ddecd8f5b022bf6"><div class="ttname"><a href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">foedus::storage::masstree::KeySlice</a></div><div class="ttdeci">uint64_t KeySlice</div><div class="ttdoc">Each key slice is an 8-byte integer. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00126">masstree_id.hpp:126</a></div></div>
<div class="ttc" id="group__MASSTREE_html_gaa0c469cd4f863aa64e07fcea90b72859"><div class="ttname"><a href="group__MASSTREE.html#gaa0c469cd4f863aa64e07fcea90b72859">foedus::storage::masstree::KeyLength</a></div><div class="ttdeci">uint16_t KeyLength</div><div class="ttdoc">Represents a byte-length of a key in this package. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00069">masstree_id.hpp:69</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga78a96e3a0ec4256513d9d2e9c94f37fd"><div class="ttname"><a href="group__MASSTREE.html#ga78a96e3a0ec4256513d9d2e9c94f37fd">foedus::storage::masstree::kBorderPageMaxSlots</a></div><div class="ttdeci">const SlotIndex kBorderPageMaxSlots</div><div class="ttdoc">Maximum number of slots in one MasstreeBorderPage. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00163">masstree_id.hpp:163</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_acea98e6f343df2d62a9a8f9ddd127234"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#acea98e6f343df2d62a9a8f9ddd127234">foedus::storage::masstree::verify_page_basic</a></div><div class="ttdeci">ErrorStack verify_page_basic(thread::Thread *context, MasstreePage *page, PageType page_type, KeySlice low_fence, HighFence high_fence)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00069">masstree_storage_verify.cpp:69</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a7bfcd277a96bcd1e9008459abe1ec40d"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">foedus::storage::masstree::kSupremumSlice</a></div><div class="ttdeci">const KeySlice kSupremumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00137">masstree_id.hpp:137</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a09d587cc38996109b753a7704fa33736"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736">foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread_layer</a></div><div class="ttdeci">ErrorStack verify_single_thread_layer(thread::Thread *context, uint8_t layer, MasstreePage *layer_root)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00047">masstree_storage_verify.cpp:47</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a688e9af62605f137637cc239f161c84f_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a688e9af62605f137637cc239f161c84f_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a688e9af62605f137637cc239f161c84f_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a688e9af62605f137637cc239f161c84f_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="517,305,705,361"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1560,355,1767,396"/>
<area shape="rect" id="node5" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="819,247,941,288"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="793,1689,967,1745"/>
<area shape="rect" id="node11" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="1061,1980,1235,2021"/>
<area shape="rect" id="node12" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="285,385,407,427"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a44cc8d18dc9077ae2310667e88ed5b7c" title="foedus::storage::masstree\l::MasstreePage::get_foster_fence" alt="" coords="771,713,989,755"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a27d301fad7d4d340cd2d6255dc330607" title="foedus::storage::masstree\l::MasstreePage::get_foster_major" alt="" coords="1039,1091,1257,1132"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a32653a16ddca213c94560652e9388dd5" title="foedus::storage::masstree\l::MasstreePage::get_foster_minor" alt="" coords="1039,1156,1257,1197"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="793,844,967,885"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="257,451,435,507"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="1059,382,1237,438"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="521,582,700,638"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="240,916,452,957"/>
<area shape="rect" id="node25" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="285,981,407,1023"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a6318577ff1e6f5106712e9ed60a429fe" title="Whether this page is receiving only sequential inserts. " alt="" coords="259,1047,433,1103"/>
<area shape="rect" id="node27" href="structfoedus_1_1xct_1_1McsRwLock.html#adc5e6612e3cecf3d2f15d02237b4ef8f" title="foedus::xct::McsRwLock\l::is_locked" alt="" coords="263,1128,429,1169"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#adc22d21883e15b87cd5ff6b6ec513c35" title="foedus::storage::masstree\l::MasstreePage::is_moved" alt="" coords="1060,895,1236,936"/>
<area shape="rect" id="node30" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="269,1274,423,1301"/>
<area shape="rect" id="node31" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="805,779,955,820"/>
<area shape="rect" id="node33" href="namespacefoedus_1_1storage_1_1masstree.html#acea98e6f343df2d62a9a8f9ddd127234" title="foedus::storage::masstree\l::verify_page_basic" alt="" coords="793,1389,967,1431"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_layer" alt="" coords="257,1194,435,1250"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a1781897598dfbd41a6d1291d0c5dc060" title="foedus::storage::masstree\l::MasstreeBorderPage::verify\l_slot_lengthes" alt="" coords="251,134,441,190"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1305,355,1512,396"/>
<area shape="rect" id="node7" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1073,1915,1223,1956"/>
<area shape="rect" id="node8" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1317,1885,1501,1927"/>
<area shape="rect" id="node9" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1583,1841,1744,1883"/>
<area shape="rect" id="node10" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1815,1841,1976,1883"/>
<area shape="rect" id="node13" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="549,385,672,427"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="521,451,700,507"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a2c1e8415916dbf458aee87572741890f" title="foedus::storage::masstree\l::MasstreeBorderPage::get_record" alt="" coords="769,463,991,504"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a475fb985aa078dff7c627ce18538b52e" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_suffix_length_aligned" alt="" coords="791,382,969,438"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="1313,1160,1505,1201"/>
<area shape="rect" id="node32" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="1073,960,1223,1001"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab55e48873dcf5700871a035c65bfa588" title="used only in masstree. " alt="" coords="1044,1025,1252,1067"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="1043,1389,1253,1431"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="1046,1455,1250,1496"/>
<area shape="rect" id="node37" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1313,1585,1504,1627"/>
<area shape="rect" id="node38" href="structfoedus_1_1storage_1_1Page.html#a33a7095a34e8a551fc22bd1aad2bda97" title="foedus::storage::Page\l::get_page_type" alt="" coords="1073,1585,1223,1627"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="1040,1221,1256,1263"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="1061,1520,1235,1561"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="1061,1849,1235,1891"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a7a9d09469e106d14513932f3aebeef97" title="foedus::storage::masstree\l::MasstreePage::is_foster\l_major_null" alt="" coords="1322,1790,1495,1846"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a698b417f5e89daf68ebd78044222bb23" title="foedus::storage::masstree\l::MasstreePage::is_foster\l_minor_null" alt="" coords="1322,1334,1495,1390"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="1061,1651,1235,1707"/>
<area shape="rect" id="node45" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a16a2c06a304514be7b99fb6c884e7e9b" title="foedus::storage::masstree\l::MasstreePage::is_locked" alt="" coords="1059,1732,1237,1773"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_intermediate" alt="" coords="500,1018,721,1074"/>
<area shape="rect" id="node49" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_1_1Slot.html#a96be3b659b1812ecd7efbf601ea8c929" title="foedus::storage::masstree\l::MasstreeBorderPage::Slot\l::does_point_to_layer" alt="" coords="519,174,702,230"/>
<area shape="rect" id="node50" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_1_1Slot.html#a447049b6067b0d1be460802f1b6a7076" title="This might be affected by concurrent threads. " alt="" coords="519,94,702,150"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a688e9af62605f137637cc239f161c84f_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a688e9af62605f137637cc239f161c84f_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a688e9af62605f137637cc239f161c84f_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a688e9af62605f137637cc239f161c84f_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_intermediate" alt="" coords="240,5,461,61"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_layer" alt="" coords="509,83,688,139"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a2a4e90569074d49ab538041caedacf6a" title="These are defined in masstree_storage_verify.cpp. " alt="" coords="736,83,909,139"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aedee683fbced316953d1cbc622f22c87" title="foedus::storage::masstree\l::MasstreeStorage::verify\l_single_thread" alt="" coords="957,83,1131,139"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a351ca64071b130468a9ba9f200ccd417"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread_intermediate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a>&#160;</td>
          <td class="paramname"><em>low_fence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfoedus_1_1storage_1_1masstree_1_1HighFence.html">HighFence</a>&#160;</td>
          <td class="paramname"><em>high_fence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html">MasstreeIntermediatePage</a> *&#160;</td>
          <td class="paramname"><em>page</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__verify_8cpp_source.html#l00103">103</a> of file <a class="el" href="masstree__storage__verify_8cpp_source.html">masstree_storage_verify.cpp</a>.</p>

<p>References <a class="el" href="masstree__storage__verify_8cpp_source.html#l00035">CHECK_AND_ASSERT</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="masstree__storage__pimpl_8cpp_source.html#l00367">follow_page()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00146">foedus::storage::masstree::MasstreePage::get_btree_level()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00109">foedus::storage::masstree::MasstreePage::get_foster_fence()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00113">foedus::storage::masstree::MasstreePage::get_foster_major()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00112">foedus::storage::masstree::MasstreePage::get_foster_minor()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00148">foedus::storage::masstree::MasstreePage::get_key_count()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00144">foedus::storage::masstree::MasstreePage::get_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00322">foedus::storage::masstree::MasstreeIntermediatePage::get_minipage()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00324">foedus::storage::masstree::MasstreeIntermediatePage::get_separator()</a>, <a class="el" href="storage__id_8hpp_source.html#l00303">foedus::storage::DualPagePointer::is_both_null()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00097">foedus::storage::masstree::MasstreePage::is_empty_range()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00169">foedus::storage::masstree::MasstreePage::is_moved()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00271">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::key_count_</a>, <a class="el" href="page_8hpp_source.html#l00049">foedus::storage::kMasstreeIntermediatePageType</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00244">foedus::storage::masstree::kMaxIntermediateMiniSeparators</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00237">foedus::storage::masstree::kMaxIntermediateSeparators</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="masstree__id_8hpp_source.html#l00137">foedus::storage::masstree::kSupremumSlice</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00278">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::pointers_</a>, <a class="el" href="thread_8hpp_source.html#l00110">foedus::thread::Thread::resolve_cast()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00276">foedus::storage::masstree::MasstreeIntermediatePage::MiniPage::separators_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00054">foedus::storage::masstree::HighFence::slice_</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00055">foedus::storage::masstree::HighFence::supremum_</a>, <a class="el" href="masstree__storage__verify_8cpp_source.html#l00069">foedus::storage::masstree::verify_page_basic()</a>, <a class="el" href="masstree__storage__verify_8cpp_source.html#l00201">verify_single_thread_border()</a>, and <a class="el" href="error__stack_8hpp_source.html#l00533">WRAP_ERROR_CODE</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__verify_8cpp_source.html#l00047">verify_single_thread_layer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                  {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#acea98e6f343df2d62a9a8f9ddd127234">verify_page_basic</a>(context, page, <a class="code" href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba23ef27cc0a436fe010a22a7374e8737b">kMasstreeIntermediatePageType</a>, low_fence, high_fence));</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (page-&gt;is_empty_range()) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page-&gt;get_key_count() == 0);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!page-&gt;is_moved());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (page-&gt;is_moved()) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keyword">auto</span>* minor = context-&gt;resolve_cast&lt;MasstreeIntermediatePage&gt;(page-&gt;get_foster_minor());</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keyword">auto</span>* major = context-&gt;resolve_cast&lt;MasstreeIntermediatePage&gt;(page-&gt;get_foster_major());</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// If major is empty-range, the minor might be supremum</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">bool</span> is_minor_supremum = high_fence.supremum_ &amp;&amp; page-&gt;get_foster_fence() == <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">kSupremumSlice</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417">verify_single_thread_intermediate</a>(</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      context,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      low_fence,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      HighFence(page-&gt;get_foster_fence(), is_minor_supremum),</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      minor));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417">verify_single_thread_intermediate</a>(</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      context,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      page-&gt;get_foster_fence(),</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      high_fence,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      major));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  uint8_t key_count = page-&gt;get_key_count();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(key_count &lt;= <a class="code" href="group__MASSTREE.html#ga2ce564bb661a338ce070653e1ca48efa">kMaxIntermediateSeparators</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> previous_low = low_fence;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">for</span> (uint8_t i = 0; i &lt;= key_count; ++i) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    HighFence mini_high(0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (i &lt; key_count) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      mini_high.slice_ = page-&gt;get_separator(i);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      mini_high.supremum_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(high_fence.supremum_ || mini_high.slice_ &lt; high_fence.slice_);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(mini_high.slice_ &gt; low_fence);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(mini_high.slice_ &gt; page-&gt;get_separator(i - 1));</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      mini_high = high_fence;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    MasstreeIntermediatePage::MiniPage&amp; minipage = page-&gt;get_minipage(i);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    uint8_t mini_count = minipage.key_count_;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(mini_count &lt;= <a class="code" href="group__MASSTREE.html#gaaa62799e432e5c5b145851eed621d33d">kMaxIntermediateMiniSeparators</a>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">KeySlice</a> page_low = previous_low;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">for</span> (uint8_t j = 0; j &lt;= mini_count; ++j) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      HighFence page_high(0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">if</span> (j &lt; mini_count) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        page_high.slice_ = minipage.separators_[j];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        page_high.supremum_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page_high.slice_ &lt; mini_high.slice_ || mini_high.supremum_);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">if</span> (j == 0) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page_high.slice_ &gt; previous_low);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(page_high.slice_ &gt; minipage.separators_[j - 1]);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        page_high = mini_high;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(!minipage.pointers_[j].is_both_null());</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      MasstreePage* next;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="comment">// TASK(Hideaki) probably two versions: always follow volatile vs snapshot</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="comment">// so far check volatile only</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">follow_page</a>(context, <span class="keyword">true</span>, &amp;minipage.pointers_[j], &amp;next));</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(next-&gt;get_layer() == page-&gt;get_layer());</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(next-&gt;get_btree_level() + 1U == page-&gt;get_btree_level());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">if</span> (next-&gt;is_border()) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f">verify_single_thread_border</a>(</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          context,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          page_low,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          page_high,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          reinterpret_cast&lt;MasstreeBorderPage*&gt;(next)));</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417">verify_single_thread_intermediate</a>(</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          context,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          page_low,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          page_high,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          reinterpret_cast&lt;MasstreeIntermediatePage*&gt;(next)));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      page_low = page_high.slice_;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    previous_low = mini_high.slice_;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="ttc" id="masstree__storage__verify_8cpp_html_aa0227b94f2abc9a7a5ac155db59cb2d3"><div class="ttname"><a href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a></div><div class="ttdeci">#define CHECK_AND_ASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00035">masstree_storage_verify.cpp:35</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_aff31f521523d7a7b81ff5b750e081dac"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac">foedus::storage::masstree::MasstreeStoragePimpl::follow_page</a></div><div class="ttdeci">ErrorCode follow_page(thread::Thread *context, bool for_writes, storage::DualPagePointer *pointer, MasstreePage **page)</div><div class="ttdoc">Thread::follow_page_pointer() for masstree. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__pimpl_8cpp_source.html#l00367">masstree_storage_pimpl.cpp:367</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a688e9af62605f137637cc239f161c84f"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f">foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread_border</a></div><div class="ttdeci">ErrorStack verify_single_thread_border(thread::Thread *context, KeySlice low_fence, HighFence high_fence, MasstreeBorderPage *page)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00201">masstree_storage_verify.cpp:201</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga556e8f0d5e02e78f3ddecd8f5b022bf6"><div class="ttname"><a href="group__MASSTREE.html#ga556e8f0d5e02e78f3ddecd8f5b022bf6">foedus::storage::masstree::KeySlice</a></div><div class="ttdeci">uint64_t KeySlice</div><div class="ttdoc">Each key slice is an 8-byte integer. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00126">masstree_id.hpp:126</a></div></div>
<div class="ttc" id="group__MASSTREE_html_gaaa62799e432e5c5b145851eed621d33d"><div class="ttname"><a href="group__MASSTREE.html#gaaa62799e432e5c5b145851eed621d33d">foedus::storage::masstree::kMaxIntermediateMiniSeparators</a></div><div class="ttdeci">const uint16_t kMaxIntermediateMiniSeparators</div><div class="ttdoc">Max number of separators stored in the second level of intermediate pages. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__page__impl_8hpp_source.html#l00244">masstree_page_impl.hpp:244</a></div></div>
<div class="ttc" id="group__MASSTREE_html_ga2ce564bb661a338ce070653e1ca48efa"><div class="ttname"><a href="group__MASSTREE.html#ga2ce564bb661a338ce070653e1ca48efa">foedus::storage::masstree::kMaxIntermediateSeparators</a></div><div class="ttdeci">const uint16_t kMaxIntermediateSeparators</div><div class="ttdoc">Max number of separators stored in the first level of intermediate pages. </div><div class="ttdef"><b>Definition:</b> <a href="masstree__page__impl_8hpp_source.html#l00237">masstree_page_impl.hpp:237</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_acea98e6f343df2d62a9a8f9ddd127234"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#acea98e6f343df2d62a9a8f9ddd127234">foedus::storage::masstree::verify_page_basic</a></div><div class="ttdeci">ErrorStack verify_page_basic(thread::Thread *context, MasstreePage *page, PageType page_type, KeySlice low_fence, HighFence high_fence)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00069">masstree_storage_verify.cpp:69</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a351ca64071b130468a9ba9f200ccd417"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417">foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread_intermediate</a></div><div class="ttdeci">ErrorStack verify_single_thread_intermediate(thread::Thread *context, KeySlice low_fence, HighFence high_fence, MasstreeIntermediatePage *page)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00103">masstree_storage_verify.cpp:103</a></div></div>
<div class="ttc" id="group__STORAGE_html_gga14e35f7fbe4bc18276fde8e8ba460f5ba23ef27cc0a436fe010a22a7374e8737b"><div class="ttname"><a href="group__STORAGE.html#gga14e35f7fbe4bc18276fde8e8ba460f5ba23ef27cc0a436fe010a22a7374e8737b">foedus::storage::kMasstreeIntermediatePageType</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8hpp_source.html#l00049">page.hpp:49</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a7bfcd277a96bcd1e9008459abe1ec40d"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">foedus::storage::masstree::kSupremumSlice</a></div><div class="ttdeci">const KeySlice kSupremumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00137">masstree_id.hpp:137</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga952ce4f5f860d7b28a70095b450d3f4d"><div class="ttname"><a href="group__ERRORCODES.html#ga952ce4f5f860d7b28a70095b450d3f4d">WRAP_ERROR_CODE</a></div><div class="ttdeci">#define WRAP_ERROR_CODE(x)</div><div class="ttdoc">Same as CHECK_ERROR(x) except it receives only an error code, thus more efficient. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00533">error_stack.hpp:533</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a351ca64071b130468a9ba9f200ccd417_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a351ca64071b130468a9ba9f200ccd417_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a351ca64071b130468a9ba9f200ccd417_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a351ca64071b130468a9ba9f200ccd417_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="559,98,733,154"/>
<area shape="rect" id="node8" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="825,5,999,47"/>
<area shape="rect" id="node9" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab55e48873dcf5700871a035c65bfa588" title="used only in masstree. " alt="" coords="808,136,1016,177"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a44cc8d18dc9077ae2310667e88ed5b7c" title="foedus::storage::masstree\l::MasstreePage::get_foster_fence" alt="" coords="537,399,755,440"/>
<area shape="rect" id="node11" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a27d301fad7d4d340cd2d6255dc330607" title="foedus::storage::masstree\l::MasstreePage::get_foster_major" alt="" coords="803,960,1021,1001"/>
<area shape="rect" id="node12" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a32653a16ddca213c94560652e9388dd5" title="foedus::storage::masstree\l::MasstreePage::get_foster_minor" alt="" coords="803,895,1021,936"/>
<area shape="rect" id="node13" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="543,1864,749,1905"/>
<area shape="rect" id="node14" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="825,1805,999,1847"/>
<area shape="rect" id="node15" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="289,1891,475,1947"/>
<area shape="rect" id="node16" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#adaf1febd2954da507ffd8daa2757c890" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_separator" alt="" coords="289,1971,475,2027"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a14cdcef87b3c0a6ef431df9d06a1a663" title="An empty&#45;range page, either intermediate or border, never has any entries. " alt="" coords="275,2052,489,2093"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#adc22d21883e15b87cd5ff6b6ec513c35" title="foedus::storage::masstree\l::MasstreePage::is_moved" alt="" coords="824,1091,1000,1132"/>
<area shape="rect" id="node21" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="571,333,721,375"/>
<area shape="rect" id="node24" href="namespacefoedus_1_1storage_1_1masstree.html#acea98e6f343df2d62a9a8f9ddd127234" title="foedus::storage::masstree\l::verify_page_basic" alt="" coords="559,516,733,557"/>
<area shape="rect" id="node37" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_border" alt="" coords="289,1134,475,1190"/>
<area shape="rect" id="node3" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="837,71,987,112"/>
<area shape="rect" id="node4" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1073,160,1257,201"/>
<area shape="rect" id="node5" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1330,124,1491,165"/>
<area shape="rect" id="node7" href="structfoedus_1_1memory_1_1GlobalVolatilePageResolver.html#a56250946b7719a7bd15532d211eac88f" title="Resolves offset plus NUMA node ID to storage::Page*. " alt="" coords="1309,244,1512,285"/>
<area shape="rect" id="node6" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ac3d7cb1649528efa8b9aa22b63bf52e6" title="foedus::storage::Volatile\lPagePointer::get_offset" alt="" coords="1560,124,1721,165"/>
<area shape="rect" id="node19" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="1069,963,1261,1004"/>
<area shape="rect" id="node20" href="structfoedus_1_1storage_1_1PageVersionStatus.html#ac3214863fa74628187ce46b2879994ae" title="foedus::storage::PageVersion\lStatus::is_moved" alt="" coords="1315,963,1507,1004"/>
<area shape="rect" id="node22" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="837,304,987,345"/>
<area shape="rect" id="node23" href="classfoedus_1_1thread_1_1Thread.html#aa77cde98794b5a55e0d295284acb3e6d" title="Returns the page resolver to convert page ID to page pointer. " alt="" coords="1090,357,1241,413"/>
<area shape="rect" id="node25" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="807,581,1017,623"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="810,712,1014,753"/>
<area shape="rect" id="node27" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1070,771,1261,812"/>
<area shape="rect" id="node28" href="structfoedus_1_1storage_1_1Page.html#a33a7095a34e8a551fc22bd1aad2bda97" title="foedus::storage::Page\l::get_page_type" alt="" coords="837,647,987,688"/>
<area shape="rect" id="node29" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="804,829,1020,871"/>
<area shape="rect" id="node30" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="825,369,999,411"/>
<area shape="rect" id="node31" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="825,1025,999,1067"/>
<area shape="rect" id="node32" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a7a9d09469e106d14513932f3aebeef97" title="foedus::storage::masstree\l::MasstreePage::is_foster\l_major_null" alt="" coords="1079,226,1252,282"/>
<area shape="rect" id="node33" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a698b417f5e89daf68ebd78044222bb23" title="foedus::storage::masstree\l::MasstreePage::is_foster\l_minor_null" alt="" coords="1079,79,1252,135"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="825,435,999,491"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a16a2c06a304514be7b99fb6c884e7e9b" title="foedus::storage::masstree\l::MasstreePage::is_locked" alt="" coords="823,516,1001,557"/>
<area shape="rect" id="node36" href="structfoedus_1_1storage_1_1PageVersion.html#a301cba19b01cf82d7b576a04180b56e2" title="foedus::storage::PageVersion\l::is_locked" alt="" coords="1069,516,1261,557"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="552,1653,740,1709"/>
<area shape="rect" id="node39" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="851,1627,973,1668"/>
<area shape="rect" id="node40" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="585,1536,707,1577"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="557,835,735,891"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="557,915,735,971"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="557,995,735,1051"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="540,1076,752,1117"/>
<area shape="rect" id="node45" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="585,1141,707,1183"/>
<area shape="rect" id="node46" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a6318577ff1e6f5106712e9ed60a429fe" title="Whether this page is receiving only sequential inserts. " alt="" coords="559,1207,733,1263"/>
<area shape="rect" id="node47" href="structfoedus_1_1xct_1_1McsRwLock.html#adc5e6612e3cecf3d2f15d02237b4ef8f" title="foedus::xct::McsRwLock\l::is_locked" alt="" coords="563,1339,729,1380"/>
<area shape="rect" id="node48" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="569,1405,723,1431"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_layer" alt="" coords="557,1733,735,1789"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a1781897598dfbd41a6d1291d0c5dc060" title="foedus::storage::masstree\l::MasstreeBorderPage::verify\l_slot_lengthes" alt="" coords="551,1455,741,1511"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a351ca64071b130468a9ba9f200ccd417_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a351ca64071b130468a9ba9f200ccd417_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a351ca64071b130468a9ba9f200ccd417_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a351ca64071b130468a9ba9f200ccd417_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a09d587cc38996109b753a7704fa33736" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_layer" alt="" coords="275,52,453,108"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a2a4e90569074d49ab538041caedacf6a" title="These are defined in masstree_storage_verify.cpp. " alt="" coords="508,5,681,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_border" alt="" coords="501,85,688,141"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aedee683fbced316953d1cbc622f22c87" title="foedus::storage::masstree\l::MasstreeStorage::verify\l_single_thread" alt="" coords="736,5,909,61"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a09d587cc38996109b753a7704fa33736"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfoedus_1_1ErrorStack.html">ErrorStack</a> foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread_layer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1thread_1_1Thread.html">thread::Thread</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html">MasstreePage</a> *&#160;</td>
          <td class="paramname"><em>layer_root</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="masstree__storage__verify_8cpp_source.html#l00047">47</a> of file <a class="el" href="masstree__storage__verify_8cpp_source.html">masstree_storage_verify.cpp</a>.</p>

<p>References <a class="el" href="masstree__storage__verify_8cpp_source.html#l00035">CHECK_AND_ASSERT</a>, <a class="el" href="error__stack_8hpp_source.html#l00517">CHECK_ERROR</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00144">foedus::storage::masstree::MasstreePage::get_layer()</a>, <a class="el" href="masstree__page__impl_8hpp_source.html#l00084">foedus::storage::masstree::MasstreePage::is_border()</a>, <a class="el" href="masstree__id_8hpp_source.html#l00132">foedus::storage::masstree::kInfimumSlice</a>, <a class="el" href="error__stack_8hpp_source.html#l00251">foedus::kRetOk</a>, <a class="el" href="masstree__id_8hpp_source.html#l00137">foedus::storage::masstree::kSupremumSlice</a>, <a class="el" href="masstree__storage__verify_8cpp_source.html#l00201">verify_single_thread_border()</a>, and <a class="el" href="masstree__storage__verify_8cpp_source.html#l00103">verify_single_thread_intermediate()</a>.</p>

<p>Referenced by <a class="el" href="masstree__storage__verify_8cpp_source.html#l00039">verify_single_thread()</a>, and <a class="el" href="masstree__storage__verify_8cpp_source.html#l00201">verify_single_thread_border()</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                            {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a>(layer_root-&gt;get_layer() == layer);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  HighFence high_fence(<a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">kSupremumSlice</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">if</span> (layer_root-&gt;is_border()) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f">verify_single_thread_border</a>(</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      context,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a>,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      high_fence,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      reinterpret_cast&lt;MasstreeBorderPage*&gt;(layer_root)));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a>(<a class="code" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417">verify_single_thread_intermediate</a>(</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      context,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <a class="code" href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">kInfimumSlice</a>,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      high_fence,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      reinterpret_cast&lt;MasstreeIntermediatePage*&gt;(layer_root)));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">kRetOk</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a9cffc20f29ad72d4edbeedece861c48f"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a9cffc20f29ad72d4edbeedece861c48f">foedus::storage::masstree::kInfimumSlice</a></div><div class="ttdeci">const KeySlice kInfimumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00132">masstree_id.hpp:132</a></div></div>
<div class="ttc" id="masstree__storage__verify_8cpp_html_aa0227b94f2abc9a7a5ac155db59cb2d3"><div class="ttname"><a href="masstree__storage__verify_8cpp.html#aa0227b94f2abc9a7a5ac155db59cb2d3">CHECK_AND_ASSERT</a></div><div class="ttdeci">#define CHECK_AND_ASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00035">masstree_storage_verify.cpp:35</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a688e9af62605f137637cc239f161c84f"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f">foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread_border</a></div><div class="ttdeci">ErrorStack verify_single_thread_border(thread::Thread *context, KeySlice low_fence, HighFence high_fence, MasstreeBorderPage *page)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00201">masstree_storage_verify.cpp:201</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga72a80915c3588aea09c053ab567e19c4"><div class="ttname"><a href="group__ERRORCODES.html#ga72a80915c3588aea09c053ab567e19c4">CHECK_ERROR</a></div><div class="ttdeci">#define CHECK_ERROR(x)</div><div class="ttdoc">This macro calls x and checks its returned value. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00517">error_stack.hpp:517</a></div></div>
<div class="ttc" id="group__ERRORCODES_html_ga61f52cd33eb500d6997a91e704ace244"><div class="ttname"><a href="group__ERRORCODES.html#ga61f52cd33eb500d6997a91e704ace244">foedus::kRetOk</a></div><div class="ttdeci">const ErrorStack kRetOk</div><div class="ttdoc">Normal return value for no-error case. </div><div class="ttdef"><b>Definition:</b> <a href="error__stack_8hpp_source.html#l00251">error_stack.hpp:251</a></div></div>
<div class="ttc" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_html_a351ca64071b130468a9ba9f200ccd417"><div class="ttname"><a href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417">foedus::storage::masstree::MasstreeStoragePimpl::verify_single_thread_intermediate</a></div><div class="ttdeci">ErrorStack verify_single_thread_intermediate(thread::Thread *context, KeySlice low_fence, HighFence high_fence, MasstreeIntermediatePage *page)</div><div class="ttdef"><b>Definition:</b> <a href="masstree__storage__verify_8cpp_source.html#l00103">masstree_storage_verify.cpp:103</a></div></div>
<div class="ttc" id="namespacefoedus_1_1storage_1_1masstree_html_a7bfcd277a96bcd1e9008459abe1ec40d"><div class="ttname"><a href="namespacefoedus_1_1storage_1_1masstree.html#a7bfcd277a96bcd1e9008459abe1ec40d">foedus::storage::masstree::kSupremumSlice</a></div><div class="ttdeci">const KeySlice kSupremumSlice</div><div class="ttdef"><b>Definition:</b> <a href="masstree__id_8hpp_source.html#l00137">masstree_id.hpp:137</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a09d587cc38996109b753a7704fa33736_cgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a09d587cc38996109b753a7704fa33736_cgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a09d587cc38996109b753a7704fa33736_cgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a09d587cc38996109b753a7704fa33736_cgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a0b54c43dec6f8ba15472a25760a3ed07" title="Layer&#45;0 stores the first 8 byte slice, Layer&#45;1 next 8 byte... " alt="" coords="785,5,960,47"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a1a6f55a5a59bcab9631bbb879da689ec" title="foedus::storage::masstree\l::MasstreePage::is_border" alt="" coords="1051,2157,1226,2199"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_border" alt="" coords="515,782,702,838"/>
<area shape="rect" id="node47" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_intermediate" alt="" coords="232,1335,453,1391"/>
<area shape="rect" id="node4" href="structfoedus_1_1storage_1_1PageHeader.html#a1bdd725342fd4aa90f983fec651f6956" title="foedus::storage::PageHeader\l::get_page_type" alt="" coords="1304,2033,1495,2075"/>
<area shape="rect" id="node6" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a04113a783c1b0022d35e7e8d7eae02a8" title="foedus::storage::masstree\l::MasstreeBorderPage::does\l_point_to_layer" alt="" coords="779,531,967,587"/>
<area shape="rect" id="node8" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a3ab3ec4aa9b6e43a606e1555c5c74cec" title="physical key count (those keys might be deleted) in this page. " alt="" coords="1296,745,1503,787"/>
<area shape="rect" id="node9" href="structfoedus_1_1xct_1_1XctId.html#aa3d33ca4fe97b735ce59594993a1dd94" title="foedus::xct::XctId\l::is_next_layer" alt="" coords="1338,473,1461,515"/>
<area shape="rect" id="node10" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#aff31f521523d7a7b81ff5b750e081dac" title="Thread::follow_page_pointer() for masstree. " alt="" coords="786,1070,959,1126"/>
<area shape="rect" id="node14" href="structfoedus_1_1storage_1_1DualPagePointer.html#aedde91e76a6e345f6d19539942f13a43" title="foedus::storage::DualPage\lPointer::is_both_null" alt="" coords="1051,1071,1226,1112"/>
<area shape="rect" id="node15" href="structfoedus_1_1xct_1_1XctId.html#af48118bbaf92a957116ae2873fe55b83" title="foedus::xct::XctId\l::get_epoch" alt="" coords="811,123,934,164"/>
<area shape="rect" id="node17" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a44cc8d18dc9077ae2310667e88ed5b7c" title="foedus::storage::masstree\l::MasstreePage::get_foster_fence" alt="" coords="764,1368,981,1409"/>
<area shape="rect" id="node18" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a27d301fad7d4d340cd2d6255dc330607" title="foedus::storage::masstree\l::MasstreePage::get_foster_major" alt="" coords="1029,1201,1248,1243"/>
<area shape="rect" id="node19" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a32653a16ddca213c94560652e9388dd5" title="foedus::storage::masstree\l::MasstreePage::get_foster_minor" alt="" coords="1029,1267,1248,1308"/>
<area shape="rect" id="node20" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a14c7383d33c5b6ddfcbab6b58ae80121" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_next_layer" alt="" coords="783,451,962,507"/>
<area shape="rect" id="node22" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a0bef5c88a00a3574b489d0259c5b49ad" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_owner_id" alt="" coords="783,742,962,798"/>
<area shape="rect" id="node23" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a4dc67e57eb2c90ffced75953dcef70fa" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_remainder_length" alt="" coords="783,822,962,878"/>
<area shape="rect" id="node24" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a42cee2c2a116efdd26420284e95a20f7" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slice" alt="" coords="767,953,979,995"/>
<area shape="rect" id="node25" href="structfoedus_1_1xct_1_1XctId.html#ad5be23a25e650f1bad81ce8c87630af0" title="foedus::xct::XctId\l::is_being_written" alt="" coords="811,188,934,229"/>
<area shape="rect" id="node26" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a6318577ff1e6f5106712e9ed60a429fe" title="Whether this page is receiving only sequential inserts. " alt="" coords="786,254,959,310"/>
<area shape="rect" id="node27" href="structfoedus_1_1xct_1_1McsRwLock.html#adc5e6612e3cecf3d2f15d02237b4ef8f" title="foedus::xct::McsRwLock\l::is_locked" alt="" coords="790,335,955,376"/>
<area shape="rect" id="node28" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#adc22d21883e15b87cd5ff6b6ec513c35" title="foedus::storage::masstree\l::MasstreePage::is_moved" alt="" coords="1051,1332,1227,1373"/>
<area shape="rect" id="node30" href="classfoedus_1_1Epoch.html#a8228a1a49b7db9b93498a778cb40f8e9" title="foedus::Epoch::is_valid" alt="" coords="795,401,950,427"/>
<area shape="rect" id="node31" href="classfoedus_1_1thread_1_1Thread.html#a17f375db3d50174cf49746e04ce00118" title="resolve() plus reinterpret_cast " alt="" coords="797,1303,948,1344"/>
<area shape="rect" id="node33" href="namespacefoedus_1_1storage_1_1masstree.html#acea98e6f343df2d62a9a8f9ddd127234" title="foedus::storage::masstree\l::verify_page_basic" alt="" coords="786,1740,959,1781"/>
<area shape="rect" id="node44" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a1781897598dfbd41a6d1291d0c5dc060" title="foedus::storage::masstree\l::MasstreeBorderPage::verify\l_slot_lengthes" alt="" coords="778,662,967,718"/>
<area shape="rect" id="node7" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a8b7973f3eb0f4f3c6894c278c18d7145" title="foedus::storage::masstree\l::MasstreeBorderPage::get_slot" alt="" coords="1035,745,1242,787"/>
<area shape="rect" id="node11" href="classfoedus_1_1thread_1_1Thread.html#a81e03c29d8931350b4df1fd1f8b9e4b6" title="A general method to follow (read) a page pointer. " alt="" coords="1063,1136,1214,1177"/>
<area shape="rect" id="node12" href="classfoedus_1_1thread_1_1ThreadPimpl.html#a9b77133f66157bca81a49caeca9a9904" title="A general method to follow (read) a page pointer. " alt="" coords="1307,1267,1491,1308"/>
<area shape="rect" id="node13" href="structfoedus_1_1storage_1_1VolatilePagePointer.html#ad9d25c0d8211f93db82d8cefe9d6ead7" title="foedus::storage::Volatile\lPagePointer::is_null" alt="" coords="1551,1451,1712,1492"/>
<area shape="rect" id="node16" href="structfoedus_1_1xct_1_1XctId.html#aa9ea819b1fb68a729e1c92825190a39c" title="foedus::xct::XctId\l::get_epoch_int" alt="" coords="1077,123,1200,164"/>
<area shape="rect" id="node21" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage.html#a357f4256ff48e1c5cefbee98d0a2dd2d" title="foedus::storage::masstree\l::MasstreeBorderPage::get\l_record_payload" alt="" coords="1049,401,1228,457"/>
<area shape="rect" id="node29" href="structfoedus_1_1storage_1_1PageVersion.html#a2b63daa9a7f39c8c85bf2d43f4c18d78" title="foedus::storage::PageVersion\l::is_moved" alt="" coords="1303,1397,1495,1439"/>
<area shape="rect" id="node32" href="classfoedus_1_1thread_1_1Thread.html#ade1f89cfaad84ff5dda0b6f7999a519e" title="Shorthand for get_global_volatile_page_resolver.resolve_offset() " alt="" coords="1063,1397,1214,1439"/>
<area shape="rect" id="node34" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab55e48873dcf5700871a035c65bfa588" title="used only in masstree. " alt="" coords="1035,2092,1243,2133"/>
<area shape="rect" id="node35" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abb6557473edd899373ed9399b455be20" title="foedus::storage::masstree\l::MasstreePage::get_high_fence" alt="" coords="1034,1675,1243,1716"/>
<area shape="rect" id="node36" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a30f922c414bf3a2faaf7e879b2277f0b" title="foedus::storage::masstree\l::MasstreePage::get_low_fence" alt="" coords="1037,1740,1241,1781"/>
<area shape="rect" id="node37" href="structfoedus_1_1storage_1_1Page.html#a33a7095a34e8a551fc22bd1aad2bda97" title="foedus::storage::Page\l::get_page_type" alt="" coords="1064,1975,1213,2016"/>
<area shape="rect" id="node38" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#abfe53cdc69964e52901556b1e8d9de9e" title="foedus::storage::masstree\l::MasstreePage::has_foster_child" alt="" coords="1031,1463,1247,1504"/>
<area shape="rect" id="node39" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#ab5ab7bbce35893143d2aac437e526d0e" title="foedus::storage::masstree\l::MasstreePage::header" alt="" coords="1052,1857,1225,1899"/>
<area shape="rect" id="node40" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a7a9d09469e106d14513932f3aebeef97" title="foedus::storage::masstree\l::MasstreePage::is_foster\l_major_null" alt="" coords="1313,1627,1486,1683"/>
<area shape="rect" id="node41" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a698b417f5e89daf68ebd78044222bb23" title="foedus::storage::masstree\l::MasstreePage::is_foster\l_minor_null" alt="" coords="1313,1726,1486,1782"/>
<area shape="rect" id="node42" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#aa0e32e13485c83c100d1153e23e96f88" title="foedus::storage::masstree\l::MasstreePage::is_high\l_fence_supremum" alt="" coords="1052,1529,1225,1585"/>
<area shape="rect" id="node43" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a16a2c06a304514be7b99fb6c884e7e9b" title="foedus::storage::masstree\l::MasstreePage::is_locked" alt="" coords="1050,1609,1227,1651"/>
<area shape="rect" id="node45" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_1_1Slot.html#a96be3b659b1812ecd7efbf601ea8c929" title="foedus::storage::masstree\l::MasstreeBorderPage::Slot\l::does_point_to_layer" alt="" coords="1047,531,1230,587"/>
<area shape="rect" id="node46" href="structfoedus_1_1storage_1_1masstree_1_1MasstreeBorderPage_1_1Slot.html#a447049b6067b0d1be460802f1b6a7076" title="This might be affected by concurrent threads. " alt="" coords="1047,662,1230,718"/>
<area shape="rect" id="node48" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#a1cb83de15afc0a903046937276b0ed31" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_minipage" alt="" coords="516,1637,701,1693"/>
<area shape="rect" id="node49" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeIntermediatePage.html#adaf1febd2954da507ffd8daa2757c890" title="foedus::storage::masstree\l::MasstreeIntermediatePage\l::get_separator" alt="" coords="516,939,701,995"/>
<area shape="rect" id="node50" href="classfoedus_1_1storage_1_1masstree_1_1MasstreePage.html#a14cdcef87b3c0a6ef431df9d06a1a663" title="An empty&#45;range page, either intermediate or border, never has any entries. " alt="" coords="501,1208,716,1249"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a09d587cc38996109b753a7704fa33736_icgraph.png" border="0" usemap="#classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a09d587cc38996109b753a7704fa33736_icgraph" alt=""/></div>
<map name="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a09d587cc38996109b753a7704fa33736_icgraph" id="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl_a09d587cc38996109b753a7704fa33736_icgraph">
<area shape="rect" id="node2" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a2a4e90569074d49ab538041caedacf6a" title="These are defined in masstree_storage_verify.cpp. " alt="" coords="239,5,412,61"/>
<area shape="rect" id="node4" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a688e9af62605f137637cc239f161c84f" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_border" alt="" coords="232,85,419,141"/>
<area shape="rect" id="node3" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStorage.html#aedee683fbced316953d1cbc622f22c87" title="foedus::storage::masstree\l::MasstreeStorage::verify\l_single_thread" alt="" coords="491,5,664,61"/>
<area shape="rect" id="node5" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html#a351ca64071b130468a9ba9f200ccd417" title="foedus::storage::masstree\l::MasstreeStoragePimpl\l::verify_single_thread_intermediate" alt="" coords="467,117,688,173"/>
</map>
</div>
</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/shino/foedus_code/foedus-core/include/foedus/storage/masstree/<a class="el" href="masstree__storage__pimpl_8hpp_source.html">masstree_storage_pimpl.hpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/masstree/<a class="el" href="masstree__storage__debug_8cpp_source.html">masstree_storage_debug.cpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/masstree/<a class="el" href="masstree__storage__fatify_8cpp_source.html">masstree_storage_fatify.cpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/masstree/<a class="el" href="masstree__storage__peek_8cpp_source.html">masstree_storage_peek.cpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/masstree/<a class="el" href="masstree__storage__pimpl_8cpp_source.html">masstree_storage_pimpl.cpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/masstree/<a class="el" href="masstree__storage__prefetch_8cpp_source.html">masstree_storage_prefetch.cpp</a></li>
<li>/home/shino/foedus_code/foedus-core/src/foedus/storage/masstree/<a class="el" href="masstree__storage__verify_8cpp_source.html">masstree_storage_verify.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefoedus.html">foedus</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1storage.html">storage</a></li><li class="navelem"><a class="el" href="namespacefoedus_1_1storage_1_1masstree.html">masstree</a></li><li class="navelem"><a class="el" href="classfoedus_1_1storage_1_1masstree_1_1MasstreeStoragePimpl.html">MasstreeStoragePimpl</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
